var b=(_,i,s)=>new Promise((f,c)=>{var g=a=>{try{u(s.next(a))}catch(n){c(n)}},m=a=>{try{u(s.throw(a))}catch(n){c(n)}},u=a=>a.done?f(a.value):Promise.resolve(a.value).then(g,m);u((s=s.apply(_,i)).next())});import{j as R,a6 as v,e4 as B,e5 as E,cM as L,C as x,a7 as M,m as z,s as D,t as T,v as t,w as r,H as e,aB as V,cK as S,y as k,z as C,ax as N,R as O,o as U,ea as $,ab as A,db as j,e7 as G,u as H,e8 as K}from"./index.0be4b5b8.js";import{C as P}from"./index.2fd0f218.js";import{_ as W}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang.cd3e18ca.js";const Y=R({__name:"MobileForm",setup(_){const i=v.Item,{t:s}=U(),{handleBackLogin:f,getLoginState:c}=B(),{getFormRules:g}=E(),{notification:m,createErrorModal:u}=H(),a=L(),n=x(),p=x(!1),l=M({mobile:"",sms:""}),{validForm:h}=K(n),F=z(()=>e(c)===$.MOBILE);function w(){return b(this,null,function*(){const d=yield h();if(!!d)try{p.value=!0;const o=yield a.phoneLogin(A({mobile:d.mobile,captcha:d.sms,mode:"none"}));o&&m.success({message:s("sys.login.loginSuccessTitle"),description:`${s("sys.login.loginSuccessDesc")}: ${o.realname}`,duration:3})}catch(o){m.error({message:s("sys.api.errorTip"),description:o.message||s("sys.api.networkExceptionMsg"),duration:3})}finally{p.value=!1}})}function I(){return j({mobile:l.mobile,smsmode:G.FORGET_PASSWORD})}return(d,o)=>F.value?(D(),T(N,{key:0},[t(W,{class:"enter-x"}),t(e(v),{class:"p-4 enter-x",model:l,rules:e(g),ref_key:"formRef",ref:n},{default:r(()=>[t(e(i),{name:"mobile",class:"enter-x"},{default:r(()=>[t(e(V),{size:"large",value:l.mobile,"onUpdate:value":o[0]||(o[0]=y=>l.mobile=y),placeholder:e(s)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),t(e(i),{name:"sms",class:"enter-x"},{default:r(()=>[t(e(P),{size:"large",class:"fix-auto-fill",value:l.sms,"onUpdate:value":o[1]||(o[1]=y=>l.sms=y),placeholder:e(s)("sys.login.smsCode"),sendCodeApi:I},null,8,["value","placeholder"])]),_:1}),t(e(i),{class:"enter-x"},{default:r(()=>[t(e(S),{type:"primary",size:"large",block:"",onClick:w,loading:p.value},{default:r(()=>[k(C(e(s)("sys.login.loginButton")),1)]),_:1},8,["loading"]),t(e(S),{size:"large",block:"",class:"mt-4",onClick:e(f)},{default:r(()=>[k(C(e(s)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])],64)):O("",!0)}});export{Y as _};
