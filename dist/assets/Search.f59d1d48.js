import{l as be,aX as we,F as s,c3 as y,di as De,dj as Fe,$ as Be,t as u,v as o,x as F,y as n,z as l,aV as xe,dk as Se,R as j,S as K,W as m,V as _,L as B,dl as Oe,dm as Ae,X as $,bj as Ee,aw as z,bb as ee,C as d,D as I,b4 as Pe,dn as ae,a6 as Ne}from"./index.5f7d93b1.js";import{extractUrl as Ue}from"./urlUtil.b8806189.js";import{g as $e}from"./api.80306347.js";const Le=()=>navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)!=null,Me=()=>!Le(),Te={class:"flex flex-wrap justify-evenly"},Ye={key:0,class:"flex flex-wrap justify-evenly"},je=d("\u4ECA\u5E74 "),Ke=d(" 30\u5929 "),ze=d(" \u672C\u6708 "),Ie=d(" \u6628\u5929 "),Ve=d(" \u4ECA\u5929 "),qe=d("\u7C98\u8D34"),He={key:1},Xe=d("\u6FC0\u6D3B\u94FE"),Je={key:1,class:"flex flex-wrap justify-evenly"},Ze=be({__name:"Search",props:{placeholder:{type:String,default:"\u7C98\u8D34\u641C\u7D22"},showTop:{type:Boolean,default:!1},showCopy:{type:Boolean,default:!1},showSwitch:{type:Boolean,default:!1},showPeople:{type:Boolean,default:!1},tabPane:{type:Object,default:()=>({tabs:[],activeKey:"0"})}},emits:["queryList","changeAdvanced","confirmCopy"],setup(k,{expose:te,emit:L}){var W;const g=k,{hasPermission:V}=we(),v=s(y()),b=s(y()),i=s(),c=s(1),q=s(!0),A=s(!1),E=s(!1),M=s([]),f=s(0),w=s(!1),h=s(!1),le=e=>e&&e>y().endOf("day"),ne=e=>e&&e>y().endOf("day")||e.isBefore(v.value),C=s(),x=(e,a=0)=>{f.value=e,f.value===365?v.value=y().startOf("year"):f.value===100?v.value=y().startOf("month"):v.value=y().subtract(e,"day"),b.value=y().subtract(a,"day"),C.value=!1,p()},H=()=>{C.value=!0,p()},ue=()=>{navigator.clipboard.readText().then(e=>{i.value=e,p()}).catch(e=>{e instanceof DOMException?ae.error("\u8BF7\u624B\u52A8\u7C98\u8D34\uFF0C\u6216\u5141\u8BB8\u8BFB\u53D6\u526A\u8D34\u677F\uFF0C\u5931\u8D25\u539F\u56E0\uFF1A"+e):ae.error("\u8BF7\u624B\u52A8\u7C98\u8D34\uFF0C\u5931\u8D25\u539F\u56E0\uFF1A"+e)})},X=()=>q.value?h.value&&g.showSwitch?"warning":"primary":"error",se=()=>{M.value.length===0&&(E.value=!0,$e({}).then(e=>{M.value=e.records,E.value=!1}))},T=De(Fe),S=s();let{username:P,realname:oe}=T==null?void 0:T.userInfo;const ie=P;S.value=oe;const re=e=>{P=e,q.value=ie===S.value,e==null&&(S.value="\u6240\u6709\u4EBA"),p()},N=s((W=g==null?void 0:g.tabPane)==null?void 0:W.activeKey),ce=e=>{N.value=e,p()},p=()=>{var a,r,D,O,U;v.value.isAfter(b.value)&&(b.value=v.value),i.value=Ue((a=i==null?void 0:i.value)==null?void 0:a.trim());let e=(r=i.value)==null?void 0:r.indexOf("/j/");e<0&&(e=(D=i.value)==null?void 0:D.indexOf("/c/")),e<0&&(e=(O=i.value)==null?void 0:O.indexOf("/d/")),e>=0&&(i.value=(U=i.value)==null?void 0:U.substring(e+3)),localStorage.setItem("searchSwitch",JSON.stringify(h.value)),L("queryList",{pageNo:1,pageSize:30,startTime:v.value.startOf("day").format("YYYY-MM-DD HH:mm:ss"),endTime:b.value.endOf("day").format("YYYY-MM-DD HH:mm:ss"),keyword:i.value,username:P,checked:h.value,status:N.value})},de=()=>{w.value=!w.value,L("changeAdvanced")},J=()=>{A.value=!0,L("confirmCopy",{count:c.value,username:P,checked:h.value})},{proxy:Q}=Ne();return te({queryFinish:(e="")=>{c.value===1?Q.tool.copy(e,e+"\u5DF2\u590D\u5236"):Q.tool.copy(e,c.value+"\u6761\u5DF2\u590D\u5236"),A.value=!1}}),Be(()=>{var e;h.value=JSON.parse((e=localStorage.getItem("searchSwitch"))!=null?e:"false"),p()}),(e,a)=>{var G,R;const r=u("a-button"),D=u("a-space"),O=u("a-date-picker"),U=u("a-select-option"),ve=u("a-spin"),fe=u("a-select"),pe=u("a-switch"),ye=u("a-input"),me=u("a-card"),Y=u("a-col"),_e=u("a-slider"),ke=u("a-popconfirm"),he=u("a-row"),Ce=u("a-tab-pane"),ge=u("a-tabs");return o(),F(z,null,[n(me,{size:"small"},{default:l(()=>[xe("div",Te,[k.showTop?(o(),F("div",Ye,[n(D,{size:5,class:"mb-2"},{default:l(()=>[n(r,{type:!C.value&&f.value===365?"link":"",onClick:a[0]||(a[0]=t=>x(365,0))},{default:l(()=>[je]),_:1},8,["type"]),n(r,{type:!C.value&&f.value===30?"link":"",onClick:a[1]||(a[1]=t=>x(30,0))},{default:l(()=>[Ke]),_:1},8,["type"]),n(r,{type:!C.value&&f.value===100?"link":"",onClick:a[2]||(a[2]=t=>x(100))},{default:l(()=>[ze]),_:1},8,["type"]),n(r,{type:!C.value&&f.value===1?"link":"",onClick:a[3]||(a[3]=t=>x(1,1))},{default:l(()=>[Ie]),_:1},8,["type"]),n(r,{type:!C.value&&f.value===0?"link":"",onClick:a[4]||(a[4]=t=>x(0,0))},{default:l(()=>[Ve]),_:1},8,["type"])]),_:1}),n(Se,{"enter-active-class":"animate__animated animate__flipInX","leave-active-class":"animate__animated animate__flipOutX animate__faster"},{default:l(()=>[j(n(D,{class:"mb-2"},{default:l(()=>[n(O,{onChange:H,allowClear:"",placeholder:"\u5F00\u59CB\u65E5\u671F","disabled-date":le,value:v.value,"onUpdate:value":a[5]||(a[5]=t=>v.value=t)},null,8,["value"]),n(O,{onChange:H,allowClear:"",placeholder:"\u7ED3\u675F\u65E5\u671F","disabled-date":ne,value:b.value,"onUpdate:value":a[6]||(a[6]=t=>b.value=t)},null,8,["value"])]),_:1},512),[[K,w.value]])]),_:1})])):m("",!0),n(ye,{size:"large",value:i.value,"onUpdate:value":a[10]||(a[10]=t=>i.value=t),onChange:p,placeholder:k.placeholder,allowClear:""},{prefix:l(()=>[n(r,{type:"link",onClick:de},{default:l(()=>[w.value?(o(),_(B(Oe),{key:0})):(o(),_(B(Ae),{key:1}))]),_:1}),$(e.$slots,"prefix"),w.value?(o(),_(D,{key:0},{default:l(()=>[B(V)("am:selectUser")&&k.showPeople?(o(),_(fe,{key:0,size:"",loading:E.value,allowClear:"",ref:"select",value:S.value,"onUpdate:value":a[7]||(a[7]=t=>S.value=t),style:{width:"90px"},onFocus:se,onChange:re},Ee({default:l(()=>[(o(!0),F(z,null,ee(M.value,t=>(o(),_(U,{key:t.id,value:t.username},{default:l(()=>[d(I(t.realname),1)]),_:2},1032,["value"]))),128))]),_:2},[E.value?{name:"notFoundContent",fn:l(()=>[n(ve,{size:"small"})]),key:"0"}:void 0]),1032,["loading","value"])):m("",!0),B(Me)()?(o(),_(r,{key:1,ghost:"",type:"success",onClick:ue},{default:l(()=>[qe]),_:1})):m("",!0)]),_:1})):m("",!0)]),suffix:l(()=>[w.value?$(e.$slots,"suffix",{key:0}):m("",!0),$(e.$slots,"suffixAdvanced"),k.showSwitch&&B(V)("link:switch")?(o(),F("span",He,[n(r,{class:"animate__animated animate__heartBeat animate__slower animate__repeat-3",onClick:a[8]||(a[8]=t=>B(Pe).push("/pms/am/link")),type:"link",danger:""},{default:l(()=>[Xe]),_:1}),n(pe,{onClick:p,checked:h.value,"onUpdate:checked":a[9]||(a[9]=t=>h.value=t)},null,8,["checked"])])):m("",!0)]),_:3},8,["value","placeholder"])])]),_:3}),k.showCopy?(o(),_(he,{key:0,class:"w-full mt-2"},{default:l(()=>[n(Y,{span:4},{default:l(()=>[$(e.$slots,"left")]),_:3}),n(Y,{span:14},{default:l(()=>[n(_e,{style:{display:"inline-block"},value:c.value,"onUpdate:value":a[11]||(a[11]=t=>c.value=t),min:1,max:500},null,8,["value"])]),_:1}),n(Y,{class:"text-center",span:6},{default:l(()=>[j(n(r,{onClick:J,loading:A.value,type:X()},{default:l(()=>[d("\u590D\u5236"+I(c.value)+"\u6761 ",1)]),_:1},8,["loading","type"]),[[K,c.value===1]]),n(ke,{title:`\u786E\u5B9A\u590D\u5236${c.value}\u6761\u5417?`,"ok-text":"\u786E\u5B9A","cancel-text":"\u53D6\u6D88",onConfirm:J},{default:l(()=>[j(n(r,{loading:A.value,placeholder:"\u5F00\u59CB\u65E5\u671F",type:X()},{default:l(()=>[d("\u590D\u5236"+I(c.value)+"\u6761 ",1)]),_:1},8,["loading","type"]),[[K,c.value>1]])]),_:1},8,["title"])]),_:1})]),_:3})):m("",!0),((R=(G=g.tabPane)==null?void 0:G.tabs)==null?void 0:R.length)>0?(o(),F("div",Je,[n(ge,{animated:!1,activeKey:N.value,"onUpdate:activeKey":a[12]||(a[12]=t=>N.value=t),onTabClick:ce},{default:l(()=>{var t;return[(o(!0),F(z,null,ee((t=g.tabPane)==null?void 0:t.tabs,Z=>(o(),_(Ce,{key:Z.tabKey,tab:Z.tabName},null,8,["tab"]))),128))]}),_:1},8,["activeKey"])])):m("",!0)],64)}}});export{Ze as default};
