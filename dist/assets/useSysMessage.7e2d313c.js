var e=(e,t,a)=>new Promise(((n,s)=>{var r=e=>{try{l(a.next(e))}catch(t){s(t)}},u=e=>{try{l(a.throw(e))}catch(t){s(t)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,u);l((a=a.apply(e,t)).next())}));import{b as t,F as a,a8 as n,dL as s,G as r,dN as u,dO as l,a1 as o}from"./index.b3c93d64.js";function i(){t("rangeDate");const s=a([]),r=a(1);const u=n({fromUser:"",rangeDateKey:"",rangeDate:[],starFlag:""});const l=a(!1);function i(){return e(this,null,(function*(){if(!0===l.value)return;let e=function(){let{fromUser:e,rangeDateKey:t,rangeDate:a,starFlag:n}=u,s={fromUser:e,starFlag:n,rangeDateKey:t,beginDate:"",endDate:"",pageNo:r.value,pageSize:10};return"zdy"==t&&(s.beginDate=a[0]+" 00:00:00",s.endDate=a[1]+" 23:59:59"),s}();const t=yield(e=>o.get({url:"/sys/annountCement/vue3List",params:e}))(e);if(!t||t.length<=0)return void(l.value=!0);t.length<10&&(l.value=!0),r.value=r.value+1;let a=s.value;a.push(...t),s.value=a}))}const c=a(!1);return{messageList:s,reset:function(){s.value=[],r.value=1,l.value=!1},loadData:i,loadEndStatus:l,searchParams:u,updateStarMessage:function(e){let t="1";e.starFlag==t&&(t="0");const a={starFlag:t,id:e.sendId};o.put({url:"/sys/sysAnnouncementSend/edit",params:a})},onLoadMore:function(){return e(this,null,(function*(){c.value=!0,yield i(),c.value=!1}))},noRead:function(e){return"1"!==e.readFlag},getMsgCategory:function(e){return"email"==e.busType?"邮件提醒:":"bpm"==e.busType?"流程催办:":"bpm_task"==e.busType?"流程任务:":"2"==e.msgCategory?"系统消息:":"1"==e.msgCategory?"通知公告:":""}}}function c(a){const n=t("messageHref"),o=s(),i=r(),c=u(),{close:g,closeSameRoute:d}=l();return{goPage:function(t,s){return e(this,null,(function*(){t.busType?yield function(t){return e(this,null,(function*(){const{busType:e,busId:a,msgAbstract:s}=t;let r=n.filter((t=>t.value===e));if(!r||0==r.length)return;let u=r[0].text;u=u.replace("{DETAIL_ID}",a);let l={detailId:a};if(s)try{let e=JSON.parse(s);Object.keys(e).map((t=>{l[t]=e[t]}))}catch(f){}i.setMessageHrefParams(l),c.path.indexOf(u)>=0?(yield g(),yield o.replace({path:u,query:{time:(new Date).getTime()}})):(d(u),yield o.push({path:u}))}))}(t):s?s():yield function(t){return e(this,null,(function*(){a("detail",t)}))}(t)}))}}}export{i as a,c as u};
