import{q as a,h as e,cI as t,dm as n,dl as l,aF as i,dz as o,a1 as s,t as d,v as p,V as h,z as u,y as r,R as b,S as g,E as c,dp as w,dq as x,aW as y}from"./index.b3c93d64.js";const S={name:"ErpTemplate",data(){return{toolbarConfig:{slot:["prefix","suffix"],btn:["add","remove","clearSelection"]},expandConfig:{accordion:!0},subTabs:{show:!1,expand:!0,autoExpand:!0},table1:{loading:!1,pagination:{current:1,pageSize:200,pageSizeOptions:["10","20","30","100","200"],total:0,showTotal:(a,o)=>{let s=e("span",`${o[0]}-${o[1]} 共 ${a} 条`);if(this.subTabs.show){return[e("span",{},[e(t,{type:"link",onClick:this.handleToggleTabs},(()=>[this.subTabs.expand?e(n):e(l),e("span",{},this.subTabs.expand?"收起":"展开")])),e(i,{checked:this.subTabs.autoExpand,"onUpdate:checked":a=>this.subTabs.autoExpand=a},(()=>"自动展开"))]),s]}return s}},selectedRows:[],dataSource:[],columns:[{key:"num",title:"序号",width:"80px"},{key:"ship_name",title:"船名",width:"180px",type:o.input},{key:"call",title:"呼叫",width:"990px",type:o.input},{key:"len",title:"长",width:"80px",type:o.inputNumber},{key:"ton",title:"吨",width:"120px",type:o.inputNumber},{key:"payer",title:"付款方",width:"120px",type:o.input},{key:"count",title:"数",width:"40px"},{key:"company",title:"公司",minWidth:"180px",type:o.input},{key:"trend",title:"动向",width:"120px",type:o.input}]},table2:{currentRowId:null,loading:!1,pagination:{current:1,pageSize:10,pageSizeOptions:["5","10","20","30"],total:0},selectedRows:[],dataSource:[],columns:[{key:"dd_num",title:"调度序号",width:"120px"},{key:"tug",title:"拖轮",width:"180px",type:o.input},{key:"work_start_time",title:"作业开始时间",width:"180px",type:o.input},{key:"work_stop_time",title:"作业结束时间",width:"180px",type:o.input},{key:"type",title:"船舶分类",width:"120px",type:o.input},{key:"port_area",title:"所属港区",width:"120px",type:o.input}]},currentSubRow:null,url:{getData:"/mock/vxe/getData"}}},computed:{tableHeight(){let{show:a,expand:e}=this.subTabs;return a&&e?350:482}},created(){this.loadTable1Data()},methods:{loadTable1Data(){let a={pageNo:this.table1.pagination.current,pageSize:this.table1.pagination.pageSize};this.table1.loading=!0,s.get({url:this.url.getData,params:a}).then((a=>{this.table1.pagination.total=a.total,this.table1.dataSource=a.records,this.table1.selectedRows=[]})).finally((()=>{this.table1.loading=!1}))},loadSubData(a){return!!a&&(this.table2.currentRowId===a.id||(this.table2.currentRowId=a.id,this.loadTable2Data()),!0)},loadTable2Data(){let a=this.table2,e={parentId:a.currentRowId,pageNo:this.table2.pagination.current,pageSize:this.table2.pagination.pageSize};a.loading=!0,s.get({url:this.url.getData,params:e}).then((e=>{a.selectedRows=[],a.dataSource=e.records,a.pagination.total=e.total})).finally((()=>{a.loading=!1}))},handleTable1SelectRowChange(a){this.table1.selectedRows=a.selectedRows,this.subTabs.show=!0,this.subTabs.autoExpand&&(this.subTabs.expand=!0),this.loadSubData(a.selectedRows[0])},handleTable2SelectRowChange(a){this.table2.selectedRows=a.selectedRows},handleTable1PageChange(a){this.table1.pagination.current=a.current,this.table1.pagination.pageSize=a.pageSize,this.loadTable1Data()},handleTable2PageChange(a){this.table2.pagination.current=a.current,this.table2.pagination.pageSize=a.pageSize,this.loadTable2Data()},handleToggleTabs(){this.subTabs.expand=!this.subTabs.expand}}},T=a=>(w("data-v-62164a83"),a=a(),x(),a),m=T((()=>y("h1",null,"这里是子表2",-1))),C=T((()=>y("h1",null,"这里是子表2",-1))),k=T((()=>y("h1",null,"这里是子表2",-1))),R=T((()=>y("h1",null,"这里是子表2",-1))),f=T((()=>y("h1",null,"这里是子表2",-1))),z=T((()=>y("h1",null,"这里是子表2",-1)));var _=a(S,[["render",function(a,e,t,n,l,i){const o=d("JVxeTable"),s=d("a-tab-pane"),w=d("a-tabs"),x=d("a-card");return p(),h(x,{bordered:!1},{default:u((()=>[r(o,{toolbar:"",toolbarConfig:l.toolbarConfig,rowNumber:"",rowSelection:"",rowSelectionType:"radio",clickSelectRow:"",highlightCurrentRow:"",height:i.tableHeight,loading:l.table1.loading,columns:l.table1.columns,dataSource:l.table1.dataSource,pagination:l.table1.pagination,expandConfig:l.expandConfig,style:{"margin-bottom":"8px"},onPageChange:i.handleTable1PageChange,onSelectRowChange:i.handleTable1SelectRowChange},null,8,["toolbarConfig","height","loading","columns","dataSource","pagination","expandConfig","onPageChange","onSelectRowChange"]),b(r(w,{class:c({"sub-tabs":!0,"un-expand":!l.subTabs.expand})},{default:u((()=>[r(s,{tab:"子表1",key:"1"},{default:u((()=>[r(o,{toolbar:"","row-number":"","row-selection":"",height:"auto",maxHeight:350,loading:l.table2.loading,columns:l.table2.columns,dataSource:l.table2.dataSource,pagination:l.table2.pagination,onPageChange:i.handleTable2PageChange,onSelectRowChange:i.handleTable2SelectRowChange},null,8,["loading","columns","dataSource","pagination","onPageChange","onSelectRowChange"])])),_:1}),r(s,{tab:"子表2",key:"2"},{default:u((()=>[m,C,k,R,f,z])),_:1})])),_:1},8,["class"]),[[g,l.subTabs.show]])])),_:1})}],["__scopeId","data-v-62164a83"]]);export{_ as default};
