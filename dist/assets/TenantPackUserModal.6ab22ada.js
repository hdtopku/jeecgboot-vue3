var k=(e,f,n)=>new Promise((B,m)=>{var g=o=>{try{r(n.next(o))}catch(i){m(i)}},c=o=>{try{r(n.throw(o))}catch(i){m(i)}},r=o=>o.done?B(o.value):Promise.resolve(o.value).then(g,c);r((n=n.apply(e,f)).next())});import{B as A}from"./index.942ae64c.js";import j from"./BasicTable.1f9db63f.js";import{T as O}from"./componentMap.402f8d06.js";import"./BasicTable.vue_vue_type_style_index_0_lang.7002ba29.js";import"./TableImg.vue_vue_type_style_index_0_lang.e550a269.js";import{useListPage as $}from"./useListPage.5ed5bcb5.js";import{t as q}from"./tenant.data.80ce3b21.js";import{q as v,b as D,c as L}from"./tenant.api.ff45769b.js";import{a as V}from"./index.1ca4599c.js";import{j as z,a8 as E,bH as H,C as K,bI as Q,cM as G,q as J,r as u,s as M,Q as W,w as l,v as b,t as S,ax as I,y as h,z as y,R as U}from"./index.241c886f.js";import"./BasicModal.cfab584a.js";import"./useWindowSizeFn.01c7b19f.js";import"./BasicForm.85dd04b6.js";import"./BasicForm.vue_vue_type_style_index_0_lang.ae157906.js";import"./uniqBy.57f60d92.js";import"./useFormItem.f1fb85ce.js";import"./functional.a3a4ffc3.js";import"./download.21653b1e.js";import"./base64Conver.030fa32c.js";import"./index.ba19cec8.js";import"./index.67d46494.js";import"./useCountdown.fad41293.js";import"./JAddInput.2d42a71c.js";import"./areaDataUtil.5ccd89d2.js";import"./api.cd27fbef.js";import"./props.10f1db43.js";import"./index.a2e27c18.js";import"./bem.d4d59b92.js";import"./props.394b99ec.js";import"./useContextMenu.37ec29c7.js";import"./index.63c54a6a.js";import"./onMountedOrActivated.7d12d100.js";import"./index.96da7ff0.js";import"./htmlmixed.4a3ad425.js";import"./vue.93346669.js";/* empty css             */import"./depart.api.4991cabc.js";import"./MinusCircleOutlined.99343ef9.js";import"./JUpload.vue_vue_type_style_index_0_lang.67ed2e27.js";import"./index.5c569bac.js";import"./useForm.8e4ea63f.js";import"./index.b05a25ac.js";import"./useContentHeight.77e84762.js";import"./useContentViewHeight.2c1193bb.js";import"./usePageContext.bb3e692a.js";import"./RedoOutlined.507a2036.js";import"./useTable.5cd37444.js";import"./renderUtils.03e07a7e.js";const X=z({name:"TenantPackUserModal",components:{BasicModal:A,BasicTable:j,TableAction:O,UserSelectModal:V},setup(){const e=E({}),[f,{setModalProps:n,closeModal:B}]=H(t=>k(this,null,function*(){n({confirmLoading:!1,showCancelBtn:!0,showOkBtn:!1}),Object.assign(e,t.record),yield p()})),m=K("\u7528\u6237"),{tableContext:g}=$({tableProps:{api:v,immediate:!1,columns:q,canResize:!1,useSearchForm:!1,beforeFetch:t=>(t.tenantId=e.tenantId,t.packId=e.id,t.status=1,t),actionColumn:{width:120,fixed:"right"}}}),[c,{openModal:r,closeModal:o}]=Q(),[i,{reload:p},{rowSelection:a,selectedRowKeys:w}]=g;function C(t){return t.join(",")}function _(t){let s=G().getUserInfo.username;return s!=e.createBy,[{label:"\u79FB\u9664",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u79FB\u9664",confirm:N.bind(null,t)},ifShow:s==e.createBy},{label:"---",ifShow:s!=e.createBy}]}function N(t){return k(this,null,function*(){let d={packId:t.packId,packName:t.packName,tenantId:t.tenantId,userId:t.id,realname:t.realname};yield D(d),yield p()})}function P(){r(!0,{list:[]})}function R(t){return k(this,null,function*(){if(t&&t.length>0){let d=[],s=[];for(let T of t)d.push(T.realname),s.push(T.id);console.log(e);let F={packId:e.id,packName:e.packName,tenantId:e.tenantId,userId:s.join(","),realname:d.join(",")};yield L(F),yield p()}o()})}return{title:m,registerModal:f,registerTable:i,rowSelection:a,getName:C,getTableAction:_,registerUserModal:c,addUser:P,onSelected:R}}});function Y(e,f,n,B,m,g){const c=u("a-button"),r=u("TableAction"),o=u("BasicTable"),i=u("user-select-modal"),p=u("BasicModal");return M(),W(p,{onRegister:e.registerModal,destroyOnClose:"",title:e.title,width:1e3,onOk:e.handleSubmit},{default:l(()=>[b(o,{onRegister:e.registerTable,rowSelection:e.rowSelection},{departNames:l(({text:a,record:w})=>[a&&a.length>0?(M(),S(I,{key:0},[h(y(e.getName(a)),1)],64)):U("",!0)]),positionNames:l(({text:a,record:w})=>[a&&a.length>0?(M(),S(I,{key:0},[h(y(e.getName(a)),1)],64)):U("",!0)]),tableTitle:l(()=>[b(c,{preIcon:"ant-design:usergroup-add-outlined",type:"primary",onClick:e.addUser},{default:l(()=>[h("\u9080\u8BF7\u6210\u5458")]),_:1},8,["onClick"])]),action:l(({record:a})=>[b(r,{actions:e.getTableAction(a)},null,8,["actions"])]),_:1},8,["onRegister","rowSelection"]),b(i,{multi:!0,onRegister:e.registerUserModal,onSelected:e.onSelected},null,8,["onRegister","onSelected"])]),_:1},8,["onRegister","title","onOk"])}const Ge=J(X,[["render",Y]]);export{Ge as default};
