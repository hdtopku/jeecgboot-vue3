var E=Object.defineProperty;var D=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var C=(r,t,o)=>t in r?E(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o,B=(r,t)=>{for(var o in t||(t={}))L.call(t,o)&&C(r,o,t[o]);if(D)for(var o of D(t))S.call(t,o)&&C(r,o,t[o]);return r};var w=(r,t,o)=>new Promise((f,m)=>{var a=i=>{try{n(o.next(i))}catch(u){m(u)}},c=i=>{try{n(o.throw(i))}catch(u){m(u)}},n=i=>i.done?f(i.value):Promise.resolve(i.value).then(a,c);n((o=o.apply(r,t)).next())});import{B as T}from"./BasicForm.e500713f.js";import"./helper.15e1830a.js";import{u as U}from"./useForm.f4b29e26.js";import"./JAddInput.5c78e955.js";import{l as V,dR as k,F as v,L as s,o as I,v as W,V as x,z as M,y as N,B as O}from"./index.6c1aeca2.js";import{f as $,l as j,C as q,g as z}from"./menu.data.ac210277.js";import{u as G,B as H}from"./index.019f55e0.js";import{useDrawerAdaptiveWidth as J}from"./useAdaptiveWidth.1c3c9787.js";import"./uniqBy.b316cd09.js";import"./index.c1c509d9.js";import"./BasicModal.2246c02b.js";import"./useWindowSizeFn.a6a246d2.js";import"./useFormItem.63b4eda3.js";import"./functional.32464814.js";import"./download.54491438.js";import"./base64Conver.030fa32c.js";import"./index.1785e33e.js";import"./index.9d763a26.js";import"./useCountdown.c7fbe84b.js";import"./JUpload.7c7f9634.js";import"./api.52ea4d1e.js";import"./index.af09c9a6.js";import"./props.0c0dfcc6.js";import"./index.5b79f8bf.js";import"./bem.8f063110.js";import"./props.ee552767.js";import"./useContextMenu.2ad8381d.js";import"./index.3803400c.js";import"./onMountedOrActivated.0e85db74.js";import"./index.2847d809.js";import"./htmlmixed.6fb02709.js";import"./vue.ab8c7c18.js";/* empty css             */import"./usePopBiz.651349c4.js";import"./useMethods.eccfa16d.js";import"./depart.api.c664bb73.js";import"./user.api.295372fd.js";import"./renderUtils.b120a814.js";import"./validator.ec5b4198.js";const Ie=V({__name:"MenuDrawer",emits:["success","register"],setup(r,{emit:t}){const{adaptiveWidth:o}=J(),f=k(),m=v(!0),a=v(0),c=e=>e===2,[n,{setProps:i,resetFields:u,setFieldsValue:y,updateSchema:g,validate:_,clearValidate:K}]=U({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:$,showActionButtonGroup:!1}),[b,{setDrawerProps:d,closeDrawer:A}]=G(e=>w(this,null,function*(){var F;yield u(),d({confirmLoading:!1}),m.value=!!(e!=null&&e.isUpdate),a.value=(F=e==null?void 0:e.record)==null?void 0:F.menuType;const p=yield j();if(g([{field:"parentId",componentProps:{treeData:p}},{field:"name",label:c(s(a))?"\u6309\u94AE/\u6743\u9650":"\u83DC\u5355\u540D\u79F0"},{field:"url",required:!c(s(a)),componentProps:{onChange:l=>h(l.target.value)}}]),typeof e.record=="object"){let l=B({},e.record);y(l),h(l.url)}i({disabled:!f.showFooter})})),P=I(()=>s(m)?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355");function R(){return w(this,null,function*(){try{const e=yield _();q.IFrame===e.component&&(e.component=e.frameSrc),d({confirmLoading:!0}),yield z(e,s(m)),A(),t("success")}finally{d({confirmLoading:!1})}})}function h(e){let p="";e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),p=`${e}`):p="\u8BF7\u8F93\u5165\u7EC4\u4EF6\u540D\u79F0",g([{field:"componentName",componentProps:{placeholder:p}}])}return(e,p)=>(W(),x(s(H),O(e.$attrs,{onRegister:s(b),showFooter:"",width:s(o),title:s(P),onOk:R}),{default:M(()=>[N(s(T),{onRegister:s(n),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{Ie as default};
