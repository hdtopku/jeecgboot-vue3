var e=(e,a,l)=>new Promise(((t,r)=>{var o=e=>{try{n(l.next(e))}catch(a){r(a)}},d=e=>{try{n(l.throw(e))}catch(a){r(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,d);n((l=l.apply(e,a)).next())}));import{B as a}from"./index.934459b9.js";import{q as l,l as t,F as r,a8 as o,bH as d,L as n,o as i,t as s,v as u,V as c,z as f,y as p,B as v,C as m}from"./index.26a57b91.js";import"./BasicModal.e5e1fb3e.js";import"./useWindowSizeFn.9ed8a10e.js";const b=t({name:"VexTableModal",components:{BasicModal:a},emits:["success","register"],setup(a,{emit:l}){const t=r(!0),s=r({}),u=r(""),c=r(),f=o({xs:{span:24},sm:{span:5}}),p=o({xs:{span:24},sm:{span:16}}),v=r([{label:"",value:""},{label:"男",value:"1"},{label:"女",value:"2"}]),m=o({id:null,orderCode:"",orderMoney:"",ctype:"",content:"",jeecgOrderCustomerList:[],jeecgOrderTicketList:[]}),[b,{setModalProps:M,closeModal:g}]=d((a=>e(this,null,(function*(){m.orderCode="",M({confirmLoading:!1}),t.value=!!(null==a?void 0:a.isUpdate),n(t)&&(u.value=a.record.id,m.orderCode=a.record.orderCode)})))),h=r([]),_=i((()=>n(t)?"编辑":"新增"));return{xTable:s,tableData:h,sexList:v,formRef:c,validatorRules:{orderCode:[{required:!0,message:"订单号不能为空",trigger:"blur"}]},orderMainModel:m,registerModal:b,getTitle:_,labelCol:f,wrapperCol:p,insertEvent:function(a){return e(this,null,(function*(){const e=s.value,{row:l}=yield e.insertAt({name:"",sex:"1",idcard:"",telphone:""},a);yield e.setActiveCell(l,"sex")}))},handleSubmit:function(){return e(this,null,(function*(){c.value.validate().then((()=>{try{const e=s.value,{fullData:a}=e.getTableData();m.jeecgOrderCustomerList=a,M({confirmLoading:!0}),g(),l("success",{isUpdate:n(t),values:{id:u.value}})}finally{M({confirmLoading:!1})}})).catch((e=>{}))}))}}}}),M=m("国内订单"),g=m("国际订单"),h=m("新增"),_=m("删除选中");var x=l(b,[["render",function(e,a,l,t,r,o){const d=s("a-input"),n=s("a-form-item"),i=s("a-col"),m=s("a-select-option"),b=s("a-select"),x=s("a-date-picker"),w=s("a-row"),C=s("vxe-button"),y=s("vxe-toolbar"),k=s("vxe-column"),L=s("vxe-table"),T=s("a-tab-pane"),j=s("a-tabs"),R=s("a-form"),D=s("BasicModal");return u(),c(D,v(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit,width:"70%"}),{default:f((()=>[p(R,{ref:"formRef",model:e.orderMainModel,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,rules:e.validatorRules},{default:f((()=>[p(w,{class:"form-row",gutter:16},{default:f((()=>[p(i,{lg:8},{default:f((()=>[p(n,{label:"订单号",name:"orderCode"},{default:f((()=>[p(d,{value:e.orderMainModel.orderCode,"onUpdate:value":a[0]||(a[0]=a=>e.orderMainModel.orderCode=a),placeholder:"请输入订单号"},null,8,["value"])])),_:1})])),_:1}),p(i,{lg:8},{default:f((()=>[p(n,{label:"订单类型"},{default:f((()=>[p(b,{placeholder:"请选择订单类型",value:e.orderMainModel.ctype,"onUpdate:value":a[1]||(a[1]=a=>e.orderMainModel.ctype=a)},{default:f((()=>[p(m,{value:"1"},{default:f((()=>[M])),_:1}),p(m,{value:"2"},{default:f((()=>[g])),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),p(i,{lg:8},{default:f((()=>[p(n,{label:"订单日期"},{default:f((()=>[p(x,{showTime:"",valueFormat:"YYYY-MM-DD HH:mm:ss",value:e.orderMainModel.orderDate,"onUpdate:value":a[2]||(a[2]=a=>e.orderMainModel.orderDate=a)},null,8,["value"])])),_:1})])),_:1})])),_:1}),p(w,{class:"form-row",gutter:16},{default:f((()=>[p(i,{lg:8},{default:f((()=>[p(n,{label:"订单金额"},{default:f((()=>[p(d,{value:e.orderMainModel.orderMoney,"onUpdate:value":a[3]||(a[3]=a=>e.orderMainModel.orderMoney=a),placeholder:"请输入订单金额"},null,8,["value"])])),_:1})])),_:1}),p(i,{lg:8},{default:f((()=>[p(n,{label:"订单备注"},{default:f((()=>[p(d,{value:e.orderMainModel.content,"onUpdate:value":a[4]||(a[4]=a=>e.orderMainModel.content=a),placeholder:"请输入订单备注"},null,8,["value"])])),_:1})])),_:1})])),_:1}),p(j,{defaultActiveKey:"1"},{default:f((()=>[p(T,{tab:"客户信息",key:"1"},{default:f((()=>[p(y,null,{buttons:f((()=>[p(C,{icon:"fa fa-plus",onClick:a[5]||(a[5]=a=>e.insertEvent())},{default:f((()=>[h])),_:1}),p(C,{onClick:a[6]||(a[6]=a=>e.$refs.xTable.removeCheckboxRow())},{default:f((()=>[_])),_:1})])),_:1}),p(L,{border:"","show-overflow":"","keep-source":"",ref:"xTable","max-height":"400",data:e.orderMainModel.jeecgOrderCustomerList,"edit-config":{trigger:"click",mode:"row",icon:"fa fa-pencil",showStatus:!0}},{default:f((()=>[p(k,{type:"checkbox",width:"60",align:"center"}),p(k,{type:"seq",width:"60",align:"center"}),p(k,{field:"name",title:"客户名",sortable:"","edit-render":{name:"input",defaultValue:""}}),p(k,{field:"sex",title:"性别","edit-render":{name:"$select",options:e.sexList}},null,8,["edit-render"]),p(k,{field:"idcard",title:"身份证",sortable:"","edit-render":{name:"input",defaultValue:""}}),p(k,{field:"telphone",title:"手机",sortable:"","edit-render":{name:"input",defaultValue:""}})])),_:1},8,["data"])])),_:1}),p(T,{tab:"机票信息",key:"2",forceRender:""})])),_:1})])),_:1},8,["model","label-col","wrapper-col","rules"])])),_:1},16,["onRegister","title","onOk"])}],["__scopeId","data-v-5e3ed646"]]);export{x as default};
