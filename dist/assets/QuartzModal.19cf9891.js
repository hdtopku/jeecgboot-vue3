var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,s=(e,t,a)=>new Promise(((r,o)=>{var s=e=>{try{n(a.next(e))}catch(t){o(t)}},l=e=>{try{n(a.throw(e))}catch(t){o(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,l);n((a=a.apply(e,t)).next())}));import{B as l}from"./index.934459b9.js";import{B as n}from"./BasicForm.5f094c03.js";import"./helper.7e5efd4b.js";import{u as i}from"./useForm.18cf269c.js";import"./JAddInput.a2bd8bfb.js";import{a1 as d,a5 as u,l as p,F as c,bH as m,L as b,ch as f,o as y,v as g,V as h,z as v,y as j,B as x}from"./index.26a57b91.js";import{render as J}from"./renderUtils.9c2a0911.js";import{J as w}from"./validator.9bb2c50a.js";const z=[{title:"任务类名",dataIndex:"jobClassName",width:200,align:"left"},{title:"Cron表达式",dataIndex:"cronExpression",width:200},{title:"参数",dataIndex:"parameter",width:200},{title:"描述",dataIndex:"description",width:200},{title:"状态",dataIndex:"status",width:100,customRender:({text:e})=>{const t="0"==e?"green":"-1"==e?"red":"gray";return J.renderTag(J.renderDict(e,"quartz_status"),t)}}],T=[{field:"jobClassName",label:"任务类名",component:"Input",colProps:{span:8}},{field:"status",label:"任务状态",component:"JDictSelectTag",componentProps:{dictCode:"quartz_status",stringToNumber:!0},colProps:{span:8}}],q=[{field:"id",label:"id",component:"Input",show:!1},{field:"jobClassName",label:"任务类名",component:"Input",required:!0},{field:"cronExpression",label:"Cron表达式",component:"JEasyCron",defaultValue:"* * * * * ? *",rules:[{required:!0,message:"请输入Cron表达式"},{validator:w}]},{field:"paramterType",label:"参数类型",component:"Select",defaultValue:"string",componentProps:{options:[{label:"字符串",value:"string"},{label:"JSON对象",value:"json"}]}},{field:"parameter",label:"参数",component:"InputTextArea",ifShow:({values:e})=>"string"==e.paramterType},{field:"parameter",label:"参数",component:"JAddInput",helpMessage:"键值对形式填写",ifShow:({values:e})=>"json"==e.paramterType},{field:"status",label:"状态",component:"JDictSelectTag",componentProps:{dictCode:"quartz_status",type:"radioButton",stringToNumber:!0,dropdownStyle:{maxHeight:"6vh"}}},{field:"description",label:"描述",component:"InputTextArea"}],P="/sys/quartzJob/exportXls",I="/sys/quartzJob/importExcel",O=e=>d.get({url:"/sys/quartzJob/list",params:e}),_=(e,t)=>d.delete({url:"/sys/quartzJob/delete",data:e},{joinParamsToUrl:!0}).then((()=>{t()})),S=(e,t)=>d.get({url:"/sys/quartzJob/resume",params:e}).then((()=>{t()})),C=(e,t)=>d.get({url:"/sys/quartzJob/pause",params:e}).then((()=>{t()})),B=(e,t)=>d.get({url:"/sys/quartzJob/execute",params:e}).then((()=>{t()})),N=(e,t)=>{u.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>d.delete({url:"/sys/quartzJob/deleteBatch",data:e},{joinParamsToUrl:!0}).then((()=>{t()}))})},A=p({__name:"QuartzModal",emits:["register","success"],setup(e,{emit:u}){const p=c(!0),[J,{resetFields:w,setFieldsValue:z,validate:T}]=i({schemas:q,showActionButtonGroup:!1}),[P,{setModalProps:I,closeModal:O}]=m((e=>s(this,null,(function*(){var s;if(yield w(),I({confirmLoading:!1}),p.value=!!(null==e?void 0:e.isUpdate),b(p)){try{e.record.paramterType=f(null==(s=null==e?void 0:e.record)?void 0:s.parameter)?"json":"string"}catch(l){}yield z(((e,s)=>{for(var l in s||(s={}))a.call(s,l)&&o(e,l,s[l]);if(t)for(var l of t(s))r.call(s,l)&&o(e,l,s[l]);return e})({},e.record))}})))),_=y((()=>b(p)?"编辑任务":"新增任务"));function S(e){return s(this,null,(function*(){try{let e=yield T();I({confirmLoading:!0}),yield((e,t)=>{let a=t?"/sys/quartzJob/edit":"/sys/quartzJob/add";return d.post({url:a,params:e})})(e,p.value),O(),u("success")}finally{I({confirmLoading:!1})}}))}return(e,t)=>(g(),h(b(l),x(e.$attrs,{onRegister:b(P),title:b(_),onOk:S,width:"40%"}),{default:v((()=>[j(b(n),{onRegister:b(J)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});var E=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{E as Q,A as _,P as a,I as b,z as c,_ as d,B as e,N as f,O as g,C as p,S as r,T as s};
