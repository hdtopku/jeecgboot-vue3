var e=(e,a,t)=>new Promise(((l,n)=>{var i=e=>{try{u(t.next(e))}catch(a){n(a)}},s=e=>{try{u(t.throw(e))}catch(a){n(a)}},u=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,s);u((t=t.apply(e,a)).next())}));import{a}from"./index.32c2f26d.js";import{_ as t}from"./index.3e7bd500.js";import l from"./DepartDataRuleDrawer.3f9a19e5.js";import{a as n,b as i,c as s}from"./depart.api.c295d6d2.js";import{q as u,l as r,o,bj as d,F as c,H as p,Q as f,t as v,v as y,x as m,y as k,z as h,V as x,aW as g,D as b,W as _,L as j,ax as C,C as I}from"./index.26a57b91.js";import"./bem.73404aba.js";import"./props.d9d42440.js";import"./useContextMenu.7af190c4.js";const D={class:"j-box-bottom-button offset-20",style:{"margin-top":"30px"}},K={class:"j-box-bottom-button-float"},w=I("全部勾选"),A=I("取消全选"),R=I("展开所有"),F=I("收起所有"),S=I(" 树操作 "),T=I("保存");var E=u(r({__name:"DepartRuleTab",props:{data:{type:Object,default:()=>({})}},setup(u){const r=u,I=o((()=>{var e;return null==(e=r.data)?void 0:e.id}));d("prefixCls");const E=c(),L=c(!1),P=c([]),W=c([]),q=c([]),z=c([]),H=c([]),M=c(!0),[N,O]=a();function Q(){return e(this,null,(function*(){try{L.value=!0;let{treeList:e}=yield n();P.value=e,yield f(),X(!0)}finally{L.value=!1}}))}function V(){return e(this,null,(function*(){if(I.value)try{L.value=!0;let e=yield i({departId:I.value});z.value=e,H.value=[...e]}finally{L.value=!1}}))}function B(){return e(this,null,(function*(){try{L.value=!0,yield s({departId:I.value,permissionIds:z.value.join(","),lastpermissionIds:H.value.join(",")}),yield Q(),yield V()}finally{L.value=!1}}))}function G(e){Array.isArray(e)?z.value=e:z.value=e.checked}function J(e){W.value=e}function U(e,{selectedNodes:a}){var t;if(null==(t=a[0])?void 0:t.ruleFlag){let a=e[0];O.openDrawer(!0,{departId:I,functionId:a})}q.value=[]}function X(a){return e(this,null,(function*(){E.value.expandAll(a),yield f(),W.value=E.value.getExpandedKeys()}))}function Y(a){return e(this,null,(function*(){E.value.checkAll(a),yield f(),z.value=E.value.getCheckedKeys()}))}return Q(),p(I,(()=>V()),{immediate:!0}),(e,a)=>{const n=v("Icon"),i=v("a-empty"),s=v("a-menu-item"),u=v("a-menu"),r=v("a-button"),o=v("a-dropdown"),d=v("a-spin");return y(),m(C,null,[k(d,{spinning:L.value},{default:h((()=>[P.value.length>0?(y(),x(j(t),{key:0,ref_key:"basicTree",ref:E,class:"depart-rule-tree",checkable:"",treeData:P.value,checkedKeys:z.value,selectedKeys:q.value,expandedKeys:W.value,checkStrictly:M.value,style:{height:"500px",overflow:"auto"},onCheck:G,onExpand:J,onSelect:U},{title:h((({slotTitle:e,ruleFlag:a})=>[g("span",null,b(e),1),a?(y(),x(n,{key:0,icon:"ant-design:align-left-outlined",style:{"margin-left":"5px",color:"red"}})):_("",!0)])),_:1},8,["treeData","checkedKeys","selectedKeys","expandedKeys","checkStrictly"])):(y(),x(i,{key:1,description:"无可配置部门权限"})),g("div",D,[g("div",K,[k(o,{trigger:["click"],placement:"top"},{overlay:h((()=>[k(u,null,{default:h((()=>[k(s,{key:"3",onClick:a[0]||(a[0]=e=>Y(!0))},{default:h((()=>[w])),_:1}),k(s,{key:"4",onClick:a[1]||(a[1]=e=>Y(!1))},{default:h((()=>[A])),_:1}),k(s,{key:"5",onClick:a[2]||(a[2]=e=>X(!0))},{default:h((()=>[R])),_:1}),k(s,{key:"6",onClick:a[3]||(a[3]=e=>X(!1))},{default:h((()=>[F])),_:1})])),_:1})])),default:h((()=>[k(r,{style:{float:"left"}},{default:h((()=>[S,k(n,{icon:"ant-design:up-outlined"})])),_:1})])),_:1}),k(r,{type:"primary",preIcon:"ant-design:save-filled",onClick:B},{default:h((()=>[T])),_:1})])])])),_:1},8,["spinning"]),k(l,{onRegister:j(N)},null,8,["onRegister"])],64)}}}),[["__scopeId","data-v-09f0a1d2"]]);export{E as default};
