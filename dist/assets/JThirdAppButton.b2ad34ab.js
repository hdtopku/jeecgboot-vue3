var L=(e,u,n)=>new Promise((f,i)=>{var l=t=>{try{s(n.next(t))}catch(y){i(y)}},o=t=>{try{s(n.throw(t))}catch(y){i(y)}},s=t=>t.done?f(t.value):Promise.resolve(t.value).then(l,o);s((n=n.apply(e,u)).next())});import{Z as q,eX as H,j as Z,m as $,r as B,s as r,Q as m,w as p,v as I,y as F,z as k,R as C,K as E,C as X,a2 as D,eY as Y,h as w,t as K,x as N,eZ as O,ax as P,u as G,q as ee}from"./index.b9a81c40.js";const Q={getEnabledType:"/sys/thirdApp/getEnabledType",wechatEnterprise:{user:"/sys/thirdApp/sync/wechatEnterprise/user",depart:"/sys/thirdApp/sync/wechatEnterprise/depart"},dingtalk:{user:"/sys/thirdApp/sync/dingtalk/user",depart:"/sys/thirdApp/sync/dingtalk/depart"}};let S=null;const ne=()=>L(void 0,null,function*(){if(S!=null)return H(S);{let{success:e,result:u}=yield q.get({url:Q.getEnabledType},{isTransformResponse:!1});if(e)return S=H(u),u;console.warn("getEnabledType\u67E5\u8BE2\u5931\u8D25\uFF1A")}return{}}),V=Z({__name:"JThirdAppDropdown",props:{type:String,name:String,syncToApp:Boolean,syncToLocal:Boolean},emits:["to-app","to-local"],setup(e,{emit:u}){const n=e,f=$(()=>n.type==="wechatEnterprise"?!1:n.syncToLocal);function i(l){u(l.key,{type:n.type})}return(l,o)=>{const s=B("a-button"),t=B("a-menu-item"),y=B("a-menu"),h=B("a-dropdown");return e.syncToApp&&e.syncToLocal?(r(),m(h,{key:0},{overlay:p(()=>[I(y,{onClick:i},{default:p(()=>[e.syncToApp?(r(),m(t,{key:"to-app"},{default:p(()=>[F("\u540C\u6B65\u5230"+k(e.name),1)]),_:1})):C("",!0),E(f)?(r(),m(t,{key:"to-local"},{default:p(()=>[F("\u540C\u6B65\u5230\u672C\u5730")]),_:1})):C("",!0)]),_:1})]),default:p(()=>[I(s,{type:"primary",preIcon:"ant-design:sync-outlined"},{default:p(()=>[F("\u540C\u6B65"+k(e.name),1)]),_:1})]),_:1})):e.syncToApp?(r(),m(s,{key:1,type:"primary",preIcon:"ant-design:sync-outlined",onClick:o[0]||(o[0]=A=>i({key:"to-app"}))},{default:p(()=>[F("\u540C\u6B65"+k(e.name),1)]),_:1})):(r(),m(s,{key:2,type:"primary",preIcon:"ant-design:sync-outlined",onClick:o[1]||(o[1]=A=>i({key:"to-local"}))},{default:p(()=>[F("\u540C\u6B65"+k(e.name)+"\u5230\u672C\u5730",1)]),_:1}))}}}),te=Z({__name:"JThirdAppButton",props:{bizType:{type:String,required:!0},syncToApp:Boolean,syncToLocal:Boolean,selectedRowKeys:Array},emits:["sync-ok","sync-error","sync-finally"],setup(e,{emit:u}){const n=e,{createMessage:f,createWarningModal:i}=G(),l=X({}),o=$(()=>({syncToApp:n.syncToApp,syncToLocal:n.syncToLocal})),s=$(()=>({"to-app":t,"to-local":y}));function t(a){A(a.type,"/toApp")}function y(a){A(a.type,"/toLocal")}function h(){return L(this,null,function*(){l.value=yield ne()})}function A(a,d){let b=Q[a];if(!(b&&b[n.bizType])){console.warn("\u914D\u7F6E\u51FA\u9519");return}let U=b[n.bizType]+d,T=n.selectedRowKeys,R="\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u5168\u90E8\u6570\u636E\u5417\uFF1F\u53EF\u80FD\u82B1\u8D39\u8F83\u957F\u65F6\u95F4\uFF01";return Array.isArray(T)&&T.length>0?R=`\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u8FD9 ${T.length} \u9879\u5417\uFF1F`:T=[],new Promise((z,ue)=>{const J=D.confirm({icon:I(Y),title:"\u540C\u6B65",content:R,onOk:()=>{J.update({keyboard:!1,okText:"\u540C\u6B65\u4E2D\u2026",cancelButtonProps:{disabled:!0}});let W={ids:T.join(",")};return q.get({url:U,params:W},{isTransformResponse:!1}).then(c=>{let g={};c.result&&(g={width:600,title:c.message,content:()=>{let _,M=["\u6210\u529F\u4FE1\u606F\u5982\u4E0B\uFF1A",j(w,c.result.successInfo.map((x,v)=>`${v+1}. ${x}`).join(`
`))];return c.success?_=[...M,w("br"),"\u65E0\u5931\u8D25\u4FE1\u606F\uFF01"]:_=["\u5931\u8D25\u4FE1\u606F\u5982\u4E0B\uFF1A",j(w,c.result.failInfo.map((x,v)=>`${v+1}. ${x}`).join(`
`)),w("br"),...M],_}}),c.success?(g!=null?D.success(g):f.warning(c.message),u("sync-ok")):(g!=null?D.warning(g):f.warning(c.message),u("sync-error"))}).catch(()=>J.destroy()).finally(()=>{z(),u("sync-finally",{type:a,direction:d,isToApp:d==="/toApp",isToLocal:d==="/toLocal"})})},onCancel(){z()}})})}function j(a,d){return a("div",{id:"box",style:{minHeight:"100px",border:"1px solid #d9d9d9",fontSize:"14px",maxHeight:"250px",whiteSpace:"pre",overflow:"auto",padding:"10px"}},d)}return h(),(a,d)=>e.syncToApp||e.syncToLocal?(r(),K(P,{key:0},[l.value.wechatEnterprise?(r(),m(V,N({key:0,type:"wechatEnterprise",name:"\u4F01\u5FAE"},E(o),O(E(s))),null,16)):C("",!0),l.value.dingtalk?(r(),m(V,N({key:1,type:"dingtalk",name:"\u9489\u9489"},E(o),O(E(s))),null,16)):C("",!0)],64)):(r(),K(P,{key:1},[F("\u672A\u8BBE\u7F6E\u4EFB\u4F55\u540C\u6B65\u65B9\u5411")],64))}});const ae=ee(te,[["__scopeId","data-v-d8023e59"]]);export{ae as J};
