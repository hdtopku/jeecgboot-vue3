var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;import{q as o,l as i,aB as d,T as c,a8 as u,dh as p,aa as m,o as v,cL as f,b8 as g,t as b,v as h,V as y,z as x,aW as O,y as w,C as j,D as T,x as C,bc as P,ax as I}from"./index.b3c93d64.js";import{a as k}from"./index.4258d6df.js";import"./useContentHeight.7565ed37.js";import"./onMountedOrActivated.d3784e6c.js";import"./useWindowSizeFn.e6386ae5.js";import"./useContentViewHeight.d3266665.js";import"./usePageContext.f338fb2a.js";const L=i({components:{PageWrapper:k,[d.name]:d,InputTextArea:d.TextArea,Tag:c},setup(){const e=u({server:"ws://localhost:3300/test",sendValue:"",recordList:[]}),{status:o,data:i,send:d,close:c,open:b}=p(e.server,{autoReconnect:!1,heartbeat:!0});m((()=>{if(i.value)try{const a=JSON.parse(i.value);e.recordList.push(a)}catch(a){e.recordList.push({res:i.value,id:Math.ceil(1e3*Math.random()),time:(new Date).getTime()})}}));const h=v((()=>"OPEN"===o.value)),y=v((()=>h.value?"success":"red")),x=v((()=>[...e.recordList].reverse()));return O=((e,a)=>{for(var t in a||(a={}))r.call(a,t)&&n(e,t,a[t]);if(s)for(var t of s(a))l.call(a,t)&&n(e,t,a[t]);return e})({status:o,formatToDateTime:f},g(e)),a(O,t({handlerSend:function(){d(e.sendValue),e.sendValue=""},getList:x,toggle:function(){h.value?c():b()},getIsOpen:h,getTagColor:y}));var O}}),V={class:"flex"},S={class:"w-1/3 bg-white p-4"},D={class:"flex items-center"},W=O("span",{class:"text-lg font-medium mr-4"}," 连接状态: ",-1),_=O("hr",{class:"my-4"},null,-1),A={class:"flex"},M=j(" 服务地址 "),z=O("p",{class:"text-lg font-medium mt-4"},"设置",-1),B=O("hr",{class:"my-4"},null,-1),E=j(" 发送 "),H={class:"w-2/3 bg-white ml-4 p-4"},N=O("span",{class:"text-lg font-medium mr-4"}," 消息记录: ",-1),U=O("hr",{class:"my-4"},null,-1),q={class:"max-h-80 overflow-auto"},F={class:"flex items-center"},J=O("span",{class:"mr-2 text-primary font-medium"},"收到消息:",-1);var R=o(L,[["render",function(e,a,t,s,r,l){const n=b("Tag"),o=b("a-input"),i=b("a-button"),d=b("InputTextArea"),c=b("PageWrapper");return h(),y(c,{title:"WebSocket 示例"},{default:x((()=>[O("div",V,[O("div",S,[O("div",D,[W,w(n,{color:e.getTagColor},{default:x((()=>[j(T(e.status),1)])),_:1},8,["color"])]),_,O("div",A,[w(o,{value:e.server,"onUpdate:value":a[0]||(a[0]=a=>e.server=a),disabled:""},{addonBefore:x((()=>[M])),_:1},8,["value"]),w(i,{type:e.getIsOpen?"danger":"primary",onClick:e.toggle},{default:x((()=>[j(T(e.getIsOpen?"关闭连接":"开启连接"),1)])),_:1},8,["type","onClick"])]),z,B,w(d,{placeholder:"需要发送到服务器的内容",disabled:!e.getIsOpen,value:e.sendValue,"onUpdate:value":a[1]||(a[1]=a=>e.sendValue=a),allowClear:""},null,8,["disabled","value"]),w(i,{type:"primary",block:"",class:"mt-4",disabled:!e.getIsOpen,onClick:e.handlerSend},{default:x((()=>[E])),_:1},8,["disabled","onClick"])]),O("div",H,[N,U,O("div",q,[O("ul",null,[(h(!0),C(I,null,P(e.getList,(a=>(h(),C("li",{class:"mt-2",key:a.time},[O("div",F,[J,O("span",null,T(e.formatToDateTime(a.time)),1)]),O("div",null,T(a.res),1)])))),128))])])])])])),_:1})}]]);export{R as default};
