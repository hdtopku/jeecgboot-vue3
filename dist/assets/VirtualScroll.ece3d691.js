import{l as t,F as e,a8 as i,o as s,L as a,H as r,$ as l,Q as n,am as o,y as m,bh as d,q as c,Z as u,b7 as h,t as g,v as p,V as f,z as v,aW as b,D as _,C as H}from"./index.435ab247.js";import{a as x}from"./index.4cdbd2ab.js";import"./useContentHeight.60ff243a.js";import"./onMountedOrActivated.e9ddbd41.js";import"./useWindowSizeFn.3d5b1a05.js";import"./useContentViewHeight.f55d8457.js";import"./usePageContext.56c44530.js";function S(t,e="px"){return null==t||""===t?void 0:isNaN(+t)?String(t):`${Number(t)}${e}`}const N=u(c(t({name:"VirtualScroll",props:{height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String],bench:{type:[Number,String],default:0},itemHeight:{type:[Number,String],required:!0},items:{type:Array,default:()=>[]}},setup(t,{slots:c}){const u=e(null),h=i({first:0,last:0,scrollTop:0}),g=s((()=>parseInt(t.bench,10))),p=s((()=>parseInt(t.itemHeight,10))),f=s((()=>Math.max(0,h.first-a(g)))),v=s((()=>Math.min((t.items||[]).length,h.last+a(g)))),b=s((()=>({height:S((t.items||[]).length*a(p))}))),_=s((()=>{const e={},i=S(t.height),s=S(t.minHeight),a=S(t.minWidth),r=S(t.maxHeight),l=S(t.maxWidth),n=S(t.width);return i&&(e.height=i),s&&(e.minHeight=s),a&&(e.minWidth=a),r&&(e.maxHeight=r),l&&(e.maxWidth=l),n&&(e.width=n),e}));function H(e){const i=a(u);if(!i)return 0;const s=parseInt(t.height||0,10)||i.clientHeight;return e+Math.ceil(s/a(p))}function x(){const t=a(u);t&&(h.scrollTop=t.scrollTop,h.first=Math.floor(h.scrollTop/a(p)),h.last=H(h.first))}function N(){const{items:e=[]}=t;return e.slice(a(f),a(v)).map(w)}function w(t,e){const i=S((e+=a(f))*a(p));return m("div",{class:"virtual-scroll__item",style:{top:i},key:e},[d(c,"default",{index:e,item:t})])}return r([()=>t.itemHeight,()=>t.height],(()=>{x()})),l((()=>{h.last=H(0),n((()=>{const t=a(u);t&&o({el:t,name:"scroll",listener:x,wait:0})}))})),()=>m("div",{class:"virtual-scroll",style:a(_),ref:u},[m("div",{class:"virtual-scroll__container",style:a(b)},[N()])])}}),[["__scopeId","data-v-1d50f09e"]]));const w=(()=>{const t=[];for(let e=1;e<2e4;e++)t.push({title:"列表项"+e});return t})(),W=t({components:{VScroll:N,Divider:h,PageWrapper:x},setup:()=>({data:w})}),y=H("基础滚动示例"),j={class:"virtual-scroll-demo-wrap"},I={class:"virtual-scroll-demo__item"},M=H("即使不可见，也预先加载50条数据，防止空白"),V={class:"virtual-scroll-demo-wrap"},C={class:"virtual-scroll-demo__item"};var T=c(W,[["render",function(t,e,i,s,a,r){const l=g("Divider"),n=g("VScroll"),o=g("PageWrapper");return p(),f(o,{class:"virtual-scroll-demo"},{default:v((()=>[m(l,null,{default:v((()=>[y])),_:1}),b("div",j,[m(n,{itemHeight:41,items:t.data,height:300,width:300},{default:v((({item:t})=>[b("div",I,_(t.title),1)])),_:1},8,["items"])]),m(l,null,{default:v((()=>[M])),_:1}),b("div",V,[m(n,{itemHeight:41,items:t.data,height:300,width:300,bench:50},{default:v((({item:t})=>[b("div",C,_(t.title),1)])),_:1},8,["items"])])])),_:1})}],["__scopeId","data-v-002a1a68"]]);export{T as default};
