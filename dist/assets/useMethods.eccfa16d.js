var d=(i,c,e)=>new Promise((u,t)=>{var r=s=>{try{n(e.next(s))}catch(l){t(l)}},o=s=>{try{n(e.throw(s))}catch(l){t(l)}},n=s=>s.done?u(s.value):Promise.resolve(s.value).then(r,o);n((e=e.apply(i,c)).next())});import{m as F,a1 as f,u as b}from"./index.6c1aeca2.js";const{createMessage:p,createWarningModal:g}=b(),w=F(),E="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",y=".xlsx";function x(){function i(e,u,t,r=!1){return d(this,null,function*(){const o=yield f.get({url:u,params:t,responseType:"blob"},{isTransformResponse:!1});if(!o){p.warning("\u6587\u4EF6\u4E0B\u8F7D\u5931\u8D25");return}(!e||typeof e!="string")&&(e="\u5BFC\u51FA\u6587\u4EF6");let n={type:"application/vnd.ms-excel"},s=".xls";if(r===!0&&(n.type=E,s=y),typeof window.navigator.msSaveBlob!="undefined")window.navigator.msSaveBlob(new Blob([o],n),e+s);else{let l=window.URL.createObjectURL(new Blob([o],n)),a=document.createElement("a");a.style.display="none",a.href=l,a.setAttribute("download",e+s),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(l)}})}function c(e,u,t){return d(this,null,function*(){const r=o=>{try{if(o.code===201){let{message:n,result:{msg:s,fileUrl:l,fileName:a}}=o,m=w.uploadUrl+l;g({title:n,centered:!1,content:`<div>
                                <span>${s}</span><br/> 
                                <span>\u5177\u4F53\u8BE6\u60C5\u8BF7<a href = ${m} download = ${a}> \u70B9\u51FB\u4E0B\u8F7D </a> </span> 
                              </div>`})}else o.code===500?p.error(o.message||`${e.file.name} \u5BFC\u5165\u5931\u8D25`):p.success(o.message||`${e.file.name} \u6587\u4EF6\u4E0A\u4F20\u6210\u529F`)}catch(n){console.log("\u5BFC\u5165\u7684\u6570\u636E\u5F02\u5E38",n)}finally{typeof t=="function"&&t(o)}};yield f.uploadFile({url:u},{file:e.file},{success:r})})}return{handleExportXls:(e,u,t)=>i(e,u,t),handleImportXls:(e,u,t)=>c(e,u,t),handleExportXlsx:(e,u,t)=>i(e,u,t,!0)}}export{y as XLSX_FILE_SUFFIX,E as XLSX_MIME_TYPE,x as useMethods};
