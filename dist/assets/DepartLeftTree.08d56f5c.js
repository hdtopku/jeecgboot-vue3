var f=(l,m,i)=>new Promise((r,t)=>{var s=n=>{try{o(i.next(n))}catch(d){t(d)}},c=n=>{try{o(i.throw(n))}catch(d){t(d)}},o=n=>n.done?r(n.value):Promise.resolve(n.value).then(s,c);o((i=i.apply(l,m)).next())});import{a1 as x,l as j,bi as q,F as u,t as p,v as _,V as D,z as T,y as C,x as O,W as P,aw as V,Q as K}from"./index.f119eb41.js";import{s as z}from"./depart.user.api.d8ef405d.js";const b=l=>x.get({url:"/sys/sysDepart/queryDepartTreeSync",params:l}),M=l=>x.get({url:"/sys/user/queryByOrgCodeForAddressList",params:l}),Q=l=>x.get({url:"/sys/position/list",params:l}),N=j({__name:"DepartLeftTree",emits:["select","rootTreeData"],setup(l,{expose:m,emit:i}){q("prefixCls");const r=u(!1),t=u([]),s=u([]),c=u([]),o=u(!1),n=u(null),d=u("");function g(){return f(this,null,function*(){try{r.value=!0,t.value=[];const e=yield b();Array.isArray(e)&&(t.value=e),s.value.length===0&&w()}finally{r.value=!1}})}g();function E(e){return f(this,null,function*(){try{const a=yield b({pid:e.dataRef.id});if(a.length==0)e.dataRef.isLeaf=!0;else if(e.dataRef.children=a,s.value.length>0){let y=[];for(let v of s.value)a.findIndex(h=>h.id===v)!==-1&&y.push(v);y.length>0&&(s.value=[...s.value])}t.value=[...t.value]}catch(a){console.error(a)}return Promise.resolve()})}function w(){let e=t.value[0];e&&(e.isLeaf||(s.value=[e.key]),L())}function L(){return f(this,null,function*(){yield K(),o.value=!0,yield K(),o.value=!1})}function k(e,a){c.value=[e],a&&(n.value=a,i("select",a))}function S(e){return f(this,null,function*(){if(e)try{r.value=!0,t.value=[];let a=yield z({keyWord:e});Array.isArray(a)&&(t.value=a),w()}finally{r.value=!1}else g();d.value=e})}function R(e,a){e.length>0&&c.value[0]!==e[0]?k(e[0],a.selectedNodes[0]):k(c.value[0])}return m({loadRootTreeData:g}),(e,a)=>{const y=p("a-input-search"),v=p("a-tree"),h=p("a-empty"),A=p("a-spin"),B=p("a-card");return _(),D(B,{bordered:!1,style:{height:"100%"}},{default:T(()=>[C(A,{spinning:r.value},{default:T(()=>[C(y,{placeholder:"\u6309\u90E8\u95E8\u540D\u79F0\u641C\u7D22\u2026",style:{"margin-bottom":"10px"},onSearch:S,allowClear:""}),t.value.length>0?(_(),O(V,{key:0},[o.value?P("",!0):(_(),D(v,{key:0,showLine:"",clickRowToExpand:!1,treeData:t.value,selectedKeys:c.value,"load-data":E,expandedKeys:s.value,"onUpdate:expandedKeys":a[0]||(a[0]=F=>s.value=F),onSelect:R},null,8,["treeData","selectedKeys","expandedKeys"]))],64)):(_(),D(h,{key:1,description:"\u6682\u65E0\u6570\u636E"}))]),_:1},8,["spinning"])]),_:1})}}});var U=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}));export{U as D,N as _,M as l,Q as p};
