import{B as e}from"./BasicTable.8cbbb86a.js";import{T as o}from"./helper.7e5efd4b.js";import"./TableImg.f02873d7.js";import{f0 as t,F as n,H as i,t as a,v as l,x as r,y as s,V as d,z as c,C as u,W as p,ax as m,bc as g,D as f,R as h,S as b,aW as y,E as C,bl as j,bm as x,dE as S,B as w,ep as T,u as F,a1 as I}from"./index.26a57b91.js";import k from"./OnlineAutoModal.b463e7bd.js";import R from"./OnlineDetailModal.0410a998.js";import B from"./OnlineCustomModal.1a2c2e2f.js";import{J as D}from"./JImportModal.8ec266c5.js";import{u as v,a as O}from"./useListButton.f3fba3a4.js";import{c as M,j as E,g as L}from"./useAutoForm.67b4b6d8.js";import A from"./OnlineQueryForm.a53cc830.js";import _ from"./OnlineSuperQuery.9ce00950.js";import"./index.934459b9.js";import"./BasicForm.5f094c03.js";import"./JAddInput.a2bd8bfb.js";import"./JUpload.7c63ef7b.js";import"./JUploadModal.4b0dd4d4.js";import"./pick.dbff1c58.js";import"./omit.d6518a29.js";import"./OnlineSelectCascade.2c5f6973.js";import"./Area.5f50cf87.js";import"./functional.c7818516.js";import"./LinkTableListPiece.ee26873b.js";import"./_flatRest.ff1861ce.js";import"./isArray.40a4ed15.js";import"./toString.cf909882.js";import"./_arrayPush.8821345e.js";import"./_baseClone.a8082016.js";import"./CommentPanel.04ee21e3.js";import"./DetailForm.371b8607.js";import"./api.54a4ca84.js";import"./OnlineSuperQueryValComponent.vue_vue_type_script_lang.4e04ad91.js";import"./useForm.18cf269c.js";import"./index.1a78ea68.js";import"./useContentHeight.3e69d770.js";import"./onMountedOrActivated.d719a17d.js";import"./useWindowSizeFn.9ed8a10e.js";import"./useContentViewHeight.34b8e2f1.js";import"./usePageContext.dd16d566.js";import"./BasicModal.e5e1fb3e.js";import"./RedoOutlined.48666e00.js";import"./useFormItem.efca0b58.js";import"./download.4b98da42.js";import"./base64Conver.030fa32c.js";import"./index.608c7cf2.js";import"./index.b94b363f.js";import"./useCountdown.e60db803.js";import"./index.9c299300.js";import"./OnlineForm.4b8653d0.js";import"./FormSchemaFactory.00db1169.js";import"./uniqBy.006870c7.js";import"./props.eaaadc91.js";import"./index.3e7bd500.js";import"./bem.73404aba.js";import"./props.d9d42440.js";import"./useContextMenu.7af190c4.js";import"./index.0d2a049f.js";import"./index.6fce0e9a.js";import"./htmlmixed.fbaa0b47.js";import"./vue.38e13cef.js";/* empty css             */import"./depart.api.c295d6d2.js";import"./user.api.c522f7b9.js";import"./_commonjsHelpers.7ef9cff5.js";import"./customExpression.58041e91.js";import"./useListPage.fd3526da.js";import"./useTable.98dbd6c0.js";import"./JModalTip.6a90f9c1.js";import"./_baseSlice.23bb44df.js";import"./OnlineFormDetail.4e0f4382.js";import"./OnlineSubFormDetail.fb92e95f.js";var Q=(e,o,t)=>new Promise(((n,i)=>{var a=e=>{try{r(t.next(e))}catch(o){i(o)}},l=e=>{try{r(t.throw(e))}catch(o){i(o)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,l);r((t=t.apply(e,o)).next())}));const J={class:"p-2"},H={key:0,style:{"font-size":"12px","font-style":"italic"}},P={key:0,style:{"font-size":"12px","font-style":"italic"}},K=["src","onClick"],q=["innerHTML"],z=["title"];var U=t({name:"DefaultOnlineList",components:{BasicTable:e,TableAction:o,OnlineAutoModal:k,JImportModal:D,OnlineQueryForm:A,OnlineSuperQuery:_,OnlineCustomModal:B,OnlineDetailModal:R},setup(){const{createMessage:e}=F(),o=n(),{ID:t,onlineTableContext:a,onlineQueryFormOuter:l,loading:r,reload:s,dataSource:d,pagination:c,handleSpecialConfig:u,getColumnList:p,handleChangeInTable:m,loadData:g,superQueryButtonRef:f,superQueryStatus:h,handleSuperQuery:b,registerCustomModal:y,getTreeDataByResult:C,expandedRowKeys:j,handleExpandedRowsChange:x,tableReloading:S,onlineExtConfigJson:w,handleFormConfig:T}=v();if(!t.value)return void e.warning("地址错误, 配置ID不存在!");a.isTree(!0);let{initCgEnhanceJs:k}=M(a);const{buttonSwitch:R,cgLinkButtonList:B,cgTopButtonList:D,importUrl:A,registerModal:_,handleAdd:J,handleEdit:H,handleBatchDelete:P,registerImportModal:K,onImportExcel:q,onExportExcel:z,cgButtonJsHandler:U,cgButtonActionHandler:V,cgButtonLinkHandler:W,handleSubmitFlow:N,getDropDownActions:$,getActions:G,initButtonList:X,initButtonSwitch:Y,registerDetailModal:Z}=O(a,w),{columns:ee,actionColumn:oe,selectedKeys:te,rowSelection:ne,enableScrollBar:ie,tableScroll:ae,downloadRowFile:le,getImgView:re,getPcaText:se,getFormatDate:de,handleColumnResult:ce,hrefComponent:ue,viewOnlineCellImage:pe}=E(a,w);function me(){return Q(this,null,(function*(){!0===a.isTree()&&(j.value=[],o.value.collapseAll()),s()}))}i(t,(()=>{!function(){Q(this,null,(function*(){r.value=!0,function(e){let o=k(e.enhanceJs);a.EnhanceJS=o,X(e.cgButtonList),Y(e.hideColumns),ce(e),u(e),a.hasChildrenField=e.hasChildrenField,a.pidField=e.pidField}(yield p()),yield g(),r.value=!1,a.execButtonEnhance("setup")}))}()}),{immediate:!0});const ge=n(!1);function fe(e){ge.value=!0;let o={[a.pidField]:e.id};J(o)}return{ID:t,onlineQueryFormOuter:l,queryWithCondition:function(e,o){a.queryParam=e,!0===o?s():me()},onQueryFormLoaded:function(e){return Q(this,null,(function*(){yield L(f),f.value.init(e)}))},reload:s,superQueryButtonRef:f,superQueryStatus:h,handleSuperQuery:b,loading:r,columns:ee,actionColumn:oe,dataSource:d,pagination:c,rowSelection:ne,selectedKeys:te,tableScroll:ae,enableScrollBar:ie,handleChangeInTable:m,buttonSwitch:R,handleAdd:J,handleEdit:H,onImportExcel:q,onExportExcel:z,cgTopButtonList:D,cgLinkButtonList:B,cgButtonJsHandler:U,cgButtonActionHandler:V,cgButtonLinkHandler:W,handleBatchDelete:P,downloadRowFile:le,getImgView:re,getPcaText:se,getFormatDate:de,getActions:G,getTreeDropDownActions:function(e){let o=$(e);return o.unshift((e=>({label:"添加下级",onClick:fe.bind(null,e)}))(e)),o},registerModal:_,registerCustomModal:y,registerImportModal:K,importUrl:A,handleFormConfig:T,tableReloading:S,handleSubmitFlow:N,hrefComponent:ue,viewOnlineCellImage:pe,onlineTreeTableRef:o,handlerFormSuccess:function(e){if(!0===ge.value){let o=e[a.pidField];if(o){let e=j.value;e.indexOf(o)<0&&e.push(o),j.value=e}}s()},searchReset:me,handleExpand:function(o,t){let n=j.value;if(o){if(function(e){let o=j.value;o&&o.indexOf(e)<0&&o.push(e);j.value=o}(t.id),t.children.length>0&&!0===t.children[0].isLoading){let o=a.hasChildrenField;const{sortField:n,sortType:i}=a;let l=Object.assign({},{column:n,order:i});l[a.pidField]=t.id,l[o]=t[o];let r=`${a.onlineUrl.getTreeData}${a.ID}`;I.get({url:r,params:l},{isTransformResponse:!1}).then((o=>{o.success?Number(o.result.total)>0?t.children=C(o.result.records):(t.children="",t.hasChildrenField="0"):e.warning(o.message)})).catch((()=>{e.warning("加载子节点失败!")}))}}else{let e=n.indexOf(t.id);e>=0&&(j.value=n.splice(e,1))}},expandedRowKeys:j,handleExpandedRowsChange:x,registerDetailModal:Z}}},[["render",function(e,o,t,n,i,F){const I=a("online-query-form"),k=a("a-button"),R=a("online-super-query"),B=a("TableAction"),D=a("BasicTable"),v=a("OnlineAutoModal"),O=a("JImportModal"),M=a("a-modal"),E=a("online-custom-modal"),L=a("online-detail-modal");return l(),r("div",J,[s(I,{ref:"onlineQueryFormOuter",id:e.ID,onSearch:e.queryWithCondition,onLoaded:e.onQueryFormLoaded},null,8,["id","onSearch","onLoaded"]),e.tableReloading?p("",!0):(l(),d(D,{key:0,ref:"onlineTreeTableRef",isTreeTable:!0,expandedRowKeys:e.expandedRowKeys,onExpandedRowsChange:e.handleExpandedRowsChange,onExpand:e.handleExpand,rowKey:"jeecg_row_key",canResize:!0,bordered:!0,showIndexColumn:!1,loading:e.loading,columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,rowSelection:e.rowSelection,actionColumn:e.actionColumn,showTableSetting:!0,clickToRowSelect:!1,scroll:e.tableScroll,onTableRedo:e.reload,class:C({"j-table-force-nowrap":e.enableScrollBar}),onChange:e.handleChangeInTable},{tableTitle:c((()=>[e.buttonSwitch.add?(l(),d(k,{key:0,preIcon:"ant-design:plus-outlined",type:"primary",onClick:e.handleAdd},{default:c((()=>[u("新增")])),_:1},8,["onClick"])):p("",!0),e.buttonSwitch.import?(l(),d(k,{key:1,preIcon:"ant-design:import-outlined",type:"primary",onClick:e.onImportExcel},{default:c((()=>[u("导入")])),_:1},8,["onClick"])):p("",!0),e.buttonSwitch.export?(l(),d(k,{key:2,preIcon:"ant-design:export-outlined",type:"primary",onClick:e.onExportExcel},{default:c((()=>[u(" 导出")])),_:1},8,["onClick"])):p("",!0),e.cgTopButtonList&&e.cgTopButtonList.length>0?(l(!0),r(m,{key:3},g(e.cgTopButtonList,((o,t)=>(l(),r(m,null,["js"==o.optType?(l(),d(k,{key:"cgbtn"+t,onClick:t=>e.cgButtonJsHandler(o.buttonCode),type:"primary",preIcon:o.buttonIcon?"ant-design:"+o.buttonIcon:""},{default:c((()=>[u(f(o.buttonName),1)])),_:2},1032,["onClick","preIcon"])):"action"==o.optType?(l(),d(k,{key:"cgbtn"+t,onClick:t=>e.cgButtonActionHandler(o.buttonCode),type:"primary",preIcon:o.buttonIcon?"ant-design:"+o.buttonIcon:""},{default:c((()=>[u(f(o.buttonName),1)])),_:2},1032,["onClick","preIcon"])):p("",!0)],64)))),256)):p("",!0),e.buttonSwitch.batch_delete?h((l(),d(k,{key:4,preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:c((()=>[u(" 批量删除")])),_:1},8,["onClick"])),[[b,e.selectedKeys.length>0]]):p("",!0),e.buttonSwitch.super_query?(l(),d(R,{key:5,ref:"superQueryButtonRef",status:e.superQueryStatus,onSearch:e.handleSuperQuery},null,8,["status","onSearch"])):p("",!0)])),fileSlot:c((({text:o})=>[o?(l(),d(k,{key:1,ghost:!0,type:"primary",preIcon:"ant-design:download",size:"small",onClick:t=>e.downloadRowFile(o)},{default:c((()=>[u(" 下载 ")])),_:2},1032,["onClick"])):(l(),r("span",H,"无文件"))])),imgSlot:c((({text:o})=>[o?(l(),r("img",{key:1,src:e.getImgView(o),alt:"图片不存在",class:"online-cell-image",onClick:t=>e.viewOnlineCellImage(o)},null,8,K)):(l(),r("span",P,"无图片"))])),htmlSlot:c((({text:e})=>[y("div",{innerHTML:e},null,8,q)])),pcaSlot:c((({text:o})=>[y("div",{title:e.getPcaText(o)},f(e.getPcaText(o)),9,z)])),dateSlot:c((({text:o})=>[y("span",null,f(e.getFormatDate(o)),1)])),action:c((({record:o})=>[s(B,{actions:e.getActions(o),dropDownActions:e.getTreeDropDownActions(o)},null,8,["actions","dropDownActions"])])),_:1},8,["expandedRowKeys","onExpandedRowsChange","onExpand","loading","columns","dataSource","pagination","rowSelection","actionColumn","scroll","onTableRedo","class","onChange"])),s(v,{id:e.ID,onRegister:e.registerModal,onSuccess:e.handlerFormSuccess,onFormConfig:e.handleFormConfig},null,8,["id","onRegister","onSuccess","onFormConfig"]),s(O,{onRegister:e.registerImportModal,url:e.importUrl(),onOk:e.reload,online:""},null,8,["onRegister","url","onOk"]),s(M,w(e.hrefComponent.model,T(e.hrefComponent.on)),{default:c((()=>[(l(),d(S(e.hrefComponent.is),j(x(e.hrefComponent.params)),null,16))])),_:1},16),s(E,{onRegister:e.registerCustomModal,onSuccess:e.reload},null,8,["onRegister","onSuccess"]),s(L,{id:e.ID,onRegister:e.registerDetailModal},null,8,["id","onRegister"])])}]]);export{U as default};
