import{l as P,F as c,o as w,H as A,e$ as N,t as m,v,x as B,V as C,aw as V,aV as M,y,z as I,C as _,u as S}from"./index.f142ecf1.js";import{c as $}from"./auth.data.fdbc2953.js";import{m as z,l as R,n as L}from"./auth.api.812b1c17.js";var k=(e,d,a)=>new Promise((p,i)=>{var h=t=>{try{o(a.next(t))}catch(r){i(r)}},u=t=>{try{o(a.throw(t))}catch(r){i(r)}},o=t=>t.done?p(t.value):Promise.resolve(t.value).then(h,u);o((a=a.apply(e,d)).next())});const q=P({name:"AuthButtonTree",props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:d}=S(),a=c(""),p=c(2),i=c(!0),h=c([]),u=c([]),o=c([]),t=c(""),r=w(()=>!a.value);A(()=>e.cgformId,g,{immediate:!0});function g(){return k(this,null,function*(){if(!e.cgformId)return;let n=yield z(e.cgformId,p.value);n.forEach(l=>{for(const f of $)if(l.code==f.code){l.title=f.title;break}});let s=[];for(let l of n){let f=b(l);s.push({key:l.id,title:f})}o.value=s})}function D(){g(),E(a.value,t.value)}function E(n,s){return k(this,null,function*(){a.value=n,t.value=s,u.value=[];let l=yield R({roleId:n,cgformId:e.cgformId,type:p.value,authMode:s});u.value=l.map(f=>f.authId)})}function F(){a.value=""}function K(){return k(this,null,function*(){yield L(a.value,e.cgformId,{authId:JSON.stringify(u.value),authMode:t.value}),d.success("\u4FDD\u5B58\u6210\u529F")})}function b(n){let s=n.title+"-";return n.page==3?s+="\u5217\u8868\u53EF\u89C1":n.page==5&&(s+="\u8868\u5355\u53EF\u89C1"),s}function x(n){h.value=n,i.value=!1}function T(){a.value="",u.value=[]}return{loadChecked:E,clear:T,expandedKeys:h,autoExpandParent:i,checkedKeys:u,treeData:o,disabled:r,onSave:K,onExpand:x,onRefresh:D,clearChecked:F}}}),H={class:"onl-auth-tree-btns"};function J(e,d,a,p,i,h){const u=m("a-empty"),o=m("a-button"),t=m("a-tree");return v(),B("div",null,[e.disabled?(v(),C(u,{key:0,description:"\u8BF7\u5148\u9009\u4E2D\u5DE6\u4FA7\u89D2\u8272/\u90E8\u95E8/\u7528\u6237"})):e.treeData.length===0?(v(),C(u,{key:1,description:"\u65E0\u6743\u9650\u4FE1\u606F"})):(v(),B(V,{key:2},[M("div",H,[y(o,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:I(()=>[_("\u5237\u65B0")]),_:1},8,["onClick"]),y(o,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:I(()=>[_("\u4FDD\u5B58")]),_:1},8,["onClick"])]),y(t,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":d[0]||(d[0]=r=>e.checkedKeys=r),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}var G=N(q,[["render",J],["__scopeId","data-v-0c1d5eb9"]]);export{G as default};
