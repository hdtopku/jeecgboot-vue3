import{B as e}from"./index.ee0a0c33.js";import{B as o}from"./BasicForm.79466d99.js";import{T as t}from"./helper.ec3e26f3.js";import{u as n}from"./useForm.ee23be26.js";import"./JAddInput.c8a1b05b.js";import{l as a,F as i,bH as r,bI as s,a8 as l,o as c,f0 as d,t as m,v as u,V as p,z as f,y as b,C as j,x as g,W as y,bl as h,bm as v,Q as w}from"./index.b3c93d64.js";import{B as C}from"./BasicTable.cdd414e6.js";import"./TableImg.6cb3a734.js";import{useListPage as x}from"./useListPage.4511beac.js";import{u as M}from"./useOnlineTest.06579696.js";import{u as T,a as B}from"./enhance.data.d0cafcbe.js";import{a as A,d as F,b as R}from"./enhance.api.a8ade277.js";import"./BasicModal.2a8ad889.js";import"./useWindowSizeFn.e6386ae5.js";import"./uniqBy.30d2558a.js";import"./useFormItem.d029403d.js";import"./functional.3bb51b91.js";import"./download.261c8978.js";import"./base64Conver.030fa32c.js";import"./index.d2e70b0d.js";import"./index.17ec2e33.js";import"./useCountdown.cb4ad478.js";import"./JUpload.6bcc6fce.js";import"./api.dced5d87.js";import"./index.ef2039b9.js";import"./props.a4f5d1ca.js";import"./index.c4683457.js";import"./bem.3d3e77ca.js";import"./props.c13d8268.js";import"./useContextMenu.de287960.js";import"./index.9bbe419b.js";import"./onMountedOrActivated.d3784e6c.js";import"./index.36d6c198.js";import"./htmlmixed.ba3cd961.js";import"./vue.8c416d71.js";/* empty css             */import"./depart.api.429e062c.js";import"./index.4258d6df.js";import"./useContentHeight.7565ed37.js";import"./useContentViewHeight.d3266665.js";import"./usePageContext.f338fb2a.js";import"./RedoOutlined.c563bb0b.js";import"./useTable.4670d269.js";import"./cgform.data.35cb6cbd.js";var k=Object.defineProperty,D=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,P=(e,o,t)=>o in e?k(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,_=(e,o,t)=>new Promise(((n,a)=>{var i=e=>{try{s(t.next(e))}catch(o){a(o)}},r=e=>{try{s(t.throw(e))}catch(o){a(o)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,r);s((t=t.apply(e,o)).next())}));const J=a({name:"EnhanceJavaModal",components:{BasicModal:e,BasicTable:C,BasicForm:o,TableAction:t},emits:["register"],setup(){const e=i(""),o=i([]),{columns:t}=B(o),{doRequest:a,doDeleteRecord:d,tableContext:m}=x({tableProps:{api:t=>_(this,null,(function*(){let{dataSource:n,btnList:a}=yield A(e.value,t);return o.value=a,n})),columns:t,canResize:!1,useSearchForm:!1,beforeFetch:e=>Object.assign(e,{column:"orderNum",order:"asc"})}}),[u,{reload:p},{rowSelection:f,selectedRowKeys:b}]=m,[j,{closeModal:g}]=r((o=>_(this,null,(function*(){e.value=o.row.id,p()})))),{aiTestMode:y,genEnhanceJavaData:h}=M(),[v,C]=s(),k=i(!1),J=l({onRegister:v,title:c((()=>(null==k?void 0:k.value)?"修改":"新增")),width:800,confirmLoading:!1,bodyStyle:{height:"350px"},onOk:function(){return _(this,null,(function*(){try{J.confirmLoading=!0;let o=yield V();o=Object.assign({},I,o),yield R(e.value,o,k.value),p(),C.closeModal()}finally{J.confirmLoading=!1}}))},onCancel:C.closeModal});let I={};const{formSchemas:L}=T(o),[E,{resetFields:H,setFieldsValue:U,validate:V}]=n({schemas:L,showActionButtonGroup:!1});function z(e){return _(this,null,(function*(){var o;k.value=e.isUpdate,I=((e,o)=>{for(var t in o||(o={}))O.call(o,t)&&P(e,t,o[t]);if(D)for(var t of D(o))S.call(o,t)&&P(e,t,o[t]);return e})({},null!=(o=e.record)?o:{}),C.openModal(),yield w(),yield H(),U(I)}))}return{rowSelection:f,selectedRowKeys:b,aiTestMode:y,onCancel:function(){g()},onAdd:function(){z({isUpdate:!1})},onGenEnhanceJavaData:function(){h(e.value)},onBatchDelete:function(){return _(this,null,(function*(){a((()=>F(b.value)))}))},getTableAction:function(e){return[{label:"编辑",onClick:()=>function(e){z({isUpdate:!0,record:e})}(e)}]},getDropDownAction:function(e){return[{label:"删除",popConfirm:{title:"确定删除吗？",placement:"left",confirm:()=>d((()=>F([e.id])))}}]},formModalProps:J,registerModal:j,registerTable:u,registerForm:E}},computed:{tableScroll:()=>({y:window.innerHeight-320})}}),I={key:0,style:{float:"left"}};var L=d(J,[["render",function(e,o,t,n,a,i){const r=m("a-button"),s=m("a-icon"),l=m("a-menu-item"),c=m("a-menu"),d=m("a-dropdown"),w=m("TableAction"),C=m("BasicTable"),x=m("BasicForm"),M=m("a-spin"),T=m("BasicModal");return u(),p(T,{onRegister:e.registerModal,title:"JAVA增强",width:1200,defaultFullscreen:"",onCancel:e.onCancel},{footer:f((()=>[b(r,{onClick:e.onCancel},{default:f((()=>[j("关闭")])),_:1},8,["onClick"]),e.aiTestMode?(u(),g("div",I,[b(r,{onClick:e.onGenEnhanceJavaData},{default:f((()=>[j("生成测试数据")])),_:1},8,["onClick"])])):y("",!0)])),default:f((()=>[b(C,{onRegister:e.registerTable,rowSelection:e.rowSelection},{tableTitle:f((()=>[b(r,{onClick:e.onAdd,type:"primary",preIcon:"ant-design:plus"},{default:f((()=>[j("新增")])),_:1},8,["onClick"]),e.selectedRowKeys.length>0?(u(),p(d,{key:0},{overlay:f((()=>[b(c,null,{default:f((()=>[b(l,{key:"1",onClick:e.onBatchDelete},{default:f((()=>[b(s,{type:"delete"}),j(" 删除 ")])),_:1},8,["onClick"])])),_:1})])),default:f((()=>[b(r,{style:{"margin-left":"8px"}},{default:f((()=>[j(" 批量操作 "),b(s,{type:"down"})])),_:1})])),_:1})):y("",!0)])),action:f((({record:o})=>[b(w,{actions:e.getTableAction(o),dropDownActions:e.getDropDownAction(o)},null,8,["actions","dropDownActions"])])),_:1},8,["onRegister","rowSelection"]),b(T,h(v(e.formModalProps)),{default:f((()=>[b(M,{spinning:e.formModalProps.confirmLoading},{default:f((()=>[b(x,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},8,["spinning"])])),_:1},16)])),_:1},8,["onRegister","onCancel"])}]]);export{L as default};
