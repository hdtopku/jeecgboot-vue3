var w=(R,t,e)=>new Promise((i,l)=>{var u=a=>{try{d(e.next(a))}catch(p){l(p)}},o=a=>{try{d(e.throw(a))}catch(p){l(p)}},d=a=>a.done?i(a.value):Promise.resolve(a.value).then(u,o);d((e=e.apply(R,t)).next())});import{u as j,B as q}from"./index.fc50eb76.js";import{e as z,f as S,g as $}from"./depart.user.api.3d0cfa8a.js";import{l as A,F as c,L as g,t as n,v as _,V as I,z as s,y as v,x as k,aw as x,bb as P,C as T,D as G,aV as B}from"./index.39dcafc9.js";const H={style:{width:"100%","margin-top":"15px"}},J=B("span",null,"\u70B9\u51FB\u4FDD\u5B58",-1),W=A({__name:"DepartRoleUserAuthDrawer",emits:["register"],setup(R){const t=c(!1),e=c(""),i=c(""),l=c(""),u=c([]),o=c([]),[d,{closeDrawer:a}]=j(r=>{e.value=g(r.userId),i.value=g(r.departId),p()});function p(){return w(this,null,function*(){try{t.value=!0;const r={departId:i.value,userId:e.value},[m,y]=yield Promise.all([z(r),S(r)]);u.value=m,o.value=y.map(D=>D.droleId),l.value=o.value.join(",")}finally{t.value=!1}})}function b(){return w(this,null,function*(){try{t.value=!0,yield $({userId:e.value,newRoleId:o.value.join(","),oldRoleId:l.value}),F()}finally{t.value=!1}})}function C(){h()}function F(){h(),a()}function h(){e.value="",i.value="",l.value="",u.value=[],o.value=[]}return(r,m)=>{const y=n("a-checkbox"),D=n("a-col"),E=n("a-row"),L=n("a-checkbox-group"),V=n("a-button"),N=n("a-empty"),U=n("a-spin");return _(),I(g(q),{title:"\u90E8\u95E8\u89D2\u8272\u5206\u914D",width:365,onClose:C,onRegister:g(d)},{default:s(()=>[v(U,{spinning:t.value},{default:s(()=>[u.value.length>0?(_(),k(x,{key:0},[v(L,{value:o.value,"onUpdate:value":m[0]||(m[0]=f=>o.value=f)},{default:s(()=>[v(E,null,{default:s(()=>[(_(!0),k(x,null,P(u.value,f=>(_(),I(D,{span:24},{default:s(()=>[v(y,{value:f.id},{default:s(()=>[T(G(f.roleName),1)]),_:2},1032,["value"])]),_:2},1024))),256))]),_:1})]),_:1},8,["value"]),B("div",H,[v(V,{type:"primary",loading:t.value,size:"small",preIcon:"ant-design:save-filled",onClick:b},{default:s(()=>[J]),_:1},8,["loading"])])],64)):(_(),I(N,{key:1,description:"\u65E0\u914D\u7F6E\u4FE1\u606F"}))]),_:1},8,["spinning"])]),_:1},8,["onRegister"])}}});export{W as default};
