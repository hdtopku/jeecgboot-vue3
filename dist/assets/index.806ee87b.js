var at=Object.defineProperty,ot=Object.defineProperties;var st=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var nt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var $=(t,e,u)=>e in t?at(t,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):t[e]=u,M=(t,e)=>{for(var u in e||(e={}))nt.call(e,u)&&$(t,u,e[u]);if(z)for(var u of z(e))it.call(e,u)&&$(t,u,e[u]);return t},G=(t,e)=>ot(t,st(e));var S=(t,e,u)=>new Promise((i,l)=>{var f=o=>{try{n(u.next(o))}catch(r){l(r)}},y=o=>{try{n(u.throw(o))}catch(r){l(r)}},n=o=>o.done?i(o.value):Promise.resolve(o.value).then(f,y);n((u=u.apply(t,e)).next())});import{v as c,av as rt,Z as W,j as X,A as I,dy as h,fS as lt,T as R,l as x,C as T,m as b,E as ct,K as pt,H as A,q as Z,r as p,s as m,Q as E,w as F,t as v,bc as dt,ax as L,B as J,V as mt,aW as j,y as gt,z as V,R as D,aI as yt,dN as H,bW as Ft,cM as ft,k as Et,a7 as vt,bI as U,X as Ct,n as Bt,fT as ht,ac as Dt,x as _t}from"./index.2bb6f736.js";import{j as bt}from"./componentMap.d3e1f736.js";import At from"./DetailModal.e4a5180c.js";import{_ as kt}from"./DynamicNotice.vue_vue_type_script_setup_true_name_dynamic-notice_lang.04e4e4e2.js";import"./index.a72c51e6.js";import{connectWebSocket as wt,onWebSocket as Mt}from"./useWebSocket.b56f8f46.js";import{r as St}from"./mynews.api.a066d8e8.js";import jt from"./SysMessageModal.dd6b4ba3.js";import"./useFormItem.63e5f7b3.js";import"./JUpload.vue_vue_type_style_index_0_lang.8267106e.js";import"./api.7c892525.js";import"./BasicModal.1a3669ee.js";import"./useWindowSizeFn.e78c48f8.js";import"./download.2a7b23d8.js";import"./base64Conver.030fa32c.js";import"./index.156b712d.js";import"./index.4a60bff2.js";import"./useCountdown.8091aef7.js";import"./JAddInput.9b38307a.js";import"./areaDataUtil.10a03c2a.js";import"./props.d2a4e773.js";import"./index.e86d3526.js";import"./bem.7b4118e0.js";import"./props.cd85f2bf.js";import"./useContextMenu.a8d24d5c.js";import"./index.abedf6a3.js";import"./onMountedOrActivated.3671a872.js";import"./depart.api.be5d265f.js";import"./MinusCircleOutlined.d23d6026.js";import"./index.1d6f6b0f.js";import"./BasicForm.vue_vue_type_style_index_0_lang.466495e4.js";import"./uniqBy.7b921394.js";import"./SysMessageList.1118d2dd.js";import"./useSysMessage.8646ecae.js";var Tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M816 768h-24V428c0-141.1-104.3-257.7-240-277.1V112c0-22.1-17.9-40-40-40s-40 17.9-40 40v38.9c-135.7 19.4-240 136-240 277.1v340h-24c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h216c0 61.8 50.2 112 112 112s112-50.2 112-112h216c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM512 888c-26.5 0-48-21.5-48-48h96c0 26.5-21.5 48-48 48zM304 768V428c0-55.6 21.6-107.8 60.9-147.1S456.4 220 512 220c55.6 0 107.8 21.6 147.1 60.9S720 372.4 720 428v340H304z"}}]},name:"bell",theme:"outlined"};const Ot=Tt;function q(t){for(var e=1;e<arguments.length;e++){var u=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(u).filter(function(l){return Object.getOwnPropertyDescriptor(u,l).enumerable}))),i.forEach(function(l){Nt(t,l,u[l])})}return t}function Nt(t,e,u){return e in t?Object.defineProperty(t,e,{value:u,enumerable:!0,configurable:!0,writable:!0}):t[e]=u,t}var O=function(e,u){var i=q({},e,u.attrs);return c(rt,q({},i,{icon:Ot}),null)};O.displayName="BellOutlined";O.inheritAttrs=!1;const Pt=O;var Q=(t=>(t.L="L",t.M="M",t.H="H",t))(Q||{});const zt=[{key:"1",name:"\u901A\u77E5",list:[{id:"000000001",avatar:"https://gw.alipayobjects.com/zos/rmsportal/ThXAXghbEsBCCSDihZxY.png",title:"\u4F60\u6536\u5230\u4E86 14 \u4EFD\u65B0\u5468\u62A5",description:"",datetime:"2017-08-09",type:"1"},{id:"000000002",avatar:"https://gw.alipayobjects.com/zos/rmsportal/OKJXDXrmkNshAMvwtvhu.png",title:"\u4F60\u63A8\u8350\u7684 \u66F2\u59AE\u59AE \u5DF2\u901A\u8FC7\u7B2C\u4E09\u8F6E\u9762\u8BD5",description:"",datetime:"2017-08-08",type:"1"},{id:"000000003",avatar:"https://gw.alipayobjects.com/zos/rmsportal/kISTdvpyTAhtGxpovNWd.png",title:"\u8FD9\u79CD\u6A21\u677F\u53EF\u4EE5\u533A\u5206\u591A\u79CD\u901A\u77E5\u7C7B\u578B",description:"",datetime:"2017-08-07",type:"1"},{id:"000000004",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u5DE6\u4FA7\u56FE\u6807\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u7C7B\u578B",description:"",datetime:"2017-08-07",type:"1"},{id:"000000005",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u6807\u9898\u53EF\u4EE5\u8BBE\u7F6E\u81EA\u52A8\u663E\u793A\u7701\u7565\u53F7\uFF0C\u672C\u4F8B\u4E2D\u6807\u9898\u884C\u6570\u5DF2\u8BBE\u4E3A1\u884C\uFF0C\u5982\u679C\u5185\u5BB9\u8D85\u8FC71\u884C\u5C06\u81EA\u52A8\u622A\u65AD\u5E76\u652F\u6301tooltip\u663E\u793A\u5B8C\u6574\u6807\u9898\u3002",description:"",datetime:"2017-08-07",type:"1"},{id:"000000006",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u5DE6\u4FA7\u56FE\u6807\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u7C7B\u578B",description:"",datetime:"2017-08-07",type:"1"},{id:"000000007",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u5DE6\u4FA7\u56FE\u6807\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u7C7B\u578B",description:"",datetime:"2017-08-07",type:"1"},{id:"000000008",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u5DE6\u4FA7\u56FE\u6807\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u7C7B\u578B",description:"",datetime:"2017-08-07",type:"1"},{id:"000000009",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u5DE6\u4FA7\u56FE\u6807\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u7C7B\u578B",description:"",datetime:"2017-08-07",type:"1"},{id:"000000010",avatar:"https://gw.alipayobjects.com/zos/rmsportal/GvqBnKhFgObvnSGkDsje.png",title:"\u5DE6\u4FA7\u56FE\u6807\u7528\u4E8E\u533A\u5206\u4E0D\u540C\u7684\u7C7B\u578B",description:"",datetime:"2017-08-07",type:"1"}],count:0},{key:"2",name:"\u7CFB\u7EDF\u6D88\u606F",list:[{id:"000000006",avatar:"https://gw.alipayobjects.com/zos/rmsportal/fcHMVNCjPOsbUGdEduuv.jpeg",title:"\u66F2\u4E3D\u4E3D \u8BC4\u8BBA\u4E86\u4F60",description:"\u63CF\u8FF0\u4FE1\u606F\u63CF\u8FF0\u4FE1\u606F\u63CF\u8FF0\u4FE1\u606F",datetime:"2017-08-07",type:"2",clickClose:!0},{id:"000000007",avatar:"https://gw.alipayobjects.com/zos/rmsportal/fcHMVNCjPOsbUGdEduuv.jpeg",title:"\u6731\u504F\u53F3 \u56DE\u590D\u4E86\u4F60",description:"\u8FD9\u79CD\u6A21\u677F\u7528\u4E8E\u63D0\u9192\u8C01\u4E0E\u4F60\u53D1\u751F\u4E86\u4E92\u52A8",datetime:"2017-08-07",type:"2",clickClose:!0},{id:"000000008",avatar:"https://gw.alipayobjects.com/zos/rmsportal/fcHMVNCjPOsbUGdEduuv.jpeg",title:"\u6807\u9898",description:"\u8BF7\u5C06\u9F20\u6807\u79FB\u52A8\u5230\u6B64\u5904\uFF0C\u4EE5\u4FBF\u6D4B\u8BD5\u8D85\u957F\u7684\u6D88\u606F\u5728\u6B64\u5904\u5C06\u5982\u4F55\u5904\u7406\u3002\u672C\u4F8B\u4E2D\u8BBE\u7F6E\u7684\u63CF\u8FF0\u6700\u5927\u884C\u6570\u4E3A2\uFF0C\u8D85\u8FC72\u884C\u7684\u63CF\u8FF0\u5185\u5BB9\u5C06\u88AB\u7701\u7565\u5E76\u4E14\u53EF\u4EE5\u901A\u8FC7tooltip\u67E5\u770B\u5B8C\u6574\u5185\u5BB9",datetime:"2017-08-07",type:"2",clickClose:!0}],count:0}],$t=t=>W.get({url:"/sys/annountCement/listByUser",params:t}),K=(t,e)=>W.put({url:"/sys/sysAnnouncementSend/editByAnntIdAndUserId",params:M({anntId:t},e)}),Gt=X({components:{[I.name]:I,[h.name]:h,[h.Item.name]:h.Item,AListItemMeta:h.Item.Meta,ATypographyParagraph:lt.Paragraph,[R.name]:R,Time:bt},props:{list:{type:Array,default:()=>[]},pageSize:{type:[Boolean,Number],default:5},currentPage:{type:Number,default:1},titleRows:{type:Number,default:1},descRows:{type:Number,default:1},onTitleClick:{type:Function}},emits:["update:currentPage"],setup(t,{emit:e}){const{prefixCls:u}=x("header-notify-list"),i=T(t.currentPage||1),l=b(()=>{const{pageSize:o,list:r}=t;if(o===!1)return[];let g=pt(o)?o:5;return r.slice(g*(A(i)-1),g*A(i))});ct(()=>t.currentPage,o=>{i.value=o});const f=b(()=>!!t.onTitleClick),y=b(()=>{const{list:o,pageSize:r}=t;return r>0&&o&&o.length>r?{total:o.length,pageSize:r,current:A(i),onChange(g){i.value=g,e("update:currentPage",g)}}:!1});function n(o){t.onTitleClick&&t.onTitleClick(o)}return{prefixCls:u,getPagination:y,getData:l,handleTitleClick:n,isTitleClickable:f,PriorityTypes:Q}}});const It={class:"title"},Rt={key:0,class:"extra"},Lt={key:2},Vt={key:0,class:"description"},Ht={class:"datetime"};function Ut(t,e,u,i,l,f){const y=p("a-typography-paragraph"),n=p("a-tag"),o=p("a-avatar"),r=p("Icon"),g=p("Time"),k=p("a-list-item-meta"),C=p("a-list-item"),_=p("a-list");return m(),E(_,{class:J(t.prefixCls),pagination:t.getPagination},{default:F(()=>[(m(!0),v(L,null,dt(t.getData,s=>(m(),E(C,{key:s.id,class:"list-item",onClick:N=>t.handleTitleClick(s),style:mt({cursor:t.isTitleClickable?"pointer":""})},{default:F(()=>[c(k,null,{title:F(()=>[j("div",It,[c(y,{style:{width:"100%","margin-bottom":"0 !important"},delete:!!s.titleDelete,ellipsis:t.$props.titleRows&&t.$props.titleRows>0?{rows:t.$props.titleRows,tooltip:!!s.title}:!1,content:s.title},null,8,["delete","ellipsis","content"]),s.extra?(m(),v("div",Rt,[c(n,{class:"tag",color:s.color},{default:F(()=>[gt(V(s.extra),1)]),_:2},1032,["color"])])):D("",!0)])]),avatar:F(()=>[s.avatar?(m(),E(o,{key:0,class:"avatar",src:s.avatar},null,8,["src"])):s.priority?(m(),v(L,{key:1},[s.priority===t.PriorityTypes.L?(m(),E(o,{key:0,class:"avatar priority-L",title:"\u4E00\u822C\u6D88\u606F"},{icon:F(()=>[c(r,{icon:"entypo:info"})]),_:1})):D("",!0),s.priority===t.PriorityTypes.M?(m(),E(o,{key:1,class:"avatar priority-M",title:"\u91CD\u8981\u6D88\u606F"},{icon:F(()=>[c(r,{icon:"bi:exclamation-lg"})]),_:1})):D("",!0),s.priority===t.PriorityTypes.H?(m(),E(o,{key:2,class:"avatar priority-H",title:"\u7D27\u6025\u6D88\u606F"},{icon:F(()=>[c(r,{icon:"ant-design:warning-filled"})]),_:1})):D("",!0)],64)):(m(),v("span",Lt,V(s.avatar),1))]),description:F(()=>[j("div",null,[s.description?(m(),v("div",Vt,[c(y,{style:{width:"100%","margin-bottom":"0 !important"},ellipsis:t.$props.descRows&&t.$props.descRows>0?{rows:t.$props.descRows,tooltip:!!s.description}:!1,content:s.description},null,8,["ellipsis","content"])])):D("",!0),j("div",Ht,[c(g,{value:s.datetime,title:s.datetime},null,8,["value","title"])])])]),_:2},1024)]),_:2},1032,["onClick","style"]))),128))]),_:1},8,["class","pagination"])}const qt=Z(Gt,[["render",Ut],["__scopeId","data-v-f011ee3f"]]),Kt=X({components:{Popover:yt,BellOutlined:Pt,Tabs:H,TabPane:H.TabPane,Badge:Ft,NoticeList:qt,DetailModal:At,DynamicNotice:kt,SysMessageModal:jt},setup(){const{prefixCls:t}=x("header-notify"),e=Dt(),u=ft(),i=Et(),l=vt({path:"",formData:{}}),[f,y]=U(),n=T(zt),o=b(()=>{let a=0;for(let d=0;d<n.value.length;d++)a+=n.value[d].count;return a}),[r,{openModal:g}]=U();function k(){for(let a=0;a<n.value.length;a++)n.value[a].count=0;g(!0,{})}const C=T(!1);Ct(()=>{Y()});function _(a){return G(M({},a),{title:a.titile,description:a.msgAbstract,datetime:a.sendTime})}function s(){return S(this,null,function*(){try{let{anntMsgList:a,sysMsgList:d,anntMsgTotal:B,sysMsgTotal:w}=yield $t({pageSize:5});n.value[0].list=a.map(_),n.value[1].list=d.map(_),n.value[0].count=B,n.value[1].count=w}catch(a){console.warn("\u7CFB\u7EDF\u6D88\u606F\u901A\u77E5\u5F02\u5E38\uFF1A",a)}})}s();function N(a){var d;try{K(a.id),s()}catch(B){console.error(B)}a.openType==="component"?(l.path=a.openPage,l.formData={id:a.busId},(d=e.refs.dynamicNoticeRef)==null||d.detail(a.openPage)):y.openModal(!0,{record:a,isUpdate:!0}),C.value=!1}function Y(){var P;let a=Bt(),d=ht(a),B=A(u.getUserInfo).id+"_"+d,w=((P=i.domainUrl)==null?void 0:P.replace("https://","wss://").replace("http://","ws://"))+"/websocket/"+B;wt(w),Mt(tt)}function tt(a){(a.cmd==="topic"||a.cmd==="user")&&setTimeout(()=>{s()},1e3)}function et(){C.value=!1,St({},s)}function ut(a){return S(this,null,function*(){try{yield K(a),yield s()}catch(d){console.error(d)}})}return{prefixCls:t,listData:n,count:o,clickBadge:k,registerMessageModal:r,reloadCount:ut,onNoticeClick:N,onEmptyNotify:et,numberStyle:{},popoverVisible:C,registerDetail:f,dynamicNoticeProps:l}}});function Wt(t,e,u,i,l,f){const y=p("BellOutlined"),n=p("Badge"),o=p("DynamicNotice"),r=p("DetailModal"),g=p("sys-message-modal");return m(),v("div",{class:J(t.prefixCls)},[c(n,{count:t.count,overflowCount:9,offset:[-4,10],numberStyle:t.numberStyle,onClick:t.clickBadge},{default:F(()=>[c(y)]),_:1},8,["count","numberStyle","onClick"]),c(o,_t({ref:"dynamicNoticeRef"},t.dynamicNoticeProps),null,16),c(r,{onRegister:t.registerDetail},null,8,["onRegister"]),c(g,{onRegister:t.registerMessageModal,onRefresh:t.reloadCount},null,8,["onRegister","onRefresh"])],2)}const Me=Z(Kt,[["render",Wt]]);export{Me as default};
