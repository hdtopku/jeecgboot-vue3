import{j as h,C as r,eP as u,e6 as k,b5 as v,ew as A,eW as m,eQ as c,cL as y,o as _,s as L,t as w,u as T}from"./index.9d4ffdff.js";const I=h({__name:"OAuth2Login",setup(x){const l=r(u()),e=r({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:g}=k(),s=g.value;u()||v.replace({path:A.BASE_LOGIN,query:s.query}),l.value&&p();function p(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),d()}function d(){if(e.value.thirdApp)if(s.query.oauth2LoginToken){let n=s.query.oauth2LoginToken;f({token:n,thirdType:s.query.thirdType,tenantId:m})}else e.value.wxWork?c("wechat_enterprise"):e.value.dingtalk&&c("dingtalk")}function f(n){const i=y(),{notification:a}=T(),{t:o}=_();i.ThirdLogin(n).then(t=>{t&&t.userInfo?a.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):a.error({message:o("sys.login.errorTip"),description:((t.response||{}).data||{}).message||t.message||o("sys.login.networkExceptionMsg"),duration:4})})}return(n,i)=>(L(),w("div"))}});export{I as default};
