import{y as e,av as t,l as n,aK as a,F as r,o as l,H as o,f0 as c,L as i,t as u,v as s,x as d,V as f,ax as p,aW as h,z as y,C as v,u as m}from"./index.435ab247.js";import{k as b,l as g,s as O}from"./auth.api.8020f544.js";var k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"};function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){j(e,t,n[t])}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(n,a){var r=C({},n,a.attrs);return e(t,C({},r,{icon:k}),null)};w.displayName="DownCircleOutlined",w.inheritAttrs=!1;var x=w,P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 00-44.4 0L77.5 505a63.9 63.9 0 00-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0018.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"}}]},name:"home",theme:"outlined"};function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){z(e,t,n[t])}))}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(n,a){var r=S({},n,a.attrs);return e(t,S({},r,{icon:P}),null)};E.displayName="HomeOutlined",E.inheritAttrs=!1;var I=E,D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"}}]},name:"undo",theme:"outlined"};function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){K(e,t,n[t])}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H=function(n,a){var r=A({},n,a.attrs);return e(t,A({},r,{icon:D}),null)};H.displayName="UndoOutlined",H.inheritAttrs=!1;var M=H,L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.5 360.3a7.95 7.95 0 00-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"up-circle",theme:"outlined"};function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){U(e,t,n[t])}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V=function(n,a){var r=_({},n,a.attrs);return e(t,_({},r,{icon:L}),null)};V.displayName="UpCircleOutlined",V.inheritAttrs=!1;var N=(e,t,n)=>new Promise(((a,r)=>{var l=e=>{try{c(n.next(e))}catch(t){r(t)}},o=e=>{try{c(n.throw(e))}catch(t){r(t)}},c=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,o);c((n=n.apply(e,t)).next())}));const B=n({name:"AuthFieldTree",components:{DownCircleOutlined:x,HomeOutlined:I,UpCircleOutlined:V,UndoOutlined:M,CheckOutlined:a},props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:t}=m(),n=r(""),a=r(1),c=r(!0),u=r([]),s=r([]),d=r([]),f=r([]),p=r(""),h=l((()=>!n.value));function y(){return N(this,null,(function*(){if(!e.cgformId)return;let t=yield b(e.cgformId,a.value),n=[],r=[];t.forEach((e=>{r.includes(e.code)||(r.push(e.code),n.push({key:e.code,title:e.title}))}));for(let e of n){let n=[];for(let a of t)if(e.key===a.code){let e=v(a);n.push({key:a.id,title:e})}e.children=n}f.value=n,u.value=[...r],d.value=r}))}function v(e){let t="";return 3==e.page?t+="列表":5==e.page&&(t+="表单"),3==e.control?t+="可编辑":5==e.control&&(t+="可见"),t}function k(t,r){return N(this,null,(function*(){n.value=t,p.value=r,s.value=[];let l=yield g({roleId:t,cgformId:e.cgformId,type:a.value,authMode:r});s.value=l.map((e=>e.authId))}))}return o((()=>e.cgformId),y,{immediate:!0}),{loadChecked:k,clear:function(){n.value="",s.value=[]},expandedKeys:u,autoExpandParent:c,checkedKeys:s,treeData:f,disabled:h,onSave:function(){return N(this,null,(function*(){let a=s.value.filter((e=>d.value.indexOf(e)<0));yield O(n.value,e.cgformId,{authId:JSON.stringify(a),authMode:p.value}),t.success("保存成功")}))},onExpand:function(e){u.value=e,c.value=!1},clearChecked:function(){n.value=""},onCloseAll:function(){u.value=[]},onExpandAll:function(){u.value=[...d.value]},onRefresh:function(){y(),k(n.value,p.value)},onClearSelected:function(){s.value=[]},onSelectAll:function(){const e=function(t){for(let n of t)s.value.push(n.key),n.children&&n.children.length>0&&e.call(null,n.children)};s.value=[],e.call(null,i(f))}}}}),F={class:"onl-auth-tree-btns"};var R=c(B,[["render",function(t,n,a,r,l,o){const c=u("a-empty"),i=u("a-button"),m=u("DownCircleOutlined"),b=u("UpCircleOutlined"),g=u("CheckOutlined"),O=u("UndoOutlined"),k=u("a-tree");return s(),d("div",null,[t.disabled?(s(),f(c,{key:0,description:"请先选中左侧角色/部门/用户"})):0===t.treeData.length?(s(),f(c,{key:1,description:"无权限信息"})):(s(),d(p,{key:2},[h("div",F,[e(i,{onClick:t.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:y((()=>[v("刷新")])),_:1},8,["onClick"]),e(i,{onClick:t.onExpandAll,size:"small",type:"primary",ghost:""},{default:y((()=>[e(m),v("展开")])),_:1},8,["onClick"]),e(i,{onClick:t.onCloseAll,size:"small",type:"primary",ghost:""},{default:y((()=>[e(b),v("折叠")])),_:1},8,["onClick"]),e(i,{onClick:t.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:y((()=>[v("保存")])),_:1},8,["onClick"]),e(i,{onClick:t.onSelectAll,size:"small",type:"primary",ghost:""},{default:y((()=>[e(g),v("全选")])),_:1},8,["onClick"]),e(i,{onClick:t.onClearSelected,size:"small",type:"primary",ghost:""},{default:y((()=>[e(O),v("重置")])),_:1},8,["onClick"])]),e(k,{checkable:"",checkedKeys:t.checkedKeys,"onUpdate:checkedKeys":n[0]||(n[0]=e=>t.checkedKeys=e),expandedKeys:t.expandedKeys,autoExpandParent:t.autoExpandParent,treeData:t.treeData,onExpand:t.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}],["__scopeId","data-v-b03cefd8"]]);export{R as default};
