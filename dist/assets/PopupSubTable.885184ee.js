import{l as e,F as a,dz as l,a8 as t,a1 as u,t as n,v as o,V as d,z as p,y as i,W as r,u as s}from"./index.26a57b91.js";const m=e({__name:"PopupSubTable",setup(e){const{createMessage:m}=s(),c=a(!1),v=a([]),_=a([{key:"num",title:"序号",width:"80px"},{key:"ship_name",title:"船名",width:"180px",type:l.input},{key:"call",title:"呼叫",width:"80px"},{key:"len",title:"长",width:"80px"},{key:"ton",title:"吨",width:"120px"},{key:"payer",title:"付款方",width:"120px"},{key:"count",title:"数",width:"40px"},{key:"company",title:"公司",minWidth:"180px",showDetails:!0},{key:"trend",title:"动向",width:"120px"}]),f=a([]),y=t({currentRowId:null,loading:!1,pagination:{current:1,pageSize:200,pageSizeOptions:["100","200"],total:0},selectedRows:[],dataSource:[],columns:[{key:"dd_num",title:"调度序号",width:"120px"},{key:"tug",title:"拖轮",width:"180px",type:l.input},{key:"work_start_time",title:"作业开始时间",width:"180px",type:l.input},{key:"work_stop_time",title:"作业结束时间",width:"180px",type:l.input},{key:"type",title:"船舶分类",width:"120px",type:l.input},{key:"port_area",title:"所属港区",minWidth:"120px",type:l.input}]}),h=t({span:4}),w=t({span:20}),g=t({num:[{required:!0,message:"必须输入序号"}]});function b(e){return!!e&&(y.currentRowId===e.id||(y.currentRowId=e.id,y.loading=!0,u.get({url:"/mock/vxe/getData",params:{pageNo:1,pageSize:30,parentId:e.id}}).then((e=>{y.dataSource=e.records})).finally((()=>{y.loading=!1}))),!0)}function k({row:e,$table:a,callback:l}){a.validate(e).then((e=>{e?(l(!1),m.warn("校验失败")):(l(!0),c.value=!0,setTimeout((()=>{c.value=!1,m.success("保存成功")}),1e3))}))}return c.value=!0,u.get({url:"/mock/vxe/getData",params:{pageNo:1,pageSize:30}}).then((e=>{v.value=e.records,f.value=[]})).finally((()=>{c.value=!1})),(e,a)=>{const l=n("a-input"),t=n("a-form-item"),u=n("a-col"),s=n("a-row"),m=n("a-form"),f=n("JVxeTable"),x=n("a-card");return o(),d(x,{title:"弹出子表示例",bordered:!1},{default:p((()=>[i(f,{toolbar:"",rowNumber:"",rowSelection:"",highlightCurrentRow:"",clickRowShowSubForm:"",clickRowShowMainForm:"",height:750,loading:c.value,columns:_.value,dataSource:v.value,onDetailsConfirm:k},{mainForm:p((({row:e})=>[e?(o(),d(m,{key:0,ref:"form2",model:e,rules:g,"label-col":h,"wrapper-col":w},{default:p((()=>[i(s,{gutter:8},{default:p((()=>[i(u,{span:8},{default:p((()=>[i(t,{label:"ID",name:"id"},{default:p((()=>[i(l,{value:e.id,"onUpdate:value":a=>e.id=a,disabled:""},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"序号",name:"num"},{default:p((()=>[i(l,{value:e.num,"onUpdate:value":a=>e.num=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"船名",name:"ship_name"},{default:p((()=>[i(l,{value:e.ship_name,"onUpdate:value":a=>e.ship_name=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"呼叫",name:"call"},{default:p((()=>[i(l,{value:e.call,"onUpdate:value":a=>e.call=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"长",name:"len"},{default:p((()=>[i(l,{value:e.len,"onUpdate:value":a=>e.len=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"吨",name:"ton"},{default:p((()=>[i(l,{value:e.ton,"onUpdate:value":a=>e.ton=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"付款方",name:"payer"},{default:p((()=>[i(l,{value:e.payer,"onUpdate:value":a=>e.payer=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"数",name:"count"},{default:p((()=>[i(l,{value:e.count,"onUpdate:value":a=>e.count=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"公司",name:"company"},{default:p((()=>[i(l,{value:e.company,"onUpdate:value":a=>e.company=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),i(u,{span:8},{default:p((()=>[i(t,{label:"动向",name:"trend"},{default:p((()=>[i(l,{value:e.trend,"onUpdate:value":a=>e.trend=a},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["model","rules","label-col","wrapper-col"])):r("",!0)])),subForm:p((({row:e})=>[b(e)?(o(),d(f,{key:0,ref:"subFormTable",height:"auto","max-height":350,loading:y.loading,columns:y.columns,dataSource:y.dataSource},null,8,["loading","columns","dataSource"])):r("",!0)])),_:1},8,["loading","columns","dataSource"])])),_:1})}}});export{m as default};
