import{U as e}from"./JUpload.6bcc6fce.js";import"./JUploadModal.99ff436d.js";var t=Object.defineProperty,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i,r=(e,t,s)=>new Promise(((i,n)=>{var o=e=>{try{l(s.next(e))}catch(t){n(t)}},r=e=>{try{l(s.throw(e))}catch(t){n(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,r);l((s=s.apply(e,t)).next())}));const l="jeecg_submit_form_and_flow",a="flow_submit_id",d="online_form_table_name",c="validate-failed",p="setup",h="EnhanceJS",u={password:"text",file:"text",image:"text",textarea:"text",umeditor:"text",markdown:"text",checkbox:"list_multi",radio:"list"},m="online_";class g{constructor(e,t){this._data=t,this.field=e,this.label=t.title,this.hidden=!1,this.order=t.order||999,this.required=!1,this.onlyValidator="",this.setFieldsValue="",this.hasChange=!0,e.indexOf("@")>0?this.pre=e.substring(0,e.indexOf("@")+1):this.pre="",this.schemaProp={},this.searchForm=!1,this.disabled=!1,this.popContainer="",this.handleWidgetAttr(t)}getFormItemSchema(){let e=this.getItem();return this.addDefaultChangeEvent(e),e}getItem(){let e={field:this.field,label:this.label,labelLength:4,component:"Input",itemProps:{labelCol:{class:"online-form-label"}}},t=this.getRule();return t.length>0&&this.onlyValidator&&(e.rules=t),!0===this.hidden&&(e.show=!1),e}setFormRef(e){this.formRef=e}isHidden(){return this.hidden=!0,this}isRequired(e){return e&&e.length>0&&e.indexOf(this.field)>=0&&(this.required=!0),this}getExtendData(){let e={},{fieldExtendJson:t}=this._data;if(t&&"string"==typeof t)try{e=((e,t)=>{for(var r in t||(t={}))i.call(t,r)&&o(e,r,t[r]);if(s)for(var r of s(t))n.call(t,r)&&o(e,r,t[r]);return e})({},JSON.parse(t))}catch(r){}return e}getRelatedHideFields(){return[]}getPlaceholder(){return"请输入"+this.label}setOnlyValidateFun(e){e&&(this.onlyValidator=(t,s)=>r(this,null,(function*(){let i=yield e(t,s);return i?Promise.reject(i):Promise.resolve()})))}getRule(){let e=[];const{view:t,errorInfo:s,pattern:i,type:n}=this._data;if(!0===this.required){let i=this.getPlaceholder();s&&(i=s),"sel_depart"==t||"sel_user"==t?this.schemaProp.required=!0:e.push({required:!0,message:i})}if("sel_user"==t&&"only"===i&&this.onlyValidator&&e.push({validator:this.onlyValidator}),"list"===t||"radio"===t||"markdown"===t||"pca"===t||t.indexOf("sel")>=0||"time"===t)return e;if(t.indexOf("upload")>=0||t.indexOf("file")>=0||t.indexOf("image")>=0)return e;if(i)if("only"===i)this.onlyValidator&&e.push({validator:this.onlyValidator});else if("z"===i)"number"==n||"integer"==n||e.push({pattern:/^-?\d+$/,message:"请输入整数"});else{let t=s||"正则表达式不正确";e.push({pattern:i,message:t})}return e}addDefaultChangeEvent(e){this.hasChange&&(e.componentProps||(e.componentProps={}),1==this.disabled&&(e.componentProps.disabled=!0),e.componentProps.hasOwnProperty("onChange")||(e.componentProps.onChange=(e,t)=>{e instanceof Event&&(e=e.target.value),e instanceof Array&&(e=e.join(",")),this.formRef&&this.formRef.value&&this.formRef.value.$formValueChange&&this.formRef.value.$formValueChange(this.field,e,t)})),Object.keys(this.schemaProp).map((t=>{e[t]=this.schemaProp[t]}))}noChange(){this.hasChange=!1}updateField(e){this.field=e}setFunctionForFieldValue(e){e&&(this.setFieldsValue=e)}asSearchForm(){this.searchForm=!0}getModalAsContainer(){let e=this.getPopContainer();return document.querySelector(e)}getPopContainer(){return!0===this.searchForm?"body":this.popContainer?`.${this.popContainer} .ant-modal-content`:".jeecg-online-modal .ant-modal-content"}handleWidgetAttr(e){e.ui&&e.ui.widgetattrs&&1==e.ui.widgetattrs.disabled&&(this.disabled=!0)}setCustomPopContainer(e){this.popContainer=e}getLinkFieldInfo(){return""}setOtherInfo(e){}}class f extends g{getItem(){let e=super.getItem();return!0===this.hidden&&(e.show=!1),e}}var b=(e=>(e.datetime="YYYY-MM-DD HH:mm:ss",e.date="YYYY-MM-DD",e))(b||{});class C extends g{constructor(e,t){super(e,t),this.format=b[t.view],this.showTime="date"!=t.view}getItem(){let e=super.getItem();return Object.assign({},e,{component:"DatePicker",componentProps:{placeholder:`请选择${this.label}`,showTime:this.showTime,valueFormat:this.format,style:{width:"100%"},getPopupContainer:e=>this.getModalAsContainer()}})}}class x extends g{constructor(e,t){super(e,t),this.options=this.getOptions(t.enum),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode}getItem(){let e=super.getItem(),t=this.getFormComponent(),s=this.getComponentProps();return Object.assign({},e,{component:t,componentProps:s})}getFormComponent(){return this.options.length>0?"Select":"JDictSelectTag"}getComponentProps(){let e={allowClear:!0,style:{width:"100%"},getPopupContainer:e=>this.getModalAsContainer()};if(this.options.length>0)e.options=this.options;else if(this.dictTable){let t=`${this.dictTable},${this.dictText},${this.dictCode}`;e.dictCode=encodeURI(t)}else e.dictCode=this.dictCode;return e}getOptions(e){if(!e||0==e.length)return[];let t=[];for(let s of e)t.push({value:s.value,label:s.title});return t}}class P extends g{getItem(){let e=super.getItem();return Object.assign({},e,{component:"InputPassword"})}}class w extends g{getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JUpload",componentProps:t})}getComponentProps(){let e=this.getExtendData();return e&&e.uploadnum?{maxCount:Number(e.uploadnum)}:{}}}class I extends g{getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JUpload",componentProps:t})}getComponentProps(){let t={fileType:e.image},s=this.getExtendData();return s&&s.uploadnum&&(t.maxCount=Number(s.uploadnum)),t}}class F extends g{getItem(){let e=super.getItem();return Object.assign({},e,{component:"InputTextArea"})}}class y extends g{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSelectMultiple",componentProps:t})}getComponentProps(){if(this.dictTable||this.dictCode){let e={};if(this.dictTable){let t=`${this.dictTable},${this.dictText},${this.dictCode}`;e.dictCode=encodeURI(t)}else e.dictCode=this.dictCode;return e.triggerChange=!0,e.popContainer=this.getPopContainer(),e}return{}}}class O extends g{constructor(e,t){super(e,t),this.dict=encodeURI(`${t.dictTable},${t.dictText},${t.dictCode}`)}getItem(){let e=super.getItem(),t=this.getPopContainer();return Object.assign({},e,{component:"JSearchSelect",componentProps:{dict:this.dict,pageSize:6,async:!0,popContainer:t}})}}class T extends g{constructor(e,t){super(e,t),this.code=t.code,this.multi=t.popupMulti,this.fieldConfig=this.getFieldConfig(t)}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JPopup",componentProps:t})}getComponentProps(){let e={code:this.code,multi:this.multi,fieldConfig:this.fieldConfig};return this.formRef?e.formElRef=this.formRef:e.setFieldsValue=this.setFieldsValue,e}getFieldConfig(e){let{destFields:t,orgFields:s}=e;if(!t||0==t.length)return[];let i=t.split(","),n=s.split(","),o=[];const r=this.pre;for(let l=0;l<i.length;l++)o.push({target:r+i[l],source:n[l]});return o}}class v extends g{constructor(e,t){super(e,t),this.multi=!1,this.pid=t.pidValue,this.textField=t.textField}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{componentProps:t,component:"JCategorySelect"})}getComponentProps(){let e=this.pid||"EMPTY_PID";return this.textField?{loadTriggleChange:!0,multiple:this.multi,pid:e,back:this.textField,onChange:(e,t)=>{this.formRef&&(this.formRef.value.setFieldsValue(t),this.formRef.value.$formValueChange(this.field,e))}}:{multiple:this.multi,pid:e}}getRelatedHideFields(){let e=[];return this.textField&&e.push(this.textField),e}}class S extends g{getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSelectDept",componentProps:t})}getComponentProps(){let e=this.getExtendData(),t={checkStrictly:!0,showButton:!1};return e.text&&(t.labelKey=e.text),e.store&&(t.rowKey=e.store),!1===e.multiSelect&&(t.multiple=!1),t}}class j extends g{getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSelectUser",componentProps:t})}getComponentProps(){let e=this.getExtendData(),t={showSelected:!1,allowClear:!0,isRadioSelection:!1};return e.text&&(t.labelKey=e.text),e.store&&(t.rowKey=e.store),!1===e.multiSelect&&(t.isRadioSelection=!0),t}}class _ extends g{getItem(){let e=super.getItem();return Object.assign({},e,{component:"JEditor",componentProps:{options:{auto_focus:!1}}})}}class R extends g{getItem(){let e=super.getItem();return Object.assign({},e,{component:"JMarkdownEditor",componentProps:{}})}}class V extends g{getItem(){let e=super.getItem();return Object.assign({},e,{component:"JAreaSelect"})}}class k extends g{constructor(e,t){super(e,t),this.dict=t.dict,this.pidField=t.pidField,this.pidValue=t.pidValue}getItem(){let e=super.getItem();return Object.assign({},e,{component:"JTreeSelect",componentProps:{dict:this.dict,pidField:this.pidField,pidValue:this.pidValue}})}}class D extends g{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JDictSelectTag",componentProps:t})}getComponentProps(){if(this.dictTable||this.dictCode){if(this.dictTable){let e=`${this.dictTable},${this.dictText},${this.dictCode}`;return{dictCode:encodeURI(e),type:"radio"}}return{dictCode:this.dictCode,type:"radio"}}return{}}}class J extends g{constructor(e,t){super(e,t),this.options=this.getOptions(t.enum)}getItem(){let e=super.getItem();return Object.assign({},e,{component:"JCheckbox",componentProps:{options:this.options,triggerChange:!0}})}getOptions(e){if(!e||0==e.length)return[];let t=[];for(let s of e)t.push({value:s.value,label:s.title});return t}}class $ extends g{constructor(e,t){super(e,t),this.hasChange=!1}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"JSwitch",componentProps:t})}getComponentProps(){let{fieldExtendJson:e}=this._data,t=["Y","N"];if(e&&"string"==typeof e){let s=JSON.parse(e);2==s.length&&(t=s)}return{options:t}}}class E extends g{getItem(){let e=super.getItem();return Object.assign({},e,{component:"TimePicker",componentProps:{placeholder:`请选择${this.label}`,valueFormat:"HH:mm:ss",getPopupContainer:e=>this.getModalAsContainer(),style:{width:"100%"}}})}}class M extends g{constructor(e,t){super(e,t);const{dictTable:s,dictText:i,dictCode:n,pidField:o,idField:r,origin:l,condition:a}=t;this.table=s,this.txt=i,this.store=n,this.idField=r,this.pidField=o,this.origin=l,this.condition=a,this.options=[],this.next=t.next||"",this.type=t.type}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"OnlineSelectCascade",componentProps:t})}getComponentProps(){let e={table:this.table,txt:this.txt,store:this.store,pidField:this.pidField,idField:this.idField,origin:this.origin,pidValue:"-1",style:{width:"100%"},onChange:e=>{this.valueChange(e)},onNext:e=>{this.nextOptionsChange(e)}};return!0===this._data.origin&&(e.condition=this.condition),e}nextOptionsChange(e){return r(this,null,(function*(){if(!this.formRef)return;if(!this.next)return;let t=this.formRef.value;yield t.updateSchema({field:this.next,componentProps:{pidValue:e}})}))}valueChange(e){return r(this,null,(function*(){if(!this.formRef)return;if(!this.next)return;let t=this.formRef.value;t.$formValueChange(this.field,e),yield t.setFieldsValue({[this.next]:""})}))}}class N extends g{constructor(e,t){super(e,t),this.slot=""}getItem(){let e=super.getItem(),t=this.slot;return Object.assign({},e,{slot:t})}groupDate(){return this.slot="groupDate",this}groupDatetime(){return this.slot="groupDatetime",this}groupNumber(){return this.slot="groupNumber",this}}class U extends g{constructor(e,t){super(e,t),this.dbPointLength=t.dbPointLength}getItem(){let e=super.getItem(),t=this.getComponentProps();return Object.assign({},e,{component:"InputNumber",componentProps:t})}getComponentProps(){const e={style:{width:"100%"}};return this.dbPointLength>=0&&(e.precision=this.dbPointLength),e}}class Y extends g{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText,this.dictCode=t.dictCode,this.view=t.view,this.componentString="",this.linkFields=[]}getItem(){let e=super.getItem();const t=this.getComponentProps();return Object.assign({},e,{component:this.componentString,componentProps:t})}getComponentProps(){let e={textField:this.dictText,tableName:this.dictTable,valueField:this.dictCode},t=this.getExtendData();if(t.multiSelect?e.multi=!0:e.multi=!1,t.imageField?e.imageField=t.imageField:e.imageField="","select"==t.showType){this.componentString="LinkTableSelect";let t=this.getPopContainer();e.popContainer=t}else this.componentString="LinkTableCard";return this.linkFields.length>0&&(e.linkFields=this.linkFields),e}setOtherInfo(e){this.linkFields=e}}class A extends g{constructor(e,t){super(e,t),this.dictTable=t.dictTable,this.dictText=t.dictText}getItem(){let e=super.getItem();return Object.assign({},e,{componentProps:{readOnly:!0,allowClear:!1,disabled:!0,style:{background:"none",color:"rgba(0, 0, 0, 0.85)",border:"none"}}})}getLinkFieldInfo(){return[this.dictTable,`${this.field},${this.dictText}`]}}class L{static createFormSchema(e,t){switch(t.view){case"password":return new P(e,t);case"list":return new x(e,t);case"radio":return new D(e,t);case"checkbox":return new J(e,t);case"date":case"datetime":return new C(e,t);case"time":return new E(e,t);case"file":return new w(e,t);case"image":return new I(e,t);case"textarea":return new F(e,t);case"list_multi":return new y(e,t);case"sel_search":return new O(e,t);case"popup":return new T(e,t);case"cat_tree":return new v(e,t);case"sel_depart":return new S(e,t);case"sel_user":return new j(e,t);case"umeditor":return new _(e,t);case"markdown":return new R(e,t);case"pca":return new V(e,t);case"link_down":return new M(e,t);case"sel_tree":return new k(e,t);case"switch":return new $(e,t);case"link_table":return new Y(e,t);case"link_table_field":return new A(e,t);case"slot":return new N(e,t);case"hidden":return new f(e,t).isHidden();default:return"number"==t.type?new U(e,t):new f(e,t)}}static createSlotFormSchema(e,t){let s=new N(e,t),i=t.view;if("date"==i)s.groupDate();else if("datetime"==i)s.groupDatetime();else{let e=t.type;"number"!=e&&"integer"!=e||s.groupNumber()}return s}static createIdField(){return{label:"",field:"id",component:"Input",show:!1}}}export{h as E,L as F,d as O,l as S,c as V,m as a,a as b,u as c,p as d};
