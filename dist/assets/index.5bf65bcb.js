import{q as e,l as t,bd as a,be as s,cc as o,cd as r,aN as n,n as l,d7 as c,dU as d,o as i,bI as u,F as p,t as m,v as f,x as g,y as h,z as w,V as x,W as _,aW as k,E as y,D as v,ax as D,s as I,a as b,a3 as S,ej as C,el as P,ek as j,u as M}from"./index.26a57b91.js";import{S as U}from"./siteSetting.967dfbc9.js";import{useHeaderSetting as L}from"./useHeaderSetting.dd22f97a.js";import"./index.934459b9.js";import{h as R}from"./header.d801b988.js";import{r as A,q as E}from"./dict.api.fa980774.js";import"./BasicModal.e5e1fb3e.js";import"./useWindowSizeFn.9ed8a10e.js";const{createMessage:O}=M(),$=t({name:"UserDropdown",components:{Dropdown:a,Menu:s,MenuItem:o((()=>r((()=>import("./DropMenuItem.7673326e.js")),["assets/DropMenuItem.7673326e.js","assets/index.26a57b91.js","assets/index.8c83d65d.css"]))),MenuDivider:s.Divider,LockAction:o((()=>r((()=>import("./LockModal.bc8d5ac2.js")),["assets/LockModal.bc8d5ac2.js","assets/LockModal.db0fe75f.css","assets/idea.b218466e.css","assets/index.26a57b91.js","assets/index.8c83d65d.css","assets/index.934459b9.js","assets/index.9b6aba0b.css","assets/BasicModal.e5e1fb3e.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.9ed8a10e.js","assets/BasicForm.5f094c03.js","assets/BasicForm.afcef0d6.css","assets/helper.7e5efd4b.js","assets/helper.67489728.css","assets/useFormItem.efca0b58.js","assets/functional.c7818516.js","assets/functional.a68b3505.css","assets/download.4b98da42.js","assets/base64Conver.030fa32c.js","assets/index.608c7cf2.js","assets/index.8dedeae0.css","assets/index.b94b363f.js","assets/index.950cae9e.css","assets/useCountdown.e60db803.js","assets/JAddInput.a2bd8bfb.js","assets/JAddInput.27ff29e1.css","assets/api.54a4ca84.js","assets/props.eaaadc91.js","assets/index.3e7bd500.js","assets/index.037a125c.css","assets/bem.73404aba.js","assets/props.d9d42440.js","assets/useContextMenu.7af190c4.js","assets/useContextMenu.e7cbf068.css","assets/index.0d2a049f.js","assets/index.2254685a.css","assets/onMountedOrActivated.d719a17d.js","assets/index.6fce0e9a.js","assets/index.c827a9c8.css","assets/htmlmixed.fbaa0b47.js","assets/vue.38e13cef.js","assets/vue.a361089e.css","assets/depart.api.c295d6d2.js","assets/JUpload.7c63ef7b.js","assets/JUpload.bb1c69a5.css","assets/index.9c299300.js","assets/uniqBy.006870c7.js","assets/useForm.18cf269c.js","assets/lock.8982d38a.js","assets/header.d801b988.js"]))),DepartSelect:o((()=>r((()=>import("./DepartSelect.cd1e10ea.js")),["assets/DepartSelect.cd1e10ea.js","assets/DepartSelect.ff282e06.css","assets/index.934459b9.js","assets/index.9b6aba0b.css","assets/index.26a57b91.js","assets/index.8c83d65d.css","assets/BasicModal.e5e1fb3e.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.9ed8a10e.js","assets/depart.api.c295d6d2.js","assets/tenant.api.b2340665.js"]))),UpdatePassword:o((()=>r((()=>import("./UpdatePassword.d1fa9aa6.js")),["assets/UpdatePassword.d1fa9aa6.js","assets/idea.b218466e.css","assets/validator.a47312b2.js","assets/index.26a57b91.js","assets/index.8c83d65d.css","assets/user.api.c522f7b9.js","assets/index.934459b9.js","assets/index.9b6aba0b.css","assets/BasicModal.e5e1fb3e.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.9ed8a10e.js","assets/BasicForm.5f094c03.js","assets/BasicForm.afcef0d6.css","assets/helper.7e5efd4b.js","assets/helper.67489728.css","assets/useFormItem.efca0b58.js","assets/functional.c7818516.js","assets/functional.a68b3505.css","assets/download.4b98da42.js","assets/base64Conver.030fa32c.js","assets/index.608c7cf2.js","assets/index.8dedeae0.css","assets/index.b94b363f.js","assets/index.950cae9e.css","assets/useCountdown.e60db803.js","assets/JAddInput.a2bd8bfb.js","assets/JAddInput.27ff29e1.css","assets/api.54a4ca84.js","assets/props.eaaadc91.js","assets/index.3e7bd500.js","assets/index.037a125c.css","assets/bem.73404aba.js","assets/props.d9d42440.js","assets/useContextMenu.7af190c4.js","assets/useContextMenu.e7cbf068.css","assets/index.0d2a049f.js","assets/index.2254685a.css","assets/onMountedOrActivated.d719a17d.js","assets/index.6fce0e9a.js","assets/index.c827a9c8.css","assets/htmlmixed.fbaa0b47.js","assets/vue.38e13cef.js","assets/vue.a361089e.css","assets/depart.api.c295d6d2.js","assets/JUpload.7c63ef7b.js","assets/JUpload.bb1c69a5.css","assets/index.9c299300.js","assets/uniqBy.006870c7.js","assets/useForm.18cf269c.js"])))},props:{theme:n.oneOf(["dark","light"])},setup(){const{prefixCls:e}=l("header-user-dropdown"),{t:t}=I(),{getShowDoc:a,getUseLockPage:s}=L(),o=c(),r=d(),n=i((()=>{const{realname:e="",avatar:t,desc:a}=o.getUserInfo||{};return{realname:e,avatar:t||R,desc:a}})),m=i((()=>{let{avatar:e}=n.value;return e==R?e:b(e)})),[f,{openModal:g}]=u(),h=p();function w(){return e=this,t=null,a=function*(){if((yield A()).success){const e=yield E();C(j),P(j,e.result),O.success("刷新缓存完成！")}else O.error("刷新缓存失败！")},new Promise(((s,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},n=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,n);l((a=a.apply(e,t)).next())}));var e,t,a}const x=p();return{prefixCls:e,t:t,getUserInfo:n,getAvatarUrl:m,handleMenuClick:function(e){switch(e.key){case"logout":o.confirmLoginOut();break;case"doc":S(U);break;case"lock":g(!0);break;case"cache":w();break;case"depart":h.value.show();break;case"password":x.value.show(o.getUserInfo.username);break;case"account":r("/page-demo/account/setting")}},getShowDoc:a,register:f,getUseLockPage:s,loginSelectRef:h,updatePasswordRef:x}}}),V=["src"];var T=e($,[["render",function(e,t,a,s,o,r){const n=m("MenuItem"),l=m("MenuDivider"),c=m("Menu"),d=m("Dropdown"),i=m("LockAction"),u=m("DepartSelect"),p=m("UpdatePassword");return f(),g(D,null,[h(d,{placement:"bottomLeft",overlayClassName:`${e.prefixCls}-dropdown-overlay`},{overlay:w((()=>[h(c,{onClick:e.handleMenuClick},{default:w((()=>[e.getShowDoc?(f(),x(n,{key:"doc",text:e.t("layout.header.dropdownItemDoc"),icon:"ion:document-text-outline"},null,8,["text"])):_("",!0),e.getShowDoc?(f(),x(l,{key:1})):_("",!0),h(n,{key:"account",text:e.t("layout.header.dropdownItemSwitchAccount"),icon:"ant-design:setting-outlined"},null,8,["text"]),h(n,{key:"password",text:e.t("layout.header.dropdownItemSwitchPassword"),icon:"ant-design:edit-outlined"},null,8,["text"]),h(n,{key:"depart",text:e.t("layout.header.dropdownItemSwitchDepart"),icon:"ant-design:cluster-outlined"},null,8,["text"]),h(n,{key:"cache",text:e.t("layout.header.dropdownItemRefreshCache"),icon:"ion:sync-outline"},null,8,["text"]),h(n,{key:"logout",text:e.t("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"])])),_:1},8,["onClick"])])),default:w((()=>[k("span",{class:y([[e.prefixCls,`${e.prefixCls}--${e.theme}`],"flex"])},[k("img",{class:y(`${e.prefixCls}__header`),src:e.getAvatarUrl},null,10,V),k("span",{class:y(`${e.prefixCls}__info hidden md:block`)},[k("span",{class:y([`${e.prefixCls}__name  `,"truncate"])},v(e.getUserInfo.realname),3)],2)],2)])),_:1},8,["overlayClassName"]),h(i,{onRegister:e.register},null,8,["onRegister"]),h(u,{ref:"loginSelectRef"},null,512),h(p,{ref:"updatePasswordRef"},null,512)],64)}]]);export{T as default};
