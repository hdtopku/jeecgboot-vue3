import{l as e,a8 as t,F as a,dz as l,a1 as n,t as o,v as i,V as u,z as r,y as s,u as c}from"./index.b3c93d64.js";const p=e({__name:"JSBCDemo",setup(e){const{createMessage:p}=c(),d=t({btn:["add","save","remove","clearSelection"]}),m=a(!1),v=t({current:1,pageSize:200,pageSizeOptions:["10","20","30","100","200"],total:0}),y=a([]),g=a([]),h=a([{key:"num",title:"序号",width:80,type:l.normal},{key:"ship_name",title:"船名",width:180,type:l.input},{key:"call",title:"呼叫",width:80,type:l.input},{key:"len",title:"长",width:80,type:l.input},{key:"ton",title:"吨",width:120,defaultValue:233,type:l.input},{key:"payer",title:"付款方",width:120,defaultValue:"张三",type:l.input},{key:"count",title:"数",width:40,type:l.normal},{key:"company",title:"公司",minWidth:180,type:l.input},{key:"trend",title:"动向",width:120,type:l.input}]);function w(){return e=this,t=null,a=function*(){m.value=!0,yield n.get({url:"/mock/vxe/getData",params:{pageNo:v.current,pageSize:v.pageSize}}).then((e=>{v.total=e.total,g.value=e.records,y.value=[]})).finally((()=>{m.value=!1}))},new Promise(((l,n)=>{var o=e=>{try{u(a.next(e))}catch(t){n(t)}},i=e=>{try{u(a.throw(e))}catch(t){n(t)}},u=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,i);u((a=a.apply(e,t)).next())}));var e,t,a}function f({$table:e,target:t}){e.validate().then((e=>{if(!e){let e=t.getTableData();t.getNewData(),t.getDeleteData();m.value=!0,n.post({url:"/mock/vxe/immediateSaveAll",params:e}).then((()=>{p.success("保存成功！")})).finally((()=>{m.value=!1}))}}))}function S(e){e.deleteRows.map((e=>e.id));m.value=!0,window.setTimeout((()=>{m.value=!1,p.success("删除成功"),e.confirmRemove()}),1e3)}function k(e){let{$table:t,row:a,column:l}=e,o=l.property;t.isUpdateByRow(a,o)&&t.validate(a).then((e=>{if(!e){let e=p.loading(`正在保存"${l.title}"`,0);n.put({url:"/mock/vxe/immediateSaveRow",params:a}).then((e=>{p.success(`"${l.title}"保存成功！`),t.reloadRow(a,null,o)})).finally((()=>{e()}))}}))}function b(e){v.current=e.current,v.pageSize=e.pageSize,w()}function R(e){y.value=e.selectedRows}return w(),(e,t)=>{const a=o("JVxeTable"),l=o("a-card");return i(),u(l,{title:"即时保存示例",bordered:!1},{default:r((()=>[s(a,{toolbar:"",toolbarConfig:d,rowNumber:"",rowSelection:"",keepSource:"",asyncRemove:"",height:340,loading:m.value,columns:h.value,dataSource:g.value,pagination:v,onSave:f,onRemoved:S,onEditClosed:k,onPageChange:b,onSelectRowChange:R},null,8,["toolbarConfig","loading","columns","dataSource","pagination"])])),_:1})}}});export{p as default};
