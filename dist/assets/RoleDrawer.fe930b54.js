var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,l=(e,t,a)=>new Promise(((r,o)=>{var l=e=>{try{s(a.next(e))}catch(t){o(t)}},n=e=>{try{s(a.throw(e))}catch(t){o(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,n);s((a=a.apply(e,t)).next())}));import{B as n}from"./BasicForm.d9f6c231.js";import"./helper.1c9dc9a5.js";import{u as s}from"./useForm.45d68074.js";import"./JAddInput.8c125e2c.js";import{h as i,aE as d,u as c,l as u,F as p,o as m,L as f,q as h,t as b,v as g,V as v,z as w,y,B as j}from"./index.435ab247.js";import{s as x,c as I}from"./system.d1710ccf.js";import{B,u as D}from"./index.65c1cb1a.js";import{_ as F}from"./index.713dc63d.js";const P=[{title:"角色名称",dataIndex:"roleName",width:200},{title:"角色值",dataIndex:"roleValue",width:180},{title:"排序",dataIndex:"orderNo",width:50},{title:"状态",dataIndex:"status",width:120,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),i(d,{checked:"1"===e.status,checkedChildren:"已启用",unCheckedChildren:"已禁用",loading:e.pendingStatus,onChange(t){e.pendingStatus=!0;const a=t?"1":"0",{createMessage:r}=c();x(e.id,a).then((()=>{e.status=a,r.success("已成功修改角色状态")})).catch((()=>{r.error("修改角色状态失败")})).finally((()=>{e.pendingStatus=!1}))}}))},{title:"创建时间",dataIndex:"createTime",width:180},{title:"备注",dataIndex:"remark"}],S=[{field:"roleNme",label:"角色名称",component:"Input",colProps:{span:8}},{field:"status",label:"状态",component:"Select",componentProps:{options:[{label:"启用",value:"0"},{label:"停用",value:"1"}]},colProps:{span:8}}],O=[{field:"roleName",label:"角色名称",required:!0,component:"Input"},{field:"roleValue",label:"角色值",required:!0,component:"Input"},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:"0",componentProps:{options:[{label:"启用",value:"0"},{label:"停用",value:"1"}]}},{label:"备注",field:"remark",component:"InputTextArea"},{label:" ",field:"menu",slot:"menu",component:"Input"}];var k=h(u({name:"RoleDrawer",components:{BasicDrawer:B,BasicForm:n,BasicTree:F},emits:["success","register"],setup(e,{emit:n}){const i=p(!0),d=p([]),[c,{resetFields:u,setFieldsValue:h,validate:b}]=s({labelWidth:90,schemas:O,showActionButtonGroup:!1}),[g,{setDrawerProps:v,closeDrawer:w}]=D((e=>l(this,null,(function*(){u(),v({confirmLoading:!1}),0===f(d).length&&(d.value=yield I()),i.value=!!(null==e?void 0:e.isUpdate),f(i)&&h(((e,l)=>{for(var n in l||(l={}))a.call(l,n)&&o(e,n,l[n]);if(t)for(var n of t(l))r.call(l,n)&&o(e,n,l[n]);return e})({},e.record))}))));return{registerDrawer:g,registerForm:c,getTitle:m((()=>f(i)?"编辑角色":"新增角色")),handleSubmit:function(){return l(this,null,(function*(){try{yield b();v({confirmLoading:!0}),w(),n("success")}finally{v({confirmLoading:!1})}}))},treeData:d}}}),[["render",function(e,t,a,r,o,l){const n=b("BasicTree"),s=b("BasicForm"),i=b("BasicDrawer");return g(),v(i,j(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:w((()=>[y(s,{onRegister:e.registerForm},{menu:w((({model:t,field:a})=>[y(n,{value:t[a],"onUpdate:value":e=>t[a]=e,treeData:e.treeData,replaceFields:{title:"menuName",key:"id"},checkable:"",toolbar:"",title:"菜单分配"},null,8,["value","onUpdate:value","treeData"])])),_:1},8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])}]]),R=Object.freeze(Object.defineProperty({__proto__:null,default:k},Symbol.toStringTag,{value:"Module"}));export{k as R,R as a,P as c,S as s};
