import{q as e,l as t,bd as a,be as s,cc as o,cd as r,aN as n,n as l,d7 as c,dU as d,o as i,bI as u,F as p,t as m,v as f,x as g,y as h,z as w,V as x,W as _,aW as k,E as y,D as v,ax as D,s as b,a as I,a3 as S,ej as C,el as P,ek as j,u as M}from"./index.435ab247.js";import{S as U}from"./siteSetting.967dfbc9.js";import{useHeaderSetting as L}from"./useHeaderSetting.f908897c.js";import"./index.e1e06dd6.js";import{h as R}from"./header.d801b988.js";import{r as A,q as E}from"./dict.api.600c8ef0.js";import"./BasicModal.c66de981.js";import"./useWindowSizeFn.3d5b1a05.js";const{createMessage:O}=M(),$=t({name:"UserDropdown",components:{Dropdown:a,Menu:s,MenuItem:o((()=>r((()=>import("./DropMenuItem.bb7febdd.js")),["assets/DropMenuItem.bb7febdd.js","assets/index.435ab247.js","assets/index.8c83d65d.css"]))),MenuDivider:s.Divider,LockAction:o((()=>r((()=>import("./LockModal.640ff77f.js")),["assets/LockModal.640ff77f.js","assets/LockModal.db0fe75f.css","assets/idea.b218466e.css","assets/index.435ab247.js","assets/index.8c83d65d.css","assets/index.e1e06dd6.js","assets/index.9b6aba0b.css","assets/BasicModal.c66de981.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.3d5b1a05.js","assets/BasicForm.d9f6c231.js","assets/BasicForm.afcef0d6.css","assets/helper.1c9dc9a5.js","assets/helper.67489728.css","assets/useFormItem.816007c4.js","assets/functional.be5901d6.js","assets/functional.a68b3505.css","assets/download.5dc68cfb.js","assets/base64Conver.030fa32c.js","assets/index.a5502478.js","assets/index.8dedeae0.css","assets/index.64086148.js","assets/index.950cae9e.css","assets/useCountdown.adc4ab77.js","assets/JAddInput.8c125e2c.js","assets/JAddInput.7dae569e.css","assets/api.bc301b0f.js","assets/props.5467b933.js","assets/index.713dc63d.js","assets/index.037a125c.css","assets/bem.0e923c54.js","assets/props.37836c63.js","assets/useContextMenu.82ce6d89.js","assets/useContextMenu.e7cbf068.css","assets/index.e1ec35e6.js","assets/index.2254685a.css","assets/onMountedOrActivated.e9ddbd41.js","assets/index.627c6cd3.js","assets/index.c827a9c8.css","assets/htmlmixed.749cbc8c.js","assets/vue.f62dfd4a.js","assets/vue.a361089e.css","assets/depart.api.c07add53.js","assets/JUpload.e164672b.js","assets/JUpload.bb1c69a5.css","assets/index.cdc49bf1.js","assets/uniqBy.91f18935.js","assets/useForm.45d68074.js","assets/lock.13907917.js","assets/header.d801b988.js"]))),DepartSelect:o((()=>r((()=>import("./DepartSelect.ac220285.js")),["assets/DepartSelect.ac220285.js","assets/DepartSelect.ff282e06.css","assets/index.e1e06dd6.js","assets/index.9b6aba0b.css","assets/index.435ab247.js","assets/index.8c83d65d.css","assets/BasicModal.c66de981.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.3d5b1a05.js","assets/depart.api.c07add53.js","assets/tenant.api.8734e9c7.js"]))),UpdatePassword:o((()=>r((()=>import("./UpdatePassword.7db3a171.js")),["assets/UpdatePassword.7db3a171.js","assets/idea.b218466e.css","assets/validator.f9147ad2.js","assets/index.435ab247.js","assets/index.8c83d65d.css","assets/user.api.f3bf5333.js","assets/index.e1e06dd6.js","assets/index.9b6aba0b.css","assets/BasicModal.c66de981.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.3d5b1a05.js","assets/BasicForm.d9f6c231.js","assets/BasicForm.afcef0d6.css","assets/helper.1c9dc9a5.js","assets/helper.67489728.css","assets/useFormItem.816007c4.js","assets/functional.be5901d6.js","assets/functional.a68b3505.css","assets/download.5dc68cfb.js","assets/base64Conver.030fa32c.js","assets/index.a5502478.js","assets/index.8dedeae0.css","assets/index.64086148.js","assets/index.950cae9e.css","assets/useCountdown.adc4ab77.js","assets/JAddInput.8c125e2c.js","assets/JAddInput.7dae569e.css","assets/api.bc301b0f.js","assets/props.5467b933.js","assets/index.713dc63d.js","assets/index.037a125c.css","assets/bem.0e923c54.js","assets/props.37836c63.js","assets/useContextMenu.82ce6d89.js","assets/useContextMenu.e7cbf068.css","assets/index.e1ec35e6.js","assets/index.2254685a.css","assets/onMountedOrActivated.e9ddbd41.js","assets/index.627c6cd3.js","assets/index.c827a9c8.css","assets/htmlmixed.749cbc8c.js","assets/vue.f62dfd4a.js","assets/vue.a361089e.css","assets/depart.api.c07add53.js","assets/JUpload.e164672b.js","assets/JUpload.bb1c69a5.css","assets/index.cdc49bf1.js","assets/uniqBy.91f18935.js","assets/useForm.45d68074.js"])))},props:{theme:n.oneOf(["dark","light"])},setup(){const{prefixCls:e}=l("header-user-dropdown"),{t:t}=b(),{getShowDoc:a,getUseLockPage:s}=L(),o=c(),r=d(),n=i((()=>{const{realname:e="",avatar:t,desc:a}=o.getUserInfo||{};return{realname:e,avatar:t||R,desc:a}})),m=i((()=>{let{avatar:e}=n.value;return e==R?e:I(e)})),[f,{openModal:g}]=u(),h=p();function w(){return e=this,t=null,a=function*(){if((yield A()).success){const e=yield E();C(j),P(j,e.result),O.success("刷新缓存完成！")}else O.error("刷新缓存失败！")},new Promise(((s,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},n=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,n);l((a=a.apply(e,t)).next())}));var e,t,a}const x=p();return{prefixCls:e,t:t,getUserInfo:n,getAvatarUrl:m,handleMenuClick:function(e){switch(e.key){case"logout":o.confirmLoginOut();break;case"doc":S(U);break;case"lock":g(!0);break;case"cache":w();break;case"depart":h.value.show();break;case"password":x.value.show(o.getUserInfo.username);break;case"account":r("/page-demo/account/setting")}},getShowDoc:a,register:f,getUseLockPage:s,loginSelectRef:h,updatePasswordRef:x}}}),V=["src"];var T=e($,[["render",function(e,t,a,s,o,r){const n=m("MenuItem"),l=m("MenuDivider"),c=m("Menu"),d=m("Dropdown"),i=m("LockAction"),u=m("DepartSelect"),p=m("UpdatePassword");return f(),g(D,null,[h(d,{placement:"bottomLeft",overlayClassName:`${e.prefixCls}-dropdown-overlay`},{overlay:w((()=>[h(c,{onClick:e.handleMenuClick},{default:w((()=>[e.getShowDoc?(f(),x(n,{key:"doc",text:e.t("layout.header.dropdownItemDoc"),icon:"ion:document-text-outline"},null,8,["text"])):_("",!0),e.getShowDoc?(f(),x(l,{key:1})):_("",!0),h(n,{key:"account",text:e.t("layout.header.dropdownItemSwitchAccount"),icon:"ant-design:setting-outlined"},null,8,["text"]),h(n,{key:"password",text:e.t("layout.header.dropdownItemSwitchPassword"),icon:"ant-design:edit-outlined"},null,8,["text"]),h(n,{key:"depart",text:e.t("layout.header.dropdownItemSwitchDepart"),icon:"ant-design:cluster-outlined"},null,8,["text"]),h(n,{key:"cache",text:e.t("layout.header.dropdownItemRefreshCache"),icon:"ion:sync-outline"},null,8,["text"]),h(n,{key:"logout",text:e.t("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"])])),_:1},8,["onClick"])])),default:w((()=>[k("span",{class:y([[e.prefixCls,`${e.prefixCls}--${e.theme}`],"flex"])},[k("img",{class:y(`${e.prefixCls}__header`),src:e.getAvatarUrl},null,10,V),k("span",{class:y(`${e.prefixCls}__info hidden md:block`)},[k("span",{class:y([`${e.prefixCls}__name  `,"truncate"])},v(e.getUserInfo.realname),3)],2)],2)])),_:1},8,["overlayClassName"]),h(i,{onRegister:e.register},null,8,["onRegister"]),h(u,{ref:"loginSelectRef"},null,512),h(p,{ref:"updatePasswordRef"},null,512)],64)}]]);export{T as default};
