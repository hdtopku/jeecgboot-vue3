var R=Object.defineProperty;var C=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var D=(t,o,s)=>o in t?R(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,v=(t,o)=>{for(var s in o||(o={}))S.call(o,s)&&D(t,s,o[s]);if(C)for(var s of C(o))T.call(o,s)&&D(t,s,o[s]);return t};var w=(t,o,s)=>new Promise((f,n)=>{var u=a=>{try{c(s.next(a))}catch(m){n(m)}},p=a=>{try{c(s.throw(a))}catch(m){n(m)}},c=a=>a.done?f(a.value):Promise.resolve(a.value).then(u,p);c((s=s.apply(t,o)).next())});import{B as U}from"./BasicForm.ab69c67e.js";import"./helper.f767d3be.js";import{u as k}from"./useForm.7ab6626f.js";import"./JAddInput.17bd90fa.js";import{j as x,eo as I,C as B,K as r,m as L,s as V,Q as W,w as j,v as M,x as N}from"./index.6a7efbe3.js";import{f as O,l as $,C as q,g as G}from"./menu.data.f1ecbc20.js";import{u as K,B as Q}from"./index.28bdf088.js";import{useDrawerAdaptiveWidth as z}from"./useAdaptiveWidth.f348e1d8.js";const ae=x({__name:"MenuDrawer",emits:["success","register"],setup(t,{emit:o}){const{adaptiveWidth:s}=z(),f=I(),n=B(!0),u=B(0),p=e=>e===2,[c,{setProps:a,resetFields:m,setFieldsValue:_,updateSchema:g,validate:y,clearValidate:H}]=k({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:O,showActionButtonGroup:!1}),[b,{setDrawerProps:d,closeDrawer:A}]=K(e=>w(this,null,function*(){var F;yield m(),d({confirmLoading:!1}),n.value=!!(e!=null&&e.isUpdate),u.value=(F=e==null?void 0:e.record)==null?void 0:F.menuType;const i=yield $();if(g([{field:"parentId",componentProps:{treeData:i}},{field:"name",label:p(r(u))?"\u6309\u94AE/\u6743\u9650":"\u83DC\u5355\u540D\u79F0"},{field:"url",required:!p(r(u)),componentProps:{onChange:l=>h(l.target.value)}}]),typeof e.record=="object"){let l=v({},e.record);_(l),h(l.url)}a({disabled:!f.showFooter})})),P=L(()=>r(n)?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355");function E(){return w(this,null,function*(){try{const e=yield y();q.IFrame===e.component&&(e.component=e.frameSrc),d({confirmLoading:!0}),yield G(e,r(n)),A(),o("success")}finally{d({confirmLoading:!1})}})}function h(e){let i="";e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),i=`${e}`):i="\u8BF7\u8F93\u5165\u7EC4\u4EF6\u540D\u79F0",g([{field:"componentName",componentProps:{placeholder:i}}])}return(e,i)=>(V(),W(r(Q),N(e.$attrs,{onRegister:r(b),showFooter:"",width:r(s),title:r(P),onOk:E}),{default:j(()=>[M(r(U),{onRegister:r(c),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{ae as _};
