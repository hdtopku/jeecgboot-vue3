var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,r=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&i(e,n,t[n]);if(l)for(var n of l(t))a.call(t,n)&&i(e,n,t[n]);return e},s=(e,l)=>t(e,n(l)),c=(e,t,n)=>new Promise(((l,o)=>{var a=e=>{try{r(n.next(e))}catch(t){o(t)}},i=e=>{try{r(n.throw(e))}catch(t){o(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(a,i);r((n=n.apply(e,t)).next())}));import{y as u,av as d,l as f,q as p,t as g,v as m,x as h,X as b,C as v,D as y,aw as C,n as S,o as w,V as x,z as R,E as k,W as O,ax as P,s as T,F as I,H as F,ay as _,L as K,az as D,aA as A,aB as j,aC as L,aD as M,aE as E,aF as H,aG as B,aH as $,h as z,aI as V,aJ as N,aK as W,aL as q,aM as U,aN as G,aa as J,aO as Q,Q as X,aP as Y,N as Z,aQ as ee,ac as te,aR as ne,aS as le,aT as oe,aU as ae,aV as ie,R as re,S as se,aW as ce,B as ue,aX as de,aY as fe,a8 as pe,aZ as ge,a_ as me,ab as he,a$ as be,$ as ve,b0 as ye,b1 as Ce,b2 as Se,al as we,b3 as xe,b4 as Re,b5 as ke,u as Oe,e as Pe,b6 as Te,b7 as Ie,I as Fe,b8 as _e,b9 as Ke,ba as De,bb as Ae,bc as je,bd as Le,be as Me,bf as Ee,bg as He,bh as Be,bi as $e,am as ze,bj as Ve,bk as Ne,bl as We,bm as qe,bn as Ue}from"./index.b3c93d64.js";import{B as Ge}from"./BasicForm.79466d99.js";import{P as Je,a as Qe,A as Xe,b as Ye,u as Ze,D as et,I as tt,c as nt,R as lt,F as ot,d as at,e as it,f as rt,g as st}from"./helper.ec3e26f3.js";import{u as ct}from"./useForm.ee23be26.js";import"./JAddInput.c8a1b05b.js";import{P as ut}from"./index.4258d6df.js";import{useWindowSizeFn as dt}from"./useWindowSizeFn.e6386ae5.js";import"./index.ee0a0c33.js";import{onMountedOrActivated as ft}from"./onMountedOrActivated.d3784e6c.js";import{u as pt,F as gt,a as mt}from"./BasicModal.2a8ad889.js";import{R as ht}from"./RedoOutlined.c563bb0b.js";var bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){yt(e,t,n[t])}))}return e}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ct=function(e,t){var n=vt({},e,t.attrs);return u(d,vt({},n,{icon:bt}),null)};Ct.displayName="ColumnHeightOutlined",Ct.inheritAttrs=!1;var St=Ct,wt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"}}]},name:"drag",theme:"outlined"};function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){Rt(e,t,n[t])}))}return e}function Rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kt=function(e,t){var n=xt({},e,t.attrs);return u(d,xt({},n,{icon:wt}),null)};kt.displayName="DragOutlined",kt.inheritAttrs=!1;var Ot=kt,Pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"};function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){It(e,t,n[t])}))}return e}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ft=function(e,t){var n=Tt({},e,t.attrs);return u(d,Tt({},n,{icon:Pt}),null)};Ft.displayName="FormOutlined",Ft.inheritAttrs=!1;var _t=Ft,Kt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"};function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},l=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),l.forEach((function(t){At(e,t,n[t])}))}return e}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jt=function(e,t){var n=Dt({},e,t.attrs);return u(d,Dt({},n,{icon:Kt}),null)};jt.displayName="SettingOutlined",jt.inheritAttrs=!1;var Lt=jt;const Mt=f({name:"EditTableHeaderIcon",components:{FormOutlined:_t},props:{title:{type:String,default:""}}});const Et=f({name:"TableHeaderCell",components:{EditTableHeaderCell:p(Mt,[["render",function(e,t,n,l,o,a){const i=g("FormOutlined");return m(),h("span",null,[b(e.$slots,"default"),v(" "+y(e.title)+" ",1),u(i)])}]]),BasicHelp:C},props:{column:{type:Object,default:()=>({})}},setup(e){const{prefixCls:t}=S("basic-table-header-cell");return{prefixCls:t,getIsEdit:w((()=>{var t;return!!(null==(t=e.column)?void 0:t.edit)})),getTitle:w((()=>{var t,n;return(null==(t=e.column)?void 0:t.customTitle)||(null==(n=e.column)?void 0:n.title)})),getHelpMessage:w((()=>{var t;return null==(t=e.column)?void 0:t.helpMessage}))}}}),Ht={key:1};var Bt=p(Et,[["render",function(e,t,n,l,o,a){const i=g("EditTableHeaderCell"),r=g("BasicHelp");return m(),h(P,null,[e.getIsEdit?(m(),x(i,{key:0},{default:R((()=>[v(y(e.getTitle),1)])),_:1})):(m(),h("span",Ht,y(e.getTitle),1)),e.getHelpMessage?(m(),x(r,{key:2,text:e.getHelpMessage,class:k(`${e.prefixCls}__help`)},null,8,["text","class"])):O("",!0)],64)}]]);function $t({page:e,type:t,originalElement:n}){return"prev"===t?0===e?null:u(D,null,null):"next"===t?1===e?null:u(A,null,null):n}const zt=new Map;zt.set("Input",j),zt.set("InputNumber",L),zt.set("Select",M),zt.set("ApiSelect",Xe),zt.set("ApiTreeSelect",Ye),zt.set("Switch",E),zt.set("Checkbox",H),zt.set("DatePicker",B),zt.set("TimePicker",$);const{t:Vt}=T();function Nt(e){return e.includes("Input")?Vt("common.inputText"):e.includes("Picker")||e.includes("Select")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")||e.includes("DatePicker")||e.includes("TimePicker")?Vt("common.chooseText"):""}const Wt=f({name:"EditableCell",components:{FormOutlined:_t,CloseOutlined:N,CheckOutlined:W,CellComponent:({component:e="Input",rule:t=!0,ruleMessage:n,popoverVisible:l,getPopupContainer:o},{attrs:a})=>{const i=zt.get(e),s=z(i,a);return t?z(V,r({overlayClassName:"edit-cell-rule-popover",visible:!!l},o?{getPopupContainer:o}:{}),{default:()=>s,content:()=>n}):s},ASpin:q},directives:{clickOutside:U},props:{value:{type:[String,Number,Boolean,Object],default:""},record:{type:Object},column:{type:Object,default:()=>({})},index:G.number},setup(e){const t=Ze(),n=I(!1),l=I(),o=I(!1),a=I(""),i=I([]),u=I(e.value),d=I(e.value),f=I(!1),{prefixCls:p}=S("editable-cell"),g=w((()=>{var t;return(null==(t=e.column)?void 0:t.editComponent)||"Input"})),m=w((()=>{var t;return null==(t=e.column)?void 0:t.editRule})),h=w((()=>K(a)&&K(o))),b=w((()=>{const e=K(g);return["Checkbox","Switch"].includes(e)})),v=w((()=>{var n,l;const o=null!=(l=null==(n=e.column)?void 0:n.editComponentProps)?l:{},a={};"ApiSelect"===K(g)&&(a.cache=!0);const i=K(b),c=i?"checked":"value",d=K(u),f=i?Z(d)&&_(d)?d:!!d:d;return s(r(r({size:"small",getPopupContainer:()=>{var e;return null!=(e=K(null==t?void 0:t.wrapRef.value))?e:document.body},getCalendarContainer:()=>{var e;return null!=(e=K(null==t?void 0:t.wrapRef.value))?e:document.body},placeholder:Nt(K(g))},a),ae(o,"onChange")),{[c]:f})})),y=w((()=>{var t,n;const{editComponentProps:l,editValueMap:o}=e.column,a=K(u);if(o&&ee(o))return o(a);if(!K(g).includes("Select"))return a;const r=(null!=(t=null==l?void 0:l.options)?t:K(i)||[]).find((e=>`${e.value}`==`${a}`));return null!=(n=null==r?void 0:r.label)?n:a})),C=w((()=>K(b)||K(R)?{}:{width:"calc(100% - 48px)"})),x=w((()=>{const{align:t="center"}=e.column;return`edit-cell-align-${t}`})),R=w((()=>{const{editable:t}=e.record||{};return!!t}));function k(){return c(this,null,(function*(){const{column:t,record:n}=e,{editRule:l}=t,i=K(u);if(l){if(_(l)&&!i&&!Z(i)){o.value=!0;const e=K(g);return a.value=Nt(e),!1}if(ee(l)){const e=yield l(i,n);return e?(a.value=e,o.value=!0,!1):(a.value="",!0)}}return a.value="",!0}))}function O(l=!0,o=!0){return c(this,null,(function*(){var a;if(o){if(!(yield k()))return!1}const{column:i,index:r,record:s}=e;if(!s)return!1;const{key:c,dataIndex:d}=i,p=K(u);if(!c||!d)return;const g=d||c;if(!s.editable){const{getBindValues:e}=t,{beforeEditSubmit:n,columns:l}=K(e);if(n&&ee(n)){f.value=!0;const e=l.map((e=>e.dataIndex)).filter((e=>!!e));let t=!0;try{t=yield n({record:ne(s,e),index:r,key:c,value:p})}catch(m){t=!1}finally{f.value=!1}if(!1===t)return}}le(s,g,p),l&&(null==(a=t.emit)||a.call(t,"edit-end",{record:s,index:r,key:c,value:p})),n.value=!1}))}function P(){var l;n.value=!1,u.value=d.value;const{column:o,index:a,record:i}=e,{key:r,dataIndex:s}=o;null==(l=t.emit)||l.call(t,"edit-cancel",{record:i,index:a,key:s||r,value:K(u)})}function T(t,n){var l;e.record&&(Q(e.record[t])?null==(l=e.record[t])||l.push(n):e.record[t]=[n])}return J((()=>{d.value=e.value,u.value=e.value})),J((()=>{const{editable:t}=e.column;(_(t)||_(K(R)))&&(n.value=!!t||K(R))})),e.record&&(T("submitCbs",O),T("validCbs",k),T("cancelCbs",P),e.column.dataIndex&&(e.record.editValueRefs||(e.record.editValueRefs={}),e.record.editValueRefs[e.column.dataIndex]=u),e.record.onCancelEdit=()=>{var t,n;Q(null==(t=e.record)?void 0:t.cancelCbs)&&(null==(n=e.record)||n.cancelCbs.forEach((e=>e())))},e.record.onSubmitEdit=()=>c(this,null,(function*(){var n,l,o,a,i;if(Q(null==(n=e.record)?void 0:n.submitCbs)){if(!(null==(o=null==(l=e.record)?void 0:l.onValid)?void 0:o.call(l)))return;return((null==(a=e.record)?void 0:a.submitCbs)||[]).forEach((e=>e(!1,!1))),null==(i=t.emit)||i.call(t,"edit-row-end"),!0}}))),{isEdit:n,prefixCls:p,handleEdit:function(){var t;K(R)||K(null==(t=e.column)?void 0:t.editRow)||(a.value="",n.value=!0,X((()=>{var e;const t=K(l);null==(e=null==t?void 0:t.focus)||e.call(t)})))},currentValueRef:u,handleSubmit:O,handleChange:function(n){return c(this,arguments,(function*(n){var l,o,a;const i=K(g);n?(null==n?void 0:n.target)&&Reflect.has(n.target,"value")?u.value=n.target.value:"Checkbox"===i?u.value=n.target.checked:(Y(n)||_(n)||Z(n))&&(u.value=n):u.value=n;const r=null==(o=null==(l=e.column)?void 0:l.editComponentProps)?void 0:o.onChange;r&&ee(r)&&r(...arguments),null==(a=t.emit)||a.call(t,"edit-change",{column:e.column,value:K(u),record:te(e.record)}),k()}))},handleCancel:P,elRef:l,getComponent:g,getRule:m,onClickOutside:function(){var t;if((null==(t=e.column)?void 0:t.editable)||K(R))return;K(g).includes("Input")&&P()},ruleMessage:a,getRuleVisible:h,getComponentProps:v,handleOptionsChange:function(t){var n,l;const{replaceFields:o}=null!=(l=null==(n=e.column)?void 0:n.editComponentProps)?l:{};if("ApiTreeSelect"===K(g)){const{title:e="title",value:n="value",children:l="children"}=o||{};let a=oe(t,{children:l});a=a.map((t=>({label:t[e],value:t[n]}))),i.value=a}else i.value=t},getWrapperStyle:C,getWrapperClass:x,getRowEditable:R,getValues:y,handleEnter:function(){return c(this,null,(function*(){var t;(null==(t=e.column)?void 0:t.editRow)||O()}))},handleSubmitClick:function(){O()},spinning:f}}}),qt=["title"];var Ut=p(Wt,[["render",function(e,t,n,l,o,a){var i;const r=g("FormOutlined"),s=g("CellComponent"),c=g("CheckOutlined"),d=g("CloseOutlined"),f=g("a-spin"),p=ie("click-outside");return m(),h("div",{class:k(e.prefixCls)},[re(ce("div",{class:k({[`${e.prefixCls}__normal`]:!0,"ellipsis-cell":e.column.ellipsis}),onClick:t[0]||(t[0]=(...t)=>e.handleEdit&&e.handleEdit(...t))},[ce("div",{class:"cell-content",title:e.column.ellipsis&&null!=(i=e.getValues)?i:""},y(e.getValues?e.getValues:" "),9,qt),e.column.editRow?O("",!0):(m(),x(r,{key:0,class:k(`${e.prefixCls}__normal-icon`)},null,8,["class"]))],2),[[se,!e.isEdit]]),e.isEdit?(m(),x(f,{key:0,spinning:e.spinning},{default:R((()=>[re((m(),h("div",{class:k(`${e.prefixCls}__wrapper`)},[u(s,ue(e.getComponentProps,{component:e.getComponent,style:e.getWrapperStyle,popoverVisible:e.getRuleVisible,rule:e.getRule,ruleMessage:e.ruleMessage,class:e.getWrapperClass,ref:"elRef",onChange:e.handleChange,onOptionsChange:e.handleOptionsChange,onPressEnter:e.handleEnter}),null,16,["component","style","popoverVisible","rule","ruleMessage","class","onChange","onOptionsChange","onPressEnter"]),e.getRowEditable?O("",!0):(m(),h("div",{key:0,class:k(`${e.prefixCls}__action`)},[u(c,{class:k([`${e.prefixCls}__icon`,"mx-2"]),onClick:e.handleSubmitClick},null,8,["class","onClick"]),u(d,{class:k(`${e.prefixCls}__icon `),onClick:e.handleCancel},null,8,["class","onClick"])],2))],2)),[[p,e.onClickOutside]])])),_:1},8,["spinning"])):O("",!0)],2)}]]);function Gt(e,t){const{key:n,dataIndex:l,children:o}=e;e.align=e.align||et,t&&(n||(e.key=l),_(e.ellipsis)||Object.assign(e,{ellipsis:t})),o&&o.length&&Jt(o,!!t)}function Jt(e,t){e&&e.forEach((e=>{const{children:n}=e;Gt(e,t),Jt(n,t)}))}function Qt(e,t){const n=I(K(e).columns);let l=K(e).columns;const o=w((()=>{const l=de(K(n));if(function(e,t,n){const{t:l}=T(),{showIndexColumn:o,indexColumnProps:a,isTreeTable:i}=K(e);let s=!1;if(K(i))return;if(n.forEach((()=>{const e=n.findIndex((e=>e.flag===tt));o?s=-1===e:o||-1===e||n.splice(e,1)})),!s)return;const c=n.some((e=>"left"===e.fixed));n.unshift(r(r({flag:tt,width:50,title:l("component.table.index"),align:"center",customRender:({index:e})=>{const n=K(t);if(_(n))return`${e+1}`;const{current:l=1,pageSize:o=Je}=n;return((l<1?1:l)-1)*o+e+1}},c?{fixed:"left"}:{}),a))}(e,t,l),function(e,t){const{actionColumn:n,showActionColumn:l}=K(e);if(!n||!l)return;const o=t.findIndex((e=>e.flag===nt));-1===o&&t.push(s(r(r({},t[o]),n),{flag:nt}))}(e,l),!l)return[];const{ellipsis:o}=K(e);return l.forEach((e=>{const{customRender:t,slots:n}=e;Gt(e,Reflect.has(e,"ellipsis")?!!e.ellipsis:!!o&&!t&&!n)})),l}));const{hasPermission:a}=fe(),i=w((()=>{const e=Xt(K(o));return de(e).filter((e=>a(e.auth)&&function(e){const t=e.ifShow;let n=!0;return _(t)&&(n=t),ee(t)&&(n=t(e)),n}(e))).map((e=>{const{slots:t,customRender:n,format:l,edit:o,editRow:a,flag:i,title:r}=e;t&&(null==t?void 0:t.title)||(e.customTitle=e.title,Reflect.deleteProperty(e,"title")),e.children&&(e.title=r);const s=[tt,nt].includes(i);return n||!l||o||s||(e.customRender=({text:e,record:t,index:n})=>function(e,t,n,l){if(!t)return e;if(ee(t))return t(e,n,l);try{const n="date|";if(Y(t)&&t.startsWith(n)){const l=t.replace(n,"");return l?ge(e,l):e}if(me(t))return t.get(e)}catch(o){return e}}(e,l,t,n)),!o&&!a||s||(e.customRender=function(e){return({text:t,record:n,index:l})=>(n.onValid=()=>c(this,null,(function*(){if(Q(null==n?void 0:n.validCbs)){const e=((null==n?void 0:n.validCbs)||[]).map((e=>e()));return(yield Promise.all(e)).every((e=>!!e))}return!1})),n.onEdit=(e,t=!1)=>c(this,null,(function*(){var l,o;return t||(n.editable=e),!e&&t?!!(yield n.onValid())&&(!!(yield null==(l=n.onSubmitEdit)?void 0:l.call(n))&&(n.editable=!1,!0)):(e||t||null==(o=n.onCancelEdit)||o.call(n),!0)})),z(Ut,{value:t,record:n,column:e,index:l}))}(e)),pe(e)}))}));return F((()=>K(e).columns),(e=>{var t;n.value=e,l=null!=(t=null==e?void 0:e.filter((e=>!e.flag)))?t:[]})),{getColumnsRef:o,getCacheColumns:function(){return l},getColumns:function(e){const{ignoreIndex:t,ignoreAction:n,sort:l}=e||{};let a=te(K(o));return t&&(a=a.filter((e=>e.flag!==tt))),n&&(a=a.filter((e=>e.flag!==nt))),l&&(a=Xt(a)),a},setColumns:function(e){const t=de(e);if(!Q(t))return;if(t.length<=0)return void(n.value=[]);const o=t[0],a=l.map((e=>e.dataIndex));if(Y(o)||Q(o)){const e=t.map((e=>e.toString())),o=[];l.forEach((t=>{var n;o.push(s(r({},t),{defaultHidden:!e.includes((null==(n=t.dataIndex)?void 0:n.toString())||t.key)}))})),he(a,t)||o.sort(((t,n)=>{var l,o;return e.indexOf(null==(l=t.dataIndex)?void 0:l.toString())-e.indexOf(null==(o=n.dataIndex)?void 0:o.toString())})),n.value=o}else n.value=t},getViewColumns:i,setCacheColumnsByField:function(e,t){e&&t&&l.forEach((n=>{n.dataIndex!==e||Object.assign(n,t)}))}}}function Xt(e){const t=[],n=[],l=[];for(const o of e)"left"!==o.fixed?"right"!==o.fixed?l.push(o):n.push(o):t.push(o);return[...t,...l,...n].filter((e=>!e.defaultHidden))}function Yt(e,{getPaginationInfo:t,setPagination:n,setLoading:l,validate:o,clearSelectedRowKeys:a,tableData:i},s){const u=pe({sortInfo:{},filterInfo:{}}),d=I([]),f=I({});function p(e){e&&Array.isArray(e)&&e.forEach((e=>{e[lt]||(e[lt]=be()),e.children&&e.children.length&&p(e.children)}))}J((()=>{i.value=K(d)})),F((()=>K(e).dataSource),(()=>{const{dataSource:t,api:n}=K(e);!n&&t&&(d.value=t)}),{immediate:!0});const g=w((()=>K(e).autoCreateKey&&!K(e).rowKey)),m=w((()=>{const{rowKey:t}=K(e);return K(g)?lt:t})),h=w((()=>{const e=K(d);if(!e||0===e.length)return K(d);if(K(g)){const t=e[0],n=e[e.length-1];if(t&&n&&(!t[lt]||!n[lt])){const e=de(K(d));e.forEach((e=>{e[lt]||(e[lt]=be()),e.children&&e.children.length&&p(e.children)})),d.value=e}}return K(d)}));function b(t){if(!d.value||0==d.value.length)return;const n=K(m);if(!n)return;const{childrenColumnName:l="children"}=K(e);return(e=>{let o;return e.some((function e(a){if("function"==typeof n){if(n(a)===t)return o=a,!0}else if(Reflect.has(a,n)&&a[n]===t)return o=a,!0;return a[l]&&a[l].some(e)})),o})(d.value)}function v(a){return c(this,null,(function*(){var i,c,p;const{api:g,searchInfo:m,defSort:h,fetchSetting:b,beforeFetch:y,afterFetch:C,useSearchForm:S,pagination:w}=K(e);if(g&&ee(g))try{l(!0);const{pageField:e,sizeField:x,listField:R,totalField:k}=Object.assign({},ot,b);let O={};const{current:P=1,pageSize:T=Je}=K(t);_(w)&&!w||_(t)?O={}:(O[e]=a&&a.page||P,O[x]=T);const{sortInfo:I={},filterInfo:F}=u;let D=r(r(r(r(r(r(r(r(r({},O),S?yield o():{}),m),h),null!=(i=null==a?void 0:a.searchInfo)?i:{}),I),F),null!=(c=null==a?void 0:a.sortInfo)?c:{}),null!=(p=null==a?void 0:a.filterInfo)?p:{});y&&ee(y)&&(D=(yield y(D))||D);const A=yield g(D);f.value=A;const j=Array.isArray(A);let L=j?A:Ce(A,R);const M=j?0:Ce(A,k);if(M){const e=Math.ceil(Number(M)/T);if(P>e)return n({current:e}),yield v(a)}return C&&ee(C)&&(L=(yield C(L))||L),d.value=L,n({total:Number(M)||0}),a&&a.page&&n({current:a.page||1}),s("fetch-success",{items:K(L),total:Number(M)}),L}catch(x){s("fetch-error",x),d.value=[],n({total:0})}finally{l(!1)}}))}return ve((()=>{ye((()=>{K(e).immediate&&v()}),16)})),{getDataSourceRef:h,getDataSource:function(){return h.value},getRawDataSource:function(){return f.value},getRowKey:m,setTableData:function(e){d.value=e},getAutoCreateKey:g,fetch:v,reload:function(e){return c(this,null,(function*(){return yield v(e)}))},updateTableData:function(e,t,n){return c(this,null,(function*(){return d.value[e]&&(d.value[e][t]=n),d.value[e]}))},updateTableDataRecord:function(e,t){const n=b(e);if(n){for(const e in n)Reflect.has(t,e)&&(n[e]=t[e]);return n}},deleteTableDataRecord:function(t){var l,o,a;if(!d.value||0==d.value.length)return;const i=K(m);if(!i)return;const r=Array.isArray(t)?t:[t];for(const n of r){let t=d.value.findIndex((e=>{let t;return t="function"==typeof i?i(e):i,e[t]===n}));t>=0&&d.value.splice(t,1),t=null==(l=K(e).dataSource)?void 0:l.findIndex((e=>{let t;return t="function"==typeof i?i(e):i,e[t]===n})),void 0!==t&&-1!==t&&(null==(o=K(e).dataSource)||o.splice(t,1))}n({total:null==(a=K(e).dataSource)?void 0:a.length})},insertTableDataRecord:function(e,t){var n;return t=null!=t?t:null==(n=d.value)?void 0:n.length,K(d).splice(t,0,e),K(d)},findTableDataRecord:b,handleTableChange:function(t,l,o){const{clearSelectOnPageChange:i,sortFn:r,filterFn:s}=K(e);i&&a(),n(t);const c={};if(o&&ee(r)){const e=r(o);u.sortInfo=e,c.sortInfo=e}if(l&&ee(s)){const e=s(l);u.filterInfo=e,c.filterInfo=e}v(c)}}}function Zt(e,t,n,l,o){const a=I(null),i=pt(),s=we(d,100),u=w((()=>{const{canResize:t,scroll:n}=K(e);return t&&!(n||{}).y}));function d(){X((()=>{m()}))}let f,p,g;function m(){return c(this,null,(function*(){var n,l;const{resizeHeightOffset:r,pagination:s,maxHeight:c,minHeight:d}=K(e),m=K(o),h=K(t);if(!h)return;const b=h.$el;if(!b)return;if(!g&&(g=b.querySelector(".ant-table-body"),!g))return;const v=g.scrollHeight>g.clientHeight,y=g.scrollWidth>g.clientWidth;if(v?b.classList.contains("hide-scrollbar-y")&&b.classList.remove("hide-scrollbar-y"):!b.classList.contains("hide-scrollbar-y")&&b.classList.add("hide-scrollbar-y"),y?b.classList.contains("hide-scrollbar-x")&&b.classList.remove("hide-scrollbar-x"):!b.classList.contains("hide-scrollbar-x")&&b.classList.add("hide-scrollbar-x"),g.style.height="unset",!K(u)||0===m.length)return;yield X();const C=b.querySelector(".ant-table-thead ");if(!C)return;const{bottomIncludeBody:S}=xe(C);let w=2;if(_(s))w=-8;else if(f=b.querySelector(".ant-pagination"),f){w+=f.offsetHeight||0}else w+=24;let x=0;if(!_(s))if(p){x+=p.offsetHeight||0}else p=b.querySelector(".ant-table-footer");let R=0;C&&(R=C.offsetHeight);let k=S-(r||0)-32-w-x-R;k=null!=(n=k<d?d:k)?n:k,k=null!=(l=k>c?c:k)?l:k,function(e){var t;a.value=e,null==(t=null==i?void 0:i.redoModalHeight)||t.call(i)}(k),g.style.height=`${k}px`}))}F((()=>{var e;return[K(u),null==(e=K(o))?void 0:e.length]}),(()=>{s()}),{flush:"post"}),dt(m,280),ft((()=>{m(),X((()=>{s()}))}));const h=w((()=>{var e,o;let a=0;K(l)&&(a+=60);const i=K(n).filter((e=>!e.defaultHidden));i.forEach((e=>{a+=Number.parseInt(e.width)||0}));const r=i.filter((e=>!Reflect.has(e,"width"))).length;0!==r&&(a+=150*r);const s=K(t);return(null!=(o=null==(e=null==s?void 0:s.$el)?void 0:e.offsetWidth)?o:0)>a?"100%":a}));return{getScrollRef:w((()=>{const t=K(a),{canResize:n,scroll:l}=K(e);return r({x:K(h),y:n?t:null,scrollToFirstRowOnChange:!1},l)})),redoHeight:d}}function en(e,{setSelectedRowKeys:t,getSelectRowKeys:n,getAutoCreateKey:l,clearSelectedRowKeys:o,emit:a}){return{customRow:(i,r)=>({onClick:s=>{null==s||s.stopPropagation(),function(){var a;const{rowSelection:r,rowKey:c,clickToRowSelect:u}=K(e);if(!r||!u)return;const d=n(),f=function(e,t,n){return!t||n?e[lt]:Y(t)?e[t]:ee(t)?e[t(e)]:null}(i,c,K(l));if(!f)return;if("checkbox"===r.type){const e=null==(a=s.composedPath)?void 0:a.call(s).find((e=>"TR"===e.tagName));if(!e)return;const n=e.querySelector("input[type=checkbox]");if(!n||n.hasAttribute("disabled"))return;if(!d.includes(f))return void t([...d,f]);const l=d.findIndex((e=>e===f));return d.splice(l,1),void t(d)}if("radio"===r.type){if(!d.includes(f))return d.length&&o(),void t([f]);o()}}(),a("row-click",i,r,s)},onDblclick:e=>{a("row-dbClick",i,r,e)},onContextmenu:e=>{a("row-contextmenu",i,r,e)},onMouseenter:e=>{a("row-mouseenter",i,r,e)},onMouseleave:e=>{a("row-mouseleave",i,r,e)}})}}function tn(e,t,n){let l=!1;const o=Ze(),a=Re(),{createMessage:i}=Oe(),r=w((()=>{var e;let{fullPath:t}=ke.currentRoute.value,n=t.replace(/[\/\\]/g,"_"),l=null==(e=o.getBindValues.value.tableSetting)?void 0:e.cacheKey;return l&&(n+=":"+l),"columnCache:"+n}));J((()=>{o.getColumns().length&&function(){c(this,null,(function*(){if(l)return;l=!0;let i=a.get(r.value);if(i&&i.checkedList){const{checkedList:l,sortedList:a,sortableOrder:r,checkIndex:s}=i;yield X(),e.sortableOrder.value=r,e.state.checkedList=l,e.plainSortOptions.value.sort(((e,t)=>a.indexOf(e.value)-a.indexOf(t.value))),l.sort(((e,t)=>a.indexOf(e)-a.indexOf(t))),s&&o.setProps({showIndexColumn:!0}),t(l),function(t){c(this,null,(function*(){const{fixedColumns:l}=t,o=e.plainOptions.value;for(const e of o){let t=l.find((t=>t.key===(e.key||e.dataIndex)));t&&(yield X(),n(e,t.fixed))}}))}(i)}}))}()}));const s=/^(true|left|right)$/;function u(){var t;let n=[];const l=e.plainOptions.value;for(const e of l)s.test((null!=(t=e.fixed)?t:"").toString())&&n.push({key:e.key||e.dataIndex,fixed:!0===e.fixed?"left":e.fixed});return n}return{saveSetting:function(){const{checkedList:t}=e.state,n=K(e.plainSortOptions).map((e=>e.value));a.set(r.value,{checkedList:t,sortedList:n,checkIndex:K(e.checkIndex),sortableOrder:K(e.sortableOrder),fixedColumns:u()}),i.success("保存成功"),e.popoverVisible.value=!1},resetSetting:function(){return c(this,null,(function*(){yield function(){return c(this,null,(function*(){var t;const l=e.plainOptions.value;for(const e of l)e.fixed,s.test((null!=(t=e.fixed)?t:"").toString())&&(yield X(),n(e,null))}))}(),a.remove(r.value),i.success("重置成功")}))}}}const nn=f({name:"ColumnSetting",props:{isMobile:Boolean},components:{SettingOutlined:Lt,Popover:V,Tooltip:Pe,Checkbox:H,CheckboxGroup:H.Group,DragOutlined:Ot,ScrollContainer:Te,Divider:Ie,Icon:Fe},emits:["columns-change"],setup(e,{emit:t,attrs:n}){const{t:l}=T(),o=Ze(),a=I(!0);X((()=>a.value=!1));const i=ae(o.getRowSelection(),"selectedRowKeys");let c=!1;const u=I([]),d=I([]),f=I([]),p=I(null),g=pe({checkAll:!0,checkedList:[],defaultCheckList:[]}),m=I(!1),h=I(!1),{prefixCls:b}=S("basic-column-setting"),v=w((()=>K(null==o?void 0:o.getBindValues)||{})),y=w((()=>{let t={};return e.isMobile&&(t.visible=!1),t}));let C;const x=I(),{saveSetting:R,resetSetting:k}=tn({state:g,popoverVisible:a,plainOptions:d,plainSortOptions:f,sortableOrder:x,checkIndex:m},_,F);function O(){const e=[];return o.getColumns({ignoreIndex:!0,ignoreAction:!0}).forEach((t=>{e.push(r({label:t.title||t.customTitle,value:t.dataIndex||t.title},t))})),e}J((()=>{setTimeout((()=>{o.getColumns().length&&!g.isInit&&function(){const e=O(),t=o.getColumns({ignoreAction:!0}).map((e=>e.defaultHidden?"":e.dataIndex||e.title)).filter(Boolean);d.value.length?K(d).forEach((t=>{const n=e.find((e=>e.dataIndex===t.dataIndex));n&&(t.fixed=n.fixed)})):(d.value=e,f.value=e,u.value=e,g.defaultCheckList=t);g.isInit=!0,g.checkedList=t}()}),0)})),J((()=>{const e=K(v);m.value=!!e.showIndexColumn,h.value=!!e.rowSelection}));const P=w((()=>{const e=d.value.length;let t=g.checkedList.length;return K(m)&&t--,t>0&&t<e}));function F(e,t){var n;if(!g.checkedList.includes(e.dataIndex))return;const l=O(),a=e.fixed!==t&&t,i=l.findIndex((t=>t.dataIndex===e.dataIndex));-1!==i&&(l[i].fixed=a),e.fixed=a,a&&!e.width&&(e.width=100),null==(n=o.setCacheColumnsByField)||n.call(o,e.dataIndex,{fixed:a}),_(l)}function _(e){o.setColumns(e);const n=K(f).map((t=>{const n=-1!==e.findIndex((e=>e===t.value||"string"!=typeof e&&e.dataIndex===t.value));return{dataIndex:t.value,fixed:t.fixed,visible:n}}));t("columns-change",n)}return s(r({getBindProps:y,t:l},_e(g)),{popoverVisible:a,indeterminate:P,onCheckAllChange:function(e){const t=d.value.map((e=>e.value));e.target.checked?(g.checkedList=t,_(t)):(g.checkedList=[],_([]))},onChange:function(e){const t=f.value.length;g.checkAll=e.length===t;const n=K(f).map((e=>e.value));e.sort(((e,t)=>n.indexOf(e)-n.indexOf(t))),_(e)},plainOptions:d,reset:function(){g.checkedList=[...g.defaultCheckList],g.checkAll=!0,d.value=K(u),f.value=K(u),_(o.getCacheColumns()),x.value&&C.sort(x.value),k()},saveSetting:R,prefixCls:b,columnListRef:p,handleVisibleChange:function(){c||X((()=>{const e=K(p);if(!e)return;const t=e.$el;t&&(C=Ke.create(K(t),{animation:500,delay:400,delayOnTouchOnly:!0,handle:".table-column-drag-icon ",onEnd:e=>{const{oldIndex:t,newIndex:n}=e;if(De(t)||De(n)||t===n)return;const l=de(f.value);t>n?(l.splice(n,0,l[t]),l.splice(t+1,1)):(l.splice(n+1,0,l[t]),l.splice(t,1)),f.value=l,_(l)}}),x.value||(x.value=C.toArray()),c=!0)}))},checkIndex:m,checkSelect:h,handleIndexCheckChange:function(e){o.setProps({showIndexColumn:e.target.checked})},handleSelectCheckChange:function(e){o.setProps({rowSelection:e.target.checked?i:void 0})},defaultRowSelection:i,handleColumnFixed:F,getPopupContainer:function(){return ee(n.getPopupContainer)?n.getPopupContainer():Ae()}})}}),ln=v(" 保存 ");var on=p(nn,[["render",function(e,t,n,l,o,a){const i=g("Checkbox"),r=g("DragOutlined"),s=g("Icon"),c=g("Tooltip"),d=g("Divider"),f=g("CheckboxGroup"),p=g("ScrollContainer"),b=g("a-button"),C=g("SettingOutlined"),S=g("Popover");return m(),x(c,ue({placement:"top"},e.getBindProps),{title:R((()=>[ce("span",null,y(e.t("component.table.settingColumn")),1)])),default:R((()=>[u(S,{visible:e.popoverVisible,"onUpdate:visible":t[3]||(t[3]=t=>e.popoverVisible=t),placement:"bottomLeft",trigger:"click",onVisibleChange:e.handleVisibleChange,overlayClassName:`${e.prefixCls}__cloumn-list`,getPopupContainer:e.getPopupContainer},{title:R((()=>[ce("div",{class:k(`${e.prefixCls}__popover-title`)},[u(i,{indeterminate:e.indeterminate,checked:e.checkAll,"onUpdate:checked":t[0]||(t[0]=t=>e.checkAll=t),onChange:e.onCheckAllChange},{default:R((()=>[v(y(e.t("component.table.settingColumnShow")),1)])),_:1},8,["indeterminate","checked","onChange"]),u(i,{checked:e.checkIndex,"onUpdate:checked":t[1]||(t[1]=t=>e.checkIndex=t),onChange:e.handleIndexCheckChange},{default:R((()=>[v(y(e.t("component.table.settingIndexColumnShow")),1)])),_:1},8,["checked","onChange"])],2)])),content:R((()=>[u(p,null,{default:R((()=>[u(f,{value:e.checkedList,"onUpdate:value":t[2]||(t[2]=t=>e.checkedList=t),onChange:e.onChange,ref:"columnListRef"},{default:R((()=>[(m(!0),h(P,null,je(e.plainOptions,(t=>(m(),h(P,{key:t.value},[!("ifShow"in t)||t.ifShow?(m(),h("div",{key:0,class:k(`${e.prefixCls}__check-item`)},[u(r,{class:"table-column-drag-icon"}),u(i,{value:t.value},{default:R((()=>[v(y(t.label),1)])),_:2},1032,["value"]),u(c,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:R((()=>[v(y(e.t("component.table.settingFixedLeft")),1)])),default:R((()=>[u(s,{icon:"line-md:arrow-align-left",class:k([`${e.prefixCls}__fixed-left`,{active:"left"===t.fixed,disabled:!e.checkedList.includes(t.value)}]),onClick:n=>e.handleColumnFixed(t,"left")},null,8,["class","onClick"])])),_:2},1032,["mouseLeaveDelay","getPopupContainer"]),u(d,{type:"vertical"}),u(c,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:R((()=>[v(y(e.t("component.table.settingFixedRight")),1)])),default:R((()=>[u(s,{icon:"line-md:arrow-align-left",class:k([`${e.prefixCls}__fixed-right`,{active:"right"===t.fixed,disabled:!e.checkedList.includes(t.value)}]),onClick:n=>e.handleColumnFixed(t,"right")},null,8,["class","onClick"])])),_:2},1032,["mouseLeaveDelay","getPopupContainer"])],2)):O("",!0)],64)))),128))])),_:1},8,["value","onChange"])])),_:1}),ce("div",{class:k(`${e.prefixCls}__popover-footer`)},[u(b,{size:"small",onClick:e.reset},{default:R((()=>[v(y(e.t("common.resetText")),1)])),_:1},8,["onClick"]),u(b,{size:"small",type:"primary",onClick:e.saveSetting},{default:R((()=>[ln])),_:1},8,["onClick"])],2)])),default:R((()=>[u(C)])),_:1},8,["visible","onVisibleChange","overlayClassName","getPopupContainer"])])),_:1},16)}]]);var an=p(f({name:"SizeSetting",props:{isMobile:Boolean},components:{ColumnHeightOutlined:St,Tooltip:Pe,Dropdown:Le,Menu:Me,MenuItem:Me.Item},setup(e){const t=Ze(),{t:n}=T(),l=I([t.getSize()]);return{getBindProps:w((()=>{let t={};return e.isMobile&&(t.visible=!1),t})),handleTitleClick:function({key:e}){l.value=[e],t.setProps({size:e})},selectedKeysRef:l,getPopupContainer:Ae,t:n}}}),[["render",function(e,t,n,l,o,a){const i=g("ColumnHeightOutlined"),r=g("MenuItem"),s=g("Menu"),c=g("Dropdown"),d=g("Tooltip");return m(),x(d,ue({placement:"top"},e.getBindProps),{title:R((()=>[ce("span",null,y(e.t("component.table.settingDens")),1)])),default:R((()=>[u(c,{placement:"bottom",trigger:["click"],getPopupContainer:e.getPopupContainer},{overlay:R((()=>[u(s,{onClick:e.handleTitleClick,selectable:"",selectedKeys:e.selectedKeysRef,"onUpdate:selectedKeys":t[0]||(t[0]=t=>e.selectedKeysRef=t)},{default:R((()=>[u(r,{key:"default"},{default:R((()=>[ce("span",null,y(e.t("component.table.settingDensDefault")),1)])),_:1}),u(r,{key:"middle"},{default:R((()=>[ce("span",null,y(e.t("component.table.settingDensMiddle")),1)])),_:1}),u(r,{key:"small"},{default:R((()=>[ce("span",null,y(e.t("component.table.settingDensSmall")),1)])),_:1})])),_:1},8,["onClick","selectedKeys"])])),default:R((()=>[u(i)])),_:1},8,["getPopupContainer"])])),_:1},16)}]]);var rn=p(f({name:"RedoSetting",props:{isMobile:Boolean},components:{RedoOutlined:ht,Tooltip:Pe},setup(e){const t=Ze(),{t:n}=T();return{getBindProps:w((()=>{let t={};return e.isMobile&&(t.visible=!1),t})),redo:function(){t.reload(),t.emit("table-redo")},t:n}}}),[["render",function(e,t,n,l,o,a){const i=g("RedoOutlined"),r=g("Tooltip");return m(),x(r,ue({placement:"top"},e.getBindProps),{title:R((()=>[ce("span",null,y(e.t("common.redo")),1)])),default:R((()=>[u(i,{onClick:e.redo},null,8,["onClick"])])),_:1},16)}]]);const sn=f({name:"FullScreenSetting",props:{isMobile:Boolean},components:{FullscreenExitOutlined:gt,FullscreenOutlined:mt,Tooltip:Pe},setup(e){const t=Ze(),{t:n}=T(),{toggle:l,isFullscreen:o}=Ee(t.wrapRef);return{getBindProps:w((()=>{let t={};return e.isMobile&&(t.visible=!1),t})),toggle:l,isFullscreen:o,t:n}}});const cn=f({name:"TableSetting",components:{ColumnSetting:on,SizeSetting:an,RedoSetting:rn,FullScreenSetting:p(sn,[["render",function(e,t,n,l,o,a){const i=g("FullscreenOutlined"),r=g("FullscreenExitOutlined"),s=g("Tooltip");return m(),x(s,ue({placement:"top"},e.getBindProps),{title:R((()=>[ce("span",null,y(e.t("component.table.settingFullScreen")),1)])),default:R((()=>[e.isFullscreen?(m(),x(r,{key:1,onClick:e.toggle},null,8,["onClick"])):(m(),x(i,{key:0,onClick:e.toggle},null,8,["onClick"]))])),_:1},16)}]])},props:{setting:{type:Object,default:()=>({})},mode:String},emits:["columns-change"],setup(e,{emit:t}){const{t:n}=T(),l=Ze();return{getSetting:w((()=>r({redo:!0,size:!0,setting:!0,fullScreen:!1},e.setting))),t:n,handleColumnChange:function(e){t("columns-change",e)},getTableContainer:function(){return l?K(l.wrapRef):document.body},isMobile:w((()=>"mobile"===e.mode))}}}),un={class:"table-settings"};var dn=p(cn,[["render",function(e,t,n,l,o,a){const i=g("RedoSetting"),r=g("SizeSetting"),s=g("ColumnSetting"),c=g("FullScreenSetting");return m(),h("div",un,[e.getSetting.redo?(m(),x(i,{key:0,isMobile:e.isMobile,getPopupContainer:e.getTableContainer},null,8,["isMobile","getPopupContainer"])):O("",!0),e.getSetting.size?(m(),x(r,{key:1,isMobile:e.isMobile,getPopupContainer:e.getTableContainer},null,8,["isMobile","getPopupContainer"])):O("",!0),e.getSetting.setting?(m(),x(s,{key:2,isMobile:e.isMobile,onColumnsChange:e.handleColumnChange,getPopupContainer:e.getTableContainer},null,8,["isMobile","onColumnsChange","getPopupContainer"])):O("",!0),e.getSetting.fullScreen?(m(),x(c,{key:3,isMobile:e.isMobile,getPopupContainer:e.getTableContainer},null,8,["isMobile","getPopupContainer"])):O("",!0)])}]]);const fn=f({name:"BasicTableTitle",components:{BasicTitle:He},props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(e){const{prefixCls:t}=S("basic-table-title");return{getTitle:w((()=>{const{title:t,getSelectRows:n=(()=>{})}=e;let l=t;return ee(t)&&(l=t({selectRows:n()})),l})),prefixCls:t}}});const pn=f({name:"BasicTableHeader",components:{Divider:Ie,TableTitle:p(fn,[["render",function(e,t,n,l,o,a){const i=g("BasicTitle");return e.getTitle?(m(),x(i,{key:0,class:k(e.prefixCls),helpMessage:e.helpMessage},{default:R((()=>[v(y(e.getTitle),1)])),_:1},8,["class","helpMessage"])):O("",!0)}]]),TableSetting:dn},props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""}},emits:["columns-change"],setup(e,{emit:t}){const{prefixCls:n}=S("basic-table-header");const{getSelectRowKeys:l,setSelectedRowKeys:o,getRowSelection:a}=Ze(),i=w((()=>l())),r=w((()=>a())),s=w((()=>{var e;return!0===(null==(e=r.value)?void 0:e.preserveSelectedRowKeys)}));return{prefixCls:n,handleColumnChange:function(e){t("columns-change",e)},selectRowKeys:i,setSelectedRowKeys:o,openRowSelection:r,isAcrossPage:s}}}),gn={style:{width:"100%"}},mn={key:0,style:{margin:"5px"}},hn={style:{margin:"-4px 0 -2px","padding-top":"5px"}},bn={key:0},vn={key:1};var yn=p(pn,[["render",function(e,t,n,l,o,a){const i=g("TableTitle"),r=g("Divider"),s=g("TableSetting"),c=g("a-button"),d=g("a-popover"),f=g("a-divider"),p=g("a-alert");return m(),h("div",gn,[e.$slots.headerTop?(m(),h("div",mn,[b(e.$slots,"headerTop")])):O("",!0),ce("div",{class:k(`flex items-center ${e.prefixCls}__table-title-box`)},[ce("div",{class:k(`${e.prefixCls}__tableTitle`)},[e.$slots.tableTitle?b(e.$slots,"tableTitle",{key:0}):O("",!0),!e.$slots.tableTitle&&e.title?(m(),x(i,{key:1,helpMessage:e.titleHelpMessage,title:e.title},null,8,["helpMessage","title"])):O("",!0)],2),ce("div",{class:k(`${e.prefixCls}__toolbar`)},[b(e.$slots,"toolbar"),e.$slots.toolbar&&e.showTableSetting?(m(),x(r,{key:0,type:"vertical"})):O("",!0),e.showTableSetting?(m(),x(s,{key:1,class:k(`${e.prefixCls}__toolbar-desktop`),style:{"white-space":"nowrap"},setting:e.tableSetting,onColumnsChange:e.handleColumnChange},null,8,["class","setting","onColumnsChange"])):O("",!0),u(d,{overlayClassName:`${e.prefixCls}__toolbar-mobile`,trigger:"click",placement:"left",getPopupContainer:e=>e.parentElement},{content:R((()=>[e.showTableSetting?(m(),x(s,{key:0,mode:"mobile",setting:e.tableSetting,onColumnsChange:e.handleColumnChange},null,8,["setting","onColumnsChange"])):O("",!0)])),default:R((()=>[e.showTableSetting?(m(),x(c,{key:0,class:k(`${e.prefixCls}__toolbar-mobile`),type:"text",preIcon:"ant-design:menu",shape:"circle"},null,8,["class"])):O("",!0)])),_:1},8,["overlayClassName","getPopupContainer"])],2)],2),ce("div",hn,[b(e.$slots,"tableTop",{},(()=>[null!=e.openRowSelection?(m(),x(p,{key:0,type:"info","show-icon":"",class:"alert"},{message:R((()=>[e.selectRowKeys.length>0?(m(),h(P,{key:0},[ce("span",null,[ce("span",null,"已选中 "+y(e.selectRowKeys.length)+" 条记录",1),e.isAcrossPage?(m(),h("span",bn,"(可跨页)")):O("",!0)]),u(f,{type:"vertical"}),ce("a",{onClick:t[0]||(t[0]=t=>e.setSelectedRowKeys([]))},"清空"),b(e.$slots,"alertAfter")],64)):(m(),h("span",vn,"未选中任何数据"))])),_:3})):O("",!0)]))])])}]]);function Cn(e,t,n){const l=I([]),o=w((()=>K(e).autoCreateKey&&!K(e).rowKey)),a=w((()=>{const{rowKey:t}=K(e);return K(o)?lt:t}));function i(n){const l=[],{childrenColumnName:o}=K(e);return te(n||K(t)).forEach((e=>{l.push(e[K(a)]);const t=e[o||"children"];(null==t?void 0:t.length)&&l.push(...i(t))})),l}return{getExpandOption:w((()=>{const{isTreeTable:t}=K(e);return t?{expandedRowKeys:K(l),onExpandedRowsChange:e=>{l.value=e,n("expanded-rows-change",e)}}:{}})),expandAll:function(){const e=i();l.value=e},collapseAll:function(){l.value=[]}}}var Sn=p(f({name:"BasicTableFooter",components:{Table:$e},props:{summaryFunc:{type:Function},summaryData:{type:Array},scroll:{type:Object},rowKey:G.string.def("key")},setup(e){const t=Ze(),n=w((()=>{const{summaryFunc:n,summaryData:l}=e;if(null==l?void 0:l.length)return l.forEach(((t,n)=>t[e.rowKey]=`${n}`)),l;if(!ee(n))return[];let o=te(K(t.getDataSource()));return o=n(o),o.forEach(((t,n)=>{t[e.rowKey]=`${n}`})),o}));return{getColumns:w((()=>{const e=K(n),l=de(t.getColumns()),o=l.findIndex((e=>e.flag===tt)),a=e.some((e=>Reflect.has(e,"_row"))),i=e.some((e=>Reflect.has(e,"_index")));if(-1!==o&&(i?(l[o].customRender=({record:e})=>e._index,l[o].ellipsis=!1):Reflect.deleteProperty(l[o],"customRender")),t.getRowSelection()&&a){const e=l.some((e=>"left"===e.fixed));l.unshift(s(r({width:60,title:"selection",key:"selectionKey",align:"center"},e?{fixed:"left"}:{}),{customRender:({record:e})=>e._row}))}return l})),getDataSource:n}}}),[["render",function(e,t,n,l,o,a){const i=g("Table");return e.summaryFunc||e.summaryData?(m(),x(i,{key:0,showHeader:!1,bordered:!1,pagination:!1,dataSource:e.getDataSource,rowKey:t=>t[e.rowKey],columns:e.getColumns,tableLayout:"fixed",scroll:e.scroll},null,8,["dataSource","rowKey","columns","scroll"])):O("",!0)}]]);function wn(e,t,n,l){const o=w((()=>0===(K(l)||[]).length)),a=w((()=>{const{summaryFunc:n,showSummary:l,summaryData:a}=K(e);return l&&!K(o)?()=>z(Sn,{summaryFunc:n,summaryData:a,scroll:K(t)}):void 0}));return J((()=>{!function(){const{showSummary:t}=K(e);if(!t||K(o))return;X((()=>{const e=K(n);if(!e)return;const t=e.$el.querySelector(".ant-table-content");ze({el:t,name:"scroll",listener:()=>{const n=e.$el.querySelector(".ant-table-footer .ant-table-content");n&&t&&(n.scrollLeft=t.scrollLeft)},wait:0,options:!0})}))}()})),{getFooterProps:a}}var xn=p(f({components:{Table:$e,BasicForm:Ge,HeaderCell:Bt},props:{clickToRowSelect:G.bool.def(!0),isTreeTable:G.bool.def(!1),tableSetting:G.shape({}),inset:G.bool,sortFn:{type:Function,default:at},filterFn:{type:Function,default:it},showTableSetting:G.bool,autoCreateKey:G.bool.def(!0),striped:G.bool.def(!1),showSummary:G.bool,summaryFunc:{type:[Function,Array],default:null},summaryData:{type:Array,default:null},indentSize:G.number.def(24),canColDrag:G.bool.def(!0),api:{type:Function,default:null},beforeFetch:{type:Function,default:null},afterFetch:{type:Function,default:null},handleSearchInfoFn:{type:Function,default:null},fetchSetting:{type:Object,default:()=>ot},immediate:G.bool.def(!0),emptyDataIsShowTable:G.bool.def(!0),searchInfo:{type:Object,default:null},defSort:{type:Object,default:null},useSearchForm:G.bool,formConfig:{type:Object,default:null},columns:{type:[Array],default:()=>[]},showIndexColumn:G.bool.def(!0),indexColumnProps:{type:Object,default:null},showActionColumn:{type:Boolean,default:!0},actionColumn:{type:Object,default:null},ellipsis:G.bool.def(!0),canResize:G.bool.def(!0),clearSelectOnPageChange:G.bool,resizeHeightOffset:G.number.def(0),rowSelection:{type:Object,default:null},title:{type:[String,Function],default:null},titleHelpMessage:{type:[String,Array]},minHeight:G.number,maxHeight:G.number,dataSource:{type:Array,default:null},rowKey:{type:[String,Function],default:""},bordered:G.bool,pagination:{type:[Object,Boolean],default:null},loading:G.bool,rowClassName:{type:Function},scroll:{type:Object,default:null},beforeEditSubmit:{type:Function},size:{type:String,default:rt}},emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change","table-redo"],setup(e,{attrs:t,emit:n,slots:l,expose:o}){const a=I(null),i=I([]),u=I(null),d=I(),{prefixCls:f}=S("basic-table"),[p,g]=ct(),m=w((()=>r(r({},e),K(d)))),h=Ve(ut,!1);J((()=>{K(h)&&e.canResize&&Ue("'canResize' of BasicTable may not work in PageWrapper with 'fixedHeight' (especially in hot updates)")}));const{getLoading:b,setLoading:v}=function(e){const t=I(K(e).loading);return F((()=>K(e).loading),(e=>{t.value=e})),{getLoading:w((()=>K(t))),setLoading:function(e){t.value=e}}}(m),{getPaginationInfo:y,getPagination:C,setPagination:x,setShowPagination:R,getShowPagination:k}=function(e){const{t:t}=T(),n=I({}),l=I(!0);F((()=>K(e).pagination),(e=>{!_(e)&&e&&(n.value=r(r({},K(n)),null!=e?e:{}))}));const o=w((()=>{const{pagination:o}=K(e);return!(!K(l)||_(o)&&!o)&&r(r({current:1,pageSize:Je,size:"small",defaultPageSize:Je,showTotal:e=>t("component.table.total",{total:e}),showSizeChanger:!0,pageSizeOptions:Qe,itemRender:$t,showQuickJumper:!0},_(o)?{}:o),K(n))}));return{getPagination:function(){return K(o)},getPaginationInfo:o,setShowPagination:function(e){return c(this,null,(function*(){l.value=e}))},getShowPagination:function(){return K(l)},setPagination:function(e){const t=K(o);n.value=r(r({},_(t)?{}:t),e)}}}(m),{getRowSelection:O,getRowSelectionRef:P,getSelectRows:D,clearSelectedRowKeys:A,getSelectRowKeys:j,deleteSelectRowByKey:L,setSelectedRowKeys:M}=function(e,t,n){const l=I([]),o=I([]),a=w((()=>{const{rowSelection:t}=K(e);return t?r({preserveSelectedRowKeys:!0,selectedRowKeys:K(l),onChange:e=>{c(e)}},ae(t,["onChange"])):null}));F((()=>{var t;return null==(t=K(e).rowSelection)?void 0:t.selectedRowKeys}),(e=>{c(e)})),F((()=>K(l)),(()=>{X((()=>{const{rowSelection:t}=K(e);if(t){const{onChange:e}=t;e&&ee(e)&&e(u(),d())}n("selection-change",{keys:u(),rows:d()})}))}),{deep:!0});const i=w((()=>K(e).autoCreateKey&&!K(e).rowKey)),s=w((()=>{const{rowKey:t}=K(e);return K(i)?lt:t}));function c(n){var a;l.value=n;const i=Se(te(K(t)).concat(te(K(o))),(e=>n.includes(e[K(s)])),{children:null!=(a=e.value.childrenColumnName)?a:"children"}),r=[];n.forEach((e=>{const t=i.find((t=>t[K(s)]===e));t&&r.push(t)})),o.value=r}function u(){return K(l)}function d(){return K(o)}return{getRowSelection:function(){return K(a)},getRowSelectionRef:a,getSelectRows:d,getSelectRowKeys:u,setSelectedRowKeys:c,clearSelectedRowKeys:function(){o.value=[],l.value=[]},deleteSelectRowByKey:function(e){const t=K(l).findIndex((t=>t===e));-1!==t&&K(l).splice(t,1)},setSelectedRows:function(e){o.value=e}}}(m,i,n),{handleTableChange:E,getDataSourceRef:H,getDataSource:B,getRawDataSource:$,setTableData:V,updateTableDataRecord:N,deleteTableDataRecord:W,insertTableDataRecord:q,findTableDataRecord:U,fetch:G,getRowKey:Q,reload:Z,getAutoCreateKey:ne,updateTableData:le}=Yt(m,{tableData:i,getPaginationInfo:y,setLoading:v,setPagination:x,validate:g.validate,clearSelectedRowKeys:A},n);const{getViewColumns:oe,getColumns:ie,setCacheColumnsByField:re,setColumns:se,getColumnsRef:ce,getCacheColumns:ue}=Qt(m,y),{getScrollRef:de,redoHeight:fe}=Zt(m,a,ce,P,H),{customRow:pe}=en(m,{setSelectedRowKeys:M,getSelectRowKeys:j,clearSelectedRowKeys:A,getAutoCreateKey:ne,emit:n}),{getRowClassName:ge}=function(e,t){return{getRowClassName:function(n,l){const{striped:o,rowClassName:a}=K(e),i=[];return o&&i.push((l||0)%2==1?`${t}-row__striped`:""),a&&ee(a)&&i.push(a(n,l)),i.filter((e=>!!e)).join(" ")}}}(m,f),{getExpandOption:me,expandAll:he,collapseAll:be}=Cn(m,i,n),ve={onColumnsChange:e=>{var t,l;n("columns-change",e),null==(l=(t=K(m)).onColumnsChange)||l.call(t,e)}},{getHeaderProps:ye}=function(e,t,n){return{getHeaderProps:w((()=>{const{title:l,showTableSetting:o,titleHelpMessage:a,tableSetting:i}=K(e),s=!(t.tableTitle||l||t.toolbar||o);return s&&!Y(l)?{}:{title:s?null:()=>z(yn,{title:l,titleHelpMessage:a,showTableSetting:o,tableSetting:i,onColumnsChange:n.onColumnsChange},r(r(r(r(r({},t.toolbar?{toolbar:()=>Be(t,"toolbar")}:{}),t.tableTitle?{tableTitle:()=>Be(t,"tableTitle")}:{}),t.headerTop?{headerTop:()=>Be(t,"headerTop")}:{}),t.tableTop?{tableTop:()=>Be(t,"tableTop")}:{}),t.alertAfter?{alertAfter:()=>Be(t,"alertAfter")}:{}))}}))}}(m,l,ve),{getFooterProps:Ce}=wn(m,de,a,H),{getFormProps:we,replaceFormSlotKey:xe,getFormSlotKeys:Re,handleSearchInfoChange:ke}=function(e,t,n,l){return{getFormProps:w((()=>{const{formConfig:t}=K(e),{submitButtonOptions:n}=t||{};return s(r({showAdvancedButton:!0},t),{submitButtonOptions:r({loading:K(l)},n),compact:!0,autoSubmitOnEnter:!0})})),replaceFormSlotKey:function(e){var t,n;return e&&null!=(n=null==(t=null==e?void 0:e.replace)?void 0:t.call(e,/form\-/,""))?n:""},getFormSlotKeys:w((()=>Object.keys(t).map((e=>e.startsWith("form-")?e:null)).filter((e=>!!e)))),handleSearchInfoChange:function(t){const{handleSearchInfoFn:l}=K(e);l&&ee(l)&&(t=l(t)||t),n({searchInfo:t,page:1})}}}(m,l,G,b),Oe=w((()=>{const e=K(H);let n=r(s(r(r(s(r({},t),{customRow:pe}),K(m)),K(ye)),{scroll:K(de),loading:K(b),tableLayout:"fixed",rowSelection:K(P),rowKey:K(Q),columns:te(K(oe)),pagination:te(K(y)),dataSource:e,footer:K(Ce)}),K(me));return l.expandedRowRender&&(n=ae(n,"scroll")),n=ae(n,["class","onChange"]),n})),Pe=w((()=>{const e=K(Oe);return[f,t.class,{[`${f}-form-container`]:e.useSearchForm,[`${f}--inset`]:e.inset}]})),Te=w((()=>{const{emptyDataIsShowTable:e,useSearchForm:t}=K(m);return!(!e&&t)||!!K(H).length}));const Ie={reload:Z,getSelectRows:D,clearSelectedRowKeys:A,getSelectRowKeys:j,deleteSelectRowByKey:L,setPagination:x,setTableData:V,updateTableDataRecord:N,deleteTableDataRecord:W,insertTableDataRecord:q,findTableDataRecord:U,redoHeight:fe,setSelectedRowKeys:M,setColumns:se,setLoading:v,getDataSource:B,getRawDataSource:$,setProps:function(e){d.value=r(r({},K(d)),e)},getRowSelection:O,getPaginationRef:C,getColumns:ie,getCacheColumns:ue,emit:n,updateTableData:le,setShowPagination:R,getShowPagination:k,setCacheColumnsByField:re,expandAll:he,collapseAll:be,getSize:()=>K(Oe).size};return st(s(r({},Ie),{wrapRef:u,getBindValues:Oe})),o(Ie),n("register",Ie,g),{tableElRef:a,getBindValues:Oe,getLoading:b,registerForm:p,handleSearchInfoChange:ke,getEmptyDataIsShowTable:Te,handleTableChange:function(...e){E.call(void 0,...e),n("change",...e);const{onChange:t}=K(m);t&&ee(t)&&t.call(void 0,...e)},getRowClassName:ge,wrapRef:u,tableAction:Ie,redoHeight:fe,handleResizeColumn:(e,t)=>{t.width=e},getFormProps:we,replaceFormSlotKey:xe,getFormSlotKeys:Re,getWrapperClass:Pe,columns:oe}}}),[["render",function(e,t,n,l,o,a){const i=g("BasicForm"),r=g("HeaderCell"),s=g("Table"),c=g("a-form-item-rest");return m(),h("div",{ref:"wrapRef",class:k(e.getWrapperClass)},[e.getBindValues.useSearchForm?(m(),x(i,ue({key:0,submitOnReset:""},e.getFormProps,{tableAction:e.tableAction,onRegister:e.registerForm,onSubmit:e.handleSearchInfoChange,onAdvancedChange:e.redoHeight}),Ne({_:2},[je(e.getFormSlotKeys,(t=>({name:e.replaceFormSlotKey(t),fn:R((n=>[b(e.$slots,t,We(qe(n||{})))]))})))]),1040,["tableAction","onRegister","onSubmit","onAdvancedChange"])):O("",!0),u(c,null,{default:R((()=>[re(u(s,ue({ref:"tableElRef"},e.getBindValues,{rowClassName:e.getRowClassName,onResizeColumn:e.handleResizeColumn,onChange:e.handleTableChange}),Ne({headerCell:R((({column:e})=>[u(r,{column:e},null,8,["column"])])),bodyCell:R((t=>[b(e.$slots,"bodyCell",We(qe(t||{})))])),_:2},[je(Object.keys(e.$slots),(t=>({name:t,fn:R((n=>[b(e.$slots,t,We(qe(n||{})))]))})))]),1040,["rowClassName","onResizeColumn","onChange"]),[[se,e.getEmptyDataIsShowTable]])])),_:3})],2)}]]),Rn=Object.freeze(Object.defineProperty({__proto__:null,default:xn},Symbol.toStringTag,{value:"Module"}));export{xn as B,_t as F,Rn as a};
