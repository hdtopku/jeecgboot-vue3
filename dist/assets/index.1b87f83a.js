import{q as e,l as t,bd as a,be as s,cc as o,cd as r,aN as n,n as l,d7 as c,dU as i,o as d,bI as u,F as p,t as m,v as f,x as g,y as h,z as w,V as x,W as _,aW as k,E as y,D as v,ax as D,s as b,a as I,a3 as S,ej as C,el as P,ek as j,u as M}from"./index.b3c93d64.js";import{S as U}from"./siteSetting.967dfbc9.js";import{useHeaderSetting as L}from"./useHeaderSetting.c2e42345.js";import"./index.ee0a0c33.js";import{h as R}from"./header.d801b988.js";import{r as A,q as E}from"./dict.api.8f662f2a.js";import"./BasicModal.2a8ad889.js";import"./useWindowSizeFn.e6386ae5.js";const{createMessage:O}=M(),$=t({name:"UserDropdown",components:{Dropdown:a,Menu:s,MenuItem:o((()=>r((()=>import("./DropMenuItem.6bd6992a.js")),["assets/DropMenuItem.6bd6992a.js","assets/index.b3c93d64.js","assets/index.8c83d65d.css"]))),MenuDivider:s.Divider,LockAction:o((()=>r((()=>import("./LockModal.860e9714.js")),["assets/LockModal.860e9714.js","assets/LockModal.db0fe75f.css","assets/idea.b218466e.css","assets/index.b3c93d64.js","assets/index.8c83d65d.css","assets/index.ee0a0c33.js","assets/index.9b6aba0b.css","assets/BasicModal.2a8ad889.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.e6386ae5.js","assets/BasicForm.79466d99.js","assets/BasicForm.afcef0d6.css","assets/helper.ec3e26f3.js","assets/helper.67489728.css","assets/useFormItem.d029403d.js","assets/functional.3bb51b91.js","assets/functional.a68b3505.css","assets/download.261c8978.js","assets/base64Conver.030fa32c.js","assets/index.d2e70b0d.js","assets/index.8dedeae0.css","assets/index.17ec2e33.js","assets/index.950cae9e.css","assets/useCountdown.cb4ad478.js","assets/JAddInput.c8a1b05b.js","assets/JAddInput.27ff29e1.css","assets/api.dced5d87.js","assets/props.a4f5d1ca.js","assets/index.c4683457.js","assets/index.037a125c.css","assets/bem.3d3e77ca.js","assets/props.c13d8268.js","assets/useContextMenu.de287960.js","assets/useContextMenu.e7cbf068.css","assets/index.9bbe419b.js","assets/index.2254685a.css","assets/onMountedOrActivated.d3784e6c.js","assets/index.36d6c198.js","assets/index.c827a9c8.css","assets/htmlmixed.ba3cd961.js","assets/vue.8c416d71.js","assets/vue.a361089e.css","assets/depart.api.429e062c.js","assets/JUpload.6bcc6fce.js","assets/JUpload.bb1c69a5.css","assets/index.ef2039b9.js","assets/uniqBy.30d2558a.js","assets/useForm.ee23be26.js","assets/lock.ec4d33f8.js","assets/header.d801b988.js"]))),DepartSelect:o((()=>r((()=>import("./DepartSelect.8ebb773f.js")),["assets/DepartSelect.8ebb773f.js","assets/DepartSelect.ff282e06.css","assets/index.ee0a0c33.js","assets/index.9b6aba0b.css","assets/index.b3c93d64.js","assets/index.8c83d65d.css","assets/BasicModal.2a8ad889.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.e6386ae5.js","assets/depart.api.429e062c.js","assets/tenant.api.e9076c03.js"]))),UpdatePassword:o((()=>r((()=>import("./UpdatePassword.8b75ba49.js")),["assets/UpdatePassword.8b75ba49.js","assets/idea.b218466e.css","assets/validator.08db3aa9.js","assets/index.b3c93d64.js","assets/index.8c83d65d.css","assets/user.api.f4883dd0.js","assets/index.ee0a0c33.js","assets/index.9b6aba0b.css","assets/BasicModal.2a8ad889.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.e6386ae5.js","assets/BasicForm.79466d99.js","assets/BasicForm.afcef0d6.css","assets/helper.ec3e26f3.js","assets/helper.67489728.css","assets/useFormItem.d029403d.js","assets/functional.3bb51b91.js","assets/functional.a68b3505.css","assets/download.261c8978.js","assets/base64Conver.030fa32c.js","assets/index.d2e70b0d.js","assets/index.8dedeae0.css","assets/index.17ec2e33.js","assets/index.950cae9e.css","assets/useCountdown.cb4ad478.js","assets/JAddInput.c8a1b05b.js","assets/JAddInput.27ff29e1.css","assets/api.dced5d87.js","assets/props.a4f5d1ca.js","assets/index.c4683457.js","assets/index.037a125c.css","assets/bem.3d3e77ca.js","assets/props.c13d8268.js","assets/useContextMenu.de287960.js","assets/useContextMenu.e7cbf068.css","assets/index.9bbe419b.js","assets/index.2254685a.css","assets/onMountedOrActivated.d3784e6c.js","assets/index.36d6c198.js","assets/index.c827a9c8.css","assets/htmlmixed.ba3cd961.js","assets/vue.8c416d71.js","assets/vue.a361089e.css","assets/depart.api.429e062c.js","assets/JUpload.6bcc6fce.js","assets/JUpload.bb1c69a5.css","assets/index.ef2039b9.js","assets/uniqBy.30d2558a.js","assets/useForm.ee23be26.js"])))},props:{theme:n.oneOf(["dark","light"])},setup(){const{prefixCls:e}=l("header-user-dropdown"),{t:t}=b(),{getShowDoc:a,getUseLockPage:s}=L(),o=c(),r=i(),n=d((()=>{const{realname:e="",avatar:t,desc:a}=o.getUserInfo||{};return{realname:e,avatar:t||R,desc:a}})),m=d((()=>{let{avatar:e}=n.value;return e==R?e:I(e)})),[f,{openModal:g}]=u(),h=p();function w(){return e=this,t=null,a=function*(){if((yield A()).success){const e=yield E();C(j),P(j,e.result),O.success("刷新缓存完成！")}else O.error("刷新缓存失败！")},new Promise(((s,o)=>{var r=e=>{try{l(a.next(e))}catch(t){o(t)}},n=e=>{try{l(a.throw(e))}catch(t){o(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,n);l((a=a.apply(e,t)).next())}));var e,t,a}const x=p();return{prefixCls:e,t:t,getUserInfo:n,getAvatarUrl:m,handleMenuClick:function(e){switch(e.key){case"logout":o.confirmLoginOut();break;case"doc":S(U);break;case"lock":g(!0);break;case"cache":w();break;case"depart":h.value.show();break;case"password":x.value.show(o.getUserInfo.username);break;case"account":r("/page-demo/account/setting")}},getShowDoc:a,register:f,getUseLockPage:s,loginSelectRef:h,updatePasswordRef:x}}}),V=["src"];var T=e($,[["render",function(e,t,a,s,o,r){const n=m("MenuItem"),l=m("MenuDivider"),c=m("Menu"),i=m("Dropdown"),d=m("LockAction"),u=m("DepartSelect"),p=m("UpdatePassword");return f(),g(D,null,[h(i,{placement:"bottomLeft",overlayClassName:`${e.prefixCls}-dropdown-overlay`},{overlay:w((()=>[h(c,{onClick:e.handleMenuClick},{default:w((()=>[e.getShowDoc?(f(),x(n,{key:"doc",text:e.t("layout.header.dropdownItemDoc"),icon:"ion:document-text-outline"},null,8,["text"])):_("",!0),e.getShowDoc?(f(),x(l,{key:1})):_("",!0),h(n,{key:"account",text:e.t("layout.header.dropdownItemSwitchAccount"),icon:"ant-design:setting-outlined"},null,8,["text"]),h(n,{key:"password",text:e.t("layout.header.dropdownItemSwitchPassword"),icon:"ant-design:edit-outlined"},null,8,["text"]),h(n,{key:"depart",text:e.t("layout.header.dropdownItemSwitchDepart"),icon:"ant-design:cluster-outlined"},null,8,["text"]),h(n,{key:"cache",text:e.t("layout.header.dropdownItemRefreshCache"),icon:"ion:sync-outline"},null,8,["text"]),h(n,{key:"logout",text:e.t("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"])])),_:1},8,["onClick"])])),default:w((()=>[k("span",{class:y([[e.prefixCls,`${e.prefixCls}--${e.theme}`],"flex"])},[k("img",{class:y(`${e.prefixCls}__header`),src:e.getAvatarUrl},null,10,V),k("span",{class:y(`${e.prefixCls}__info hidden md:block`)},[k("span",{class:y([`${e.prefixCls}__name  `,"truncate"])},v(e.getUserInfo.realname),3)],2)],2)])),_:1},8,["overlayClassName"]),h(d,{onRegister:e.register},null,8,["onRegister"]),h(u,{ref:"loginSelectRef"},null,512),h(p,{ref:"updatePasswordRef"},null,512)],64)}]]);export{T as default};
