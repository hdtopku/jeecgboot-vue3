import{q as e,l as a,bj as t,F as s,t as n,v as r,x as l,y as i,z as u,L as o,ax as c,V as d,W as p,Q as v,u as y}from"./index.26a57b91.js";import{_ as h}from"./index.3e7bd500.js";import{q as m,s as f}from"./depart.user.api.24442b65.js";import"./bem.73404aba.js";import"./props.d9d42440.js";import"./useContextMenu.7af190c4.js";const x={class:"bg-white m-4 mr-0 overflow-hidden"};var g=e(a({__name:"DepartTree",emits:["select"],setup(e,{emit:a}){t("prefixCls");const{createMessage:g}=y();let b=s(!1),w=s([]),j=s([]),k=s([]),_=s(!0),E=s("2"),A=s(!1);function D(){b.value=!0,w.value=[],m().then((e=>{e.success?Array.isArray(e.result)&&(w.value=e.result,E.value=e.message,function(){let e=[];w.value.forEach(((a,t)=>{a.children&&a.children.length>0&&e.push(a.key),0===t&&K(a.id,a)})),e.length>0&&(!function(){return e=this,a=null,t=function*(){yield v(),A.value=!0,yield v(),A.value=!1},new Promise(((s,n)=>{var r=e=>{try{i(t.next(e))}catch(a){n(a)}},l=e=>{try{i(t.throw(e))}catch(a){n(a)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,l);i((t=t.apply(e,a)).next())}));var e,a,t}(),j.value=e)}()):g.warning(e.message)})).finally((()=>b.value=!1))}function K(e,t){k.value=[e],t&&a("select",t)}function P(e){e?(b.value=!0,f({keyWord:e,myDeptSearch:"1"}).then((e=>{Array.isArray(e)?w.value=e:(g.warning("未查询到部门信息"),w.value=[])})).finally((()=>b.value=!1))):D()}function S(e,a){e.length>0&&k.value[0]!==e[0]?K(e[0],a.selectedNodes[0]):K(k.value[0])}function q(e){j.value=e,_.value=!1}return D(),(e,a)=>{const t=n("a-empty"),s=n("a-spin");return r(),l("div",x,[i(s,{spinning:o(b)},{default:u((()=>["2"===o(E)?(r(),l(c,{key:0},[o(A)?p("",!0):(r(),d(o(h),{key:0,title:"部门列表",toolbar:"",search:"",showLine:"",checkStrictly:!0,clickRowToExpand:!1,treeData:o(w),selectedKeys:o(k),expandedKeys:o(j),autoExpandParent:o(_),onSelect:S,onExpand:q,onSearch:P},null,8,["treeData","selectedKeys","expandedKeys","autoExpandParent"]))],64)):(r(),d(t,{key:1,description:"普通员工无此权限"}))])),_:1},8,["spinning"])])}}}),[["__scopeId","data-v-62078959"]]);export{g as default};
