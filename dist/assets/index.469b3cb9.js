var Ce=Object.defineProperty,he=Object.defineProperties;var Ee=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var ee=(n,t,o)=>t in n?Ce(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,ne=(n,t)=>{for(var o in t||(t={}))we.call(t,o)&&ee(n,o,t[o]);if(Z)for(var o of Z(t))be.call(t,o)&&ee(n,o,t[o]);return n},te=(n,t)=>he(n,Ee(t));var E=(n,t,o)=>new Promise((f,_)=>{var l=r=>{try{p(o.next(r))}catch(C){_(C)}},g=r=>{try{p(o.throw(r))}catch(C){_(C)}},p=r=>r.done?f(r.value):Promise.resolve(r.value).then(l,g);p((o=o.apply(n,t)).next())});import{B as Ae}from"./BasicTable.1db2499e.js";import{T as ke}from"./helper.15e1830a.js";import"./TableImg.e6a1ca63.js";import Te from"./UserDrawer.25602d89.js";import De from"./UserRecycleBinModal.6957080f.js";import ve from"./PasswordModal.b245f27f.js";import xe from"./UserAgentModal.4d92661f.js";import{a1 as ce,en as oe,l as J,t as F,v as y,V as w,z as a,y as u,C as i,D as H,W as M,q as Se,F as Re,o as ue,a5 as N,eo as $e,h as O,x as G,B as se,ep as ae,L as s,av as ie,u as pe,bG as W}from"./index.6c1aeca2.js";import{a as Ie}from"./index.019f55e0.js";import{useListPage as Me}from"./useListPage.7d5f3d18.js";import"./index.c1c509d9.js";import{c as Le,s as ze}from"./user.data.d37f02c2.js";import{l as Ue,k as je,m as Pe,n as He,o as re,q as Oe,r as Je}from"./user.api.295372fd.js";import"./BasicForm.e500713f.js";import"./uniqBy.b316cd09.js";import"./BasicModal.2246c02b.js";import"./useWindowSizeFn.a6a246d2.js";import"./useForm.f4b29e26.js";import"./JAddInput.5c78e955.js";import"./useFormItem.63b4eda3.js";import"./api.52ea4d1e.js";import"./props.0c0dfcc6.js";import"./index.5b79f8bf.js";import"./bem.8f063110.js";import"./props.ee552767.js";import"./useContextMenu.2ad8381d.js";import"./index.3803400c.js";import"./onMountedOrActivated.0e85db74.js";import"./index.2847d809.js";import"./htmlmixed.6fb02709.js";import"./vue.ab8c7c18.js";/* empty css             */import"./usePopBiz.651349c4.js";import"./useMethods.eccfa16d.js";import"./depart.api.c664bb73.js";import"./index.866fff1a.js";import"./useContentHeight.a77fa571.js";import"./useContentViewHeight.bf6f2f30.js";import"./usePageContext.5da89706.js";import"./RedoOutlined.f33cdacc.js";import"./functional.32464814.js";import"./download.54491438.js";import"./base64Conver.030fa32c.js";import"./index.1785e33e.js";import"./index.9d763a26.js";import"./useCountdown.c7fbe84b.js";import"./JUpload.7c7f9634.js";import"./index.af09c9a6.js";import"./useAdaptiveWidth.1c3c9787.js";import"./validator.ec5b4198.js";import"./renderUtils.b120a814.js";import"./useTable.d616a74c.js";const de={getEnabledType:"/sys/thirdApp/getEnabledType",wechatEnterprise:{user:"/sys/thirdApp/sync/wechatEnterprise/user",depart:"/sys/thirdApp/sync/wechatEnterprise/depart"},dingtalk:{user:"/sys/thirdApp/sync/dingtalk/user",depart:"/sys/thirdApp/sync/dingtalk/depart"}};let X=null;const Ke=()=>E(void 0,null,function*(){if(X!=null)return oe(X);{let{success:n,result:t}=yield ce.get({url:de.getEnabledType},{isTransformResponse:!1});if(n)return X=oe(t),t;console.warn("getEnabledType\u67E5\u8BE2\u5931\u8D25\uFF1A")}return{}}),Ve=i("\u540C\u6B65\u5230\u672C\u5730"),le=J({__name:"JThirdAppDropdown",props:{type:String,name:String,syncToApp:Boolean,syncToLocal:Boolean},emits:["to-app","to-local"],setup(n,{emit:t}){const o=n;function f(_){t(_.key,{type:o.type})}return(_,l)=>{const g=F("a-button"),p=F("a-menu-item"),r=F("a-menu"),C=F("a-dropdown");return n.syncToApp&&n.syncToLocal?(y(),w(C,{key:0},{overlay:a(()=>[u(r,{onClick:f},{default:a(()=>[n.syncToApp?(y(),w(p,{key:"to-app"},{default:a(()=>[i("\u540C\u6B65\u5230"+H(n.name),1)]),_:1})):M("",!0),n.syncToLocal?(y(),w(p,{key:"to-local"},{default:a(()=>[Ve]),_:1})):M("",!0)]),_:1})]),default:a(()=>[u(g,{type:"primary",preIcon:"ant-design:sync-outlined"},{default:a(()=>[i("\u540C\u6B65"+H(n.name),1)]),_:1})]),_:1})):n.syncToApp?(y(),w(g,{key:1,type:"primary",preIcon:"ant-design:sync-outlined",onClick:l[0]||(l[0]=D=>f({key:"to-app"}))},{default:a(()=>[i("\u540C\u6B65"+H(n.name),1)]),_:1})):(y(),w(g,{key:2,type:"primary",preIcon:"ant-design:sync-outlined",onClick:l[1]||(l[1]=D=>f({key:"to-local"}))},{default:a(()=>[i("\u540C\u6B65"+H(n.name)+"\u5230\u672C\u5730",1)]),_:1}))}}});const qe=i("\u672A\u8BBE\u7F6E\u4EFB\u4F55\u540C\u6B65\u65B9\u5411"),Ne=J({__name:"JThirdAppButton",props:{bizType:{type:String,required:!0},syncToApp:Boolean,syncToLocal:Boolean,selectedRowKeys:Array},emits:["sync-ok","sync-error","sync-finally"],setup(n,{emit:t}){const o=n,{createMessage:f,createWarningModal:_}=pe(),l=Re({}),g=ue(()=>({syncToApp:o.syncToApp,syncToLocal:o.syncToLocal})),p=ue(()=>({"to-app":r,"to-local":C}));function r(d){K(d.type,"/toApp")}function C(d){K(d.type,"/toLocal")}function D(){return E(this,null,function*(){l.value=yield Ke()})}function K(d,h){let v=de[d];if(!(v&&v[o.bizType])){console.warn("\u914D\u7F6E\u51FA\u9519");return}let m=v[o.bizType]+h,k=o.selectedRowKeys,z="\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u5168\u90E8\u6570\u636E\u5417\uFF1F\u53EF\u80FD\u82B1\u8D39\u8F83\u957F\u65F6\u95F4\uFF01";return Array.isArray(k)&&k.length>0?z=`\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u8FD9 ${k.length} \u9879\u5417\uFF1F`:k=[],new Promise((x,T)=>{const U=N.confirm({icon:u($e),title:"\u540C\u6B65",content:z,onOk:()=>{U.update({keyboard:!1,okText:"\u540C\u6B65\u4E2D\u2026",cancelButtonProps:{disabled:!0}});let V={ids:k.join(",")};return ce.get({url:m,params:V},{isTransformResponse:!1}).then(B=>{let b={};B.result&&(b={width:600,title:B.message,content:()=>{let S,j=["\u6210\u529F\u4FE1\u606F\u5982\u4E0B\uFF1A",L(O,B.result.successInfo.map((R,$)=>`${$+1}. ${R}`).join(`
`))];return B.success?S=[...j,O("br"),"\u65E0\u5931\u8D25\u4FE1\u606F\uFF01"]:S=["\u5931\u8D25\u4FE1\u606F\u5982\u4E0B\uFF1A",L(O,B.result.failInfo.map((R,$)=>`${$+1}. ${R}`).join(`
`)),O("br"),...j],S}}),B.success?(b!=null?N.success(b):f.warning(B.message),t("sync-ok")):(b!=null?N.warning(b):f.warning(B.message),t("sync-error"))}).catch(()=>U.destroy()).finally(()=>{x(),t("sync-finally",{type:d,direction:h,isToApp:h==="/toApp",isToLocal:h==="/toLocal"})})},onCancel(){x()}})})}function L(d,h){return d("div",{id:"box",style:{minHeight:"100px",border:"1px solid #d9d9d9",fontSize:"14px",maxHeight:"250px",whiteSpace:"pre",overflow:"auto",padding:"10px"}},h)}return D(),(d,h)=>n.syncToApp||n.syncToLocal?(y(),G(ie,{key:0},[l.value.wechatEnterprise?(y(),w(le,se({key:0,type:"wechatEnterprise",name:"\u4F01\u5FAE"},s(g),ae(s(p))),null,16)):M("",!0),l.value.dingtalk?(y(),w(le,se({key:1,type:"dingtalk",name:"\u9489\u9489"},s(g),ae(s(p))),null,16)):M("",!0)],64)):(y(),G(ie,{key:1},[qe],64))}});var We=Se(Ne,[["__scopeId","data-v-7ecd6fe9"]]);const Xe=i(" \u65B0\u589E"),Ge=i(" \u5BFC\u51FA"),Qe=i("\u5BFC\u5165"),Ye=i(" \u540C\u6B65\u6D41\u7A0B"),Ze=i(" \u56DE\u6536\u7AD9"),en=i(" \u5220\u9664 "),nn=i(" \u51BB\u7ED3 "),tn=i(" \u89E3\u51BB "),on=i("\u6279\u91CF\u64CD\u4F5C "),un=J({name:"system-user"}),st=J(te(ne({},un),{setup(n){const{createMessage:t,createConfirm:o}=pe(),[f,{openDrawer:_}]=Ie(),[l,{openModal:g}]=W(),[p,{openModal:r}]=W(),[C,{openModal:D}]=W(),{prefixCls:K,tableContext:L,onExportXls:d,onImportXls:h}=Me({designScope:"user-list",tableProps:{title:"\u7528\u6237\u5217\u8868",api:Ue,columns:Le,size:"small",formConfig:{schemas:ze},actionColumn:{width:120},beforeFetch:e=>Object.assign({column:"createTime",order:"desc"},e)},exportConfig:{name:"\u7528\u6237\u5217\u8868",url:je},importConfig:{url:Pe}}),[v,{reload:m,updateTableDataRecord:k},{rowSelection:z,selectedRows:x,selectedRowKeys:T}]=L;function U(){_(!0,{isUpdate:!1,showFooter:!0})}function V(e){return E(this,null,function*(){_(!0,{record:e,isUpdate:!0,showFooter:!0})})}function B(e){return E(this,null,function*(){_(!0,{record:e,isUpdate:!0,showFooter:!1})})}function b(e){return E(this,null,function*(){if(e.username=="admin"){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield Je({id:e.id},m)})}function S(){return E(this,null,function*(){let e=s(x).filter(c=>c.username=="admin");if(s(e).length>0){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield He({ids:T.value},()=>{T.value=[],m()})})}function j(){m()}function R(e){r(!0,{username:e})}function $(e){D(!0,{userName:e})}function Q(e,c){return E(this,null,function*(){if(e.username=="admin"){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield re({ids:e.id,status:c},m)})}function Y(e){let c=x.value.filter(A=>A.username=="admin");if(s(c).length>0){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}o({iconType:"warning",title:"\u786E\u8BA4\u64CD\u4F5C",content:"\u662F\u5426"+(e==1?"\u89E3\u51BB":"\u51BB\u7ED3")+"\u9009\u4E2D\u8D26\u53F7?",onOk:()=>E(this,null,function*(){yield re({ids:s(T).join(","),status:e},m)})})}function me(){Oe()}function ye({isToLocal:e}){e&&m()}function fe(e){return[{label:"\u7F16\u8F91",onClick:V.bind(null,e)}]}function _e(e){return[{label:"\u8BE6\u60C5",onClick:B.bind(null,e)},{label:"\u5BC6\u7801",onClick:R.bind(null,e.username)},{label:"\u5220\u9664",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664",confirm:b.bind(null,e)}},{label:"\u51BB\u7ED3",ifShow:e.status==1,popConfirm:{title:"\u786E\u5B9A\u51BB\u7ED3\u5417?",confirm:Q.bind(null,e,2)}},{label:"\u89E3\u51BB",ifShow:e.status==2,popConfirm:{title:"\u786E\u5B9A\u89E3\u51BB\u5417?",confirm:Q.bind(null,e,1)}},{label:"\u4EE3\u7406\u4EBA",onClick:$.bind(null,e.username)}]}return(e,c)=>{const A=F("a-button"),ge=F("j-upload-button"),P=F("Icon"),q=F("a-menu-item"),Be=F("a-menu"),Fe=F("a-dropdown");return y(),G("div",null,[u(s(Ae),{onRegister:s(v),rowSelection:s(z)},{tableTitle:a(()=>[u(A,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:U},{default:a(()=>[Xe]),_:1}),u(A,{type:"primary",preIcon:"ant-design:export-outlined",onClick:s(d)},{default:a(()=>[Ge]),_:1},8,["onClick"]),u(ge,{type:"primary",preIcon:"ant-design:import-outlined",onClick:s(h)},{default:a(()=>[Qe]),_:1},8,["onClick"]),u(A,{type:"primary",onClick:me,preIcon:"ant-design:sync-outlined"},{default:a(()=>[Ye]),_:1}),u(A,{type:"primary",onClick:c[0]||(c[0]=I=>s(g)(!0,{})),preIcon:"ant-design:hdd-outlined"},{default:a(()=>[Ze]),_:1}),u(We,{"biz-type":"user","selected-row-keys":s(T),syncToApp:"",syncToLocal:"",onSyncFinally:ye},null,8,["selected-row-keys"]),s(T).length>0?(y(),w(Fe,{key:0},{overlay:a(()=>[u(Be,null,{default:a(()=>[u(q,{key:"1",onClick:S},{default:a(()=>[u(P,{icon:"ant-design:delete-outlined"}),en]),_:1}),u(q,{key:"2",onClick:c[1]||(c[1]=I=>Y(2))},{default:a(()=>[u(P,{icon:"ant-design:lock-outlined"}),nn]),_:1}),u(q,{key:"3",onClick:c[2]||(c[2]=I=>Y(1))},{default:a(()=>[u(P,{icon:"ant-design:unlock-outlined"}),tn]),_:1})]),_:1})]),default:a(()=>[u(A,null,{default:a(()=>[on,u(P,{icon:"mdi:chevron-down"})]),_:1})]),_:1})):M("",!0)]),action:a(({record:I})=>[u(s(ke),{actions:fe(I),dropDownActions:_e(I)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),u(Te,{onRegister:s(f),onSuccess:j},null,8,["onRegister"]),u(ve,{onRegister:s(p),onSuccess:s(m)},null,8,["onRegister","onSuccess"]),u(xe,{onRegister:s(C),onSuccess:s(m)},null,8,["onRegister","onSuccess"]),u(De,{onRegister:s(l),onSuccess:s(m)},null,8,["onRegister","onSuccess"])])}}}));export{st as default};
