var p=(D,x,o)=>new Promise((i,s)=>{var f=t=>{try{c(o.next(t))}catch(d){s(d)}},m=t=>{try{c(o.throw(t))}catch(d){s(d)}},c=t=>t.done?i(t.value):Promise.resolve(t.value).then(f,m);c((o=o.apply(D,x)).next())});import{a as H}from"./index.b74fc315.js";import{_ as O}from"./index.c0884eed.js";import Q from"./DepartDataRuleDrawer.8a405af4.js";import{a as W,b as G,c as J}from"./depart.api.37e03c1e.js";import{q as M,l as U,o as X,bi as Y,F as u,H as Z,Q as w,t as r,v as g,x as ee,y as a,z as n,V as C,aV as K,D as te,W as ae,L as T,aw as ne,C as _}from"./index.df6cbb3d.js";import"./bem.5fa20b7a.js";import"./props.9345007b.js";import"./useContextMenu.c6597c00.js";const oe={class:"j-box-bottom-button offset-20",style:{"margin-top":"30px"}},se={class:"j-box-bottom-button-float"},le=_("\u5168\u90E8\u52FE\u9009"),ue=_("\u53D6\u6D88\u5168\u9009"),ie=_("\u5C55\u5F00\u6240\u6709"),re=_("\u6536\u8D77\u6240\u6709"),ce=_(" \u6811\u64CD\u4F5C "),de=_("\u4FDD\u5B58"),pe=U({__name:"DepartRuleTab",props:{data:{type:Object,default:()=>({})}},setup(D){const x=D,o=X(()=>{var e;return(e=x.data)==null?void 0:e.id});Y("prefixCls");const i=u(),s=u(!1),f=u([]),m=u([]),c=u([]),t=u([]),d=u([]),j=u(!0),[A,S]=H();E(),Z(o,()=>I(),{immediate:!0});function E(){return p(this,null,function*(){try{s.value=!0;let{treeList:e}=yield W();f.value=e,yield w(),h(!0)}finally{s.value=!1}})}function I(){return p(this,null,function*(){if(o.value)try{s.value=!0;let e=yield G({departId:o.value});t.value=e,d.value=[...e]}finally{s.value=!1}})}function V(){return p(this,null,function*(){try{s.value=!0,yield J({departId:o.value,permissionIds:t.value.join(","),lastpermissionIds:d.value.join(",")}),yield E(),yield I()}finally{s.value=!1}})}function $(e){Array.isArray(e)?t.value=e:t.value=e.checked}function B(e){m.value=e}function L(e,{selectedNodes:l}){var y;if((y=l[0])!=null&&y.ruleFlag){let b=e[0];S.openDrawer(!0,{departId:o,functionId:b})}c.value=[]}function h(e){return p(this,null,function*(){i.value.expandAll(e),yield w(),m.value=i.value.getExpandedKeys()})}function F(e){return p(this,null,function*(){i.value.checkAll(e),yield w(),t.value=i.value.getCheckedKeys()})}return(e,l)=>{const y=r("Icon"),b=r("a-empty"),k=r("a-menu-item"),N=r("a-menu"),R=r("a-button"),q=r("a-dropdown"),P=r("a-spin");return g(),ee(ne,null,[a(P,{spinning:s.value},{default:n(()=>[f.value.length>0?(g(),C(T(O),{key:0,ref_key:"basicTree",ref:i,class:"depart-rule-tree",checkable:"",treeData:f.value,checkedKeys:t.value,selectedKeys:c.value,expandedKeys:m.value,checkStrictly:j.value,style:{height:"500px",overflow:"auto"},onCheck:$,onExpand:B,onSelect:L},{title:n(({slotTitle:v,ruleFlag:z})=>[K("span",null,te(v),1),z?(g(),C(y,{key:0,icon:"ant-design:align-left-outlined",style:{"margin-left":"5px",color:"red"}})):ae("",!0)]),_:1},8,["treeData","checkedKeys","selectedKeys","expandedKeys","checkStrictly"])):(g(),C(b,{key:1,description:"\u65E0\u53EF\u914D\u7F6E\u90E8\u95E8\u6743\u9650"})),K("div",oe,[K("div",se,[a(q,{trigger:["click"],placement:"top"},{overlay:n(()=>[a(N,null,{default:n(()=>[a(k,{key:"3",onClick:l[0]||(l[0]=v=>F(!0))},{default:n(()=>[le]),_:1}),a(k,{key:"4",onClick:l[1]||(l[1]=v=>F(!1))},{default:n(()=>[ue]),_:1}),a(k,{key:"5",onClick:l[2]||(l[2]=v=>h(!0))},{default:n(()=>[ie]),_:1}),a(k,{key:"6",onClick:l[3]||(l[3]=v=>h(!1))},{default:n(()=>[re]),_:1})]),_:1})]),default:n(()=>[a(R,{style:{float:"left"}},{default:n(()=>[ce,a(y,{icon:"ant-design:up-outlined"})]),_:1})]),_:1}),a(R,{type:"primary",preIcon:"ant-design:save-filled",onClick:V},{default:n(()=>[de]),_:1})])])]),_:1},8,["spinning"]),a(Q,{onRegister:T(A)},null,8,["onRegister"])],64)}}});var he=M(pe,[["__scopeId","data-v-28e223e1"]]);export{he as default};
