import{q as e,l as t,bd as a,be as s,cc as o,cd as r,aN as n,n as c,d7 as l,dU as d,o as i,bI as u,F as p,t as m,v as f,x as g,y as h,z as w,V as x,W as _,aW as k,E as y,D as v,ax as D,s as I,a as b,a3 as S,ej as C,el as P,ek as j,u as M}from"./index.b2c24a42.js";import{S as U}from"./siteSetting.967dfbc9.js";import{useHeaderSetting as L}from"./useHeaderSetting.0ddf1300.js";import"./index.12c6f6d1.js";import{h as R}from"./header.d801b988.js";import{r as A,q as E}from"./dict.api.a0727c4d.js";import"./BasicModal.c95a44ff.js";import"./useWindowSizeFn.6c0c5931.js";const{createMessage:O}=M(),$=t({name:"UserDropdown",components:{Dropdown:a,Menu:s,MenuItem:o((()=>r((()=>import("./DropMenuItem.c08b1386.js")),["assets/DropMenuItem.c08b1386.js","assets/index.b2c24a42.js","assets/index.8c83d65d.css"]))),MenuDivider:s.Divider,LockAction:o((()=>r((()=>import("./LockModal.a233ed09.js")),["assets/LockModal.a233ed09.js","assets/LockModal.db0fe75f.css","assets/idea.b218466e.css","assets/index.b2c24a42.js","assets/index.8c83d65d.css","assets/index.12c6f6d1.js","assets/index.9b6aba0b.css","assets/BasicModal.c95a44ff.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.6c0c5931.js","assets/BasicForm.fb9b9310.js","assets/BasicForm.afcef0d6.css","assets/helper.c50e6850.js","assets/helper.67489728.css","assets/useFormItem.9110ec70.js","assets/functional.d6fe070d.js","assets/functional.a68b3505.css","assets/download.0dd0b191.js","assets/base64Conver.030fa32c.js","assets/index.de682914.js","assets/index.8dedeae0.css","assets/index.fb0e3f73.js","assets/index.950cae9e.css","assets/useCountdown.cfa41944.js","assets/JAddInput.2ba637e0.js","assets/JAddInput.27ff29e1.css","assets/api.e26748d3.js","assets/props.4a0f18d3.js","assets/index.27a29657.js","assets/index.037a125c.css","assets/bem.a0439036.js","assets/props.d4c4f199.js","assets/useContextMenu.0c34a59e.js","assets/useContextMenu.e7cbf068.css","assets/index.9872fa51.js","assets/index.2254685a.css","assets/onMountedOrActivated.bfdd028b.js","assets/index.d802f44f.js","assets/index.c827a9c8.css","assets/htmlmixed.8e042aa6.js","assets/vue.bbfa1b85.js","assets/vue.a361089e.css","assets/depart.api.2d5bb309.js","assets/JUpload.152dd3a7.js","assets/JUpload.bb1c69a5.css","assets/index.be1c9e2b.js","assets/uniqBy.be1d69f1.js","assets/useForm.5a9ed278.js","assets/lock.ffbc5e4b.js","assets/header.d801b988.js"]))),DepartSelect:o((()=>r((()=>import("./DepartSelect.b44287af.js")),["assets/DepartSelect.b44287af.js","assets/DepartSelect.ff282e06.css","assets/index.12c6f6d1.js","assets/index.9b6aba0b.css","assets/index.b2c24a42.js","assets/index.8c83d65d.css","assets/BasicModal.c95a44ff.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.6c0c5931.js","assets/depart.api.2d5bb309.js","assets/tenant.api.112076be.js"]))),UpdatePassword:o((()=>r((()=>import("./UpdatePassword.68e45900.js")),["assets/UpdatePassword.68e45900.js","assets/idea.b218466e.css","assets/validator.b4088ecf.js","assets/index.b2c24a42.js","assets/index.8c83d65d.css","assets/user.api.ceae0e75.js","assets/index.12c6f6d1.js","assets/index.9b6aba0b.css","assets/BasicModal.c95a44ff.js","assets/BasicModal.1311e866.css","assets/useWindowSizeFn.6c0c5931.js","assets/BasicForm.fb9b9310.js","assets/BasicForm.afcef0d6.css","assets/helper.c50e6850.js","assets/helper.67489728.css","assets/useFormItem.9110ec70.js","assets/functional.d6fe070d.js","assets/functional.a68b3505.css","assets/download.0dd0b191.js","assets/base64Conver.030fa32c.js","assets/index.de682914.js","assets/index.8dedeae0.css","assets/index.fb0e3f73.js","assets/index.950cae9e.css","assets/useCountdown.cfa41944.js","assets/JAddInput.2ba637e0.js","assets/JAddInput.27ff29e1.css","assets/api.e26748d3.js","assets/props.4a0f18d3.js","assets/index.27a29657.js","assets/index.037a125c.css","assets/bem.a0439036.js","assets/props.d4c4f199.js","assets/useContextMenu.0c34a59e.js","assets/useContextMenu.e7cbf068.css","assets/index.9872fa51.js","assets/index.2254685a.css","assets/onMountedOrActivated.bfdd028b.js","assets/index.d802f44f.js","assets/index.c827a9c8.css","assets/htmlmixed.8e042aa6.js","assets/vue.bbfa1b85.js","assets/vue.a361089e.css","assets/depart.api.2d5bb309.js","assets/JUpload.152dd3a7.js","assets/JUpload.bb1c69a5.css","assets/index.be1c9e2b.js","assets/uniqBy.be1d69f1.js","assets/useForm.5a9ed278.js"])))},props:{theme:n.oneOf(["dark","light"])},setup(){const{prefixCls:e}=c("header-user-dropdown"),{t:t}=I(),{getShowDoc:a,getUseLockPage:s}=L(),o=l(),r=d(),n=i((()=>{const{realname:e="",avatar:t,desc:a}=o.getUserInfo||{};return{realname:e,avatar:t||R,desc:a}})),m=i((()=>{let{avatar:e}=n.value;return e==R?e:b(e)})),[f,{openModal:g}]=u(),h=p();function w(){return e=this,t=null,a=function*(){if((yield A()).success){const e=yield E();C(j),P(j,e.result),O.success("刷新缓存完成！")}else O.error("刷新缓存失败！")},new Promise(((s,o)=>{var r=e=>{try{c(a.next(e))}catch(t){o(t)}},n=e=>{try{c(a.throw(e))}catch(t){o(t)}},c=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,n);c((a=a.apply(e,t)).next())}));var e,t,a}const x=p();return{prefixCls:e,t:t,getUserInfo:n,getAvatarUrl:m,handleMenuClick:function(e){switch(e.key){case"logout":o.confirmLoginOut();break;case"doc":S(U);break;case"lock":g(!0);break;case"cache":w();break;case"depart":h.value.show();break;case"password":x.value.show(o.getUserInfo.username);break;case"account":r("/page-demo/account/setting")}},getShowDoc:a,register:f,getUseLockPage:s,loginSelectRef:h,updatePasswordRef:x}}}),V=["src"];var T=e($,[["render",function(e,t,a,s,o,r){const n=m("MenuItem"),c=m("MenuDivider"),l=m("Menu"),d=m("Dropdown"),i=m("LockAction"),u=m("DepartSelect"),p=m("UpdatePassword");return f(),g(D,null,[h(d,{placement:"bottomLeft",overlayClassName:`${e.prefixCls}-dropdown-overlay`},{overlay:w((()=>[h(l,{onClick:e.handleMenuClick},{default:w((()=>[e.getShowDoc?(f(),x(n,{key:"doc",text:e.t("layout.header.dropdownItemDoc"),icon:"ion:document-text-outline"},null,8,["text"])):_("",!0),e.getShowDoc?(f(),x(c,{key:1})):_("",!0),h(n,{key:"account",text:e.t("layout.header.dropdownItemSwitchAccount"),icon:"ant-design:setting-outlined"},null,8,["text"]),h(n,{key:"password",text:e.t("layout.header.dropdownItemSwitchPassword"),icon:"ant-design:edit-outlined"},null,8,["text"]),h(n,{key:"depart",text:e.t("layout.header.dropdownItemSwitchDepart"),icon:"ant-design:cluster-outlined"},null,8,["text"]),h(n,{key:"cache",text:e.t("layout.header.dropdownItemRefreshCache"),icon:"ion:sync-outline"},null,8,["text"]),h(n,{key:"logout",text:e.t("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"])])),_:1},8,["onClick"])])),default:w((()=>[k("span",{class:y([[e.prefixCls,`${e.prefixCls}--${e.theme}`],"flex"])},[k("img",{class:y(`${e.prefixCls}__header`),src:e.getAvatarUrl},null,10,V),k("span",{class:y(`${e.prefixCls}__info hidden md:block`)},[k("span",{class:y([`${e.prefixCls}__name  `,"truncate"])},v(e.getUserInfo.realname),3)],2)],2)])),_:1},8,["overlayClassName"]),h(i,{onRegister:e.register},null,8,["onRegister"]),h(u,{ref:"loginSelectRef"},null,512),h(p,{ref:"updatePasswordRef"},null,512)],64)}]]);export{T as default};
