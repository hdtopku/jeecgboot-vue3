var e=(e,a,t)=>new Promise(((l,s)=>{var r=e=>{try{u(t.next(e))}catch(a){s(a)}},n=e=>{try{u(t.throw(e))}catch(a){s(a)}},u=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,n);u((t=t.apply(e,a)).next())}));import{a1 as a,l as t,bj as l,F as s,t as r,v as n,V as u,z as i,y as o,x as d,W as c,ax as y,Q as v}from"./index.b3c93d64.js";import{s as p}from"./depart.user.api.c569e3bf.js";const f=e=>a.get({url:"/sys/sysDepart/queryDepartTreeSync",params:e}),h=e=>a.get({url:"/sys/user/queryByOrgCodeForAddressList",params:e}),m=e=>a.get({url:"/sys/position/list",params:e}),g=t({__name:"DepartLeftTree",emits:["select","rootTreeData"],setup(a,{expose:t,emit:h}){l("prefixCls");const m=s(!1),g=s([]),x=s([]),_=s([]),b=s(!1),D=s(null),k=s("");function T(){return e(this,null,(function*(){try{m.value=!0,g.value=[];const e=yield f();Array.isArray(e)&&(g.value=e),0===x.value.length&&w()}finally{m.value=!1}}))}function j(a){return e(this,null,(function*(){try{const e=yield f({pid:a.dataRef.id});if(0==e.length)a.dataRef.isLeaf=!0;else if(a.dataRef.children=e,x.value.length>0){let a=[];for(let t of x.value)-1!==e.findIndex((e=>e.id===t))&&a.push(t);a.length>0&&(x.value=[...x.value])}g.value=[...g.value]}catch(e){}return Promise.resolve()}))}function w(){let a=g.value[0];a&&(a.isLeaf||(x.value=[a.key]),function(){e(this,null,(function*(){yield v(),b.value=!0,yield v(),b.value=!1}))}())}function A(e,a){_.value=[e],a&&(D.value=a,h("select",a))}function K(a){return e(this,null,(function*(){if(a)try{m.value=!0,g.value=[];let e=yield p({keyWord:a});Array.isArray(e)&&(g.value=e),w()}finally{m.value=!1}else T();k.value=a}))}function L(e,a){e.length>0&&_.value[0]!==e[0]?A(e[0],a.selectedNodes[0]):A(_.value[0])}return T(),t({loadRootTreeData:T}),(e,a)=>{const t=r("a-input-search"),l=r("a-tree"),s=r("a-empty"),v=r("a-spin"),p=r("a-card");return n(),u(p,{bordered:!1,style:{height:"100%"}},{default:i((()=>[o(v,{spinning:m.value},{default:i((()=>[o(t,{placeholder:"按部门名称搜索…",style:{"margin-bottom":"10px"},onSearch:K,allowClear:""}),g.value.length>0?(n(),d(y,{key:0},[b.value?c("",!0):(n(),u(l,{key:0,showLine:"",clickRowToExpand:!1,treeData:g.value,selectedKeys:_.value,"load-data":j,expandedKeys:x.value,"onUpdate:expandedKeys":a[0]||(a[0]=e=>x.value=e),onSelect:L},null,8,["treeData","selectedKeys","expandedKeys"]))],64)):(n(),u(s,{key:1,description:"暂无数据"}))])),_:1},8,["spinning"])])),_:1})}}});var x=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{x as D,g as _,h as l,m as p};
