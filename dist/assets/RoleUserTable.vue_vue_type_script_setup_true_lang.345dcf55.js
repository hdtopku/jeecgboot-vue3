var l=(h,g,a)=>new Promise((r,p)=>{var w=o=>{try{i(a.next(o))}catch(c){p(c)}},b=o=>{try{i(a.throw(o))}catch(c){p(c)}},i=o=>o.done?r(o.value):Promise.resolve(o.value).then(w,b);i((a=a.apply(h,g)).next())});import P from"./BasicTable.66437f1b.js";import{T as W}from"./componentMap.0d9ed10b.js";import"./BasicTable.vue_vue_type_style_index_0_lang.5d67575c.js";import"./TableImg.vue_vue_type_style_index_0_lang.02ffe232.js";import{u as $}from"./useTable.c9c1730c.js";import{u as z,a as H,B as Q}from"./index.7d351504.js";import"./index.abb79268.js";import{_ as q}from"./UserDrawer.vue_vue_type_script_setup_true_lang.8fcc66f2.js";import{_ as G}from"./UseSelectModal.vue_vue_type_script_setup_true_lang.89b8a4d7.js";import{u as J,g as X,h as Y,j as Z}from"./role.api.a4c568c3.js";import{u as ee,s as te}from"./role.data.49a6d5e2.js";import{g as oe}from"./user.api.dccf9d73.js";import{j as ne,C as R,bI as se,r as m,s as D,Q as y,w as s,v as t,K as u,y as f,R as ae}from"./index.e95b1f12.js";const Ce=ne({__name:"RoleUserTable",emits:["register","hideUserList"],setup(h,{emit:g}){const a=R([]),r=R(""),[p,{setDrawerProps:w,closeDrawer:b}]=z(e=>l(this,null,function*(){r.value=e.id,T({searchInfo:{roleId:e.id}}),d()})),[i,{openDrawer:o}]=H(),[c,{openModal:I}]=se(),[k,{reload:d,updateTableDataRecord:S,setProps:T}]=$({title:"\u7528\u6237\u5217\u8868",api:J,columns:ee,formConfig:{labelWidth:120,schemas:te,autoSubmitOnEnter:!0,actionColOptions:{pull:1}},striped:!0,useSearchForm:!0,showTableSetting:!0,clickToRowSelect:!1,bordered:!0,showIndexColumn:!1,tableSetting:{fullScreen:!0},canResize:!1,rowKey:"id",actionColumn:{width:180,title:"\u64CD\u4F5C",dataIndex:"action",slots:{customRender:"action"},fixed:void 0}}),v={type:"checkbox",columnWidth:50,selectedRowKeys:a,onChange:x};function x(e,n){a.value=e}function F(){o(!0,{isUpdate:!1,selectedroles:[r.value],isRole:!0})}function U(e){return l(this,null,function*(){try{const n=yield oe({userid:e.id});n&&n.length>0&&(e.selectedroles=n)}catch(n){console.log(n)}o(!0,{record:e,isUpdate:!0,isRole:!0})})}function B(e){return l(this,null,function*(){yield Z({userId:e.id,roleId:r.value},d)})}function E(){return l(this,null,function*(){yield X({userIds:a.value.join(","),roleId:r.value},d)})}function K({isUpdate:e,values:n}){e?S(n.id,n):d()}function O(){I(!0)}function j(e){return l(this,null,function*(){yield Y({roleId:r.value,userIdList:e},d)})}function A(e){return[{label:"\u7F16\u8F91",onClick:U.bind(null,e)},{label:"\u53D6\u6D88\u5173\u8054",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u53D6\u6D88\u5173\u8054",confirm:B.bind(null,e)}}]}return(e,n)=>{const _=m("a-button"),C=m("Icon"),L=m("a-menu-item"),M=m("a-menu"),N=m("a-dropdown");return D(),y(u(Q),{onRegister:u(p),title:"\u89D2\u8272\u7528\u6237",width:"800",destroyOnClose:""},{default:s(()=>[t(u(P),{onRegister:u(k),rowSelection:v},{tableTitle:s(()=>[t(_,{type:"primary",onClick:F},{default:s(()=>[f(" \u65B0\u589E\u7528\u6237")]),_:1}),t(_,{type:"primary",onClick:O},{default:s(()=>[f(" \u5DF2\u6709\u7528\u6237")]),_:1}),a.value.length>0?(D(),y(N,{key:0},{overlay:s(()=>[t(M,null,{default:s(()=>[t(L,{key:"1",onClick:E},{default:s(()=>[t(C,{icon:"bx:bx-unlink"}),f(" \u53D6\u6D88\u5173\u8054 ")]),_:1})]),_:1})]),default:s(()=>[t(_,null,{default:s(()=>[f("\u6279\u91CF\u64CD\u4F5C "),t(C,{icon:"ant-design:down-outlined"})]),_:1})]),_:1})):ae("",!0)]),action:s(({record:V})=>[t(u(W),{actions:A(V)},null,8,["actions"])]),_:1},8,["onRegister"]),t(q,{onRegister:u(i),onSuccess:K},null,8,["onRegister"]),t(G,{onRegister:u(c),onSelect:j},null,8,["onRegister"])]),_:1},8,["onRegister"])}}});export{Ce as _};
