var _e=Object.defineProperty,Ee=Object.defineProperties;var we=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var ee=(n,t,o)=>t in n?_e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,ne=(n,t)=>{for(var o in t||(t={}))be.call(t,o)&&ee(n,o,t[o]);if(Y)for(var o of Y(t))Ae.call(t,o)&&ee(n,o,t[o]);return n},te=(n,t)=>Ee(n,we(t));var w=(n,t,o)=>new Promise((f,g)=>{var l=i=>{try{p(o.next(i))}catch(_){g(_)}},B=i=>{try{p(o.throw(i))}catch(_){g(_)}},p=i=>i.done?f(i.value):Promise.resolve(i.value).then(l,B);p((o=o.apply(n,t)).next())});import ke from"./BasicTable.24085ffb.js";import{T as Te}from"./helper.f767d3be.js";import"./BasicTable.vue_vue_type_style_index_0_lang.e39809a9.js";import"./TableImg.vue_vue_type_style_index_0_lang.0231a34e.js";import{_ as he}from"./UserDrawer.vue_vue_type_script_setup_true_lang.94ea82ae.js";import{_ as De}from"./UserRecycleBinModal.vue_vue_type_script_setup_true_lang.9bdcd050.js";import{_ as xe}from"./PasswordModal.vue_vue_type_script_name_PassWordModal_setup_true_lang.6784561e.js";import{_ as Se}from"./UserAgentModal.vue_vue_type_script_setup_true_lang.226b80e6.js";import{Z as ce,eU as oe,j as O,r as C,s as y,Q as b,w as s,v as u,y as r,z as H,R as M,C as ve,m as ue,a2 as N,eV as Re,h as K,t as Q,x as ae,eW as se,K as a,ax as re,u as pe,q as Ie,bI as W}from"./index.6a7efbe3.js";import{a as $e}from"./index.28bdf088.js";import{useListPage as Me}from"./useListPage.842690ee.js";import"./index.822d1710.js";import{c as Le,s as Ue}from"./user.data.b3799516.js";import{l as je,k as ze,m as Pe,n as He,o as ie,q as Ke,r as Oe}from"./user.api.4611beb8.js";import"./BasicForm.ab69c67e.js";import"./BasicForm.vue_vue_type_style_index_0_lang.4acc0ae5.js";import"./uniqBy.a5e87f30.js";import"./BasicModal.f1c6156c.js";import"./useWindowSizeFn.72beb258.js";import"./useFormItem.4f7a482e.js";import"./functional.c227bbf0.js";import"./download.cf4e2a37.js";import"./base64Conver.030fa32c.js";import"./index.5a104c34.js";import"./index.f3fd295f.js";import"./useCountdown.d242c107.js";import"./JAddInput.17bd90fa.js";import"./api.1e452fdf.js";import"./props.0baa8d7a.js";import"./index.537529b2.js";import"./bem.eeb2727a.js";import"./props.bc04623e.js";import"./useContextMenu.8c78c4b7.js";import"./index.37a0b782.js";import"./onMountedOrActivated.27cc229d.js";import"./index.6249ac4b.js";import"./htmlmixed.3b33a315.js";import"./vue.f7a22e37.js";/* empty css             */import"./depart.api.b737ba44.js";import"./JUpload.vue_vue_type_style_index_0_lang.c6a005ca.js";import"./index.d0296e16.js";import"./useForm.7ab6626f.js";import"./index.af97c29e.js";import"./useContentHeight.285b1f65.js";import"./useContentViewHeight.191b4cfd.js";import"./usePageContext.4c6e0959.js";import"./RedoOutlined.2566f871.js";import"./useAdaptiveWidth.f348e1d8.js";import"./useTable.c0cc0d1f.js";import"./validator.6004a6ca.js";import"./renderUtils.2b2fd450.js";const de={getEnabledType:"/sys/thirdApp/getEnabledType",wechatEnterprise:{user:"/sys/thirdApp/sync/wechatEnterprise/user",depart:"/sys/thirdApp/sync/wechatEnterprise/depart"},dingtalk:{user:"/sys/thirdApp/sync/dingtalk/user",depart:"/sys/thirdApp/sync/dingtalk/depart"}};let X=null;const Je=()=>w(void 0,null,function*(){if(X!=null)return oe(X);{let{success:n,result:t}=yield ce.get({url:de.getEnabledType},{isTransformResponse:!1});if(n)return X=oe(t),t;console.warn("getEnabledType\u67E5\u8BE2\u5931\u8D25\uFF1A")}return{}}),le=O({__name:"JThirdAppDropdown",props:{type:String,name:String,syncToApp:Boolean,syncToLocal:Boolean},emits:["to-app","to-local"],setup(n,{emit:t}){const o=n;function f(g){t(g.key,{type:o.type})}return(g,l)=>{const B=C("a-button"),p=C("a-menu-item"),i=C("a-menu"),_=C("a-dropdown");return n.syncToApp&&n.syncToLocal?(y(),b(_,{key:0},{overlay:s(()=>[u(i,{onClick:f},{default:s(()=>[n.syncToApp?(y(),b(p,{key:"to-app"},{default:s(()=>[r("\u540C\u6B65\u5230"+H(n.name),1)]),_:1})):M("",!0),n.syncToLocal?(y(),b(p,{key:"to-local"},{default:s(()=>[r("\u540C\u6B65\u5230\u672C\u5730")]),_:1})):M("",!0)]),_:1})]),default:s(()=>[u(B,{type:"primary",preIcon:"ant-design:sync-outlined"},{default:s(()=>[r("\u540C\u6B65"+H(n.name),1)]),_:1})]),_:1})):n.syncToApp?(y(),b(B,{key:1,type:"primary",preIcon:"ant-design:sync-outlined",onClick:l[0]||(l[0]=D=>f({key:"to-app"}))},{default:s(()=>[r("\u540C\u6B65"+H(n.name),1)]),_:1})):(y(),b(B,{key:2,type:"primary",preIcon:"ant-design:sync-outlined",onClick:l[1]||(l[1]=D=>f({key:"to-local"}))},{default:s(()=>[r("\u540C\u6B65"+H(n.name)+"\u5230\u672C\u5730",1)]),_:1}))}}}),Ve=O({__name:"JThirdAppButton",props:{bizType:{type:String,required:!0},syncToApp:Boolean,syncToLocal:Boolean,selectedRowKeys:Array},emits:["sync-ok","sync-error","sync-finally"],setup(n,{emit:t}){const o=n,{createMessage:f,createWarningModal:g}=pe(),l=ve({}),B=ue(()=>({syncToApp:o.syncToApp,syncToLocal:o.syncToLocal})),p=ue(()=>({"to-app":i,"to-local":_}));function i(d){J(d.type,"/toApp")}function _(d){J(d.type,"/toLocal")}function D(){return w(this,null,function*(){l.value=yield Je()})}function J(d,E){let x=de[d];if(!(x&&x[o.bizType])){console.warn("\u914D\u7F6E\u51FA\u9519");return}let m=x[o.bizType]+E,T=o.selectedRowKeys,U="\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u5168\u90E8\u6570\u636E\u5417\uFF1F\u53EF\u80FD\u82B1\u8D39\u8F83\u957F\u65F6\u95F4\uFF01";return Array.isArray(T)&&T.length>0?U=`\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u8FD9 ${T.length} \u9879\u5417\uFF1F`:T=[],new Promise((S,h)=>{const j=N.confirm({icon:u(Re),title:"\u540C\u6B65",content:U,onOk:()=>{j.update({keyboard:!1,okText:"\u540C\u6B65\u4E2D\u2026",cancelButtonProps:{disabled:!0}});let V={ids:T.join(",")};return ce.get({url:m,params:V},{isTransformResponse:!1}).then(F=>{let A={};F.result&&(A={width:600,title:F.message,content:()=>{let v,z=["\u6210\u529F\u4FE1\u606F\u5982\u4E0B\uFF1A",L(K,F.result.successInfo.map((R,I)=>`${I+1}. ${R}`).join(`
`))];return F.success?v=[...z,K("br"),"\u65E0\u5931\u8D25\u4FE1\u606F\uFF01"]:v=["\u5931\u8D25\u4FE1\u606F\u5982\u4E0B\uFF1A",L(K,F.result.failInfo.map((R,I)=>`${I+1}. ${R}`).join(`
`)),K("br"),...z],v}}),F.success?(A!=null?N.success(A):f.warning(F.message),t("sync-ok")):(A!=null?N.warning(A):f.warning(F.message),t("sync-error"))}).catch(()=>j.destroy()).finally(()=>{S(),t("sync-finally",{type:d,direction:E,isToApp:E==="/toApp",isToLocal:E==="/toLocal"})})},onCancel(){S()}})})}function L(d,E){return d("div",{id:"box",style:{minHeight:"100px",border:"1px solid #d9d9d9",fontSize:"14px",maxHeight:"250px",whiteSpace:"pre",overflow:"auto",padding:"10px"}},E)}return D(),(d,E)=>n.syncToApp||n.syncToLocal?(y(),Q(re,{key:0},[l.value.wechatEnterprise?(y(),b(le,ae({key:0,type:"wechatEnterprise",name:"\u4F01\u5FAE"},a(B),se(a(p))),null,16)):M("",!0),l.value.dingtalk?(y(),b(le,ae({key:1,type:"dingtalk",name:"\u9489\u9489"},a(B),se(a(p))),null,16)):M("",!0)],64)):(y(),Q(re,{key:1},[r("\u672A\u8BBE\u7F6E\u4EFB\u4F55\u540C\u6B65\u65B9\u5411")],64))}});const qe=Ie(Ve,[["__scopeId","data-v-d8023e59"]]),Ne=O({name:"system-user"}),Wn=O(te(ne({},Ne),{setup(n){const{createMessage:t,createConfirm:o}=pe(),[f,{openDrawer:g}]=$e(),[l,{openModal:B}]=W(),[p,{openModal:i}]=W(),[_,{openModal:D}]=W(),{prefixCls:J,tableContext:L,onExportXls:d,onImportXls:E}=Me({designScope:"user-list",tableProps:{title:"\u7528\u6237\u5217\u8868",api:je,columns:Le,size:"small",formConfig:{schemas:Ue},actionColumn:{width:120},beforeFetch:e=>Object.assign({column:"createTime",order:"desc"},e)},exportConfig:{name:"\u7528\u6237\u5217\u8868",url:ze},importConfig:{url:Pe}}),[x,{reload:m,updateTableDataRecord:T},{rowSelection:U,selectedRows:S,selectedRowKeys:h}]=L;function j(){g(!0,{isUpdate:!1,showFooter:!0})}function V(e){return w(this,null,function*(){g(!0,{record:e,isUpdate:!0,showFooter:!0})})}function F(e){return w(this,null,function*(){g(!0,{record:e,isUpdate:!0,showFooter:!1})})}function A(e){return w(this,null,function*(){if(e.username=="admin"){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield Oe({id:e.id},m)})}function v(){return w(this,null,function*(){let e=a(S).filter(c=>c.username=="admin");if(a(e).length>0){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield He({ids:h.value},()=>{h.value=[],m()})})}function z(){m()}function R(e){i(!0,{username:e})}function I(e){D(!0,{userName:e})}function Z(e,c){return w(this,null,function*(){if(e.username=="admin"){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield ie({ids:e.id,status:c},m)})}function G(e){let c=S.value.filter(k=>k.username=="admin");if(a(c).length>0){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}o({iconType:"warning",title:"\u786E\u8BA4\u64CD\u4F5C",content:"\u662F\u5426"+(e==1?"\u89E3\u51BB":"\u51BB\u7ED3")+"\u9009\u4E2D\u8D26\u53F7?",onOk:()=>w(this,null,function*(){yield ie({ids:a(h).join(","),status:e},m)})})}function me(){Ke()}function ye({isToLocal:e}){e&&m()}function fe(e){return[{label:"\u7F16\u8F91",onClick:V.bind(null,e)}]}function ge(e){return[{label:"\u8BE6\u60C5",onClick:F.bind(null,e)},{label:"\u5BC6\u7801",onClick:R.bind(null,e.username)},{label:"\u5220\u9664",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664",confirm:A.bind(null,e)}},{label:"\u51BB\u7ED3",ifShow:e.status==1,popConfirm:{title:"\u786E\u5B9A\u51BB\u7ED3\u5417?",confirm:Z.bind(null,e,2)}},{label:"\u89E3\u51BB",ifShow:e.status==2,popConfirm:{title:"\u786E\u5B9A\u89E3\u51BB\u5417?",confirm:Z.bind(null,e,1)}},{label:"\u4EE3\u7406\u4EBA",onClick:I.bind(null,e.username)}]}return(e,c)=>{const k=C("a-button"),Be=C("j-upload-button"),P=C("Icon"),q=C("a-menu-item"),Fe=C("a-menu"),Ce=C("a-dropdown");return y(),Q("div",null,[u(a(ke),{onRegister:a(x),rowSelection:a(U)},{tableTitle:s(()=>[u(k,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:j},{default:s(()=>[r(" \u65B0\u589E")]),_:1}),u(k,{type:"primary",preIcon:"ant-design:export-outlined",onClick:a(d)},{default:s(()=>[r(" \u5BFC\u51FA")]),_:1},8,["onClick"]),u(Be,{type:"primary",preIcon:"ant-design:import-outlined",onClick:a(E)},{default:s(()=>[r("\u5BFC\u5165")]),_:1},8,["onClick"]),u(k,{type:"primary",onClick:me,preIcon:"ant-design:sync-outlined"},{default:s(()=>[r(" \u540C\u6B65\u6D41\u7A0B")]),_:1}),u(k,{type:"primary",onClick:c[0]||(c[0]=$=>a(B)(!0,{})),preIcon:"ant-design:hdd-outlined"},{default:s(()=>[r(" \u56DE\u6536\u7AD9")]),_:1}),u(qe,{"biz-type":"user","selected-row-keys":a(h),syncToApp:"",syncToLocal:"",onSyncFinally:ye},null,8,["selected-row-keys"]),a(h).length>0?(y(),b(Ce,{key:0},{overlay:s(()=>[u(Fe,null,{default:s(()=>[u(q,{key:"1",onClick:v},{default:s(()=>[u(P,{icon:"ant-design:delete-outlined"}),r(" \u5220\u9664 ")]),_:1}),u(q,{key:"2",onClick:c[1]||(c[1]=$=>G(2))},{default:s(()=>[u(P,{icon:"ant-design:lock-outlined"}),r(" \u51BB\u7ED3 ")]),_:1}),u(q,{key:"3",onClick:c[2]||(c[2]=$=>G(1))},{default:s(()=>[u(P,{icon:"ant-design:unlock-outlined"}),r(" \u89E3\u51BB ")]),_:1})]),_:1})]),default:s(()=>[u(k,null,{default:s(()=>[r("\u6279\u91CF\u64CD\u4F5C "),u(P,{icon:"mdi:chevron-down"})]),_:1})]),_:1})):M("",!0)]),action:s(({record:$})=>[u(a(Te),{actions:fe($),dropDownActions:ge($)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),u(he,{onRegister:a(f),onSuccess:z},null,8,["onRegister"]),u(xe,{onRegister:a(p),onSuccess:a(m)},null,8,["onRegister","onSuccess"]),u(Se,{onRegister:a(_),onSuccess:a(m)},null,8,["onRegister","onSuccess"]),u(De,{onRegister:a(l),onSuccess:a(m)},null,8,["onRegister","onSuccess"])])}}}));export{Wn as default};
