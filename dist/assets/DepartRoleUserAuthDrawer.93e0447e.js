var e=(e,a,l)=>new Promise(((u,t)=>{var n=e=>{try{r(l.next(e))}catch(a){t(a)}},s=e=>{try{r(l.throw(e))}catch(a){t(a)}},r=e=>e.done?u(e.value):Promise.resolve(e.value).then(n,s);r((l=l.apply(e,a)).next())}));import{u as a,B as l}from"./index.65c1cb1a.js";import{e as u,f as t,g as n}from"./depart.user.api.9a50a652.js";import{l as s,F as r,L as o,t as i,v,V as d,z as p,y as c,x as f,ax as m,bc as y,C as g,D as h,aW as x}from"./index.435ab247.js";const I={style:{width:"100%","margin-top":"15px"}},_=x("span",null,"点击保存",-1),w=s({__name:"DepartRoleUserAuthDrawer",emits:["register"],setup(s){const w=r(!1),b=r(""),j=r(""),k=r(""),R=r([]),D=r([]),[C,{closeDrawer:P}]=a((a=>{b.value=o(a.userId),j.value=o(a.departId),function(){e(this,null,(function*(){try{w.value=!0;const e={departId:j.value,userId:b.value},[a,l]=yield Promise.all([u(e),t(e)]);R.value=a,D.value=l.map((e=>e.droleId)),k.value=D.value.join(",")}finally{w.value=!1}}))}()}));function z(){return e(this,null,(function*(){try{w.value=!0,yield n({userId:b.value,newRoleId:D.value.join(","),oldRoleId:k.value}),A(),P()}finally{w.value=!1}}))}function U(){A()}function A(){b.value="",j.value="",k.value="",R.value=[],D.value=[]}return(e,a)=>{const u=i("a-checkbox"),t=i("a-col"),n=i("a-row"),s=i("a-checkbox-group"),r=i("a-button"),b=i("a-empty"),j=i("a-spin");return v(),d(o(l),{title:"部门角色分配",width:365,onClose:U,onRegister:o(C)},{default:p((()=>[c(j,{spinning:w.value},{default:p((()=>[R.value.length>0?(v(),f(m,{key:0},[c(s,{value:D.value,"onUpdate:value":a[0]||(a[0]=e=>D.value=e)},{default:p((()=>[c(n,null,{default:p((()=>[(v(!0),f(m,null,y(R.value,(e=>(v(),d(t,{span:24},{default:p((()=>[c(u,{value:e.id},{default:p((()=>[g(h(e.roleName),1)])),_:2},1032,["value"])])),_:2},1024)))),256))])),_:1})])),_:1},8,["value"]),x("div",I,[c(r,{type:"primary",loading:w.value,size:"small",preIcon:"ant-design:save-filled",onClick:z},{default:p((()=>[_])),_:1},8,["loading"])])],64)):(v(),d(b,{key:1,description:"无配置信息"}))])),_:1},8,["spinning"])])),_:1},8,["onRegister"])}}});export{w as default};
