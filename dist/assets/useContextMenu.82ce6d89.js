var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l;import{l as a,F as c,o as i,$ as u,Q as d,ag as p,L as m,y,be as b,bZ as f,b7 as v,ax as h,I as x,cD as O,cE as j,a6 as w}from"./index.435ab247.js";const E={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}},g=e=>{const{item:t}=e;return y("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&y(x,{class:"mr-2",icon:t.icon},null),y("span",null,[t.label])])};var L=a({name:"ContextMenu",props:E,setup(e){const a=c(null),x=c(!1),O=i((()=>{const{axis:a,items:c,styles:i,width:u}=e,{x:d,y:p}=a||{x:0,y:0},m=40*(c||[]).length,y=u,b=document.body,f=b.clientWidth<d+y?d-y:d,v=b.clientHeight<p+m?p-m:p;return h=((e,t)=>{for(var n in t||(t={}))o.call(t,n)&&r(e,n,t[n]);if(l)for(var n of l(t))s.call(t,n)&&r(e,n,t[n]);return e})({},i),t(h,n({width:`${u}px`,left:`${f+1}px`,top:`${v+1}px`}));var h}));function j(e,t){const{handler:n,disabled:l}=e;l||(x.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function w(t){return t.map((t=>{const{disabled:n,label:l,children:o,divider:s=!1}=t,r={item:t,handler:j,showIcon:e.showIcon};return o&&0!==o.length?m(x)?y(b.SubMenu,{key:l,disabled:n,popupClassName:"context-menu__popup"},{title:()=>y(g,r,null),default:()=>w(o)}):null:y(h,null,[y(b.Item,{disabled:n,class:"context-menu__item",key:l},{default:()=>[y(g,r,null)]}),s?y(v,{key:`d-${l}`},null):null])}))}return u((()=>{d((()=>x.value=!0))})),p((()=>{const e=m(a);e&&document.body.removeChild(e)})),()=>{let t;if(!m(x))return null;const{items:n}=e;return y(b,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:a,style:m(O)},"function"==typeof(l=t=w(n))||"[object Object]"===Object.prototype.toString.call(l)&&!f(l)?t:{default:()=>[t]});var l}}});const I={domList:[],resolve:()=>{}},k=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),O)return new Promise((n=>{const l=document.body,o=document.createElement("div"),s={};e.styles&&(s.styles=e.styles),e.items&&(s.items=e.items),e.event&&(s.customEvent=t,s.axis={x:t.clientX,y:t.clientY});const r=y(L,s);j(r,o);const a=function(){I.resolve("")};I.domList.push(o);const c=function(){I.domList.forEach((e=>{try{e&&l.removeChild(e)}catch(t){}})),l.removeEventListener("click",a),l.removeEventListener("scroll",a)};I.resolve=function(e){c(),n(e)},c(),l.appendChild(o),l.addEventListener("click",a),l.addEventListener("scroll",a)}))},P=function(){I&&(I.resolve(""),I.domList=[])};function C(e=!0){return w()&&e&&p((()=>{P()})),[k,P]}export{C as useContextMenu};
