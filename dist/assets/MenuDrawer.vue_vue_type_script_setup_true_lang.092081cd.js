var W=Object.defineProperty;var D=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var v=(o,t,s)=>t in o?W(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s,B=(o,t)=>{for(var s in t||(t={}))E.call(t,s)&&v(o,s,t[s]);if(D)for(var s of D(t))R.call(t,s)&&v(o,s,t[s]);return o};var w=(o,t,s)=>new Promise((d,i)=>{var u=a=>{try{p(s.next(a))}catch(m){i(m)}},l=a=>{try{p(s.throw(a))}catch(m){i(m)}},p=a=>a.done?d(a.value):Promise.resolve(a.value).then(u,l);p((s=s.apply(o,t)).next())});import{B as S}from"./BasicForm.db954593.js";import"./componentMap.74ba49ed.js";import{u as T}from"./useForm.dcf14658.js";import"./JAddInput.fad0e12a.js";import{j as k,eq as x,C as _,K as r,m as I,s as L,Q as V,w as j,v as q,x as M}from"./index.c12ded7f.js";import{f as N,l as O,C as $,g as G}from"./menu.data.f103fe45.js";import{u as K,B as Q}from"./index.f9f5103d.js";import{useDrawerAdaptiveWidth as z}from"./useAdaptiveWidth.bab82e72.js";const ae=k({__name:"MenuDrawer",emits:["success","register"],setup(o,{emit:t}){const{adaptiveWidth:s}=z(),d=x(),i=_(!0),u=_(0),l=e=>e===2,[p,{setProps:a,resetFields:m,setFieldsValue:g,updateSchema:F,validate:y,clearValidate:H}]=T({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:N,showActionButtonGroup:!1}),[b,{setDrawerProps:h,closeDrawer:A}]=K(e=>w(this,null,function*(){var n;yield m(),h({confirmLoading:!1}),i.value=!!(e!=null&&e.isUpdate),u.value=(n=e==null?void 0:e.record)==null?void 0:n.menuType;const c=yield O();if(F([{field:"parentId",componentProps:{treeData:c}},{field:"name",label:l(r(u))?"\u6309\u94AE/\u6743\u9650":"\u83DC\u5355\u540D\u79F0"},{field:"url",required:!l(r(u)),componentProps:{onChange:f=>C(f.target.value)}}]),typeof e.record=="object"){let f=B({},e.record);g(f),C(f.url)}a({disabled:!d.showFooter})})),P=I(()=>r(i)?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355");function U(){return w(this,null,function*(){try{const e=yield y();$.IFrame===e.component&&(e.component=e.frameSrc),h({confirmLoading:!0}),yield G(e,r(i)),A(),t("success")}finally{h({confirmLoading:!1})}})}function C(e){let c="",n=e;e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),c=`${e}`):c="\u8BF7\u8F93\u5165\u7EC4\u4EF6\u540D\u79F0",F([{field:"componentName",componentProps:{placeholder:c}}]),n!=null&&n!=""&&(n.startsWith("http://")||n.startsWith("https://"))&&g({component:n})}return(e,c)=>(L(),V(r(Q),M(e.$attrs,{onRegister:r(b),showFooter:"",width:r(s),title:r(P),onOk:U}),{default:j(()=>[q(r(S),{onRegister:r(p),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{ae as _};
