var f=(D,x,p)=>new Promise((i,u)=>{var l=n=>{try{c(p.next(n))}catch(o){u(o)}},y=n=>{try{c(p.throw(n))}catch(o){u(o)}},c=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,y);c((p=p.apply(D,x)).next())});import{a as M}from"./index.1aa39cfc.js";import{_ as O}from"./index.201afc50.js";import{_ as Q}from"./DepartDataRuleDrawer.vue_vue_type_script_setup_true_lang.bddf9ac6.js";import{c as W,e as G,f as J}from"./depart.api.ef5d901e.js";import{j as U,l as X,m as Y,C as r,E as Z,M as w,r as d,s as g,t as ee,v as t,w as a,Q as h,H as E,aW as K,z as te,R as ae,B as ne,y as m,ax as oe,q as se}from"./index.c1d8dbc8.js";import"./bem.452cc75b.js";import"./props.82dd77cc.js";import"./useContextMenu.184539a6.js";const le={class:"j-box-bottom-button offset-20",style:{"margin-top":"30px"}},ue=U({__name:"DepartRuleTab",props:{data:{type:Object,default:()=>({})}},setup(D){const x=D,{prefixCls:p}=X("j-depart-form-content"),i=Y(()=>{var e;return(e=x.data)==null?void 0:e.id}),u=r(),l=r(!1),y=r([]),c=r([]),n=r([]),o=r([]),I=r([]),$=r(!0),[A,B]=M();R(),Z(i,()=>F(),{immediate:!0});function R(){return f(this,null,function*(){try{l.value=!0;let{treeList:e}=yield W();y.value=e,yield w(),C(!0)}finally{l.value=!1}})}function F(){return f(this,null,function*(){if(i.value)try{l.value=!0;let e=yield G({departId:i.value});o.value=e,I.value=[...e]}finally{l.value=!1}})}function S(){return f(this,null,function*(){try{l.value=!0,yield J({departId:i.value,permissionIds:o.value.join(","),lastpermissionIds:I.value.join(",")}),yield R(),yield F()}finally{l.value=!1}})}function L(e){Array.isArray(e)?o.value=e:o.value=e.checked}function N(e){c.value=e}function V(e,{selectedNodes:s}){var _;if((_=s[0])!=null&&_.ruleFlag){let b=e[0];B.openDrawer(!0,{departId:i,functionId:b})}n.value=[]}function C(e){return f(this,null,function*(){u.value.expandAll(e),yield w(),c.value=u.value.getExpandedKeys()})}function T(e){return f(this,null,function*(){u.value.checkAll(e),yield w(),o.value=u.value.getCheckedKeys()})}return(e,s)=>{const _=d("Icon"),b=d("a-empty"),k=d("a-menu-item"),q=d("a-menu"),j=d("a-button"),P=d("a-dropdown"),z=d("a-spin");return g(),ee(oe,null,[t(z,{spinning:l.value},{default:a(()=>[y.value.length>0?(g(),h(E(O),{key:0,ref_key:"basicTree",ref:u,class:"depart-rule-tree",checkable:"",treeData:y.value,checkedKeys:o.value,selectedKeys:n.value,expandedKeys:c.value,checkStrictly:$.value,style:{height:"500px",overflow:"auto"},onCheck:L,onExpand:N,onSelect:V},{title:a(({slotTitle:v,ruleFlag:H})=>[K("span",null,te(v),1),H?(g(),h(_,{key:0,icon:"ant-design:align-left-outlined",style:{"margin-left":"5px",color:"red"}})):ae("",!0)]),_:1},8,["treeData","checkedKeys","selectedKeys","expandedKeys","checkStrictly"])):(g(),h(b,{key:1,description:"\u65E0\u53EF\u914D\u7F6E\u90E8\u95E8\u6743\u9650"})),K("div",le,[K("div",{class:ne(["j-box-bottom-button-float",[`${E(p)}`]])},[t(P,{trigger:["click"],placement:"top"},{overlay:a(()=>[t(q,null,{default:a(()=>[t(k,{key:"3",onClick:s[0]||(s[0]=v=>T(!0))},{default:a(()=>[m("\u5168\u90E8\u52FE\u9009")]),_:1}),t(k,{key:"4",onClick:s[1]||(s[1]=v=>T(!1))},{default:a(()=>[m("\u53D6\u6D88\u5168\u9009")]),_:1}),t(k,{key:"5",onClick:s[2]||(s[2]=v=>C(!0))},{default:a(()=>[m("\u5C55\u5F00\u6240\u6709")]),_:1}),t(k,{key:"6",onClick:s[3]||(s[3]=v=>C(!1))},{default:a(()=>[m("\u6536\u8D77\u6240\u6709")]),_:1})]),_:1})]),default:a(()=>[t(j,{style:{float:"left"}},{default:a(()=>[m(" \u6811\u64CD\u4F5C "),t(_,{icon:"ant-design:up-outlined"})]),_:1})]),_:1}),t(j,{type:"primary",preIcon:"ant-design:save-filled",onClick:S},{default:a(()=>[m("\u4FDD\u5B58")]),_:1})],2)])]),_:1},8,["spinning"]),t(Q,{onRegister:E(A)},null,8,["onRegister"])],64)}}});const ve=se(ue,[["__scopeId","data-v-92cad6be"]]);export{ve as default};
