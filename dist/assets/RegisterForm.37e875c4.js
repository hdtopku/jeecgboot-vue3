var k=(x,i,d)=>new Promise((o,m)=>{var g=r=>{try{f(d.next(r))}catch(c){m(c)}},p=r=>{try{f(d.throw(r))}catch(c){m(c)}},f=r=>r.done?o(r.value):Promise.resolve(r.value).then(g,p);f((d=d.apply(x,i)).next())});import _ from"./LoginFormTitle.23e3917e.js";import{l as F,bY as b,az as y,s as P,d_ as M,F as C,a7 as T,d$ as U,o as B,L as e,e4 as L,v as D,x as N,y as a,z as n,aD as V,C as v,D as w,cG as h,av as G,W as $,ed as A,ab as W,dc as Y,e1 as j,u as q,e2 as H}from"./index.6c1aeca2.js";import{S as J}from"./index.1785e33e.js";import{C as K}from"./index.9d763a26.js";import"./useCountdown.c7fbe84b.js";import"./useFormItem.63b4eda3.js";const oe=F({__name:"RegisterForm",setup(x){const i=b.Item,d=y.Password,{t:o}=P(),{handleBackLogin:m,getLoginState:g}=M(),{notification:p,createErrorModal:f}=q(),r=C(),c=C(!1),l=T({account:"",password:"",confirmPassword:"",mobile:"",sms:"",policy:!1}),{getFormRules:R}=U(l),{validForm:S}=H(r),z=B(()=>e(g)===L.REGISTER);function E(){return k(this,null,function*(){const u=yield S();if(!!u)try{c.value=!0;const s=yield A(W({username:u.account,password:u.password,phone:u.mobile,smscode:u.sms}));s&&s.data.success?(p.success({description:s.data.message||o("sys.api.registerMsg"),duration:3}),m()):p.warning({message:o("sys.api.errorTip"),description:s.data.message||o("sys.api.networkExceptionMsg"),duration:3})}catch(s){p.error({message:o("sys.api.errorTip"),description:s.message||o("sys.api.networkExceptionMsg"),duration:3})}finally{c.value=!1}})}function I(){return Y({mobile:l.mobile,smsmode:j.REGISTER})}return(u,s)=>e(z)?(D(),N(G,{key:0},[a(_,{class:"enter-x"}),a(e(b),{class:"p-4 enter-x",model:l,rules:e(R),ref_key:"formRef",ref:r},{default:n(()=>[a(e(i),{name:"account",class:"enter-x"},{default:n(()=>[a(e(y),{class:"fix-auto-fill",size:"large",value:l.account,"onUpdate:value":s[0]||(s[0]=t=>l.account=t),placeholder:e(o)("sys.login.userName")},null,8,["value","placeholder"])]),_:1}),a(e(i),{name:"mobile",class:"enter-x"},{default:n(()=>[a(e(y),{size:"large",value:l.mobile,"onUpdate:value":s[1]||(s[1]=t=>l.mobile=t),placeholder:e(o)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),a(e(i),{name:"sms",class:"enter-x"},{default:n(()=>[a(e(K),{size:"large",class:"fix-auto-fill",value:l.sms,"onUpdate:value":s[2]||(s[2]=t=>l.sms=t),placeholder:e(o)("sys.login.smsCode"),sendCodeApi:I},null,8,["value","placeholder"])]),_:1}),a(e(i),{name:"password",class:"enter-x"},{default:n(()=>[a(e(J),{size:"large",value:l.password,"onUpdate:value":s[3]||(s[3]=t=>l.password=t),placeholder:e(o)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),a(e(i),{name:"confirmPassword",class:"enter-x"},{default:n(()=>[a(e(d),{size:"large",visibilityToggle:"",value:l.confirmPassword,"onUpdate:value":s[4]||(s[4]=t=>l.confirmPassword=t),placeholder:e(o)("sys.login.confirmPassword")},null,8,["value","placeholder"])]),_:1}),a(e(i),{class:"enter-x",name:"policy"},{default:n(()=>[a(e(V),{checked:l.policy,"onUpdate:checked":s[5]||(s[5]=t=>l.policy=t),size:"small"},{default:n(()=>[v(w(e(o)("sys.login.policy")),1)]),_:1},8,["checked"])]),_:1}),a(e(h),{type:"primary",class:"enter-x",size:"large",block:"",onClick:E,loading:c.value},{default:n(()=>[v(w(e(o)("sys.login.registerButton")),1)]),_:1},8,["loading"]),a(e(h),{size:"large",block:"",class:"mt-4 enter-x",onClick:e(m)},{default:n(()=>[v(w(e(o)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1},8,["model","rules"])],64)):$("",!0)}});export{oe as default};
