var v=Object.defineProperty;var y=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var F=(n,t,e)=>t in n?v(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,f=(n,t)=>{for(var e in t||(t={}))D.call(t,e)&&F(n,e,t[e]);if(y)for(var e of y(t))E.call(t,e)&&F(n,e,t[e]);return n};var B=(n,t,e)=>new Promise((c,l)=>{var p=s=>{try{u(e.next(s))}catch(i){l(i)}},m=s=>{try{u(e.throw(s))}catch(i){l(i)}},u=s=>s.done?c(s.value):Promise.resolve(s.value).then(p,m);u((e=e.apply(n,t)).next())});import{B as h}from"./index.5f6d2eec.js";import{B as w}from"./BasicForm.763c9f74.js";import"./componentMap.995605ed.js";import{u as A}from"./useForm.4b03a18a.js";import"./JAddInput.c425dfe6.js";import{j as M,C as k,bH as P,H as r,e2 as x,m as I,r as R,s as S,Q as U,w as C,v as _,y as V,x as H,e1 as L,e3 as O,d_ as T}from"./index.c1d8dbc8.js";import{s as j}from"./page.api.4b24c6a8.js";const Y=[{label:"\u540D\u79F0",field:"name",component:"Input",colProps:{span:6}}],q=[{label:"",field:"id",component:"Input",show:!1},{label:"\u540D\u79F0",field:"name",component:"Input",required:!0},{label:"\u5C01\u9762\u56FE",field:"coverUrl",component:"JImageUpload",componentProps:{fileMax:1}},{label:"\u5206\u7C7B",field:"type",component:"Select",defaultValue:"1",required:!0,componentProps:{options:[{label:"\u4EEA\u8868\u76D8\u8BBE\u8BA1",value:"1",key:"1"},{label:"\u95E8\u6237\u8BBE\u8BA1\u5668",value:"2",key:"2"}]}},{label:"\u4FDD\u62A4\u7801",field:"protectionCode",component:"StrengthMeter"}],Z=M({__name:"PageModal",emits:["success","register"],setup(n,{emit:t}){const e=k(!0),[c,{resetFields:l,setFieldsValue:p,validate:m}]=A({schemas:q,showActionButtonGroup:!1}),[u,{setModalProps:s,closeModal:i}]=P(a=>B(this,null,function*(){if(yield l(),s({confirmLoading:!1}),e.value=!!(a!=null&&a.isUpdate),r(e)){let o=f({},a.record);o.protectionCode&&o.protectionCode.length>0&&(o.protectionCode=x(o.protectionCode)),yield p(f({},o))}})),b=I(()=>r(e)?"\u7F16\u8F91":"\u65B0\u589E");function g(a=0){return B(this,null,function*(){try{const o=yield m();s({confirmLoading:!0}),o.protectionCode&&(o.protectionCode=L(o.protectionCode));const d=yield j(o,e.value);o.id&&O(T.DRAG_CACHE_PREFIX+o.id),i(),t("success",a===1?d:null)}finally{s({confirmLoading:!1})}})}return(a,o)=>{const d=R("a-button");return S(),U(r(h),H(a.$attrs,{onRegister:r(u),okText:"\u4FDD\u5B58",title:b.value,onOk:g,width:700,destroyOnClose:""}),{appendFooter:C(()=>[_(d,{type:"primary",onClick:o[0]||(o[0]=G=>g(1))},{default:C(()=>[V("\u4FDD\u5B58\u5E76\u8BBE\u8BA1")]),_:1})]),default:C(()=>[_(r(w),{onRegister:r(c)},null,8,["onRegister"])]),_:1},16,["onRegister","title"])}}});export{Z as _,Y as s};
