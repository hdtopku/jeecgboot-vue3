import{u as a,B as e}from"./index.32c2f26d.js";import{e as t,f as l}from"./depart.api.c295d6d2.js";import{l as n,F as u,L as s,t as r,v as i,V as d,z as o,y as v,x as p,bc as c,C as f,D as m,ax as y,aW as _}from"./index.26a57b91.js";const g={style:{width:"100%","margin-top":"15px"}},h=_("span",null,"点击保存",-1),x=n({__name:"DepartDataRuleDrawer",emits:["register"],setup(n){const x=u(!1),b=u(""),k=u(""),w=u([]),I=u([]),[D,{closeDrawer:j}]=a((a=>{b.value=s(a.departId),k.value=s(a.functionId),function(){return a=this,e=null,l=function*(){try{x.value=!0;const{datarule:a,drChecked:e}=yield t(k,b);w.value=a,e&&(I.value=e.split(","))}finally{x.value=!1}},new Promise(((t,n)=>{var u=a=>{try{r(l.next(a))}catch(e){n(e)}},s=a=>{try{r(l.throw(a))}catch(e){n(e)}},r=a=>a.done?t(a.value):Promise.resolve(a.value).then(u,s);r((l=l.apply(a,e)).next())}));var a,e,l}()}));function C(){let a={departId:b.value,permissionId:k.value,dataRuleIds:I.value.join(",")};l(a)}function R(){k.value="",w.value=[],I.value=[]}return(a,t)=>{const l=r("a-checkbox"),n=r("a-col"),u=r("a-button"),b=r("a-row"),k=r("a-checkbox-group"),j=r("a-empty"),z=r("a-tab-pane"),P=r("a-tabs"),A=r("a-spin");return i(),d(s(e),{title:"数据规则/按钮权限配置",width:365,onClose:R,onRegister:s(D)},{default:o((()=>[v(A,{spinning:x.value},{default:o((()=>[v(P,{defaultActiveKey:"1"},{default:o((()=>[v(z,{tab:"数据规则",key:"1"},{default:o((()=>[w.value.length>0?(i(),d(k,{key:0,value:I.value,"onUpdate:value":t[0]||(t[0]=a=>I.value=a)},{default:o((()=>[v(b,null,{default:o((()=>[(i(!0),p(y,null,c(w.value,((a,e)=>(i(),d(n,{span:24,key:"dr"+e},{default:o((()=>[v(l,{value:a.id},{default:o((()=>[f(m(a.ruleName),1)])),_:2},1032,["value"])])),_:2},1024)))),128)),v(n,{span:24},{default:o((()=>[_("div",g,[v(u,{type:"primary",loading:x.value,size:"small",preIcon:"ant-design:save-filled",onClick:C},{default:o((()=>[h])),_:1},8,["loading"])])])),_:1})])),_:1})])),_:1},8,["value"])):(i(),d(j,{key:1,description:"无配置信息"}))])),_:1})])),_:1})])),_:1},8,["spinning"])])),_:1},8,["onRegister"])}}});export{x as default};
