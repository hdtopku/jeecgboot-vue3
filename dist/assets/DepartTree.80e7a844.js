var h=(v,f,r)=>new Promise((l,n)=>{var p=t=>{try{c(r.next(t))}catch(u){n(u)}},i=t=>{try{c(r.throw(t))}catch(u){n(u)}},c=t=>t.done?l(t.value):Promise.resolve(t.value).then(p,i);c((r=r.apply(v,f)).next())});import{q as C,l as S,bi as F,F as o,t as E,v as d,x,y as N,z as P,L as s,aw as b,V as g,W as q,Q as k,u as L}from"./index.bf68c475.js";import{_ as M}from"./index.6fb73d11.js";import{q as V,s as I}from"./depart.user.api.2f94d83b.js";import"./bem.50a076c2.js";import"./props.454eaba2.js";import"./useContextMenu.c45c31d7.js";const R={class:"bg-white m-4 mr-0 overflow-hidden"},W=S({__name:"DepartTree",emits:["select"],setup(v,{emit:f}){F("prefixCls");const{createMessage:r}=L();let l=o(!1),n=o([]),p=o([]),i=o([]),c=o(!0),t=o("2"),u=o(!1);function m(){l.value=!0,n.value=[],V().then(e=>{e.success?Array.isArray(e.result)&&(n.value=e.result,t.value=e.message,w()):r.warning(e.message)}).finally(()=>l.value=!1)}m();function w(){let e=[];n.value.forEach((a,y)=>{a.children&&a.children.length>0&&e.push(a.key),y===0&&_(a.id,a)}),e.length>0&&(D(),p.value=e)}function D(){return h(this,null,function*(){yield k(),u.value=!0,yield k(),u.value=!1})}function _(e,a){i.value=[e],a&&f("select",a)}function T(e){e?(l.value=!0,I({keyWord:e,myDeptSearch:"1"}).then(a=>{Array.isArray(a)?n.value=a:(r.warning("\u672A\u67E5\u8BE2\u5230\u90E8\u95E8\u4FE1\u606F"),n.value=[])}).finally(()=>l.value=!1)):m()}function A(e,a){e.length>0&&i.value[0]!==e[0]?_(e[0],a.selectedNodes[0]):_(i.value[0])}function B(e){p.value=e,c.value=!1}return(e,a)=>{const y=E("a-empty"),K=E("a-spin");return d(),x("div",R,[N(K,{spinning:s(l)},{default:P(()=>[s(t)==="2"?(d(),x(b,{key:0},[s(u)?q("",!0):(d(),g(s(M),{key:0,title:"\u90E8\u95E8\u5217\u8868",toolbar:"",search:"",showLine:"",checkStrictly:!0,clickRowToExpand:!1,treeData:s(n),selectedKeys:s(i),expandedKeys:s(p),autoExpandParent:s(c),onSelect:A,onExpand:B,onSearch:T},null,8,["treeData","selectedKeys","expandedKeys","autoExpandParent"]))],64)):(d(),g(y,{key:1,description:"\u666E\u901A\u5458\u5DE5\u65E0\u6B64\u6743\u9650"}))]),_:1},8,["spinning"])])}}});var O=C(W,[["__scopeId","data-v-62078959"]]);export{O as default};
