import{p as t}from"./print.cca29b18.js";import{Q as e}from"./index.435ab247.js";class s{constructor(t){this.standards={strict:"strict",loose:"loose",html5:"html5"},this.counter=0,this.settings={standard:this.standards.html5,extraHead:"",extraCss:"",popTitle:"",endCallback:null,el:""},Object.assign(this.settings,t),this.init()}init(){this.counter++,this.settings.id=`printArea_${this.counter}`;let t=document.getElementById(this.settings.id);t&&t.parentNode.removeChild(t);let e=this.getPrintWindow();this.write(e.doc),this.settings.endCallback()}print(t){let e=t;e.focus(),e.print()}write(t,e){t.open(),t.write(`${this.docType()}<html>${this.getHead()}${this.getBody()}</html>`),t.close()}docType(){return this.settings.standard===this.standards.html5?"<!DOCTYPE html>":`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01${this.settings.standard===this.standards.loose?" Transitional":""}//EN" "http://www.w3.org/TR/html4/${this.settings.standard===this.standards.loose?"loose":"strict"}.dtd">`}getHead(){let t="",e="",s="";this.settings.extraHead&&this.settings.extraHead.replace(/([^,]+)/g,(function(e){t+=e})),[].forEach.call(document.querySelectorAll("link"),(function(t,s){t.href.indexOf(".css")>=0&&(e+='<link type="text/css" rel="stylesheet" href="'+t.href+'" >')}));for(let r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].cssRules||document.styleSheets[r].rules){let t=document.styleSheets[r].cssRules||document.styleSheets[r].rules;for(let e=0;e<t.length;e++)try{s+=t[e].cssText}catch(n){}}return this.settings.extraCss&&this.settings.extraCss.replace(/([^,\s]+)/g,(function(t){e+=`<link type="text/css" rel="stylesheet" href="${t}">`})),`<head><title>${this.settings.popTitle}</title>${t}${e}<style type="text/css">${s}</style></head>`}getBody(){return"<body>"+this.getFormData(document.querySelector(this.settings.el)).outerHTML+"</body>"}getFormData(t){let e=this,s=t.cloneNode(!0),n=s.querySelectorAll("*");[].forEach.call(n,(function(t){let e=t.getAttribute("ignore-print");e=null==e?t.getAttribute("ignoreprint"):e,null!=e&&"true"===e.toString()&&(t.outerHTML="")}));let r=s.querySelectorAll("input,select,textarea");[].forEach.call(r,(function(t,e){let s=t.getAttribute("type"),n=r[e];null==s&&(s="SELECT"===t.tagName?"select":"TEXTAREA"===t.tagName?"textarea":""),"radio"===s||"checkbox"===s?n.setAttribute("checked",t.checked):"select"===s?[].forEach.call(n.querySelectorAll("option"),(function(t,e){t.selected&&t.setAttribute("selected",!0)})):"textarea"===s?n.innerHTML=t.value:(n.value=t.value,n.setAttribute("value",t.value))}));var i=t.querySelectorAll("canvas"),l=s.querySelectorAll("canvas");return[].forEach.call(l,(function(t,s){e.isECharts(t)&&(t.parentElement.style.width&&(t.parentElement.style.width="100%"),t.parentElement.parentElement.style.width&&(t.parentElement.parentElement.style.width="100%"));var n=i[s].toDataURL();t.outerHTML='<img src="'+n+'" style="width:100%;"/>'})),s}isECharts(t){let e="_echarts_instance_",s=t.parentElement;return null!=s.getAttribute(e)||null!=s.parentElement.getAttribute(e)}getPrintWindow(){var t=this.Iframe();return{win:t.contentWindow||t,doc:t.doc}}Iframe(){let t,e=this.settings.id;var s=this;try{t=document.createElement("iframe"),document.body.appendChild(t),t.style.border="0px",t.style.position="absolute",t.style.width="0px",t.style.height="0px",t.style.right="0px",t.style.top="0px",t.setAttribute("id",e),t.setAttribute("src",(new Date).getTime()),t.doc=null,t.onload=function(){var e=t.contentWindow||t;s.print(e)},t.doc=t.contentDocument?t.contentDocument:t.contentWindow?t.contentWindow.document:t.document}catch(n){throw new Error(n+". iframes may not be supported in this browser.")}if(null==t.doc)throw new Error("Cannot find document.");return t}}function n(e){if("html"!==(null==e?void 0:e.type))return t(e);r(e.printable)}function r(t){t?function(t){"string"!=typeof t||t.startsWith("#")||(t="#"+t);e((()=>{i&&(i=!1,new s({el:t,endCallback(){i=!0}}))}))}(t):window.print()}let i=!0;export{n as printJS,r as printNb};
