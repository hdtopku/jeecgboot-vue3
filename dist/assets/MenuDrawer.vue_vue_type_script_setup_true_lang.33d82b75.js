var U=Object.defineProperty;var D=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var v=(o,t,s)=>t in o?U(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s,B=(o,t)=>{for(var s in t||(t={}))E.call(t,s)&&v(o,s,t[s]);if(D)for(var s of D(t))R.call(t,s)&&v(o,s,t[s]);return o};var w=(o,t,s)=>new Promise((d,i)=>{var c=r=>{try{p(s.next(r))}catch(m){i(m)}},l=r=>{try{p(s.throw(r))}catch(m){i(m)}},p=r=>r.done?d(r.value):Promise.resolve(r.value).then(c,l);p((s=s.apply(o,t)).next())});import{B as S}from"./BasicForm.763c9f74.js";import"./componentMap.995605ed.js";import{u as T}from"./useForm.4b03a18a.js";import"./JAddInput.c425dfe6.js";import{j as k,dW as x,C as _,m as I,H as a,s as L,Q as V,w as j,v as M,x as N}from"./index.c1d8dbc8.js";import{f as O,l as $,C as q,g as G}from"./menu.data.39c5fa2a.js";import{u as H,B as Q}from"./index.1aa39cfc.js";import{useDrawerAdaptiveWidth as z}from"./useAdaptiveWidth.48a0150a.js";const ae=k({__name:"MenuDrawer",emits:["success","register"],setup(o,{emit:t}){const{adaptiveWidth:s}=z(),d=x(),i=_(!0),c=_(0),l=e=>e===2,[p,{setProps:r,resetFields:m,setFieldsValue:g,updateSchema:F,validate:y,clearValidate:J}]=T({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:O,showActionButtonGroup:!1}),[b,{setDrawerProps:h,closeDrawer:A}]=H(e=>w(this,null,function*(){var n;yield m(),h({confirmLoading:!1}),i.value=!!(e!=null&&e.isUpdate),c.value=(n=e==null?void 0:e.record)==null?void 0:n.menuType;const u=yield $();if(F([{field:"parentId",componentProps:{treeData:u}},{field:"name",label:l(a(c))?"\u6309\u94AE/\u6743\u9650":"\u83DC\u5355\u540D\u79F0"},{field:"url",required:!l(a(c)),componentProps:{onChange:f=>C(f.target.value)}}]),typeof e.record=="object"){let f=B({},e.record);g(f),C(f.url)}r({disabled:!d.showFooter})})),P=I(()=>a(i)?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355");function W(){return w(this,null,function*(){try{const e=yield y();q.IFrame===e.component&&(e.component=e.frameSrc),h({confirmLoading:!0}),yield G(e,a(i)),A(),t("success")}finally{h({confirmLoading:!1})}})}function C(e){let u="",n=e;e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),u=`${e}`):u="\u8BF7\u8F93\u5165\u7EC4\u4EF6\u540D\u79F0",F([{field:"componentName",componentProps:{placeholder:u}}]),n!=null&&n!=""&&(n.startsWith("http://")||n.startsWith("https://"))&&g({component:n})}return(e,u)=>(L(),V(a(Q),N(e.$attrs,{onRegister:a(b),showFooter:"",width:a(s),title:P.value,onOk:W}),{default:j(()=>[M(a(S),{onRegister:a(p),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{ae as _};
