import{a1 as e,a5 as l,h as a,I as n}from"./index.b3c93d64.js";import{d as o}from"./user.api.f4883dd0.js";import{render as t}from"./renderUtils.864e5731.js";const i=l=>e.get({url:"/sys/permission/list",params:l}),s=(l,a)=>e.delete({url:"/sys/permission/delete",params:l},{joinParamsToUrl:!0}).then((()=>{a()})),r=(a,n)=>{l.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>e.delete({url:"/sys/permission/deleteBatch",data:a},{joinParamsToUrl:!0}).then((()=>{n()}))})},d=(l,a)=>{let n=a?"/sys/permission/edit":"/sys/permission/add";return e.post({url:n,params:l})},u=l=>e.get({url:"/sys/permission/queryPermissionRule",params:l}),p=(l,a)=>{let n=a?"/sys/permission/editPermissionRule":"/sys/permission/addPermissionRule";return e.post({url:n,params:l})},m=(l,a)=>e.delete({url:"/sys/permission/deletePermissionRule",params:l},{joinParamsToUrl:!0}).then((()=>{a()})),c=(l,a,n)=>[{validator:(o,t)=>!t&&n?Promise.reject(`请输入${a.label}`):new Promise(((a,n)=>{var o;(o={id:l.id,url:l.url,alwaysShow:l.alwaysShow},e.get({url:"/sys/permission/checkPermDuplication",params:o},{isTransformResponse:!1})).then((e=>{e.success?a():n(e.message||"校验失败")})).catch((e=>{n(e.message||"验证失败")}))}))}],f=e=>0===e,h=e=>2===e;var y=(e=>(e.Default="layouts/default/index",e.IFrame="sys/iframe/FrameBlank",e))(y||{});const b=[{title:"菜单名称",dataIndex:"name",width:200,align:"left"},{title:"菜单类型",dataIndex:"menuType",width:150,customRender:({text:e})=>t.renderDict(e,"menu_type")},{title:"图标",dataIndex:"icon",width:50,customRender:({record:e})=>a(n,{icon:e.icon})},{title:"组件",dataIndex:"component",align:"left",width:150},{title:"路径",dataIndex:"url",align:"left",width:150},{title:"排序",dataIndex:"sortNo",width:50}],w=[{field:"name",label:"菜单名称",component:"Input",colProps:{span:8}}],v=[{label:"id",field:"id",component:"Input",show:!1},{field:"menuType",label:"菜单类型",component:"RadioButtonGroup",defaultValue:0,componentProps:({formActionType:e,formModel:l})=>({options:[{label:"一级菜单",value:0},{label:"子菜单",value:1},{label:"按钮/权限",value:2}],onChange:a=>{const{updateSchema:n,clearValidate:o}=e,t=h(a)?"按钮/权限":"菜单名称";o(),n([{field:"name",label:t},{field:"url",required:!h(a)}]),1!==a||l.id||"layouts/RouteView"!=l.component||(l.component="")}})},{field:"name",label:"菜单名称",component:"Input",required:!0},{field:"parentId",label:"上级菜单",component:"TreeSelect",required:!0,componentProps:{replaceFields:{title:"name",key:"id",value:"id"},dropdownStyle:{maxHeight:"50vh"},getPopupContainer:e=>e.parentNode},ifShow:({values:e})=>!f(e.menuType)},{field:"url",label:"访问路径",component:"Input",required:!0,ifShow:({values:e})=>!("sys/iframe/FrameBlank"===e.component&&e.internalOrExternal)&&2!==e.menuType,dynamicRules:({model:e,schema:l})=>c(e,l,!0)},{field:"component",label:"前端组件",component:"Input",componentProps:{placeholder:"请输入前端组件"},defaultValue:"layouts/RouteView",required:!0,ifShow:({values:e})=>!h(e.menuType)},{field:"componentName",label:"组件名称",component:"Input",componentProps:{placeholder:"请输入组件名称"},helpMessage:["此处名称应和vue组件的name属性保持一致。","组件名称不能重复，主要用于路由缓存功能。","如果组件名称和vue组件的name属性不一致，则会导致路由缓存失效。","非必填，留空则会根据访问路径自动生成。"],defaultValue:"",ifShow:({values:e})=>!h(e.menuType)},{field:"frameSrc",label:"Iframe地址",component:"Input",rules:[{required:!0,message:"请输入Iframe地址"},{type:"url",message:"请输入正确的url地址"}],ifShow:({values:e})=>!h(e.menuType)&&"sys/iframe/FrameBlank"===e.component},{field:"redirect",label:"默认跳转地址",component:"Input",ifShow:({values:e})=>f(e.menuType)},{field:"perms",label:"授权标识",component:"Input",ifShow:({values:e})=>h(e.menuType),dynamicRules:({model:e})=>[{required:!1,validator:(l,a)=>new Promise(((l,n)=>{let t={tableName:"sys_permission",fieldName:"perms",fieldVal:a,dataId:e.id};o(t).then((e=>{e.success?l():n(e.message||"校验失败")})).catch((e=>{n(e.message||"校验失败")}))}))}]},{field:"permsType",label:"授权策略",component:"RadioGroup",defaultValue:"1",helpMessage:["可见/可访问(授权后可见/可访问)","可编辑(未授权时禁用)"],componentProps:{options:[{label:"可见/可访问",value:"1"},{label:"可编辑",value:"2"}]},ifShow:({values:e})=>h(e.menuType)},{field:"status",label:"状态",component:"RadioGroup",defaultValue:"1",componentProps:{options:[{label:"有效",value:"1"},{label:"无效",value:"0"}]},ifShow:({values:e})=>h(e.menuType)},{field:"icon",label:"菜单图标",component:"IconPicker",ifShow:({values:e})=>!h(e.menuType)},{field:"sortNo",label:"排序",component:"InputNumber",defaultValue:1,ifShow:({values:e})=>!h(e.menuType)},{field:"route",label:"是否路由菜单",component:"Switch",defaultValue:!0,componentProps:{checkedChildren:"是",unCheckedChildren:"否"},ifShow:({values:e})=>!h(e.menuType)},{field:"hidden",label:"隐藏路由",component:"Switch",defaultValue:0,componentProps:{checkedChildren:"是",unCheckedChildren:"否"},ifShow:({values:e})=>!h(e.menuType)},{field:"hideTab",label:"隐藏Tab",component:"Switch",defaultValue:0,componentProps:{checkedChildren:"是",unCheckedChildren:"否"},ifShow:({values:e})=>!h(e.menuType)},{field:"keepAlive",label:"是否缓存路由",component:"Switch",defaultValue:!1,componentProps:{checkedChildren:"是",unCheckedChildren:"否"},ifShow:({values:e})=>!h(e.menuType)},{field:"alwaysShow",label:"聚合路由",component:"Switch",defaultValue:!1,componentProps:{checkedChildren:"是",unCheckedChildren:"否"},ifShow:({values:e})=>!h(e.menuType)},{field:"internalOrExternal",label:"打开方式",component:"Switch",defaultValue:!1,componentProps:{checkedChildren:"外部",unCheckedChildren:"内部"},ifShow:({values:e})=>!h(e.menuType)}],S=[{title:"规则名称",dataIndex:"ruleName",width:150},{title:"规则字段",dataIndex:"ruleColumn",width:100},{title:"规则值",dataIndex:"ruleValue",width:100}],I=[{field:"ruleName",label:"规则名称",component:"Input",colProps:{span:6}},{field:"ruleValue",label:"规则值",component:"Input",colProps:{span:6}}],P=[{label:"id",field:"id",component:"Input",show:!1},{field:"ruleName",label:"规则名称",component:"Input",required:!0},{field:"ruleColumn",label:"规则字段",component:"Input",ifShow:({values:e})=>"USE_SQL_RULES"!==e.ruleConditions},{field:"ruleConditions",label:"条件规则",required:!0,component:"ApiSelect",componentProps:{api:l=>e.get({url:`/sys/dict/getDictItems/${l.code}`}),params:{code:"rule_conditions"},labelField:"text",valueField:"value",getPopupContainer:e=>document.body}},{field:"ruleValue",label:"规则值",component:"Input",required:!0},{field:"status",label:"状态",component:"RadioButtonGroup",defaultValue:"1",componentProps:{options:[{label:"无效",value:"0"},{label:"有效",value:"1"}]}}];export{y as C,S as a,I as b,m as c,u as d,P as e,v as f,d as g,b as h,w as i,r as j,s as k,i as l,p as s};
