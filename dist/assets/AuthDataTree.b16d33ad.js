import{l as e,F as a,o as t,H as n,f0 as r,t as s,v as d,x as o,V as l,ax as u,aW as c,y as i,z as p,C as v,u as y}from"./index.b3c93d64.js";import{o as f,l as h,p as m}from"./auth.api.d1db9b41.js";var x=(e,a,t)=>new Promise(((n,r)=>{var s=e=>{try{o(t.next(e))}catch(a){r(a)}},d=e=>{try{o(t.throw(e))}catch(a){r(a)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,d);o((t=t.apply(e,a)).next())}));const k=e({name:"AuthDataTree",props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:r}=y(),s=a(""),d=a(3),o=a(!0),l=a([]),u=a([]),c=a([]),i=a(""),p=t((()=>!s.value));function v(){return x(this,null,(function*(){if(!e.cgformId)return;let a=yield f(e.cgformId,d.value);c.value=a.map((e=>({key:e.id,title:e.ruleName})))}))}function k(a,t){return x(this,null,(function*(){s.value=a,i.value=t,u.value=[];let n=yield h({roleId:a,cgformId:e.cgformId,type:d.value,authMode:t});u.value=n.map((e=>e.authId))}))}return n((()=>e.cgformId),v,{immediate:!0}),{loadChecked:k,clear:function(){s.value="",u.value=[]},expandedKeys:l,autoExpandParent:o,checkedKeys:u,treeData:c,disabled:p,onSave:function(){return x(this,null,(function*(){yield m(s.value,e.cgformId,{authId:JSON.stringify(u.value),authMode:i.value}),r.success("保存成功")}))},onExpand:function(e){l.value=e,o.value=!1},onRefresh:function(){v(),k(s.value,i.value)},clearChecked:function(){s.value=""}}}}),g={class:"onl-auth-tree-btns"};var I=r(k,[["render",function(e,a,t,n,r,y){const f=s("a-empty"),h=s("a-button"),m=s("a-tree");return d(),o("div",null,[e.disabled?(d(),l(f,{key:0,description:"请先选中左侧角色/部门/用户"})):0===e.treeData.length?(d(),l(f,{key:1,description:"无权限信息"})):(d(),o(u,{key:2},[c("div",g,[i(h,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:p((()=>[v("刷新")])),_:1},8,["onClick"]),i(h,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:p((()=>[v("保存")])),_:1},8,["onClick"])]),i(m,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":a[0]||(a[0]=a=>e.checkedKeys=a),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}],["__scopeId","data-v-4ce74ac6"]]);export{I as default};
