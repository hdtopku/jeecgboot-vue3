var e=Object.defineProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,r=(e,l,t)=>new Promise(((a,s)=>{var r=e=>{try{n(t.next(e))}catch(l){s(l)}},o=e=>{try{n(t.throw(e))}catch(l){s(l)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,o);n((t=t.apply(e,l)).next())}));import{B as o}from"./index.934459b9.js";import{B as n}from"./BasicForm.5f094c03.js";import"./helper.7e5efd4b.js";import{u as i}from"./useForm.18cf269c.js";import"./JAddInput.a2bd8bfb.js";import{a1 as d,a5 as u,l as p,o as c,L as m,F as f,bH as y,v as b,V as h,z as g,y as P,B as v}from"./index.26a57b91.js";import{d as I}from"./user.api.c522f7b9.js";const R=[{title:"规则名称",dataIndex:"ruleName",width:200,align:"center"},{title:"规则编码",dataIndex:"ruleCode",width:200,align:"center"},{title:"规则实现类",dataIndex:"ruleClass",width:300,align:"center"},{title:"规则参数",dataIndex:"ruleParams",width:200,align:"center"}],j=[{field:"ruleName",label:"规则名称",component:"Input",colProps:{span:6}},{field:"ruleCode",label:"规则编码",component:"Input",colProps:{span:6}}],w=[{label:"",field:"id",component:"Input",show:!1},{field:"ruleName",label:"规则名称",component:"Input",required:!0,colProps:{span:24}},{field:"ruleCode",label:"规则编码",component:"Input",colProps:{span:24},dynamicDisabled:({values:e})=>!!e.id,dynamicRules:({model:e})=>[{required:!0,validator:(l,t)=>new Promise(((l,a)=>{if(!t)return a("请输入规则编码！");let s={tableName:"sys_fill_rule",fieldName:"rule_code",fieldVal:t,dataId:e.id};I(s).then((e=>{e.success?l():a("规则编码已存在!")})).catch((e=>{a(e.message||"校验失败")}))}))}]},{field:"ruleClass",label:"规则实现类",component:"Input",required:!0,colProps:{span:24}},{field:"ruleParams",label:"规则参数",colProps:{span:24},component:"JAddInput",componentProps:{min:0}}],x="/sys/fillRule/exportXls",O="/sys/fillRule/importExcel",_=e=>d.get({url:"/sys/fillRule/list",params:e}),F=(e,l)=>d.delete({url:"/sys/fillRule/delete",data:e},{joinParamsToUrl:!0}).then((()=>{l()})),C=(e,l)=>{u.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>d.delete({url:"/sys/fillRule/deleteBatch",data:e},{joinParamsToUrl:!0}).then((()=>{l()}))})},B=e=>d.get({url:"/sys/fillRule/testFillRule",params:e},{isTransformResponse:!1}),T=p({__name:"FillRuleModal",emits:["register","success"],setup(e,{emit:u}){const p=c((()=>m(I)?"编辑":"新增")),I=f(!0),[R,{resetFields:j,setFieldsValue:x,validate:O,getFieldsValue:_}]=i({schemas:w,showActionButtonGroup:!1,baseColProps:{span:12}}),[F,{setModalProps:C,closeModal:B}]=y((e=>r(this,null,(function*(){yield j(),C({confirmLoading:!1}),I.value=!!(null==e?void 0:e.isUpdate),m(I)&&(yield x(((e,r)=>{for(var o in r||(r={}))t.call(r,o)&&s(e,o,r[o]);if(l)for(var o of l(r))a.call(r,o)&&s(e,o,r[o]);return e})({},e.record)))}))));function T(){return r(this,null,(function*(){try{let l=yield O();if(C({confirmLoading:!0}),I.value){let t=_();!l.parentId&&t.parentId&&(l.parentId=t.parentId),yield(e=l,d.put({url:"/sys/fillRule/edit",params:e}))}else yield(e=>d.post({url:"/sys/fillRule/add",params:e}))(l);B(),u("success")}finally{C({confirmLoading:!1})}var e}))}return(e,l)=>(b(),h(m(o),v(e.$attrs,{onRegister:m(F),title:m(p),onOk:T,width:800,destroyOnClose:""}),{default:g((()=>[P(m(n),{onRegister:m(R)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});var N=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"}));export{N as F,T as _,C as b,R as c,F as d,x as e,_ as g,B as h,O as i,j as s};
