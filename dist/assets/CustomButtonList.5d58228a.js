import{u as e}from"./useOnlineTest.01d0c935.js";import{useListPage as t}from"./useListPage.ddd6479e.js";import{B as o}from"./BasicTable.fa29c153.js";import{T as n}from"./helper.c50e6850.js";import"./TableImg.2942a3dc.js";import{B as a}from"./index.12c6f6d1.js";import{B as l}from"./BasicForm.fb9b9310.js";import{u as i}from"./useForm.5a9ed278.js";import"./JAddInput.2ba637e0.js";import{l as r,F as s,bH as d,bI as c,a8 as u,o as p,f0 as m,a1 as f,t as b,v as g,V as j,z as y,y as v,C as x,x as w,W as C,bl as h,bm as B,Q as I}from"./index.b2c24a42.js";import"./useTable.fb0dd6ed.js";import"./uniqBy.be1d69f1.js";import"./BasicModal.c95a44ff.js";import"./useWindowSizeFn.6c0c5931.js";import"./useFormItem.9110ec70.js";import"./api.e26748d3.js";import"./props.4a0f18d3.js";import"./index.27a29657.js";import"./bem.a0439036.js";import"./props.d4c4f199.js";import"./useContextMenu.0c34a59e.js";import"./index.9872fa51.js";import"./onMountedOrActivated.bfdd028b.js";import"./index.d802f44f.js";import"./htmlmixed.8e042aa6.js";import"./vue.bbfa1b85.js";/* empty css             */import"./depart.api.2d5bb309.js";import"./index.7e26b7de.js";import"./useContentHeight.aae13605.js";import"./useContentViewHeight.879059d9.js";import"./usePageContext.174066c3.js";import"./RedoOutlined.4dd49301.js";import"./functional.d6fe070d.js";import"./download.0dd0b191.js";import"./base64Conver.030fa32c.js";import"./index.de682914.js";import"./index.fb0e3f73.js";import"./useCountdown.cfa41944.js";import"./JUpload.152dd3a7.js";import"./index.be1c9e2b.js";var T=Object.defineProperty,P=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,k=(e,t,o)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,S=(e,t,o)=>new Promise(((n,a)=>{var l=e=>{try{r(o.next(e))}catch(t){a(t)}},i=e=>{try{r(o.throw(e))}catch(t){a(t)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(l,i);r((o=o.apply(e,t)).next())}));function F(e){return f.delete({url:"/online/cgform/button/deleteBatch",params:{ids:e.join(",")}},{joinParamsToUrl:!0})}const A=[{title:"按钮编码",align:"center",dataIndex:"buttonCode"},{title:"按钮名称",align:"center",dataIndex:"buttonName"},{title:"按钮样式",align:"center",dataIndex:"buttonStyle",customRender({text:e,record:t}){if("form"===e){return e+"("+("2"==t.optPosition?"底部":"侧面")+")"}return e}},{title:"按钮类型",align:"center",dataIndex:"optType"},{title:"排序",align:"center",dataIndex:"orderNum"},{title:"按钮图标",align:"center",dataIndex:"buttonIcon"},{title:"表达式",align:"center",dataIndex:"exp"},{title:"按钮状态",align:"center",dataIndex:"buttonStatus",customRender:({text:e})=>1==e?"激活":"未激活"}],O=[{label:"按钮编码",field:"buttonCode",component:"Input",required:!0},{label:"按钮名称",field:"buttonName",component:"Input",required:!0},{label:"按钮样式",field:"buttonStyle",component:"Select",componentProps:{options:[{label:"Link",value:"link"},{label:"Button",value:"button"},{label:"Form",value:"form"}]},defaultValue:"link"},{label:"按钮位置",field:"optPosition",component:"Select",componentProps:{options:[{label:"侧面",value:"1"},{label:"底部",value:"2"}]},defaultValue:"2",show:({model:e})=>"form"===e.buttonStyle},{label:"按钮类型",field:"optType",component:"Select",componentProps:{options:[{label:"Js",value:"js"},{label:"Action",value:"action"}]},defaultValue:"js"},{label:"排序",field:"orderNum",component:"InputNumber",componentProps:{style:"width: 100%"}},{label:"按钮图标",field:"buttonIcon",component:"Input",helpMessage:"a-icon type"},{label:"表达式",field:"exp",component:"Input"},{label:"按钮状态",field:"buttonStatus",component:"RadioButtonGroup",componentProps:{options:[{label:"激活",value:"1"},{label:"未激活",value:"0"}]},defaultValue:"1"}],_=r({name:"CustomButtonList",components:{BasicModal:a,BasicTable:o,TableAction:n,BasicForm:l},emits:["register"],setup(){const o=s(""),{doRequest:n,doDeleteRecord:a,tableContext:l}=t({tableProps:{api:e=>((e,t)=>f.get({url:"/online/cgform/button/list/"+e,params:t}))(o.value,e),columns:A,canResize:!1,useSearchForm:!1,beforeFetch:e=>Object.assign(e,{column:"orderNum",order:"asc"})}}),[r,{reload:m},{rowSelection:b,selectedRowKeys:g}]=l,[j,{closeModal:y}]=d((e=>S(this,null,(function*(){o.value=e.row.id,m()})))),{aiTestMode:v,genButtons:x}=e(),[w,C]=c(),h=s(!1),B=u({onRegister:w,title:p((()=>(null==h?void 0:h.value)?"修改":"新增")),width:800,confirmLoading:!1,onOk:function(){return S(this,null,(function*(){try{B.confirmLoading=!0;let e=yield V();e=Object.assign({cgformHeadId:o.value},T,e),yield((e,t)=>t?f.put({url:"/online/cgform/button/edit",params:e}):f.post({url:"/online/cgform/button/add",params:e}))(e,h.value),m(),C.closeModal()}finally{B.confirmLoading=!1}}))},onCancel:C.closeModal});let T={};const[_,{resetFields:D,setFieldsValue:L,validate:V}]=i({schemas:O,showActionButtonGroup:!1});function N(e){return S(this,null,(function*(){var t;h.value=e.isUpdate,T=((e,t)=>{for(var o in t||(t={}))M.call(t,o)&&k(e,o,t[o]);if(P)for(var o of P(t))R.call(t,o)&&k(e,o,t[o]);return e})({},null!=(t=e.record)?t:{}),C.openModal(),yield I(),yield D(),L(T)}))}return{onAdd:function(){N({isUpdate:!1})},onBatchDelete:function(){return S(this,null,(function*(){n((()=>F(g.value)))}))},aiTestMode:v,onGenButtons:function(){x(o.value)},registerModal:j,registerTable:r,selectedRowKeys:g,rowSelection:b,onCancel:function(){y()},getTableAction:function(e){return[{label:"编辑",onClick:()=>function(e){N({isUpdate:!0,record:e})}(e)}]},getDropDownAction:function(e){return[{label:"删除",popConfirm:{title:"确定删除吗？",placement:"left",confirm:()=>a((()=>F([e.id])))}}]},registerForm:_,formModalProps:B}}}),D={key:0,style:{float:"left"}};var L=m(_,[["render",function(e,t,o,n,a,l){const i=b("a-button"),r=b("a-icon"),s=b("a-menu-item"),d=b("a-menu"),c=b("a-dropdown"),u=b("TableAction"),p=b("BasicTable"),m=b("BasicForm"),f=b("a-spin"),I=b("BasicModal");return g(),j(I,{onRegister:e.registerModal,title:"自定义按钮",width:1200,defaultFullscreen:"",onCancel:e.onCancel},{footer:y((()=>[v(i,{onClick:e.onCancel},{default:y((()=>[x("关闭")])),_:1},8,["onClick"]),e.aiTestMode?(g(),w("div",D,[v(i,{onClick:e.onGenButtons},{default:y((()=>[x("生成测试数据")])),_:1},8,["onClick"])])):C("",!0)])),default:y((()=>[v(p,{onRegister:e.registerTable,rowSelection:e.rowSelection},{tableTitle:y((()=>[v(i,{onClick:e.onAdd,type:"primary",preIcon:"ant-design:plus"},{default:y((()=>[x("新增")])),_:1},8,["onClick"]),e.selectedRowKeys.length>0?(g(),j(c,{key:0},{overlay:y((()=>[v(d,null,{default:y((()=>[v(s,{key:"1",onClick:e.onBatchDelete},{default:y((()=>[v(r,{type:"delete"}),x(" 删除 ")])),_:1},8,["onClick"])])),_:1})])),default:y((()=>[v(i,{style:{"margin-left":"8px"}},{default:y((()=>[x(" 批量操作 "),v(r,{type:"down"})])),_:1})])),_:1})):C("",!0)])),action:y((({record:t})=>[v(u,{actions:e.getTableAction(t),dropDownActions:e.getDropDownAction(t)},null,8,["actions","dropDownActions"])])),_:1},8,["onRegister","rowSelection"]),v(I,h(B(e.formModalProps)),{default:y((()=>[v(f,{spinning:e.formModalProps.confirmLoading},{default:y((()=>[v(m,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},8,["spinning"])])),_:1},16)])),_:1},8,["onRegister","onCancel"])}]]);export{L as default};
