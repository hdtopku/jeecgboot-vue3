var e=(e,a,t)=>new Promise(((l,s)=>{var u=e=>{try{n(t.next(e))}catch(a){s(a)}},r=e=>{try{n(t.throw(e))}catch(a){s(a)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(u,r);n((t=t.apply(e,a)).next())}));import{u as a,B as t}from"./index.65c1cb1a.js";import{l,F as s,L as u,t as r,v as n,V as o,z as i,y as d,x as c,bc as v,C as f,D as p,ax as m,aW as y,B as h,u as g}from"./index.435ab247.js";import{n as x,o as _}from"./role.api.55e60fba.js";const b={style:{width:"100%","margin-top":"15px"}},k=f("点击保存"),w={key:1},I=[y("h3",null,"无配置信息!",-1)],C=l({__name:"RoleDataRuleDrawer",emits:["success","register"],setup(l,{emit:C}){const{createMessage:D}=g(),R=s(""),j=s(""),P=s([]),z=s([]),[B,{setDrawerProps:L,closeDrawer:A}]=a((a=>e(this,null,(function*(){yield(R.value="",j.value="",P.value=[],void(z.value=[])),L({confirmLoading:!1}),R.value=a.functionId,j.value=a.roleId;const e=yield x({functionId:u(R),roleId:u(j)});e.success&&(P.value=e.result.datarule,e.result.drChecked&&(z.value=e.result.drChecked.split(",")))}))));function F(){return e(this,null,(function*(){u(z)&&0!=u(z).length||D.warning("请注意，现未勾选任何数据权限!");let e={permissionId:u(R),roleId:u(j),dataRuleIds:u(z).join(",")};yield _(e),A(),C("success")}))}return(e,a)=>{const l=r("a-checkbox"),s=r("a-col"),g=r("Icon"),x=r("a-button"),_=r("a-row"),C=r("a-checkbox-group"),D=r("a-tab-pane"),R=r("a-tabs");return n(),o(u(t),h(e.$attrs,{onRegister:u(B),title:"数据规则配置",width:"450px",destroyOnClose:""}),{default:i((()=>[d(R,{defaultActiveKey:"1"},{default:i((()=>[d(D,{tab:"数据规则",key:"1"},{default:i((()=>[P.value.length>0?(n(),o(C,{key:0,value:z.value,"onUpdate:value":a[0]||(a[0]=e=>z.value=e)},{default:i((()=>[d(_,null,{default:i((()=>[(n(!0),c(m,null,v(P.value,((e,a)=>(n(),o(s,{span:24,key:"dr"+a},{default:i((()=>[d(l,{value:e.id},{default:i((()=>[f(p(e.ruleName),1)])),_:2},1032,["value"])])),_:2},1024)))),128)),d(s,{span:24},{default:i((()=>[y("div",b,[d(x,{onClick:F,type:"primary",size:"small"},{default:i((()=>[d(g,{icon:"ant-design:save-outlined"}),k])),_:1})])])),_:1})])),_:1})])),_:1},8,["value"])):(n(),c("div",w,I))])),_:1})])),_:1})])),_:1},16,["onRegister"])}}});export{C as default};
