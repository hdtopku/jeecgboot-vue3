import{j as be,aX as we,C as s,cD as m,dl as De,dm as Fe,X as Be,r as u,s as o,t as B,v as n,w as l,aW as xe,y as v,dn as Oe,N as Y,O as j,R as _,Q as k,K as x,dk as Se,dp as Ae,S as M,bx as Ee,ax as I,bc as ae,z as q,b5 as Pe,dq as te,a6 as Ne}from"./index.e8262126.js";import{g as Ue}from"./api.82eb5522.js";const $e=c=>{if(c==null)return"";const z=/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/g,h=c.match(z);return h!=null?h[0]:c},Me=()=>navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)!=null,ze=()=>!Me(),Ke={class:"flex flex-wrap justify-evenly"},Le={key:0,class:"flex flex-wrap justify-evenly"},Te={key:1},Ye={key:1,class:"flex flex-wrap justify-evenly"},He=be({__name:"Search",props:{placeholder:{type:String,default:"\u7C98\u8D34\u641C\u7D22"},showTop:{type:Boolean,default:!1},showCopy:{type:Boolean,default:!1},showSwitch:{type:Boolean,default:!1},showPeople:{type:Boolean,default:!1},tabPane:{type:Object,default:()=>({tabs:[],activeKey:"0"})}},emits:["queryList","changeAdvanced","confirmCopy"],setup(c,{expose:z,emit:h}){var G;const b=c,{hasPermission:H}=we(),f=s(m()),w=s(m()),i=s(),d=s(1),Q=s(!0),E=s(!1),P=s(!1),K=s([]),p=s(0),D=s(!1),C=s(!1),le=e=>e&&e>m().endOf("day"),ne=e=>e&&e>m().endOf("day")||e.isBefore(f.value),g=s(),O=(e,a=0)=>{p.value=e,p.value===365?f.value=m().startOf("year"):p.value===100?f.value=m().startOf("month"):f.value=m().subtract(e,"day"),w.value=m().subtract(a,"day"),g.value=!1,y()},V=()=>{g.value=!0,y()},ue=()=>{navigator.clipboard.readText().then(e=>{i.value=e,y()}).catch(e=>{e instanceof DOMException?te.error("\u8BF7\u624B\u52A8\u7C98\u8D34\uFF0C\u6216\u5141\u8BB8\u8BFB\u53D6\u526A\u8D34\u677F\uFF0C\u5931\u8D25\u539F\u56E0\uFF1A"+e):te.error("\u8BF7\u624B\u52A8\u7C98\u8D34\uFF0C\u5931\u8D25\u539F\u56E0\uFF1A"+e)})},X=()=>Q.value?C.value&&b.showSwitch?"warning":"primary":"error",se=()=>{K.value.length===0&&(P.value=!0,Ue({}).then(e=>{K.value=e.records,P.value=!1}))},L=De(Fe),S=s();let{username:N,realname:oe}=L==null?void 0:L.userInfo;const ie=N;S.value=oe;const re=e=>{N=e,Q.value=ie===S.value,e==null&&(S.value="\u6240\u6709\u4EBA"),y()},U=s((G=b==null?void 0:b.tabPane)==null?void 0:G.activeKey),ce=e=>{U.value=e,y()},y=()=>{var a,r,F,A,$;f.value.isAfter(w.value)&&(w.value=f.value),i.value=$e((a=i==null?void 0:i.value)==null?void 0:a.trim());let e=(r=i.value)==null?void 0:r.indexOf("/j/");e<0&&(e=(F=i.value)==null?void 0:F.indexOf("/c/")),e<0&&(e=(A=i.value)==null?void 0:A.indexOf("/d/")),e>=0&&(i.value=($=i.value)==null?void 0:$.substring(e+3)),localStorage.setItem("searchSwitch",JSON.stringify(C.value)),h("queryList",{pageNo:1,pageSize:30,startTime:f.value.startOf("day").format("YYYY-MM-DD HH:mm:ss"),endTime:w.value.endOf("day").format("YYYY-MM-DD HH:mm:ss"),keyword:i.value,username:N,checked:C.value,status:U.value})},de=()=>{D.value=!D.value,h("changeAdvanced")},J=()=>{E.value=!0,h("confirmCopy",{count:d.value,username:N,checked:C.value})},{proxy:W}=Ne();return z({queryFinish:(e="")=>{d.value===1?W.tool.copy(e,e+"\u5DF2\u590D\u5236"):W.tool.copy(e,d.value+"\u6761\u5DF2\u590D\u5236"),E.value=!1}}),Be(()=>{var e;C.value=JSON.parse((e=localStorage.getItem("searchSwitch"))!=null?e:"false"),y()}),(e,a)=>{var Z,R;const r=u("a-button"),F=u("a-space"),A=u("a-date-picker"),$=u("a-select-option"),ve=u("a-spin"),fe=u("a-select"),pe=u("a-switch"),ye=u("a-input"),me=u("a-card"),T=u("a-col"),_e=u("a-slider"),ke=u("a-popconfirm"),Ce=u("a-row"),ge=u("a-tab-pane"),he=u("a-tabs");return o(),B(I,null,[n(me,{size:"small"},{default:l(()=>[xe("div",Ke,[c.showTop?(o(),B("div",Le,[n(F,{size:5,class:"mb-2"},{default:l(()=>[n(r,{type:!g.value&&p.value===365?"link":"",onClick:a[0]||(a[0]=t=>O(365,0))},{default:l(()=>[v("\u4ECA\u5E74 ")]),_:1},8,["type"]),n(r,{type:!g.value&&p.value===30?"link":"",onClick:a[1]||(a[1]=t=>O(30,0))},{default:l(()=>[v(" 30\u5929 ")]),_:1},8,["type"]),n(r,{type:!g.value&&p.value===100?"link":"",onClick:a[2]||(a[2]=t=>O(100))},{default:l(()=>[v(" \u672C\u6708 ")]),_:1},8,["type"]),n(r,{type:!g.value&&p.value===1?"link":"",onClick:a[3]||(a[3]=t=>O(1,1))},{default:l(()=>[v(" \u6628\u5929 ")]),_:1},8,["type"]),n(r,{type:!g.value&&p.value===0?"link":"",onClick:a[4]||(a[4]=t=>O(0,0))},{default:l(()=>[v(" \u4ECA\u5929 ")]),_:1},8,["type"])]),_:1}),n(Oe,{"enter-active-class":"animate__animated animate__flipInX","leave-active-class":"animate__animated animate__flipOutX animate__faster"},{default:l(()=>[Y(n(F,{class:"mb-2"},{default:l(()=>[n(A,{onChange:V,allowClear:"",placeholder:"\u5F00\u59CB\u65E5\u671F","disabled-date":le,value:f.value,"onUpdate:value":a[5]||(a[5]=t=>f.value=t)},null,8,["value"]),n(A,{onChange:V,allowClear:"",placeholder:"\u7ED3\u675F\u65E5\u671F","disabled-date":ne,value:w.value,"onUpdate:value":a[6]||(a[6]=t=>w.value=t)},null,8,["value"])]),_:1},512),[[j,D.value]])]),_:1})])):_("",!0),n(ye,{size:"large",value:i.value,"onUpdate:value":a[10]||(a[10]=t=>i.value=t),onChange:y,placeholder:c.placeholder,allowClear:""},{prefix:l(()=>[n(r,{type:"link",onClick:de},{default:l(()=>[D.value?(o(),k(x(Se),{key:0})):(o(),k(x(Ae),{key:1}))]),_:1}),M(e.$slots,"prefix"),D.value?(o(),k(F,{key:0},{default:l(()=>[x(H)("am:selectUser")&&c.showPeople?(o(),k(fe,{key:0,size:"",loading:P.value,allowClear:"",ref:"select",value:S.value,"onUpdate:value":a[7]||(a[7]=t=>S.value=t),style:{width:"90px"},onFocus:se,onChange:re},Ee({default:l(()=>[(o(!0),B(I,null,ae(K.value,t=>(o(),k($,{key:t.id,value:t.username},{default:l(()=>[v(q(t.realname),1)]),_:2},1032,["value"]))),128))]),_:2},[P.value?{name:"notFoundContent",fn:l(()=>[n(ve,{size:"small"})]),key:"0"}:void 0]),1032,["loading","value"])):_("",!0),x(ze)()?(o(),k(r,{key:1,ghost:"",type:"success",onClick:ue},{default:l(()=>[v("\u7C98\u8D34")]),_:1})):_("",!0)]),_:1})):_("",!0)]),suffix:l(()=>[D.value?M(e.$slots,"suffix",{key:0}):_("",!0),M(e.$slots,"suffixAdvanced"),c.showSwitch&&x(H)("link:switch")?(o(),B("span",Te,[n(r,{class:"animate__animated animate__heartBeat animate__slower animate__repeat-3",onClick:a[8]||(a[8]=t=>x(Pe).push("/pms/am/link")),type:"link",danger:""},{default:l(()=>[v("\u6FC0\u6D3B\u94FE")]),_:1}),n(pe,{onClick:y,checked:C.value,"onUpdate:checked":a[9]||(a[9]=t=>C.value=t)},null,8,["checked"])])):_("",!0)]),_:3},8,["value","placeholder"])])]),_:3}),c.showCopy?(o(),k(Ce,{key:0,class:"w-full mt-2"},{default:l(()=>[n(T,{span:4},{default:l(()=>[M(e.$slots,"left")]),_:3}),n(T,{span:14},{default:l(()=>[n(_e,{style:{display:"inline-block"},value:d.value,"onUpdate:value":a[11]||(a[11]=t=>d.value=t),min:1,max:500},null,8,["value"])]),_:1}),n(T,{class:"text-center",span:6},{default:l(()=>[Y(n(r,{onClick:J,loading:E.value,type:X()},{default:l(()=>[v("\u590D\u5236"+q(d.value)+"\u6761 ",1)]),_:1},8,["loading","type"]),[[j,d.value===1]]),n(ke,{title:`\u786E\u5B9A\u590D\u5236${d.value}\u6761\u5417?`,"ok-text":"\u786E\u5B9A","cancel-text":"\u53D6\u6D88",onConfirm:J},{default:l(()=>[Y(n(r,{loading:E.value,placeholder:"\u5F00\u59CB\u65E5\u671F",type:X()},{default:l(()=>[v("\u590D\u5236"+q(d.value)+"\u6761 ",1)]),_:1},8,["loading","type"]),[[j,d.value>1]])]),_:1},8,["title"])]),_:1})]),_:3})):_("",!0),((R=(Z=b.tabPane)==null?void 0:Z.tabs)==null?void 0:R.length)>0?(o(),B("div",Ye,[n(he,{animated:!1,activeKey:U.value,"onUpdate:activeKey":a[12]||(a[12]=t=>U.value=t),onTabClick:ce},{default:l(()=>{var t;return[(o(!0),B(I,null,ae((t=b.tabPane)==null?void 0:t.tabs,ee=>(o(),k(ge,{key:ee.tabKey,tab:ee.tabName},null,8,["tab"]))),128))]}),_:1},8,["activeKey"])])):_("",!0)],64)}}});export{He as _};
