var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,s=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,r=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&s(e,a,t[a]);if(l)for(var a of l(t))c.call(t,a)&&s(e,a,t[a]);return e},o=(e,t,a)=>new Promise(((l,n)=>{var c=e=>{try{r(a.next(e))}catch(t){n(t)}},s=e=>{try{r(a.throw(e))}catch(t){n(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(c,s);r((a=a.apply(e,t)).next())}));import{cP as d,cQ as i,cR as u,cS as h,cT as y,cU as p,cV as f,cW as k,cX as K,l as g,F as v,cY as b,s as S,o as x,H as L,v as A,x as m,L as E,X as T,W as C,V as _,z as N,C as B,D as O,bg as D,E as I,y as j,cZ as P,ax as U,bc as w,c_ as R,bl as M,bm as X,c$ as H,be as F,I as Y,d0 as $,bd as V,al as z,d1 as Q,h as W,aX as Z,d2 as G,a8 as q,aa as J,$ as ee,cF as te,aL as ae,R as le,S as ne,b6 as ce,d3 as se,B as re,d4 as oe,bZ as de,ac as ie,aO as ue,aU as he,aQ as ye,d5 as pe,aT as fe,d6 as ke,b1 as Ke,c as ge,ay as ve,bh as be}from"./index.b3c93d64.js";import{createBEM as Se}from"./bem.3d3e77ca.js";import{buildProps as xe}from"./props.c13d8268.js";import{useContextMenu as Le}from"./useContextMenu.de287960.js";var Ae=f((function(e,t){return k(e)?function(e,t,a,l){var n=-1,c=h,s=!0,r=e.length,o=[],f=t.length;if(!r)return o;a&&(t=d(t,i(a))),l?(c=y,s=!1):t.length>=200&&(c=p,s=!1,t=new u(t));e:for(;++n<r;){var k=e[n],K=null==a?k:a(k);if(k=l||0!==k?k:0,s&&K==K){for(var g=f;g--;)if(t[g]===K)continue e;o.push(k)}else c(t,K,l)||o.push(k)}return o}(e,K(t,1,k,!0)):[]})),me=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(me||{});const Ee=xe({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),Te={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch justify-end"},Ce=g({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search","clickSearch"],setup(e,{emit:t}){const a=e,l=v(""),[n]=Se("tree-header"),c=b(),{t:s}=S(),r=x((()=>["mr-1","w-full",{"ml-5":c.headerTitle||a.title}])),o=x((()=>{const{checkable:e}=a,t=[{label:s("component.tree.expandAll"),value:me.EXPAND_ALL},{label:s("component.tree.unExpandAll"),value:me.UN_EXPAND_ALL,divider:e}];return e?[{label:s("component.tree.selectAll"),value:me.SELECT_ALL},{label:s("component.tree.unSelectAll"),value:me.UN_SELECT_ALL,divider:e},...t,{label:s("component.tree.checkStrictly"),value:me.CHECK_STRICTLY},{label:s("component.tree.checkUnStrictly"),value:me.CHECK_UN_STRICTLY}]:t}));function d(e){var l,n,c,s;const{key:r}=e;switch(r){case me.SELECT_ALL:null==(l=a.checkAll)||l.call(a,!0);break;case me.UN_SELECT_ALL:null==(n=a.checkAll)||n.call(a,!1);break;case me.EXPAND_ALL:null==(c=a.expandAll)||c.call(a,!0);break;case me.UN_EXPAND_ALL:null==(s=a.expandAll)||s.call(a,!1);break;case me.CHECK_STRICTLY:t("strictly-change",!1);break;case me.CHECK_UN_STRICTLY:t("strictly-change",!0)}}const i=z((function(e){t("search",e)}),200);return L((()=>l.value),(e=>{i(e)})),L((()=>a.searchText),(e=>{e!==l.value&&(l.value=e)})),(e,t)=>(A(),m("div",{class:I([E(n)(),"flex px-2 py-1.5 items-center"])},[E(c).headerTitle?T(e.$slots,"headerTitle",{key:0}):C("",!0),!E(c).headerTitle&&e.title?(A(),_(E(D),{key:1,helpMessage:e.helpMessage},{default:N((()=>[B(O(e.title),1)])),_:1},8,["helpMessage"])):C("",!0),e.search||e.toolbar?(A(),m("div",Te,[e.search?(A(),m("div",{key:0,class:I(E(r))},[j(E(P),{placeholder:E(s)("common.searchText"),size:"small",allowClear:"",value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e),onSearch:t[1]||(t[1]=t=>e.$emit("clickSearch",t))},null,8,["placeholder","value"])],2)):C("",!0),e.toolbar?(A(),_(E(V),{key:1,onClick:t[2]||(t[2]=$((()=>{}),["prevent"]))},{overlay:N((()=>[j(E(F),{onClick:d},{default:N((()=>[(A(!0),m(U,null,w(E(o),(e=>(A(),m(U,{key:e.value},[j(E(R),M(X({key:e.value})),{default:N((()=>[B(O(e.label),1)])),_:2},1040),e.divider?(A(),_(E(H),{key:0})):C("",!0)],64)))),128))])),_:1})])),default:N((()=>[j(E(Y),{icon:"ion:ellipsis-vertical"})])),_:1})):C("",!0)])):C("",!0)],2))}}),_e=({icon:e})=>e?Q(e)?W(Y,{icon:e,class:"mr-1"}):Y:null;var Ne=g({name:"BasicTree",inheritAttrs:!1,props:Ee,emits:["update:expandedKeys","update:selectedKeys","update:value","change","check","search","update:searchValue"],setup(e,{attrs:l,slots:n,emit:c,expose:s}){const[d]=Se("tree"),i=q({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),u=q({startSearch:!1,searchText:"",searchData:[]}),h=v([]),[y]=Le(),p=x((()=>{const{fieldNames:t}=e;return r({children:"children",title:"title",key:"key"},t)})),f=x((()=>{let n=(s=r(r({blockNode:!0},l),e),o={expandedKeys:i.expandedKeys,selectedKeys:i.selectedKeys,checkedKeys:i.checkedKeys,checkStrictly:i.checkStrictly,fieldNames:E(p),"onUpdate:expandedKeys":e=>{i.expandedKeys=e,c("update:expandedKeys",e)},"onUpdate:selectedKeys":e=>{i.selectedKeys=e,c("update:selectedKeys",e)},onCheck:(e,t)=>{let a=ie(i.checkedKeys);if(ue(a)&&u.startSearch){const{key:e}=E(p);a=Ae(a,C(t.node.$attrs.node[e])),t.checked&&a.push(t.node.$attrs.node[e]),i.checkedKeys=a}else i.checkedKeys=e;const l=ie(i.checkedKeys);c("update:value",l),c("check",l,t)},onRightClick:B},t(s,a(o)));var s,o;return he(n,"treeData","class")})),k=x((()=>u.startSearch?u.searchData:E(h))),K=x((()=>!k.value||0===k.value.length)),{deleteNodeByKey:g,insertNodeByKey:b,insertNodesByKey:S,filterByLevel:A,updateNodeByKey:m,getAllKeys:T,getChildrenKeys:C,getEnabledKeys:_,getSelectedNode:N}=function(e,t){function a(l){const n=[],c=l||E(e),{key:s,children:r}=E(t);if(!r||!s)return n;for(let e=0;e<c.length;e++){const t=c[e];n.push(t[s]);const l=t[r];l&&l.length&&n.push(...a(l))}return n}return{deleteNodeByKey:function a(l,n){if(!l)return;const c=n||E(e),{key:s,children:r}=E(t);if(r&&s)for(let e=0;e<c.length;e++){const t=c[e],n=t[r];if(t[s]===l){c.splice(e,1);break}n&&n.length&&a(l,t[r])}},insertNodeByKey:function({parentKey:a=null,node:l,push:n="push"}){const c=Z(E(e));if(!a)return c[n](l),void(e.value=c);const{key:s,children:r}=E(t);r&&s&&(G(c,(e=>{if(e[s]===a)return e[r]=e[r]||[],e[r][n](l),!0})),e.value=c)},insertNodesByKey:function({parentKey:a=null,list:l,push:n="push"}){const c=Z(E(e));if(l&&!(l.length<1))if(a){const{key:s,children:r}=E(t);if(!r||!s)return;G(c,(t=>{if(t[s]===a){t[r]=t[r]||[];for(let e=0;e<l.length;e++)t[r][n](l[e]);return e.value=c,!0}}))}else for(let e=0;e<l.length;e++)c[n](l[e])},filterByLevel:function a(l=1,n,c=1){if(!l)return[];const s=[],r=n||E(e)||[];for(let e=0;e<r.length;e++){const n=r[e],{key:o,children:d}=E(t),i=o?n[o]:"",u=d?n[d]:[];s.push(i),u&&u.length&&c<l&&(c+=1,s.push(...a(l,u,c)))}return s},updateNodeByKey:function a(l,n,c){if(!l)return;const s=c||E(e),{key:o,children:d}=E(t);if(d&&o)for(let e=0;e<s.length;e++){const t=s[e],c=t[d];if(t[o]===l){s[e]=r(r({},s[e]),n);break}c&&c.length&&a(l,n,t[d])}},getAllKeys:a,getChildrenKeys:function l(n,c){const s=[],r=c||E(e),{key:o,children:d}=E(t);if(!d||!o)return s;for(let e=0;e<r.length;e++){const t=r[e],c=t[d];n===t[o]?(s.push(t[o]),c&&c.length&&s.push(...a(c))):c&&c.length&&s.push(...l(n,c))}return s},getEnabledKeys:function a(l){const n=[],c=l||E(e),{key:s,children:r}=E(t);if(!r||!s)return n;for(let e=0;e<c.length;e++){const t=c[e];!0!==t.disabled&&!1!==t.selectable&&n.push(t[s]);const l=t[r];l&&l.length&&n.push(...a(l))}return n},getSelectedNode:function t(a,l,n){return a||0===a?((l||E(e)).forEach((e=>{if((null==n?void 0:n.key)||0===(null==n?void 0:n.key))return n;e.key!==a?e.children&&e.children.length&&(n=t(a,e.children,n)):n=e})),n||null):null}}}(h,p);function B(t){return o(this,arguments,(function*({event:t,node:a}){var l;const{rightMenuList:n=[],beforeRightClick:c}=e;let s={event:t,items:[]};if(c&&ye(c)){let e=yield c(a,t);Array.isArray(e)?s.items=e:Object.assign(s,e)}else s.items=n;(null==(l=s.items)?void 0:l.length)&&(s.items=s.items.filter((e=>!e.hidden)),y(s))}))}function O(e){i.expandedKeys=e}function D(e){i.selectedKeys=e}function I(e){i.checkedKeys=e}function P(e){i.checkedKeys=e?_():[]}function w(e){i.expandedKeys=e?T():[]}function R(e){i.checkStrictly=e}function M(t){if(t!==u.searchText&&(u.searchText=t),c("update:searchValue",t),!t)return void(u.startSearch=!1);const{filterFn:a,checkable:l,expandOnSearch:n,checkOnSearch:s,selectedOnSearch:r}=E(e);u.startSearch=!0;const{title:o,key:d}=E(p),i=[];if(u.searchData=pe(E(h),(e=>{var l,n;const c=a?a(t,e,E(p)):null!=(n=null==(l=e[o])?void 0:l.includes(t))&&n;return c&&i.push(e[d]),c}),E(p)),n){const e=fe(u.searchData).map((e=>e[d]));e&&e.length&&O(e)}s&&l&&i.length&&I(i),r&&i.length&&D(i)}function X(t,a){if(e.clickRowToExpand&&a&&0!==a.length)if(i.expandedKeys.includes(t)){const e=[...i.expandedKeys],a=e.findIndex((e=>e===t));-1!==a&&e.splice(a,1),O(e)}else O([...i.expandedKeys,t])}L((()=>e.searchValue),(e=>{e!==u.searchText&&(u.searchText=e)}),{immediate:!0}),L((()=>e.treeData),(e=>{e&&M(u.searchText)})),J((()=>{h.value=e.treeData})),ee((()=>{const t=parseInt(e.defaultExpandLevel);t>0?i.expandedKeys=A(t):e.defaultExpandAll&&w(!0)})),J((()=>{i.expandedKeys=e.expandedKeys})),J((()=>{i.selectedKeys=e.selectedKeys})),J((()=>{i.checkedKeys=e.checkedKeys})),L((()=>e.value),(()=>{i.checkedKeys=ie(e.value||[])}),{immediate:!0}),L((()=>i.checkedKeys),(()=>{const e=ie(i.checkedKeys);c("update:value",e),c("change",e)})),J((()=>{i.checkStrictly=e.checkStrictly}));const H={setExpandedKeys:O,getExpandedKeys:function(){return i.expandedKeys},setSelectedKeys:D,getSelectedKeys:function(){return i.selectedKeys},setCheckedKeys:I,getCheckedKeys:function(){return i.checkedKeys},insertNodeByKey:b,insertNodesByKey:S,deleteNodeByKey:g,updateNodeByKey:m,getSelectedNode:N,checkAll:P,expandAll:w,filterByLevel:e=>{i.expandedKeys=A(e)},setSearchValue:e=>{M(e)},getSearchValue:()=>u.searchText};function F(t){const{actionList:a}=e;if(a&&0!==a.length)return a.map(((e,a)=>{var l;let n=!0;return ye(e.show)?n=null==(l=e.show)?void 0:l.call(e,t):ve(e.show)&&(n=e.show),n?j("span",{key:a,class:d("action")},[e.render(t)]):null}))}const Y=x((()=>{const t=Z(k.value);return ke(t,((t,a)=>{var l;const c=u.searchText,{highlight:s}=E(e),{title:r,key:o,children:i}=E(p),h=function(t,a){return!a&&e.renderIcon&&ye(e.renderIcon)?e.renderIcon(t):a}(t,t.icon),y=Ke(t,r),k=c?y.indexOf(c):-1,K=u.startSearch&&!ge(c)&&s&&-1!==k,g=`color: ${ve(s)?"#f50":s}`,v=K?j("span",{class:(null==(l=E(f))?void 0:l.blockNode)?`${d("content")}`:""},[j("span",null,[y.substr(0,k)]),j("span",{style:g},[c]),j("span",null,[y.substr(k+c.length)])]):y;return t[r]=j("span",{class:`${d("title")} pl-2`,onClick:X.bind(null,t[o],t[i])},[(null==n?void 0:n.title)?be(n,"title",t):j(U,null,[h&&j(_e,{icon:h},null),v,j("span",{class:d("actions")},[F(t)])])]),t})),t}));return s(H),()=>{let t;const{title:a,helpMessage:s,toolbar:r,search:o,checkable:i}=e,h=a||r||o||n.headerTitle,y={height:"calc(100% - 38px)"};return j("div",{class:[d(),"h-full",l.class]},[h&&j(Ce,{checkable:i,checkAll:P,expandAll:w,title:a,search:o,toolbar:r,helpMessage:s,onStrictlyChange:R,onSearch:M,onClickSearch:e=>c("search",e),searchText:u.searchText},(p=t=te(n),"function"==typeof p||"[object Object]"===Object.prototype.toString.call(p)&&!de(p)?t:{default:()=>[t]})),j(ae,{spinning:E(e.loading),tip:"加载中..."},{default:()=>[le(j(ce,{style:y},{default:()=>[j(se,re(E(f),{showIcon:!1,treeData:Y.value}),null)]}),[[ne,!E(K)]]),le(j(oe,{image:oe.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ne,E(K)]])]})]);var p}}});export{Ne as _};
