import{l as e,cI as s,a7 as a,aB as o,s as t,dY as n,F as l,dZ as r,a8 as i,q as m,d_ as d,ac as u,d8 as c,d$ as p,t as f,v as g,V as h,z as b,y as v,C as x,D as C,u as y,e0 as k}from"./index.b3c93d64.js";import{C as F}from"./index.17ec2e33.js";import"./useCountdown.cb4ad478.js";import"./useFormItem.d029403d.js";const I=e({name:"step1",components:{Button:s,Form:a,FormItem:a.Item,Input:o,CountdownInput:F},emits:["nextStep"],setup(e,{emit:s}){const{t:a}=t(),{handleBackLogin:o}=n(),{notification:m}=y(),f=l(),{validForm:g}=k(f),{getFormRules:h}=r(),b=l(!1),v=i({mobile:"",sms:""});return{t:a,formRef:f,formData:v,getFormRules:h,handleNext:function(){return e=this,o=null,t=function*(){const e=yield g();if(!e)return;const o=yield d(u({phone:e.mobile,smscode:e.sms}));if(o.success){let a={username:o.result.username,phone:e.mobile,smscode:o.result.smscode};s("nextStep",a)}else m.error({message:a("sys.api.errorTip"),description:o.message||a("sys.api.networkExceptionMsg"),duration:3})},new Promise(((s,a)=>{var n=e=>{try{r(t.next(e))}catch(s){a(s)}},l=e=>{try{r(t.throw(e))}catch(s){a(s)}},r=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,l);r((t=t.apply(e,o)).next())}));var e,o,t},loading:b,handleBackLogin:o,sendCodeApi:function(){return c({mobile:v.mobile,smsmode:p.FORGET_PASSWORD})}}}}),D=x(" 下一步 ");var _=m(I,[["render",function(e,s,a,o,t,n){const l=f("Input"),r=f("FormItem"),i=f("CountdownInput"),m=f("Button"),d=f("Form");return g(),h(d,{class:"p-4 enter-x",model:e.formData,rules:e.getFormRules,ref:"formRef"},{default:b((()=>[v(r,{name:"mobile",class:"enter-x"},{default:b((()=>[v(l,{size:"large",value:e.formData.mobile,"onUpdate:value":s[0]||(s[0]=s=>e.formData.mobile=s),placeholder:e.t("sys.login.mobile")},null,8,["value","placeholder"])])),_:1}),v(r,{name:"sms",class:"enter-x"},{default:b((()=>[v(i,{size:"large",value:e.formData.sms,"onUpdate:value":s[1]||(s[1]=s=>e.formData.sms=s),placeholder:e.t("sys.login.smsCode"),sendCodeApi:e.sendCodeApi},null,8,["value","placeholder","sendCodeApi"])])),_:1}),v(r,{class:"enter-x"},{default:b((()=>[v(m,{type:"primary",size:"large",block:"",onClick:e.handleNext,loading:e.loading},{default:b((()=>[D])),_:1},8,["onClick","loading"]),v(m,{size:"large",block:"",class:"mt-4",onClick:e.handleBackLogin},{default:b((()=>[x(C(e.t("sys.login.backSignIn")),1)])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])}]]);export{_ as default};
