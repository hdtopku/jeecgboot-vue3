import{V as e}from"./cgform.data.cfb4e3e8.js";import{p as a}from"./pick.dbff1c58.js";import{bj as l,F as t,o as d,Q as i}from"./index.b2c24a42.js";var o=(e,a,l)=>new Promise(((t,d)=>{var i=e=>{try{r(l.next(e))}catch(a){d(a)}},o=e=>{try{r(l.throw(e))}catch(a){d(a)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,o);r((l=l.apply(e,a)).next())}));function r(r){const u=l("tables"),n=l("fullScreenRef"),s=t(),c=t(!1),b=t([]),f=d((()=>({normal:(null==n?void 0:n.value)?430:260,noToolbar:(null==n?void 0:n.value)?480:320}))),v=d((()=>["id"].concat(r.value.map((e=>e.key))))),m=d((()=>({scrollY:{gt:15},scrollX:{gt:20}})));return{tables:u,tableRef:s,loading:c,dataSource:b,columnKeys:v,tableHeight:f,tableProps:m,syncTable:function(e){let a=s.value,l=e.value.tableRef,t=e.value.getRemoveIds(),d=l.getXTable().internalData.tableFullData,o=a.getXTable().internalData.tableFullData;return d.forEach((e=>{let l=!1;if(o.forEach((d=>{if(e.id===d.id){let t=d.dbFieldName,i=d.dbFieldTxt;e.dbFieldName===t&&e.dbFieldTxt===i||a.setValues([{rowKey:d.id,values:{dbFieldName:e.dbFieldName,dbFieldTxt:e.dbFieldTxt}}]),l=!0}else t.forEach((e=>{e===d.id&&(a.removeRowsById(e),l=!0)}))})),!l){let l=Object.assign({},e);r.value.forEach((e=>{"dbFieldName"!==e.key&&"dbFieldTxt"!==e.key&&(l[e.key]=e.defaultValue)})),a.addRows(l)}})),i()},validateData:function(l){return o(this,null,(function*(){let t=s.value;if(yield t.fullValidateTable())throw{code:e,activeKey:l};return{tableData:t.getTableData().map((e=>a(e,v.value))),deleteIds:t.getDeleteData().map((e=>e.id))}}))},setDataSource:function(e,a=!1){return o(this,null,(function*(){a?(b.value=[],yield i(),yield s.value.addOrInsert(e,0,null,{setActive:!1}),yield i(),s.value.recalcDisableRows()):b.value=e}))}}}export{r as u};
