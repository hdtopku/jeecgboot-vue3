var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,r=(e,t)=>{for(var l in t||(t={}))o.call(t,l)&&i(e,l,t[l]);if(a)for(var l of a(t))n.call(t,l)&&i(e,l,t[l]);return e},s=(e,t,l)=>new Promise(((a,o)=>{var n=e=>{try{r(l.next(e))}catch(t){o(t)}},i=e=>{try{r(l.throw(e))}catch(t){o(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);r((l=l.apply(e,t)).next())}));import{l as u,a5 as d,aL as p,aB as c,f5 as m,F as f,O as v,o as b,L as y,$ as g,Q as h,q as j,t as C,v as x,V as w,z as O,y as P,aW as k,bl as R,bm as V,cE as T,bX as I,n as M,dz as F,f0 as S,E as _,R as L,S as A,B,u as E}from"./index.b2c24a42.js";import{u as H}from"./useTableSync.384f95b0.js";import{B as J}from"./BasicForm.fb9b9310.js";import"./helper.c50e6850.js";import{u as N}from"./useForm.5a9ed278.js";import"./JAddInput.2ba637e0.js";import"./pick.dbff1c58.js";import"./_flatRest.ff1861ce.js";import"./isArray.40a4ed15.js";import"./toString.cf909882.js";import"./_arrayPush.8821345e.js";import"./cgform.data.cfb4e3e8.js";import"./uniqBy.be1d69f1.js";import"./index.12c6f6d1.js";import"./BasicModal.c95a44ff.js";import"./useWindowSizeFn.6c0c5931.js";import"./useFormItem.9110ec70.js";import"./functional.d6fe070d.js";import"./download.0dd0b191.js";import"./base64Conver.030fa32c.js";import"./index.de682914.js";import"./index.fb0e3f73.js";import"./useCountdown.cfa41944.js";import"./JUpload.152dd3a7.js";import"./api.e26748d3.js";import"./index.be1c9e2b.js";import"./props.4a0f18d3.js";import"./index.27a29657.js";import"./bem.a0439036.js";import"./props.d4c4f199.js";import"./useContextMenu.0c34a59e.js";import"./index.9872fa51.js";import"./onMountedOrActivated.bfdd028b.js";import"./index.d802f44f.js";import"./htmlmixed.8e042aa6.js";import"./vue.bbfa1b85.js";/* empty css             */import"./depart.api.2d5bb309.js";const q=u({name:"JPrompt",components:{Modal:d,Spin:p,Input:c,BasicForm:J,ConfigProvider:m},emits:["register"],setup(e,{emit:a}){const o=f(),{getAntdLocale:n}=v(),i=f(!1),u=f(!1),d=f({}),p=b((()=>{var e;return null!=(e=d.value.placeholder)?e:"请输入内容"})),[c,{clearValidate:m,setFieldsValue:j,validate:C,updateSchema:x}]=N({compact:!0,wrapperCol:{span:24},schemas:[{label:"",field:"input",component:"Input",slot:"customInput"}],showActionButtonGroup:!1}),w=b((()=>{var a,o;let n=d.value,s={width:null!=(a=n.width)?a:500,title:null!=(o=n.title)?o:"prompt",visible:y(i),confirmLoading:y(u)};var p;return p=r(r(r({},s),e),n),t(p,l({onOk:k,onCancel(){"function"==typeof d.value.onCancel&&d.value.onCancel(),P()}}))}));function O(e){return s(this,null,(function*(){var t,l;document.body.focus(),d.value=e,i.value=!0,yield h(),yield x({field:"input",required:d.value.required,rules:d.value.rules,dynamicRules:d.value.dynamicRules}),yield j({input:null!=(t=d.value.defaultValue)?t:""}),yield m(),null==(l=o.value)||l.focus()}))}function P(){i.value=!1}function k(){return s(this,null,(function*(){try{const{onOk:e}=d.value;let t=yield C();if(R(!0),"function"==typeof e){!1!==(yield e(t.input))&&P()}else P()}finally{R(!1)}}))}function R(e){u.value=e}return g((()=>{a("register",{openModal:O,setLoading:R,getVisible:i})})),{inputRef:o,getProps:w,loading:u,options:d,placeholder:p,getAntdLocale:n,onChange:function(){C()},onSubmit:k,registerForm:c}}}),z={style:{padding:"20px"}},D=["innerHTML"];var U=j(q,[["render",function(e,t,l,a,o,n){const i=C("Input"),r=C("BasicForm"),s=C("Spin"),u=C("Modal"),d=C("ConfigProvider");return x(),w(d,{locale:e.getAntdLocale},{default:O((()=>[P(u,R(V(e.getProps)),{default:O((()=>[P(s,{spinning:e.loading},{default:O((()=>[k("div",z,[k("div",{innerHTML:e.options.content,style:{"margin-bottom":"8px"}},null,8,D),P(r,{onRegister:e.registerForm},{customInput:O((({model:t,field:l})=>[P(i,{ref:"inputRef",value:t[l],"onUpdate:value":e=>t[l]=e,placeholder:e.placeholder,onPressEnter:e.onSubmit,onInput:e.onChange},null,8,["value","onUpdate:value","placeholder","onPressEnter","onInput"])])),_:1},8,["onRegister"])])])),_:1},8,["spinning"])])),_:1},16)])),_:1},8,["locale"])}]]);var W=Object.defineProperty,G=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,Y=(e,t,l)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;const Z=u({name:"CheckDictTable",components:{VNodes:(e,{attrs:t})=>t.vnodes},setup(){const{prefixCls:e}=M("cgform-check-dict-table"),{createMessage:t}=E(),l=f([{title:"字段名称",key:"dbFieldName",width:100},{title:"字段备注",key:"dbFieldTxt",width:100},{title:"字段Href",key:"fieldHref",width:130,type:F.input,defaultValue:""},{title:"验证规则",key:"fieldValidType",width:170,type:F.slot,slotName:"fieldValidType",allowInput:!0,defaultValue:"",placeholder:"空"},{title:"校验必填",key:"fieldMustInput",width:80,type:F.checkbox,align:"center",customValue:["1","0"],defaultChecked:!1},{title:"字典Table",key:"dictTable",width:280,type:F.textarea,defaultValue:""},{title:"字典Code",key:"dictField",width:280,type:F.input,defaultValue:""},{title:"字典Text",key:"dictText",width:280,type:F.input,defaultValue:""}]),a=H(l),o=f([{label:"空",value:""},{label:"唯一校验",value:"only"},{label:"6到16位数字",value:"n6-16"},{label:"6到18位字母",value:"s6-18"},{label:"6到16位任意字符",value:"*6-16"},{label:"网址",value:"url"},{label:"电子邮件",value:"e"},{label:"手机号码",value:"m"},{label:"邮政编码",value:"p"},{label:"字母",value:"s"},{label:"数字",value:"n"},{label:"整数",value:"z"},{label:"非空",value:"*"},{label:"金额",value:"money"}]),n=b((()=>o.value.map((e=>e.value)))),{createJPrompt:i}={createJPrompt:function(e){let t=null;const l=document.createElement("div"),a=P(U,{onRegister(l){return s(this,null,(function*(){t=l,yield h(),l.openModal(e)}))},afterClose(){T(null,l),document.body.removeChild(l)}});function o(){return null==t&&I("useJPrompt instance is undefined!"),t}return T(a,l),document.body.appendChild(l),{closeModal:function(){var e;null==(e=o())||e.closeModal()},updateModal:function(e){var t;null==(t=o())||t.updateModal(e)},setLoading:function(e){var t;null==(t=o())||t.setLoading(e)}}}};function r(e){return!n.value.includes(e)}function u(e,t){return r(t)?Promise.resolve():Promise.reject("当前校验已存在")}return d=((e,t)=>{for(var l in t||(t={}))$.call(t,l)&&Y(e,l,t[l]);if(X)for(var l of X(t))K.call(t,l)&&Y(e,l,t[l]);return e})({},a),G(d,Q({prefixCls:e,columns:l,isCustomRegexp:r,validTypeOptions:o,validTypeValues:n,onAddCustomRegexp:function(e){i({title:"自定义正则表达式",placeholder:"请输入正则表达式",rules:[{required:!0,message:"正则表达式不能为空！"},{validator:u}],onOk:l=>{e.triggerChange(l),t.success("添加成功")}})},onChangeCustomRegexp:function(e){i({title:"修改自定义正则表达式",defaultValue:e.value,placeholder:"请输入正则表达式",rules:[{required:!0,message:"正则表达式不能为空！"},{validator:u}],onOk:l=>{e.triggerChange(l),l!==e.value&&t.success("修改成功")}})}}));var d}}),ee={class:"custom-option-list rc-virtual-list-holder-inner",style:{"border-top":"1px solid #dfdfdf"}},te=["onClick"];var le=S(Z,[["render",function(e,t,l,a,o,n){const i=C("VNodes"),r=C("a-select"),s=C("a-col"),u=C("a-button"),d=C("a-row"),p=C("JVxeTable");return x(),w(p,B({ref:"tableRef",rowNumber:"",keyboardEdit:"",class:[e.prefixCls],maxHeight:e.tableHeight.noToolbar,loading:e.loading,columns:e.columns,dataSource:e.dataSource,disabledRows:{dbFieldName:["id","has_child"]}},e.tableProps),{fieldValidType:O((t=>[P(d,{type:"flex",class:_(["row-valid-type",{full:!e.isCustomRegexp(t.value)}])},{default:O((()=>[P(s,{class:_(["left"])},{default:O((()=>[P(r,{value:t.value,options:e.validTypeOptions,style:{width:"100%"},onChange:t.triggerChange},{dropdownRender:O((({menuNode:l})=>[P(i,{vnodes:l},null,8,["vnodes"]),L(k("div",ee,[k("div",{class:"ant-select-item ant-select-item-option",title:"使用自定义正则表达式作为校验规则",onClick:l=>e.onAddCustomRegexp(t)}," 正则表达式 ",8,te)],512),[[A,!e.isCustomRegexp(t.value)]])])),_:2},1032,["value","options","onChange"])])),_:2},1024),P(s,{class:"right",title:"修改自定义正则表达式"},{default:O((()=>[P(u,{preIcon:"ant-design:edit",onClick:()=>e.onChangeCustomRegexp(t)},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["class"])])),_:1},16,["class","maxHeight","loading","columns","dataSource"])}],["__scopeId","data-v-8470723a"]]);export{le as default};
