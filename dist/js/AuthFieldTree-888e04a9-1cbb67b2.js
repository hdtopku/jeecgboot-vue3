import{d as V,l as p,e as T,w as H,u as R,V as f,a7 as x,a8 as w,ac as S,F as q,ad as J,f as d,aa as v,E as k}from"./vue-ebecda47.js";import{C as $,bB as j}from"./jeecg-online-vendor-cfb58502.js";import{f as G,A as L,B as Q}from"./auth.api-d3a6c4b3-03058a58.js";import{df as W,dg as X,dh as Y,di as Z,cp as ee}from"./antd-vue-vendor-b75e8c06.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-cd7703c8.js";import"./vxe-table-vendor-4aae63bf.js";var K=(e,h,c)=>new Promise((C,m)=>{var s=o=>{try{n(c.next(o))}catch(r){m(r)}},a=o=>{try{n(c.throw(o))}catch(r){m(r)}},n=o=>o.done?C(o.value):Promise.resolve(o.value).then(s,a);n((c=c.apply(e,h)).next())});const te=V({name:"AuthFieldTree",components:{DownCircleOutlined:W,HomeOutlined:X,UpCircleOutlined:Y,UndoOutlined:Z,CheckOutlined:ee},props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:h}=$(),c=p(""),C=p(1),m=p(!0),s=p([]),a=p([]),n=p([]),o=p([]),r=p(""),O=T(()=>!c.value);H(()=>e.cgformId,y,{immediate:!0});function y(){return K(this,null,function*(){if(!e.cgformId)return;let t=yield G(e.cgformId,C.value),l=[],i=[];t.forEach(u=>{i.includes(u.code)||(i.push(u.code),l.push({key:u.code,title:u.title}))});for(let u of l){let D=[];for(let E of t)if(u.key===E.code){let F=I(E);D.push({key:E.id,title:F})}u.children=D}o.value=l,s.value=[...i],n.value=i})}function I(t){let l="";return t.page==3?l+="列表":t.page==5&&(l+="表单"),t.control==3?l+="可编辑":t.control==5&&(l+="可见"),l}function g(t,l){return K(this,null,function*(){c.value=t,r.value=l,a.value=[],yield y();let i=yield L({roleId:t,cgformId:e.cgformId,type:C.value,authMode:l});a.value=i.map(u=>u.authId)})}function _(){c.value="",y()}function b(){y(),g(c.value,r.value)}function A(){return K(this,null,function*(){let t=a.value.filter(l=>n.value.indexOf(l)<0);yield Q(c.value,e.cgformId,{authId:JSON.stringify(t),authMode:r.value}),h.success("保存成功")})}function U(){s.value=[...n.value]}function z(){s.value=[]}function B(t){s.value=t,m.value=!1}function P(){c.value="",a.value=[]}function M(){a.value=[]}function N(){const t=function(l){for(let i of l)a.value.push(i.key),i.children&&i.children.length>0&&t.call(null,i.children)};a.value=[],t.call(null,R(o))}return{loadChecked:g,clear:P,expandedKeys:s,autoExpandParent:m,checkedKeys:a,treeData:o,disabled:O,onSave:A,onExpand:B,clearChecked:_,onCloseAll:z,onExpandAll:U,onRefresh:b,onClearSelected:M,onSelectAll:N}}}),le={class:"onl-auth-tree-btns"};function ne(e,h,c,C,m,s){const a=f("a-empty"),n=f("a-button"),o=f("DownCircleOutlined"),r=f("UpCircleOutlined"),O=f("CheckOutlined"),y=f("UndoOutlined"),I=f("a-tree");return x(),w("div",null,[e.disabled?(x(),S(a,{key:0,description:"请先选中左侧角色/部门/用户"})):e.treeData.length===0?(x(),S(a,{key:1,description:"无权限信息"})):(x(),w(q,{key:2},[J("div",le,[d(n,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:v(()=>[k("刷新")]),_:1},8,["onClick"]),d(n,{onClick:e.onExpandAll,size:"small",type:"primary",ghost:""},{default:v(()=>[d(o),k("展开")]),_:1},8,["onClick"]),d(n,{onClick:e.onCloseAll,size:"small",type:"primary",ghost:""},{default:v(()=>[d(r),k("折叠")]),_:1},8,["onClick"]),d(n,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:v(()=>[k("保存")]),_:1},8,["onClick"]),d(n,{onClick:e.onSelectAll,size:"small",type:"primary",ghost:""},{default:v(()=>[d(O),k("全选")]),_:1},8,["onClick"]),d(n,{onClick:e.onClearSelected,size:"small",type:"primary",ghost:""},{default:v(()=>[d(y),k("重置")]),_:1},8,["onClick"])]),d(I,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":h[0]||(h[0]=g=>e.checkedKeys=g),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}const se=j(te,[["render",ne],["__scopeId","data-v-e6dabb1d"]]);export{se as default};
