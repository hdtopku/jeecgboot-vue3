import{aC as a,aD as u}from"./index-6916e394.js";import{d as m,k as p,bF as h,aV as k,as as v}from"./vue-c7e3516e.js";import{r as A,P as y,bs as _,c as L,k as T,l as w}from"./jeecg-online-vendor-12004772.js";import"./lodash-es-vendor-42c8d3d4.js";import"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./codemirror-vendor-96aab763.js";import"./echarts-vendor-b30c7238.js";import"./html2canvas-vendor-654dcb8a.js";import"./vxe-table-vendor-8bace23a.js";const M=m({__name:"OAuth2Login",setup(x){const c=p(a()),e=p({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:l}=h(),s=l.value;a()||A.replace({path:y.BASE_LOGIN,query:s.query}),c.value&&g();function g(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),d()}function d(){if(e.value.thirdApp)if(s.query.oauth2LoginToken){let o=s.query.oauth2LoginToken;f({token:o,thirdType:s.query.thirdType,tenantId:_})}else e.value.wxWork?u("wechat_enterprise"):e.value.dingtalk&&u("dingtalk")}function f(o){const r=L(),{notification:i}=w(),{t:n}=T();r.ThirdLogin(o).then(t=>{t&&t.userInfo?i.success({message:n("sys.login.loginSuccessTitle"),description:`${n("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):i.error({message:n("sys.login.errorTip"),description:((t.response||{}).data||{}).message||t.message||n("sys.login.networkExceptionMsg"),duration:4})})}return(o,r)=>(k(),v("div"))}});export{M as default};
