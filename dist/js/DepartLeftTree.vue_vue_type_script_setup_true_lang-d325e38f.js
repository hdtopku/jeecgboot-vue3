var f=(l,_,i)=>new Promise((r,t)=>{var s=n=>{try{o(i.next(n))}catch(d){t(d)}},c=n=>{try{o(i.throw(n))}catch(d){t(d)}},o=n=>n.done?r(n.value):Promise.resolve(n.value).then(s,c);o((i=i.apply(l,_)).next())});import{ad as D}from"./jeecg-online-vendor-bf2efbcb.js";import{s as V}from"./depart.user.api-fc1a836a.js";import{d as q,c as N,k as u,U as p,aV as m,ar as x,bi as C,f as K,as as P,F as U,V as j,n as T}from"./vue-c7e3516e.js";const E=l=>D.get({url:"/sys/sysDepart/queryDepartTreeSync",params:l}),z=l=>D.get({url:"/sys/user/queryByOrgCodeForAddressList",params:l}),G=l=>D.get({url:"/sys/position/list",params:l}),J=q({__name:"DepartLeftTree",emits:["select","rootTreeData"],setup(l,{expose:_,emit:i}){N("prefixCls");const r=u(!1),t=u([]),s=u([]),c=u([]),o=u(!1),n=u(null),d=u("");function h(){return f(this,null,function*(){try{r.value=!0,t.value=[];const e=yield E();Array.isArray(e)&&(t.value=e),s.value.length===0&&k()}finally{r.value=!1}})}h();function L(e){return f(this,null,function*(){try{const a=yield E({pid:e.dataRef.id});if(a.length==0)e.dataRef.isLeaf=!0;else if(e.dataRef.children=a,s.value.length>0){let y=[];for(let v of s.value)a.findIndex(g=>g.id===v)!==-1&&y.push(v);y.length>0&&(s.value=[...s.value])}t.value=[...t.value]}catch(a){}return Promise.resolve()})}function k(){let e=t.value[0];e&&(e.isLeaf||(s.value=[e.key]),R())}function R(){return f(this,null,function*(){yield T(),o.value=!0,yield T(),o.value=!1})}function w(e,a){c.value=[e],a&&(n.value=a,i("select",a))}function A(e){return f(this,null,function*(){if(e)try{r.value=!0,t.value=[];let a=yield V({keyWord:e});Array.isArray(a)&&(t.value=a),k()}finally{r.value=!1}else h();d.value=e})}function B(e,a){e.length>0&&c.value[0]!==e[0]?w(e[0],a.selectedNodes[0]):w(c.value[0])}return _({loadRootTreeData:h}),(e,a)=>{const y=p("a-input-search"),v=p("a-tree"),g=p("a-empty"),S=p("a-spin"),b=p("a-card");return m(),x(b,{bordered:!1,style:{height:"100%"}},{default:C(()=>[K(S,{spinning:r.value},{default:C(()=>[K(y,{placeholder:"\u6309\u90E8\u95E8\u540D\u79F0\u641C\u7D22\u2026",style:{"margin-bottom":"10px"},onSearch:A,allowClear:""}),t.value.length>0?(m(),P(U,{key:0},[o.value?j("",!0):(m(),x(v,{key:0,showLine:"",clickRowToExpand:!1,treeData:t.value,selectedKeys:c.value,"load-data":L,expandedKeys:s.value,"onUpdate:expandedKeys":a[0]||(a[0]=F=>s.value=F),onSelect:B},null,8,["treeData","selectedKeys","expandedKeys"]))],64)):(m(),x(g,{key:1,description:"\u6682\u65E0\u6570\u636E"}))]),_:1},8,["spinning"])]),_:1})}}});export{J as _,z as l,G as p};
