var fe=Object.defineProperty,me=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var te=(e,t,a)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,F=(e,t)=>{for(var a in t||(t={}))ge.call(t,a)&&te(e,a,t[a]);if(ee)for(var a of ee(t))he.call(t,a)&&te(e,a,t[a]);return e},j=(e,t)=>me(e,pe(t));var A=(e,t,a)=>new Promise((d,n)=>{var i=u=>{try{c(a.next(u))}catch(f){n(f)}},l=u=>{try{c(a.throw(u))}catch(f){n(f)}},c=u=>u.done?d(u.value):Promise.resolve(u.value).then(i,l);c((a=a.apply(e,t)).next())});import{q as ie,aa as ye,D as q,S as be,aS as Ce}from"./jeecg-online-vendor-c39424cc.js";import{r as Se,ax as ve,c as ke,u as Fe,ab as He,aF as Be,m as ce,aw as Me}from"./index-a9a5a3b3.js";import{s as V,u as r,d as D,H as $e,f as h,i as Oe,k as v,e as H,w as U,o as Te,b as _e,q as P,V as g,v as we,a5 as y,a9 as B,a7 as p,t as Pe,a6 as E,R as $,an as De,F as ne,W as I,am as Ne,E as G,ab as J,ag as L,g as Re,z as We,al as oe,a8 as le,ae,af as se}from"./vue-bcbaddf9.js";import{M as je,X as Ee,bB as Le,bC as qe,aH as ze,bD as Ae,bE as Ve,S as Y}from"./antd-vue-vendor-a78909e6.js";import{useWindowSizeFn as Ie}from"./useWindowSizeFn-55a16b74.js";const{t:re}=ie(),Xe={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:re("common.cancelText")},okText:{type:String,default:re("common.okText")},closeFunc:Function},K=Object.assign({},Xe,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number},enableComment:{type:Boolean,default:!1}});function Ye(e){const t=(n,i)=>getComputedStyle(n)[i],a=n=>{if(!n)return;n.setAttribute("data-drag",r(e.draggable));const i=n.querySelector(".ant-modal-header"),l=n.querySelector(".ant-modal");!i||!l||!r(e.draggable)||(i.style.cursor="move",i.onmousedown=c=>{if(!c)return;const u=c.clientX,f=c.clientY,o=document.body.clientWidth,m=document.documentElement.clientHeight,k=l.offsetWidth,b=l.offsetHeight,C=l.offsetLeft,S=o-l.offsetLeft-k,M=l.offsetTop;let _=m-l.offsetTop-b;_<0&&(_=m-l.offsetTop);const w=t(l,"left"),N=t(l,"top");let R=+w,W=+N;w.includes("%")?(R=+document.body.clientWidth*(+w.replace(/%/g,"")/100),W=+document.body.clientHeight*(+N.replace(/%/g,"")/100)):(R=+w.replace(/px/g,""),W=+N.replace(/px/g,"")),document.onmousemove=function(z){let O=z.clientX-u,T=z.clientY-f;-O>C?O=-C:O>S&&(O=S),-T>M?T=-M:T>_&&(T=_),l.style.cssText+=`;left:${O+R}px;top:${T+W}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},d=()=>{const n=document.querySelectorAll(".ant-modal-wrap");for(const i of Array.from(n)){if(!i)continue;const l=t(i,"display"),c=i.getAttribute("data-drag");l!=="none"&&(c===null||r(e.destroyOnClose))&&a(i)}};V(()=>{!r(e.visible)||!r(e.draggable)||Se(()=>{d()},30)})}function Ue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Oe(e)}const Ge=D({name:"Modal",inheritAttrs:!1,props:K,emits:["cancel"],setup(e,{slots:t,emit:a}){const{visible:d,draggable:n,destroyOnClose:i}=$e(e),l=ye();Ye({visible:d,destroyOnClose:i,draggable:n});const c=u=>{a("cancel",u)};return()=>{let u;const f=j(F(F({},r(l)),e),{onCancel:c});return h(je,f,Ue(u=ve(t))?u:{default:()=>[u]})}}}),ue=Symbol();function Je(e){return ke(e,ue)}function St(){return Fe(ue)}const Ke={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},Qe=D({name:"ModalWrapper",components:{ScrollContainer:He},inheritAttrs:!1,props:Ke,emits:["height-change","ext-height"],setup(e,{emit:t}){const a=v(null),d=v(null),n=v(0),i=v(0);let l=0;Ie(f.bind(null,!1)),Be(d,()=>{f()},{attributes:!0,subtree:!0}),Je({redoModalHeight:f});const c=H(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${r(n)}px`}));V(()=>{e.useWrapper&&f()}),U(()=>e.fullScreen,o=>{f(),o?i.value=n.value:n.value=i.value}),Te(()=>{const{modalHeaderHeight:o,modalFooterHeight:m}=e;t("ext-height",o+m)}),_e(()=>{});function u(){return A(this,null,function*(){P(()=>{var m;const o=r(a);o&&((m=o==null?void 0:o.scrollTo)==null||m.call(o,0))})})}function f(){return A(this,null,function*(){if(!e.visible)return;const o=r(a);if(!o)return;const m=o.$el.parentElement;if(m){m.style.padding="0",yield P();try{const k=m.parentElement&&m.parentElement.parentElement;if(!k)return;const b=getComputedStyle(k).top,C=Number.parseInt(b);let S=window.innerHeight-C*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;C<40&&(S-=26),yield P();const M=r(d);if(!M)return;yield P(),l=M.scrollHeight,e.fullScreen?n.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:n.value=e.height?e.height:l>S?S:l,t("height-change",r(n))}catch(k){}}})}return{wrapperRef:a,spinRef:d,spinStyle:c,scrollTop:u,setModalHeight:f}}}),Ze=["loading-tip"];function xe(e,t,a,d,n,i){const l=g("ScrollContainer"),c=we("loading");return y(),B(l,{ref:"wrapperRef"},{default:p(()=>[Pe((y(),E("div",{ref:"spinRef",style:De(e.spinStyle),"loading-tip":e.loadingTip},[$(e.$slots,"default")],12,Ze)),[[c,e.loading]])]),_:3},512)}const et=q(Qe,[["render",xe]]),tt=D({name:"ModalClose",components:{Tooltip:Ee,FullscreenExitOutlined:Le,FullscreenOutlined:qe,CloseOutlined:ze,LeftSquareOutlined:Ae,RightSquareOutlined:Ve},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean},enableComment:{type:Boolean,default:!1},commentSpan:{type:Number,default:0}},emits:["cancel","fullscreen","comment"],setup(e,{emit:t}){const{prefixCls:a}=ce("basic-modal-close"),{t:d}=ie(),n=H(()=>[a,`${a}--custom`,{[`${a}--can-full`]:e.canFullscreen||e.enableComment}]);function i(o){t("cancel",o)}function l(o){o==null||o.stopPropagation(),o==null||o.preventDefault(),(e.commentSpan==0||e.enableComment==!1)&&t("fullscreen")}function c(o){o==null||o.stopPropagation(),o==null||o.preventDefault(),e.fullScreen==!1&&t("fullscreen"),t("comment",!0)}function u(o){o==null||o.stopPropagation(),o==null||o.preventDefault(),t("comment",!1)}const f=H(()=>e.enableComment===!0?!1:e.canFullscreen);return{t:d,getClass:n,prefixCls:a,handleCancel:i,handleFullScreen:l,handleOpenComment:c,handleCloseComment:u,fullScreenStatus:f}}});function nt(e,t,a,d,n,i){const l=g("FullscreenExitOutlined"),c=g("Tooltip"),u=g("FullscreenOutlined"),f=g("RightSquareOutlined"),o=g("LeftSquareOutlined"),m=g("CloseOutlined");return y(),E("div",{class:Ne(e.getClass)},[e.fullScreenStatus?(y(),E(ne,{key:0},[e.fullScreen?(y(),B(c,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:p(()=>[h(l,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(y(),B(c,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:p(()=>[h(u,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):I("",!0),e.enableComment?(y(),E(ne,{key:1},[e.commentSpan>0?(y(),B(c,{key:0,title:"收起",placement:"bottom"},{default:p(()=>[h(f,{onClick:e.handleCloseComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1})):(y(),B(c,{key:1,title:"展开",placement:"bottom"},{default:p(()=>[h(o,{onClick:e.handleOpenComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1}))],64)):I("",!0),h(c,{title:e.t("component.modal.close"),placement:"bottom"},{default:p(()=>[h(m,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}const ot=q(tt,[["render",nt]]),lt=D({name:"BasicModalFooter",props:K,emits:["ok","cancel"],setup(e,{emit:t}){function a(n){t("ok",n)}function d(n){t("cancel",n)}return{handleOk:a,handleCancel:d}}});function at(e,t,a,d,n,i){const l=g("a-button");return y(),E("div",null,[$(e.$slots,"insertFooter"),e.showCancelBtn?(y(),B(l,L({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:p(()=>[G(J(e.cancelText),1)]),_:1},16,["onClick"])):I("",!0),$(e.$slots,"centerFooter"),e.showOkBtn?(y(),B(l,L({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:p(()=>[G(J(e.okText),1)]),_:1},16,["type","onClick","loading"])):I("",!0),$(e.$slots,"appendFooter")])}const st=q(lt,[["render",at]]),rt=D({name:"BasicModalHeader",components:{BasicTitle:Me},emits:["dblclick"],props:{helpMessage:{type:[String,Array]},title:{type:String}}});function it(e,t,a,d,n,i){const l=g("BasicTitle");return y(),B(l,{helpMessage:e.helpMessage},{default:p(()=>[G(J(e.title),1)]),_:1},8,["helpMessage"])}const ct=q(rt,[["render",it]]);function ut(e){const t=v(!1),a=H(()=>{const n=r(e.wrapClassName)||"";return r(t)?`fullscreen-modal ${n} `:r(n)});function d(n){n&&n.stopPropagation(),t.value=!r(t)}return{getWrapClassName:a,handleFullScreen:d,fullScreenRef:t}}const dt=D({name:"BasicModal",components:{Modal:Ge,ModalWrapper:et,ModalClose:ot,ModalFooter:st,ModalHeader:ct},inheritAttrs:!1,props:K,emits:["visible-change","height-change","cancel","ok","register","update:visible"],setup(e,{emit:t,attrs:a,slots:d}){const n=v(!1),i=v(null),l=v(null),{prefixCls:c}=ce("basic-modal"),u=v(0),f={setModalProps:R,emitVisible:void 0,redoModalHeight:()=>{P(()=>{r(l)&&r(l).setModalHeight()})}},o=Re();o&&t("register",f,o.uid);const m=H(()=>F(F({},e),r(i))),k=H(()=>!r(m).title&&!d.title),{handleFullScreen:b,getWrapClassName:C,fullScreenRef:S}=ut({modalWrapperRef:l,extHeightRef:u,wrapClassName:We(m.value,"wrapClassName")}),M=H(()=>{const s=j(F({},r(m)),{visible:r(n),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return j(F({},s),{wrapClassName:r(C)})}),_=H(()=>{const s=j(F(F({},a),r(m)),{visible:r(n),wrapClassName:r(C)});return r(S)?Y(s,["height","title"]):Y(s,"title")}),w=H(()=>{if(!r(S))return r(M).height});V(()=>{S.value=!!e.defaultFullscreen}),V(()=>{n.value=!!e.visible}),U(()=>r(n),s=>{t("visible-change",s),t("update:visible",s),P(()=>{e.scrollTop&&s&&r(l)&&r(l).scrollTop()})},{immediate:!1});function N(s){return A(this,null,function*(){var Z,x;if(s==null||s.stopPropagation(),!((x=(Z=s.target)==null?void 0:Z.classList)!=null&&x.contains(c+"-close--custom"))){if(e.closeFunc&&be(e.closeFunc)){const de=yield e.closeFunc();n.value=!de;return}n.value=!1,t("cancel",s)}})}function R(s){i.value=Ce(r(i)||{},s),Reflect.has(s,"visible")&&(n.value=!!s.visible),Reflect.has(s,"defaultFullscreen")&&(S.value=!!s.defaultFullscreen)}function W(s){t("ok",s)}function z(s){t("height-change",s)}function O(s){u.value=s}function T(s){e.canFullscreen&&(s.stopPropagation(),b(s))}const X=v(0);U(()=>e.enableComment,s=>{Q(s)},{immediate:!0});function Q(s){s===!0?X.value=6:X.value=0}return{handleCancel:N,getBindValue:_,getProps:M,handleFullScreen:b,fullScreenRef:S,getMergeProps:m,handleOk:W,visibleRef:n,omit:Y,modalWrapperRef:l,handleExtHeight:O,handleHeightChange:z,handleTitleDbClick:T,getWrapperHeight:w,commentSpan:X,handleComment:Q,isNoTitle:k}}});function ft(e,t,a,d,n,i){const l=g("ModalClose"),c=g("ModalHeader"),u=g("ModalFooter"),f=g("ModalWrapper"),o=g("a-col"),m=g("a-row"),k=g("Modal");return y(),B(k,L(e.getBindValue,{onCancel:e.handleCancel}),oe({default:p(()=>[h(m,{class:"jeecg-modal-wrapper"},{default:p(()=>[h(o,{span:24-e.commentSpan,class:"jeecg-modal-content"},{default:p(()=>[h(f,L({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:p(()=>[$(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:3},8,["span"]),h(o,{span:e.commentSpan,class:"jeecg-comment-outer"},{default:p(()=>[$(e.$slots,"comment")]),_:3},8,["span"])]),_:3})]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:p(()=>[h(l,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,commentSpan:e.commentSpan,enableComment:e.getProps.enableComment,onComment:e.handleComment,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","commentSpan","enableComment","onComment","onCancel","onFullscreen"])]),key:"0"},e.isNoTitle?void 0:{name:"title",fn:p(()=>[h(c,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]),key:"1"},e.$slots.footer?void 0:{name:"footer",fn:p(()=>[h(u,L(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),oe({_:2},[le(Object.keys(e.$slots),b=>({name:b,fn:p(C=>[$(e.$slots,b,ae(se(C||{})))])}))]),1040,["onOk","onCancel"])]),key:"2"},le(Object.keys(e.omit(e.$slots,"default")),b=>({name:b,fn:p(C=>[$(e.$slots,b,ae(se(C||{})))])}))]),1040,["onCancel"])}const mt=q(dt,[["render",ft]]),vt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));export{mt as B,vt as a,St as u};
