var P=Object.defineProperty;var v=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var b=(e,o,s)=>o in e?P(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,x=(e,o)=>{for(var s in o||(o={}))M.call(o,s)&&b(e,s,o[s]);if(v)for(var s of v(o))S.call(o,s)&&b(e,s,o[s]);return e};var C=(e,o,s)=>new Promise((i,n)=>{var p=r=>{try{u(s.next(r))}catch(y){n(y)}},m=r=>{try{u(s.throw(r))}catch(y){n(y)}},u=r=>r.done?i(r.value):Promise.resolve(r.value).then(p,m);u((s=s.apply(e,o)).next())});import{d as I,l as g,e as U,u as a,a7 as k,ac as R,aa as O,f as D,af as E}from"./vue-50733b77.js";import{B as F}from"./index-f7d688aa.js";import"./index-7e7a94e9.js";import{ap as c}from"./jeecg-online-vendor-d3e1865b.js";import{M as j}from"./antd-vue-vendor-c5335947.js";import{u as H,B as X}from"./useForm-14ceb529.js";import{E as K}from"./index-b34ff7bc.js";const ee=[{title:"分类名称",dataIndex:"name",width:350,align:"left"},{title:"分类编码",dataIndex:"code"}],te=[{label:"名称",field:"name",component:"Input",colProps:{span:6}},{label:"编码",field:"code",component:"Input",colProps:{span:6}}],N=[{label:"",field:"id",component:"Input",show:!1},{label:"父级节点",field:"pid",component:"TreeSelect",componentProps:{fieldNames:{value:"key"},dropdownStyle:{maxHeight:"50vh"},getPopupContainer:()=>document.body},show:({values:e})=>e.pid!=="0",dynamicDisabled:({values:e})=>!!e.id},{label:"分类名称",field:"name",required:!0,component:"Input"}];const se="/sys/category/exportXls",oe="/sys/category/importExcel",ae=e=>c.get({url:"/sys/category/rootList",params:e}),re=(e,o)=>c.delete({url:"/sys/category/delete",params:e},{joinParamsToUrl:!0}).then(()=>{o()}),le=(e,o)=>{j.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>c.delete({url:"/sys/category/deleteBatch",data:e},{joinParamsToUrl:!0}).then(()=>{o()})})},V=(e,o)=>{let s=o?"/sys/category/edit":"/sys/category/add";return c.post({url:s,params:e})},q=e=>c.get({url:"/sys/category/loadTreeRoot",params:e}),ne=e=>c.get({url:"/sys/category/childList",params:e}),ce=e=>c.get({url:"/sys/category/getChildListBatch",params:e},{isTransformResponse:!1}),z=I({__name:"CategoryModal",emits:["register","success"],setup(e,{emit:o}){const s=g(!0),i=g([]),n=g([]),p=g(!1),[m,{resetFields:u,setFieldsValue:r,validate:y,updateSchema:B}]=H({schemas:N,showActionButtonGroup:!1,labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}}),[w,{setModalProps:f,closeModal:L}]=K(t=>C(this,null,function*(){yield u(),i.value=[],f({confirmLoading:!1,minHeight:80}),s.value=!!(t!=null&&t.isUpdate),p.value=!(t!=null&&t.isUpdate)&&t.record&&t.record.id,t!=null&&t.record&&(yield r(x({},t.record))),n.value=yield q({async:!1,pcode:""}),B({field:"pid",componentProps:{treeData:n}})})),_=U(()=>a(s)?"编辑字典":"新增字典");function h(t,l){if(t&&l&&l.length>0)for(let d=0;d<l.length;d++)l[d].key==t&&a(i).indexOf(t)<0?(i.value.push(l[d].key),h(l[d].parentId,a(n))):h(t,l[d].children)}function T(){return C(this,null,function*(){try{let t=yield y();f({confirmLoading:!0}),yield V(t,s.value),L(),yield h(t.pid,a(n)),o("success",{isUpdate:a(s),isSubAdd:a(p),values:x({},t),expandedArr:a(i).reverse()})}finally{f({confirmLoading:!1})}})}return(t,l)=>(k(),R(a(F),E(t.$attrs,{onRegister:a(w),destroyOnClose:"",title:_.value,onOk:T}),{default:O(()=>[D(a(X),{onRegister:a(m)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}}),ie=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));export{ie as C,z as _,oe as a,le as b,ee as c,re as d,ce as e,ne as f,se as g,ae as l,te as s};
