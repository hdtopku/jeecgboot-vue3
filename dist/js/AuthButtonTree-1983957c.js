import{bW as P,l as w}from"./jeecg-online-vendor-12004772.js";import{c as A}from"./auth.data-1d7a4570.js";import{m as N,l as M,n as S}from"./auth.api-eba80a18.js";import{d as V,k as d,e as R,w as $,U as y,aV as v,as as B,ar as I,F as z,at as L,f as k,bi as _,E as C}from"./vue-c7e3516e.js";import"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./lodash-es-vendor-42c8d3d4.js";var E=(e,c,a)=>new Promise((f,i)=>{var m=t=>{try{u(a.next(t))}catch(r){i(r)}},o=t=>{try{u(a.throw(t))}catch(r){i(r)}},u=t=>t.done?f(t.value):Promise.resolve(t.value).then(m,o);u((a=a.apply(e,c)).next())});const U=V({name:"AuthButtonTree",props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:c}=w(),a=d(""),f=d(2),i=d(!0),m=d([]),o=d([]),u=d([]),t=d(""),r=R(()=>!a.value);$(()=>e.cgformId,h,{immediate:!0});function h(){return E(this,null,function*(){if(!e.cgformId)return;let n=yield N(e.cgformId,f.value);n.forEach(l=>{for(const p of A)if(l.code==p.code){l.title=p.title;break}});let s=[];for(let l of n){let p=K(l);s.push({key:l.id,title:p})}u.value=s})}function D(){h(),g(a.value,t.value)}function g(n,s){return E(this,null,function*(){a.value=n,t.value=s,o.value=[],yield h();let l=yield M({roleId:n,cgformId:e.cgformId,type:f.value,authMode:s});o.value=l.map(p=>p.authId)})}function F(){a.value="",h()}function b(){return E(this,null,function*(){yield S(a.value,e.cgformId,{authId:JSON.stringify(o.value),authMode:t.value}),c.success("\u4FDD\u5B58\u6210\u529F")})}function K(n){let s=n.title+"-";return n.page==3?s+="\u5217\u8868\u53EF\u89C1":n.page==5&&(s+="\u8868\u5355\u53EF\u89C1"),s}function x(n){m.value=n,i.value=!1}function T(){a.value="",o.value=[]}return{loadChecked:g,clear:T,expandedKeys:m,autoExpandParent:i,checkedKeys:o,treeData:u,disabled:r,onSave:b,onExpand:x,onRefresh:D,clearChecked:F}}}),q={class:"onl-auth-tree-btns"};function J(e,c,a,f,i,m){const o=y("a-empty"),u=y("a-button"),t=y("a-tree");return v(),B("div",null,[e.disabled?(v(),I(o,{key:0,description:"\u8BF7\u5148\u9009\u4E2D\u5DE6\u4FA7\u89D2\u8272/\u90E8\u95E8/\u7528\u6237"})):e.treeData.length===0?(v(),I(o,{key:1,description:"\u65E0\u6743\u9650\u4FE1\u606F"})):(v(),B(z,{key:2},[L("div",q,[k(u,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:_(()=>[C("\u5237\u65B0")]),_:1},8,["onClick"]),k(u,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:_(()=>[C("\u4FDD\u5B58")]),_:1},8,["onClick"])]),k(t,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":c[0]||(c[0]=r=>e.checkedKeys=r),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}var Y=P(U,[["render",J],["__scopeId","data-v-0e98e024"]]);export{Y as default};
