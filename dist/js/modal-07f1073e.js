var b=(t,n,c)=>new Promise((F,_)=>{var B=a=>{try{o(c.next(a))}catch(f){_(f)}},s=a=>{try{o(c.throw(a))}catch(f){_(f)}},o=a=>a.done?F(a.value):Promise.resolve(a.value).then(B,s);o((c=c.apply(t,n)).next())});import{B as Y}from"./index-9d0047d3.js";import{s as $}from"./jvxetable.api-81580aa4.js";import{o as I,a as V}from"./api-e6e14170.js";import{B as q}from"./index-4b015b65.js";import{d as N,k as U,r as h,u as E,e as z,V as i,a5 as C,a9 as A,a7 as u,f as e,E as d,aa as H,a6 as O,F as j,a8 as T,ag as P}from"./vue-bcbaddf9.js";import{D as S}from"./jeecg-online-vendor-885afdd4.js";import"./BasicModal-5ab8e0d9.js";import"./antd-vue-vendor-a78909e6.js";import"./tinymce-vendor-676f8393.js";import"./useWindowSizeFn-e9ba77b6.js";import"./vxe-table-vendor-9edfd3ae.js";import"./lodash-es-vendor-9b741fb8.js";import"./echarts-vendor-6c8e2159.js";const K=N({name:"tableModal",components:{BasicModal:Y},emits:["success","register"],setup(t,{emit:n}){const c=U(!0),F=U(""),_=U(),B=h({xs:{span:24},sm:{span:5}}),s=h({xs:{span:24},sm:{span:16}}),o={orderCode:[{required:!0,message:"订单号不能为空",trigger:"blur"}]},a=h({id:null,orderCode:"",orderMoney:"",ctype:"",content:"",jeecgOrderCustomerList:[],jeecgOrderTicketList:[]}),[f,{setModalProps:v,closeModal:M}]=q(l=>b(this,null,function*(){if(v({confirmLoading:!1}),c.value=!!(l!=null&&l.isUpdate),y(),E(c)){F.value=l.record.id,Object.assign(a,l.record);let p={id:a.id};const r=yield I(p);a.jeecgOrderCustomerList=r;const R=yield V(p);a.jeecgOrderTicketList=R}})),m=z(()=>E(c)?"编辑":"新增");function g(){a.jeecgOrderCustomerList.push({})}function k(l){a.jeecgOrderCustomerList.splice(l,1),a.jeecgOrderCustomerList.splice(l,1)}function y(){a.id=null,a.orderCode="",a.orderMoney="",a.orderDate=null,a.ctype="",a.content="",a.jeecgOrderCustomerList=[],a.jeecgOrderTicketList=[]}function D(){a.jeecgOrderTicketList.push({})}function w(l){a.jeecgOrderTicketList.splice(l,1),a.jeecgOrderTicketList.splice(l,1)}function L(){return b(this,null,function*(){_.value.validate().then(()=>b(this,null,function*(){try{v({confirmLoading:!0}),yield $(a,E(c)),M(),n("success")}finally{v({confirmLoading:!1})}})).catch(l=>{})})}return{formRef:_,validatorRules:o,orderMainModel:a,registerModal:f,getTitle:m,labelCol:B,wrapperCol:s,addRowCustom:g,delRowCustom:k,addRowTicket:D,delRowTicket:w,handleSubmit:L}}});function G(t,n,c,F,_,B){const s=i("a-input"),o=i("a-form-item"),a=i("a-col"),f=i("a-select-option"),v=i("a-select"),M=i("a-date-picker"),m=i("a-row"),g=i("Icon"),k=i("a-button"),y=i("a-tab-pane"),D=i("a-tabs"),w=i("a-form"),L=i("BasicModal");return C(),A(L,P(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit,width:"70%"}),{default:u(()=>[e(w,{ref:"formRef",model:t.orderMainModel,"label-col":t.labelCol,"wrapper-col":t.wrapperCol,rules:t.validatorRules},{default:u(()=>[e(m,{class:"form-row",gutter:16},{default:u(()=>[e(a,{lg:8},{default:u(()=>[e(o,{label:"订单号",name:"orderCode"},{default:u(()=>[e(s,{value:t.orderMainModel.orderCode,"onUpdate:value":n[0]||(n[0]=l=>t.orderMainModel.orderCode=l),placeholder:"请输入订单号"},null,8,["value"])]),_:1})]),_:1}),e(a,{lg:8},{default:u(()=>[e(o,{label:"订单类型"},{default:u(()=>[e(v,{placeholder:"请选择订单类型",value:t.orderMainModel.ctype,"onUpdate:value":n[1]||(n[1]=l=>t.orderMainModel.ctype=l)},{default:u(()=>[e(f,{value:"1"},{default:u(()=>[d("国内订单")]),_:1}),e(f,{value:"2"},{default:u(()=>[d("国际订单")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(a,{lg:8},{default:u(()=>[e(o,{label:"订单日期"},{default:u(()=>[e(M,{showTime:"",valueFormat:"YYYY-MM-DD HH:mm:ss",value:t.orderMainModel.orderDate,"onUpdate:value":n[2]||(n[2]=l=>t.orderMainModel.orderDate=l)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(m,{class:"form-row",gutter:16},{default:u(()=>[e(a,{lg:8},{default:u(()=>[e(o,{label:"订单金额"},{default:u(()=>[e(s,{value:t.orderMainModel.orderMoney,"onUpdate:value":n[3]||(n[3]=l=>t.orderMainModel.orderMoney=l),placeholder:"请输入订单金额"},null,8,["value"])]),_:1})]),_:1}),e(a,{lg:8},{default:u(()=>[e(o,{label:"订单备注"},{default:u(()=>[e(s,{value:t.orderMainModel.content,"onUpdate:value":n[4]||(n[4]=l=>t.orderMainModel.content=l),placeholder:"请输入订单备注"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(D,{defaultActiveKey:"1"},{default:u(()=>[e(y,{tab:"客户信息",key:"1"},{default:u(()=>[H("div",null,[e(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16},{default:u(()=>[e(a,{span:5},{default:u(()=>[d("客户名")]),_:1}),e(a,{span:5},{default:u(()=>[d("性别")]),_:1}),e(a,{span:6},{default:u(()=>[d("身份证号码")]),_:1}),e(a,{span:6},{default:u(()=>[d("手机号")]),_:1}),e(a,{span:2},{default:u(()=>[d("操作")]),_:1})]),_:1}),(C(!0),O(j,null,T(t.orderMainModel.jeecgOrderCustomerList,(l,p)=>(C(),A(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16,key:p},{default:u(()=>[e(a,{span:6,style:{display:"none"}},{default:u(()=>[e(o,null,{default:u(()=>[e(s,{placeholder:"id",value:l.id,"onUpdate:value":r=>l.id=r},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:5},{default:u(()=>[e(o,null,{default:u(()=>[e(s,{placeholder:"客户名",value:l.name,"onUpdate:value":r=>l.name=r},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:5},{default:u(()=>[e(o,null,{default:u(()=>[e(v,{placeholder:"性别",value:l.sex,"onUpdate:value":r=>l.sex=r},{default:u(()=>[e(f,{value:"1"},{default:u(()=>[d("男")]),_:1}),e(f,{value:"2"},{default:u(()=>[d("女")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:6},{default:u(()=>[(C(),A(o,{name:["jeecgOrderCustomerList",p,"idcard"],rules:[{required:!0,message:"请输入身份证号",trigger:"blur"}],key:p},{default:u(()=>[e(s,{placeholder:"身份证号",value:l.idcard,"onUpdate:value":r=>l.idcard=r},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]))]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,{name:["jeecgOrderCustomerList",p,"telphone"]},{default:u(()=>[e(s,{placeholder:"手机号",value:l.telphone,"onUpdate:value":r=>l.telphone=r},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(a,{span:2},{default:u(()=>[e(o,null,{default:u(()=>[e(g,{icon:"ant-design:minus-outlined",onClick:r=>t.delRowCustom(p),style:{fontsize:"20px"}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(k,{type:"dashed",style:{width:"98%","margin-top":"10px"},onClick:t.addRowCustom},{default:u(()=>[e(g,{icon:"ph:plus-bold"}),d(" 添加客户信息 ")]),_:1},8,["onClick"])])]),_:1}),e(y,{tab:"机票信息",key:"2",forceRender:""},{default:u(()=>[e(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16},{default:u(()=>[e(a,{span:6},{default:u(()=>[d("航班号")]),_:1}),e(a,{span:6},{default:u(()=>[d("航班时间")]),_:1}),e(a,{span:6},{default:u(()=>[d("操作")]),_:1})]),_:1}),(C(!0),O(j,null,T(t.orderMainModel.jeecgOrderTicketList,(l,p)=>(C(),A(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16,key:p},{default:u(()=>[e(a,{span:6,style:{display:"none"}},{default:u(()=>[e(o,null,{default:u(()=>[e(s,{placeholder:"id",value:l.id,"onUpdate:value":r=>l.id=r},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,{name:["jeecgOrderTicketList",p,"ticketCode"],rules:{required:!0,message:"请输入航班号",trigger:"blur"}},{default:u(()=>[e(s,{placeholder:"航班号",value:l.ticketCode,"onUpdate:value":r=>l.ticketCode=r},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,null,{default:u(()=>[e(M,{placeholder:"航班时间",valueFormat:"YYYY-MM-DD",value:l.tickectDate,"onUpdate:value":r=>l.tickectDate=r},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,null,{default:u(()=>[e(g,{icon:"ant-design:minus-outlined",onClick:r=>t.delRowTicket(p),style:{fontsize:"20px"}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(k,{type:"dashed",style:{width:"98%","margin-top":"10px"},onClick:t.addRowTicket},{default:u(()=>[e(g,{icon:"ph:plus-bold"}),d(" 添加机票信息 ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model","label-col","wrapper-col","rules"])]),_:1},16,["onRegister","title","onOk"])}const de=S(K,[["render",G],["__scopeId","data-v-ffab824d"]]);export{de as default};
