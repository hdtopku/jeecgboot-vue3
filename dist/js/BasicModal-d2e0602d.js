var fe=Object.defineProperty,me=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var te=(e,t,a)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,F=(e,t)=>{for(var a in t||(t={}))ge.call(t,a)&&te(e,a,t[a]);if(ee)for(var a of ee(t))he.call(t,a)&&te(e,a,t[a]);return e},E=(e,t)=>me(e,pe(t));var V=(e,t,a)=>new Promise((f,o)=>{var i=u=>{try{c(a.next(u))}catch(d){o(d)}},l=u=>{try{c(a.throw(u))}catch(d){o(d)}},c=u=>u.done?f(u.value):Promise.resolve(u.value).then(i,l);c((a=a.apply(e,t)).next())});import{q as ie,af as ye,D as z,X as Ce,a$ as be}from"./jeecg-online-vendor-9cc54e36.js";import{r as Se,at as ve,c as ke,u as Fe,a6 as He,aC as $e,m as ce,as as Be}from"./index-26fb0584.js";import{s as X,u as r,d as D,H as Me,f as h,i as Oe,k as v,e as H,w as I,o as Te,b as _e,n as P,V as g,x as we,a5 as y,a9 as $,a7 as p,v as Pe,a6 as L,R as M,an as De,F as ne,W as Y,am as Ne,E as G,ab as J,ag as q,g as Re,z as We,al as oe,a8 as le,ae,af as se}from"./vue-5a09445c.js";import{M as je,bn as Ee,cY as Le,cZ as qe,c3 as ze,c_ as Ae,c$ as Ve,S as Z}from"./antd-vue-vendor-04f0af1d.js";import{useWindowSizeFn as Ie}from"./useWindowSizeFn-cfb01db5.js";const{t:re}=ie(),Xe={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:re("common.cancelText")},okText:{type:String,default:re("common.okText")},closeFunc:Function},K=Object.assign({},Xe,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number},enableComment:{type:Boolean,default:!1}});function Ye(e){const t=(o,i)=>getComputedStyle(o)[i],a=o=>{if(!o)return;o.setAttribute("data-drag",r(e.draggable));const i=o.querySelector(".ant-modal-header"),l=o.querySelector(".ant-modal");!i||!l||!r(e.draggable)||(i.style.cursor="move",i.onmousedown=c=>{if(!c)return;const u=c.clientX,d=c.clientY,n=document.body.clientWidth,m=document.documentElement.clientHeight,k=l.offsetWidth,b=l.offsetHeight,S=l.offsetLeft,C=n-l.offsetLeft-k,B=l.offsetTop;let _=m-l.offsetTop-b;_<0&&(_=m-l.offsetTop);const w=t(l,"left"),N=t(l,"top");let R=+w,W=+N;w.includes("%")?(R=+document.body.clientWidth*(+w.replace(/%/g,"")/100),W=+document.body.clientHeight*(+N.replace(/%/g,"")/100)):(R=+w.replace(/px/g,""),W=+N.replace(/px/g,"")),document.onmousemove=function(A){let O=A.clientX-u,T=A.clientY-d;-O>S?O=-S:O>C&&(O=C),-T>B?T=-B:T>_&&(T=_),l.style.cssText+=`;left:${O+R}px;top:${T+W}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},f=()=>{const o=document.querySelectorAll(".ant-modal-wrap");for(const i of Array.from(o)){if(!i)continue;const l=t(i,"display"),c=i.getAttribute("data-drag");l!=="none"&&(c===null||r(e.destroyOnClose))&&a(i)}};X(()=>{!r(e.visible)||!r(e.draggable)||Se(()=>{f()},30)})}function Ue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Oe(e)}const Ze=D({name:"Modal",inheritAttrs:!1,props:K,emits:["cancel"],setup(e,{slots:t,emit:a}){const{visible:f,draggable:o,destroyOnClose:i}=Me(e),l=ye();Ye({visible:f,destroyOnClose:i,draggable:o});const c=u=>{a("cancel",u)};return()=>{let u;const d=E(F(F({},r(l)),e),{onCancel:c});return h(je,d,Ue(u=ve(t))?u:{default:()=>[u]})}}}),ue=Symbol();function Ge(e){return ke(e,ue)}function St(){return Fe(ue)}const Je={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},Ke=D({name:"ModalWrapper",components:{ScrollContainer:He},inheritAttrs:!1,props:Je,emits:["height-change","ext-height"],setup(e,{emit:t}){const a=v(null),f=v(null),o=v(0),i=v(0);let l=0;Ie(d.bind(null,!1)),$e(f,()=>{d()},{attributes:!0,subtree:!0}),Ge({redoModalHeight:d});const c=H(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${r(o)}px`}));X(()=>{e.useWrapper&&d()}),I(()=>e.fullScreen,n=>{d(),n?i.value=o.value:o.value=i.value}),Te(()=>{const{modalHeaderHeight:n,modalFooterHeight:m}=e;t("ext-height",n+m)}),_e(()=>{});function u(){return V(this,null,function*(){P(()=>{var m;const n=r(a);n&&((m=n==null?void 0:n.scrollTo)==null||m.call(n,0))})})}function d(){return V(this,null,function*(){if(!e.visible)return;const n=r(a);if(!n)return;const m=n.$el.parentElement;if(m){m.style.padding="0",yield P();try{const k=m.parentElement&&m.parentElement.parentElement;if(!k)return;const b=getComputedStyle(k).top,S=Number.parseInt(b);let C=window.innerHeight-S*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;S<40&&(C-=26),yield P();const B=r(f);if(!B)return;yield P(),l=B.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:l>C?C:l,t("height-change",r(o))}catch(k){}}})}return{wrapperRef:a,spinRef:f,spinStyle:c,scrollTop:u,setModalHeight:d}}}),Qe=["loading-tip"];function xe(e,t,a,f,o,i){const l=g("ScrollContainer"),c=we("loading");return y(),$(l,{ref:"wrapperRef"},{default:p(()=>[Pe((y(),L("div",{ref:"spinRef",style:De(e.spinStyle),"loading-tip":e.loadingTip},[M(e.$slots,"default")],12,Qe)),[[c,e.loading]])]),_:3},512)}const et=z(Ke,[["render",xe]]),tt=D({name:"ModalClose",components:{Tooltip:Ee,FullscreenExitOutlined:Le,FullscreenOutlined:qe,CloseOutlined:ze,LeftSquareOutlined:Ae,RightSquareOutlined:Ve},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean},enableComment:{type:Boolean,default:!1},commentSpan:{type:Number,default:0}},emits:["cancel","fullscreen","comment"],setup(e,{emit:t}){const{prefixCls:a}=ce("basic-modal-close"),{t:f}=ie(),o=H(()=>[a,`${a}--custom`,{[`${a}--can-full`]:e.canFullscreen||e.enableComment}]);function i(n){t("cancel",n)}function l(n){n==null||n.stopPropagation(),n==null||n.preventDefault(),(e.commentSpan==0||e.enableComment==!1)&&t("fullscreen")}function c(n){n==null||n.stopPropagation(),n==null||n.preventDefault(),e.fullScreen==!1&&t("fullscreen"),t("comment",!0)}function u(n){n==null||n.stopPropagation(),n==null||n.preventDefault(),t("comment",!1)}const d=H(()=>e.enableComment===!0?!1:e.canFullscreen);return{t:f,getClass:o,prefixCls:a,handleCancel:i,handleFullScreen:l,handleOpenComment:c,handleCloseComment:u,fullScreenStatus:d}}});function nt(e,t,a,f,o,i){const l=g("FullscreenExitOutlined"),c=g("Tooltip"),u=g("FullscreenOutlined"),d=g("RightSquareOutlined"),n=g("LeftSquareOutlined"),m=g("CloseOutlined");return y(),L("div",{class:Ne(e.getClass)},[e.fullScreenStatus?(y(),L(ne,{key:0},[e.fullScreen?(y(),$(c,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:p(()=>[h(l,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(y(),$(c,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:p(()=>[h(u,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):Y("",!0),e.enableComment?(y(),L(ne,{key:1},[e.commentSpan>0?(y(),$(c,{key:0,title:"收起",placement:"bottom"},{default:p(()=>[h(d,{onClick:e.handleCloseComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1})):(y(),$(c,{key:1,title:"展开",placement:"bottom"},{default:p(()=>[h(n,{onClick:e.handleOpenComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1}))],64)):Y("",!0),h(c,{title:e.t("component.modal.close"),placement:"bottom"},{default:p(()=>[h(m,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}const ot=z(tt,[["render",nt]]),lt=D({name:"BasicModalFooter",props:K,emits:["ok","cancel"],setup(e,{emit:t}){function a(o){t("ok",o)}function f(o){t("cancel",o)}return{handleOk:a,handleCancel:f}}});function at(e,t,a,f,o,i){const l=g("a-button");return y(),L("div",null,[M(e.$slots,"insertFooter"),e.showCancelBtn?(y(),$(l,q({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:p(()=>[G(J(e.cancelText),1)]),_:1},16,["onClick"])):Y("",!0),M(e.$slots,"centerFooter"),e.showOkBtn?(y(),$(l,q({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:p(()=>[G(J(e.okText),1)]),_:1},16,["type","onClick","loading"])):Y("",!0),M(e.$slots,"appendFooter")])}const st=z(lt,[["render",at]]),rt=D({name:"BasicModalHeader",components:{BasicTitle:Be},emits:["dblclick"],props:{helpMessage:{type:[String,Array]},title:{type:String}}});function it(e,t,a,f,o,i){const l=g("BasicTitle");return y(),$(l,{helpMessage:e.helpMessage},{default:p(()=>[G(J(e.title),1)]),_:1},8,["helpMessage"])}const ct=z(rt,[["render",it]]);function ut(e){const t=v(!1),a=H(()=>{const o=r(e.wrapClassName)||"";return r(t)?`fullscreen-modal ${o} `:r(o)});function f(o){o&&o.stopPropagation(),t.value=!r(t)}return{getWrapClassName:a,handleFullScreen:f,fullScreenRef:t}}const dt=D({name:"BasicModal",components:{Modal:Ze,ModalWrapper:et,ModalClose:ot,ModalFooter:st,ModalHeader:ct},inheritAttrs:!1,props:K,emits:["visible-change","height-change","cancel","ok","register","update:visible","fullScreen"],setup(e,{emit:t,attrs:a,slots:f}){const o=v(!1),i=v(null),l=v(null),{prefixCls:c}=ce("basic-modal"),u=v(0),d={setModalProps:R,emitVisible:void 0,redoModalHeight:()=>{P(()=>{r(l)&&r(l).setModalHeight()})}},n=Re();n&&t("register",d,n.uid);const m=H(()=>F(F({},e),r(i))),k=H(()=>!r(m).title&&!f.title),{handleFullScreen:b,getWrapClassName:S,fullScreenRef:C}=ut({modalWrapperRef:l,extHeightRef:u,wrapClassName:We(m.value,"wrapClassName")}),B=H(()=>{const s=E(F({},r(m)),{visible:r(o),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return E(F({},s),{wrapClassName:r(S)})}),_=H(()=>{const s=E(F(F({},a),r(m)),{visible:r(o),wrapClassName:r(S)});return r(C)?Z(s,["height","title"]):Z(s,"title")}),w=H(()=>{if(!r(C))return r(B).height});X(()=>{C.value=!!e.defaultFullscreen}),X(()=>{o.value=!!e.visible}),I(()=>r(o),s=>{var j;t("visible-change",s),t("update:visible",s),n&&((j=d.emitVisible)==null||j.call(d,s,n.uid)),P(()=>{e.scrollTop&&s&&r(l)&&r(l).scrollTop()})},{immediate:!1});function N(s){return V(this,null,function*(){var j,x;if(s==null||s.stopPropagation(),!((x=(j=s.target)==null?void 0:j.classList)!=null&&x.contains(c+"-close--custom"))){if(e.closeFunc&&Ce(e.closeFunc)){const de=yield e.closeFunc();o.value=!de;return}o.value=!1,t("cancel",s)}})}function R(s){i.value=be(r(i)||{},s),Reflect.has(s,"visible")&&(o.value=!!s.visible),Reflect.has(s,"defaultFullscreen")&&(C.value=!!s.defaultFullscreen)}function W(s){t("ok",s)}function A(s){t("height-change",s)}function O(s){u.value=s}function T(s){e.canFullscreen&&(s.stopPropagation(),b(s))}const U=v(0);I(()=>e.enableComment,s=>{Q(s)},{immediate:!0});function Q(s){s===!0?U.value=6:U.value=0}return I(C,s=>{t("fullScreen",s)}),{handleCancel:N,getBindValue:_,getProps:B,handleFullScreen:b,fullScreenRef:C,getMergeProps:m,handleOk:W,visibleRef:o,omit:Z,modalWrapperRef:l,handleExtHeight:O,handleHeightChange:A,handleTitleDbClick:T,getWrapperHeight:w,commentSpan:U,handleComment:Q,isNoTitle:k}}});function ft(e,t,a,f,o,i){const l=g("ModalClose"),c=g("ModalHeader"),u=g("ModalFooter"),d=g("ModalWrapper"),n=g("a-col"),m=g("a-row"),k=g("Modal");return y(),$(k,q(e.getBindValue,{onCancel:e.handleCancel}),oe({default:p(()=>[h(m,{class:"jeecg-modal-wrapper"},{default:p(()=>[h(n,{span:24-e.commentSpan,class:"jeecg-modal-content"},{default:p(()=>[h(d,q({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:p(()=>[M(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:3},8,["span"]),h(n,{span:e.commentSpan,class:"jeecg-comment-outer"},{default:p(()=>[M(e.$slots,"comment")]),_:3},8,["span"])]),_:3})]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:p(()=>[h(l,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,commentSpan:e.commentSpan,enableComment:e.getProps.enableComment,onComment:e.handleComment,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","commentSpan","enableComment","onComment","onCancel","onFullscreen"])]),key:"0"},e.isNoTitle?void 0:{name:"title",fn:p(()=>[h(c,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]),key:"1"},e.$slots.footer?void 0:{name:"footer",fn:p(()=>[h(u,q(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),oe({_:2},[le(Object.keys(e.$slots),b=>({name:b,fn:p(S=>[M(e.$slots,b,ae(se(S||{})))])}))]),1040,["onOk","onCancel"])]),key:"2"},le(Object.keys(e.omit(e.$slots,"default")),b=>({name:b,fn:p(S=>[M(e.$slots,b,ae(se(S||{})))])}))]),1040,["onCancel"])}const mt=z(dt,[["render",ft]]),vt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));export{mt as B,vt as a,St as u};
