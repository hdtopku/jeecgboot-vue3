import{c3 as M,c4 as V,c5 as R,c6 as $,bW as q,l as H}from"./jeecg-online-vendor-bf2efbcb.js";import{k as J,l as L,s as W}from"./auth.api-9f2a65b5.js";import{d as j,k as p,e as G,w as Q,u as X,U as f,aV as E,as as A,ar as K,F as Y,at as Z,f as c,bi as y,E as k}from"./vue-c7e3516e.js";import{i as ee}from"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./lodash-es-vendor-42c8d3d4.js";var O=(e,h,u)=>new Promise((C,m)=>{var i=o=>{try{l(u.next(o))}catch(d){m(d)}},a=o=>{try{l(u.throw(o))}catch(d){m(d)}},l=o=>o.done?C(o.value):Promise.resolve(o.value).then(i,a);l((u=u.apply(e,h)).next())});const ne=j({name:"AuthFieldTree",components:{DownCircleOutlined:M,HomeOutlined:V,UpCircleOutlined:R,UndoOutlined:$,CheckOutlined:ee},props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:h}=H(),u=p(""),C=p(1),m=p(!0),i=p([]),a=p([]),l=p([]),o=p([]),d=p(""),_=G(()=>!u.value);Q(()=>e.cgformId,v,{immediate:!0});function v(){return O(this,null,function*(){if(!e.cgformId)return;let n=yield J(e.cgformId,C.value),t=[],s=[];n.forEach(r=>{s.includes(r.code)||(s.push(r.code),t.push({key:r.code,title:r.title}))});for(let r of t){let I=[];for(let D of n)if(r.key===D.code){let N=F(D);I.push({key:D.id,title:N})}r.children=I}o.value=t,i.value=[...s],l.value=s})}function F(n){let t="";return n.page==3?t+="\u5217\u8868":n.page==5&&(t+="\u8868\u5355"),n.control==3?t+="\u53EF\u7F16\u8F91":n.control==5&&(t+="\u53EF\u89C1"),t}function g(n,t){return O(this,null,function*(){u.value=n,d.value=t,a.value=[],yield v();let s=yield L({roleId:n,cgformId:e.cgformId,type:C.value,authMode:t});a.value=s.map(r=>r.authId)})}function b(){u.value="",v()}function w(){v(),g(u.value,d.value)}function B(){return O(this,null,function*(){let n=a.value.filter(t=>l.value.indexOf(t)<0);yield W(u.value,e.cgformId,{authId:JSON.stringify(n),authMode:d.value}),h.success("\u4FDD\u5B58\u6210\u529F")})}function S(){i.value=[...l.value]}function T(){i.value=[]}function U(n){i.value=n,m.value=!1}function x(){u.value="",a.value=[]}function z(){a.value=[]}function P(){const n=function(t){for(let s of t)a.value.push(s.key),s.children&&s.children.length>0&&n.call(null,s.children)};a.value=[],n.call(null,X(o))}return{loadChecked:g,clear:x,expandedKeys:i,autoExpandParent:m,checkedKeys:a,treeData:o,disabled:_,onSave:B,onExpand:U,clearChecked:b,onCloseAll:T,onExpandAll:S,onRefresh:w,onClearSelected:z,onSelectAll:P}}}),te={class:"onl-auth-tree-btns"};function le(e,h,u,C,m,i){const a=f("a-empty"),l=f("a-button"),o=f("DownCircleOutlined"),d=f("UpCircleOutlined"),_=f("CheckOutlined"),v=f("UndoOutlined"),F=f("a-tree");return E(),A("div",null,[e.disabled?(E(),K(a,{key:0,description:"\u8BF7\u5148\u9009\u4E2D\u5DE6\u4FA7\u89D2\u8272/\u90E8\u95E8/\u7528\u6237"})):e.treeData.length===0?(E(),K(a,{key:1,description:"\u65E0\u6743\u9650\u4FE1\u606F"})):(E(),A(Y,{key:2},[Z("div",te,[c(l,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:y(()=>[k("\u5237\u65B0")]),_:1},8,["onClick"]),c(l,{onClick:e.onExpandAll,size:"small",type:"primary",ghost:""},{default:y(()=>[c(o),k("\u5C55\u5F00")]),_:1},8,["onClick"]),c(l,{onClick:e.onCloseAll,size:"small",type:"primary",ghost:""},{default:y(()=>[c(d),k("\u6298\u53E0")]),_:1},8,["onClick"]),c(l,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:y(()=>[k("\u4FDD\u5B58")]),_:1},8,["onClick"]),c(l,{onClick:e.onSelectAll,size:"small",type:"primary",ghost:""},{default:y(()=>[c(_),k("\u5168\u9009")]),_:1},8,["onClick"]),c(l,{onClick:e.onClearSelected,size:"small",type:"primary",ghost:""},{default:y(()=>[c(v),k("\u91CD\u7F6E")]),_:1},8,["onClick"])]),c(F,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":h[0]||(h[0]=g=>e.checkedKeys=g),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}var re=q(ne,[["render",le],["__scopeId","data-v-909a7fde"]]);export{re as default};
