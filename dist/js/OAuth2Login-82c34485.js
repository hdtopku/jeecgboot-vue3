import{a2 as a,a3 as u}from"./index-679980cc.js";import{d as h,k as c,a4 as m,a5 as k,a6 as v}from"./vue-249e5fad.js";import{ah as A,au as y,T as _,s as T,q as L,u as w}from"./jeecg-online-vendor-216a3b98.js";import"./antd-vue-vendor-31afcf32.js";import"./tinymce-vendor-676f8393.js";import"./lodash-es-vendor-c1987ca1.js";import"./echarts-vendor-6c8e2159.js";import"./vxe-table-vendor-0b109a77.js";const R=h({__name:"OAuth2Login",setup(x){const l=c(a()),e=c({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:p}=m(),s=p.value;a()||A.replace({path:y.BASE_LOGIN,query:s.query}),l.value&&g();function g(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),d()}function d(){if(e.value.thirdApp)if(s.query.oauth2LoginToken){let o=s.query.oauth2LoginToken;f({token:o,thirdType:s.query.thirdType,tenantId:_})}else e.value.wxWork?u("wechat_enterprise"):e.value.dingtalk&&u("dingtalk")}function f(o){const i=T(),{notification:r}=w(),{t:n}=L();i.ThirdLogin(o).then(t=>{t&&t.userInfo?r.success({message:n("sys.login.loginSuccessTitle"),description:`${n("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):r.error({message:n("sys.login.errorTip"),description:((t.response||{}).data||{}).message||t.message||n("sys.login.networkExceptionMsg"),duration:4})})}return(o,i)=>(k(),v("div"))}});export{R as default};
