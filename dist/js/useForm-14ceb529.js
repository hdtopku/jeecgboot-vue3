var Je=Object.defineProperty,Ge=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var ke=Object.getOwnPropertySymbols;var Qe=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var Re=(e,o,r)=>o in e?Je(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,T=(e,o)=>{for(var r in o||(o={}))Qe.call(o,r)&&Re(e,r,o[r]);if(ke)for(var r of ke(o))Ze.call(o,r)&&Re(e,r,o[r]);return e},De=(e,o)=>Ge(e,Xe(o));var I=(e,o,r)=>new Promise((c,v)=>{var h=m=>{try{a(r.next(m))}catch(f){v(f)}},t=m=>{try{a(r.throw(m))}catch(f){v(f)}},a=m=>m.done?c(m.value):Promise.resolve(m.value).then(h,t);a((r=r.apply(e,o)).next())});import{e as N,u as n,d as Te,H as et,v as tt,B as nt,f as M,i as ot,E as le,af as J,V as H,a7 as Y,ac as ee,ai as ce,aa as _,ad as st,aq as at,R as K,ae as pe,W as ie,w as oe,J as Me,s as rt,n as Oe,r as Ve,l as U,o as it,a9 as lt,aj as he,a8 as ct,F as ut,ab as be,as as Le,b as dt}from"./vue-50733b77.js";import{c4 as de,d as we,bU as ft,c2 as Pe,e as Fe,c3 as mt}from"./antd-vue-vendor-c5335947.js";import{K as pt,L as ht,A as Ne,c as bt,u as yt,M as gt,N as At,p as S,O as vt,d as We,C as Ce,m as wt}from"./index-b34ff7bc.js";import{j as $e,h as ye}from"./componentMap-5c02cfaf.js";import{o as je,av as se,aR as z,aq as Ie,j as $,aw as ne,aA as Ft,_ as _e,k as fe,i as ue,b0 as Ct,aC as Be,$ as qe,aP as He,b1 as Bt,b2 as Tt,b3 as Ot,aB as xe,aU as Pt}from"./jeecg-online-vendor-d3e1865b.js";import{u as jt,s as It,a as St}from"./lodash-es-vendor-058e2396.js";import"./index-f7d688aa.js";import{u as kt}from"./BasicModal-064024e0.js";const{t:ge}=je();function Ee(e){return e.includes("Input")||e.includes("Complete")?ge("common.inputText"):e.includes("Picker")||e.includes("Select")||e.includes("Cascader")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")?ge("common.chooseText"):""}const Rt=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function Dt(){return[...Rt,"RangePicker"]}function Mt(e,o,r){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(o)?e.type=r?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(o)?e.type="array":["InputNumber"].includes(o)&&(e.type="number")}function Vt(e,o){return e&&["Input","InputPassword","InputSearch","InputTextArea"].includes(e)&&o&&Ie(o)?`${o}`:o}const Ke=Dt();function Lt(e,o){return N(()=>{const r=n(e),{labelCol:c={},wrapperCol:v={}}=r.itemProps||{},{labelWidth:h,disabledLabelWidth:t}=r,{labelWidth:a,labelCol:m,wrapperCol:f,layout:j}=n(o);if(t)return{labelCol:c,wrapperCol:v};if(!a&&!h&&!m)return c.style={textAlign:"left"},{labelCol:c,wrapperCol:v};let g=h||a;const B=T(T({},m),c),E=T(T({},f),v);return g&&(g=Ie(g)?`${g}px`:g),{labelCol:T({style:{width:g||"100%"}},B),wrapperCol:T({style:{width:j==="vertical"?"100%":`calc(100% - ${g})`}},E)}})}function Ae(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ot(e)}const Nt=Te({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},validateFields:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object}},setup(e,{slots:o}){const{t:r}=je(),{schema:c,formProps:v}=et(e),h=Lt(c,v),t=N(()=>{const{allDefaultValues:u,formModel:l,schema:y}=e,{mergeDynamicData:O}=e.formProps;return{field:y.field,model:l,values:T(T(T({},O),u),l),schema:y}}),a=N(()=>{var A;const{schema:u,tableAction:l,formModel:y,formActionType:O}=e;let{componentProps:p={}}=u;return $(p)&&(p=(A=p({schema:u,tableAction:l,formModel:y,formActionType:O}))!=null?A:{}),u.component==="Divider"&&(p=Object.assign({type:"horizontal",orientation:"left",plain:!0},p)),p}),m=N(()=>{const{disabled:u}=e.formProps,{dynamicDisabled:l}=e.schema,{disabled:y=!1}=n(a);let O=!!u||y;return ne(l)&&(O=l),$(l)&&(O=l(n(t))),O});function f(){const{show:u,ifShow:l}=e.schema,{showAdvancedButton:y}=e.formProps,O=y&&ne(e.schema.isAdvanced)?e.schema.isAdvanced:!0;let p=!0,A=!0;return ne(u)&&(p=u),ne(l)&&(A=l),$(u)&&(p=u(n(t))),$(l)&&(A=l(n(t))),p=p&&O,{isShow:p,isIfShow:A}}function j(){var L;const{rules:u=[],component:l,rulesMessageJoinLabel:y,label:O,dynamicRules:p,required:A}=e.schema;if($(p))return p(n(t));let F=we(u);const{rulesMessageJoinLabel:D}=e.formProps,s=Reflect.has(e.schema,"rulesMessageJoinLabel")?y:D,i=Ee(l)+`${s?O:""}`;function b(R,P){const x=R.message||i;return P===void 0||Ft(P)||Array.isArray(P)&&P.length===0||typeof P=="string"&&P.trim()===""||typeof P=="object"&&Reflect.has(P,"checked")&&Reflect.has(P,"halfChecked")&&Array.isArray(P.checked)&&Array.isArray(P.halfChecked)&&P.checked.length===0&&P.halfChecked.length===0?Promise.reject(x):Promise.resolve()}const d=$(A)?A(n(t)):A;(!F||F.length===0)&&d&&(F=[{required:d,validator:b}]);const k=F.findIndex(R=>Reflect.has(R,"required")&&!Reflect.has(R,"validator"));if(k!==-1){const R=F[k],{isShow:P}=f();if(P||(R.required=!1),l){Reflect.has(R,"type")||(R.type=l==="InputNumber"?"number":"string"),R.message=R.message||i,(l.includes("Input")||l.includes("Textarea"))&&(R.whitespace=!0);const x=(L=n(a))==null?void 0:L.valueFormat;Mt(R,l,x)}}const w=F.findIndex(R=>R.max);return w!==-1&&!F[w].validator&&(F[w].message=F[w].message||r("component.form.maxTip",[F[w].max])),F}function g(){var ae;const{renderComponentContent:u,component:l,field:y,changeEvent:O="change",valueField:p,componentProps:A}=e.schema,F=l&&["Switch","Checkbox"].includes(l);let D=!1;l==="Input"&&A&&A.trim&&(D=!0);const s=`on${jt(O)}`,i={[s]:(...G)=>{const[te]=G;w[s]&&w[s](...G);const X=te?te.target:null;let q;X?F?q=X.checked:q=D?X.value.trim():X.value:q=te,e.setFormModel(y,q)}},b=$e.get(l),{autoSetPlaceHolder:d,size:k}=e.formProps,w=De(T({allowClear:!0,getPopupContainer:G=>G.parentNode,size:k},n(a)),{disabled:n(m)});!w.disabled&&d&&l!=="RangePicker"&&l&&(w.placeholder=((ae=n(a))==null?void 0:ae.placeholder)||Ee(l)+e.schema.label),w.codeField=y,w.formValues=n(t);const R={[p||(F?"checked":"value")]:e.formModel[y]},P=T(T(T({},w),i),R);if(!u)return M(b,P,null);const x=$(u)?T({},u(n(t))):{default:()=>u};return M(b,P,Ae(x)?x:{default:()=>[x]})}function B(){const{label:u,helpMessage:l,helpComponentProps:y,subLabel:O,labelLength:p}=e.schema;let A=u+"";p&&A.length>4&&(A=A.substr(0,p));const D=O?M("span",null,[u,le(" "),M("span",{class:"text-secondary"},[O])]):p?M("label",{title:u},[A]):u,s=$(l)?l(n(t)):l;return!s||Array.isArray(s)&&s.length===0?D:M("span",null,[D,M(ht,J({placement:"top",class:"mx-1",text:s},y),null)])}function E(){const{itemProps:u,slot:l,render:y,field:O,suffix:p,component:A}=e.schema,{labelCol:F,wrapperCol:D}=n(h),{colon:s}=e.formProps;if(A==="Divider"){let i;return M(de,{span:24},{default:()=>[M(ft,n(a),Ae(i=B())?i:{default:()=>[i]})]})}else{const i=()=>l?Ne(o,l,n(t)):y?y(n(t)):g(),b=!!p,d=$(p)?p(n(t)):p;return M(Pe.Item,J({name:O,colon:s,class:{"suffix-item":b}},u,{label:B(),rules:j(),labelCol:F,wrapperCol:D}),{default:()=>[M("div",{style:"display:flex"},[M("div",{style:"flex:1; width: 100%;"},[i()]),b&&M("span",{class:"suffix"},[d])])]})}}return()=>{let u;const{colProps:l={},colSlot:y,renderColContent:O,component:p}=e.schema;if(!$e.has(p))return null;const{baseColProps:A={}}=e.formProps,{getIsMobile:F}=pt();let D;l.span&&!n(F)&&["xs","sm","md","lg","xl","xxl"].forEach(k=>delete A[k]),D=T(T({},A),l);const{isIfShow:s,isShow:i}=f(),b=n(t);return s&&tt(M(de,D,Ae(u=(()=>y?Ne(o,y,b):O?O(b):E())())?u:{default:()=>[u]}),[[nt,i]])}}}),ze=Symbol();function $t(e){return bt(e,ze)}function xt(){return yt(ze)}const Et=Te({name:"BasicFormAction",components:{FormItem:Pe.Item,Button:gt,BasicArrow:At,[de.name]:de},props:{showActionButtonGroup:S.bool.def(!0),showResetButton:S.bool.def(!0),showSubmitButton:S.bool.def(!0),showAdvancedButton:S.bool.def(!0),resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:S.number.def(6),isAdvanced:S.bool,hideAdvanceBtn:S.bool,layout:S.oneOf(["horizontal","vertical","inline"]).def("horizontal")},emits:["toggle-advanced"],setup(e,{emit:o}){const{t:r}=je(),c=N(()=>{const{showAdvancedButton:a,actionSpan:m,actionColOptions:f}=e,j=24-m,g=a?{span:j<6?24:j}:{},B=T(T({style:{textAlign:"right"}},g),f);return e.layout!=="inline"&&(B.span=a?6:4),B}),v=N(()=>Object.assign({text:r("common.resetText"),preIcon:"ic:baseline-restart-alt"},e.resetButtonOptions)),h=N(()=>Object.assign({},{text:r("common.queryText"),preIcon:"ant-design:search-outlined"},e.submitButtonOptions));function t(){o("toggle-advanced")}return T({t:r,actionColOpt:c,getResetBtnOptions:v,getSubmitBtnOptions:h,toggleAdvanced:t},xt())}});function Wt(e,o,r,c,v,h){const t=H("Button"),a=H("BasicArrow"),m=H("FormItem"),f=H("a-col");return e.showActionButtonGroup?(Y(),ee(f,ce(J({key:0},e.actionColOpt)),{default:_(()=>[st("div",{style:at([{width:"100%"},{textAlign:e.actionColOpt.style.textAlign}])},[M(m,null,{default:_(()=>[K(e.$slots,"submitBefore"),e.showSubmitButton?(Y(),ee(t,J({key:0,type:"primary",class:"mr-2"},e.getSubmitBtnOptions,{onClick:e.submitAction}),{default:_(()=>[le(pe(e.getSubmitBtnOptions.text),1)]),_:1},16,["onClick"])):ie("",!0),K(e.$slots,"resetBefore"),e.showResetButton?(Y(),ee(t,J({key:1,type:"default",class:"mr-2"},e.getResetBtnOptions,{onClick:e.resetAction}),{default:_(()=>[le(pe(e.getResetBtnOptions.text),1)]),_:1},16,["onClick"])):ie("",!0),K(e.$slots,"advanceBefore"),e.showAdvancedButton&&!e.hideAdvanceBtn?(Y(),ee(t,{key:2,type:"link",size:"small",onClick:e.toggleAdvanced},{default:_(()=>[le(pe(e.isAdvanced?e.t("component.form.putAway"):e.t("component.form.unfold"))+" ",1),M(a,{class:"ml-1",expand:!e.isAdvanced,up:""},null,8,["expand"])]),_:1},8,["onClick"])):ie("",!0),K(e.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):ie("",!0)}const _t=_e(Et,[["render",Wt]]);function Ue(e,o){var v,h;return((v=n(e))==null?void 0:v.fieldMapToTime)&&(o=qt(e,o)),((h=n(e))==null?void 0:h.fieldMapToNumber)&&(o=Ht(e,o)),o}function qt(e,o){const r=n(e).fieldMapToTime;if(!r||!Array.isArray(r))return o;for(const[c,[v,h],t="YYYY-MM-DD"]of r){if(!c||!v||!h||!o[c])continue;let a=o[c];Array.isArray(a)||(a=a.split(","));const[m,f]=a;o[v]=z(m).format(t),o[h]=z(f).format(t),Reflect.deleteProperty(o,c)}return o}function Ht(e,o){const r=n(e).fieldMapToNumber;if(!r||!Array.isArray(r))return o;for(const[c,[v,h]]of r){if(!c||!v||!h||!o[c])continue;let t=o[c];typeof t=="string"&&(t=t.split(","));const[a,m]=t;o[v]=a,o[h]=m,Reflect.deleteProperty(o,c)}return o}function Kt({defaultValueRef:e,getSchema:o,formModel:r,getProps:c}){function v(t){if(!se(t))return{};const a={};for(const m of Object.entries(t)){let[,f]=m;const[j]=m;if(!j||fe(f)&&f.length===0||$(f))continue;const g=n(c).transformDateFunc;se(f)&&(f=g==null?void 0:g(f)),fe(f)&&Fe.isDayjs(f[0])&&Fe.isDayjs(f[1])&&(f=f.map(B=>g==null?void 0:g(B))),ue(f)&&(f=f.trim()),It(a,j,f)}return Ue(c,a)}function h(){const t=n(o),a={};t.forEach(m=>{const{defaultValue:f}=m;Ct(f)||(a[m.field]=f,r[m.field]=f)}),e.value=a}return{handleFormValues:v,initDefault:h}}const Z=24;function zt({advanceState:e,emit:o,getProps:r,getSchema:c,formModel:v,defaultValueRef:h}){const{realWidthRef:t,screenEnum:a,screenRef:m}=vt(),f=N(()=>{if(!e.isAdvanced)return 0;const u=n(r).emptySpan||0;if(Ie(u))return u;if(se(u)){const{span:l=0}=u,y=n(m);return u[y.toLowerCase()]||l||0}return 0}),j=We(B,30);oe([()=>n(c),()=>e.isAdvanced,()=>n(t)],()=>{const{showAdvancedButton:u}=n(r);u&&j()},{immediate:!0});function g(u,l=0,y=!1,O=0){var b;const p=n(t),A=parseInt(u.md)||parseInt(u.xs)||parseInt(u.sm)||u.span||Z,F=parseInt(u.lg)||A,D=parseInt(u.xl)||F,s=parseInt(u.xxl)||D;p<=a.LG?l+=A:p<a.XL?l+=F:p<a.XXL?l+=D:l+=s;let i=(b=n(r).autoAdvancedCol)!=null?b:3;return y?(e.hideAdvanceBtn=n(c).length<=i,l>Z*2&&l<=Z*(n(r).autoAdvancedLine||3)?e.hideAdvanceBtn=!1:e.isLoad||(e.isLoad=!0,e.isAdvanced=!e.isAdvanced,n(c).length>i&&(e.hideAdvanceBtn=!1,e.isAdvanced=!1)),{isAdvanced:e.isAdvanced,itemColSum:l}):l>Z*(n(r).alwaysShowLines||1)?{isAdvanced:e.isAdvanced,itemColSum:l}:!e.isAdvanced&&O+1>i?{isAdvanced:!1,itemColSum:l}:{isAdvanced:!0,itemColSum:l}}function B(){let u=0,l=0;const{baseColProps:y={}}=n(r),O=n(c);for(let p=0;p<O.length;p++){const A=O[p],{show:F,colProps:D}=A;let s=!0;if(ne(F)&&(s=F),$(F)&&(s=F({schema:A,model:v,field:A.field,values:T(T({},n(h)),v)})),s&&(D||y)){const{itemColSum:i,isAdvanced:b}=g(T(T({},y),D),u,!1,p);u=i||0,b&&(l=u),A.isAdvanced=b}}e.actionSpan=l%Z+n(f),g(n(r).actionColOptions||{span:Z},u,!0),o("advanced-change")}function E(){e.isAdvanced=!e.isAdvanced}return{handleToggleAdvanced:E}}function Ut({emit:e,getProps:o,formModel:r,getSchema:c,defaultValueRef:v,formElRef:h,schemaRef:t,handleFormValues:a}){function m(){return I(this,null,function*(){const{resetFunc:s,submitOnReset:i}=n(o);s&&$(s)&&(yield s()),n(h)&&(Object.keys(r).forEach(d=>{r[d]=v.value[d]}),A(),e("reset",Me(r)),i&&D())})}function f(s){return I(this,null,function*(){const i=n(c).map(d=>d.field).filter(Boolean),b=[];Object.keys(s).forEach(d=>{const k=n(c).find(R=>R.field===d);let w=s[d];if(!(s instanceof Object))return;const L=Reflect.has(s,d);if(w=Vt(k==null?void 0:k.component,w),L&&i.includes(d)){if(y(d))if(Array.isArray(w)){const R=[];for(const P of w)R.push(P?z(P):null);r[d]=R}else{const{componentProps:R}=k||{};let P=R;typeof R=="function"&&(P=P({formModel:r})),r[d]=w?P!=null&&P.valueFormat?w:z(w):null}else r[d]=w;b.push(d)}}),O(b).catch(d=>{})})}function j(s){return I(this,null,function*(){const i=we(n(c));if(!s)return;let b=ue(s)?[s]:s;ue(s)&&(b=[s]);for(const d of b)g(d,i);t.value=i})}function g(s,i){if(ue(s)){const b=i.findIndex(d=>d.field===s);b!==-1&&(delete r[s],i.splice(b,1))}}function B(s,i,b=!1){return I(this,null,function*(){const d=we(n(c)),k=d.findIndex(L=>L.field===i);if(d.some(L=>L.field===i||s.field)){if(!i||k===-1||b){b?d.unshift(s):d.push(s),t.value=d;return}k!==-1&&d.splice(k+1,0,s),t.value=d}})}function E(s){return I(this,null,function*(){let i=[];if(se(s)&&i.push(s),fe(s)&&(i=[...s]),!i.every(d=>d.component==="Divider"||Reflect.has(d,"field")&&d.field)){Be("All children of the form Schema array that need to be updated must contain the `field` field");return}t.value=i})}function u(s){return I(this,null,function*(){let i=[];if(se(s)&&i.push(s),fe(s)&&(i=[...s]),!i.every(k=>k.component==="Divider"||Reflect.has(k,"field")&&k.field)){Be("All children of the form Schema array that need to be updated must contain the `field` field");return}const d=[];i.forEach(k=>{n(c).forEach(w=>{if(w.field===k.field){const L=qe(w,k);d.push(L)}else d.push(w)})}),t.value=St(d,"field")})}function l(){return n(h)?a(Me(n(r))):{}}function y(s){return n(c).some(i=>i.field===s?Ke.includes(i.component):!1)}function O(s,i){return I(this,null,function*(){var b;return(b=n(h))==null?void 0:b.validateFields(s,i)})}function p(s){return I(this,null,function*(){var i;return yield(i=n(h))==null?void 0:i.validate(s)})}function A(s){return I(this,null,function*(){var i;yield(i=n(h))==null?void 0:i.clearValidate(s)})}function F(s,i){return I(this,null,function*(){var b;yield(b=n(h))==null?void 0:b.scrollToField(s,i)})}function D(s){return I(this,null,function*(){s&&s.preventDefault();const{submitFunc:i}=n(o);if(i&&$(i)){yield i();return}if(n(h))try{const d=yield p();for(let w in d)d[w]instanceof Array&&He(o,w)==="string"&&(d[w]=d[w].join(","));const k=a(d);e("submit",k)}catch(d){e("submit",{})}})}return{handleSubmit:D,clearValidate:A,validate:p,validateFields:O,getFieldsValue:l,updateSchema:u,resetSchema:E,appendSchemaByField:B,removeSchemaByFiled:j,resetFields:m,setFieldsValue:f,scrollToField:F}}function Yt(v){return I(this,arguments,function*({getSchema:e,getProps:o,formElRef:r,isInitedDefault:c}){rt(()=>I(this,null,function*(){if(n(c)||!n(o).autoFocusFirstItem)return;yield Oe();const h=n(e),t=n(r),a=t==null?void 0:t.$el;if(!t||!a||!h||h.length===0||!h[0].component.includes("Input"))return;const f=a.querySelector(".ant-row:first-child input");f&&(f==null||f.focus())}))})}const{form:ve}=Ce,Jt={model:{type:Object,default:{}},labelWidth:{type:[Number,String],default:0},fieldMapToTime:{type:Array,default:()=>[]},fieldMapToNumber:{type:Array,default:()=>[]},compact:S.bool,schemas:{type:[Array],default:()=>[]},mergeDynamicData:{type:Object,default:null},baseRowStyle:{type:Object},baseColProps:{type:Object},autoSetPlaceHolder:S.bool.def(!0),autoSubmitOnEnter:S.bool.def(!1),submitOnReset:S.bool,size:S.oneOf(["default","small","large"]).def("default"),disabled:S.bool,emptySpan:{type:[Number,Object],default:0},showAdvancedButton:S.bool,transformDateFunc:{type:Function,default:e=>Fe.isDayjs(e)?e==null?void 0:e.format("YYYY-MM-DD HH:mm:ss"):e},rulesMessageJoinLabel:S.bool.def(!0),autoAdvancedCol:S.number.def(3),autoAdvancedLine:S.number.def(3),alwaysShowLines:S.number.def(1),showActionButtonGroup:S.bool.def(!0),actionColOptions:Object,showResetButton:S.bool.def(!0),autoFocusFirstItem:S.bool,resetButtonOptions:Object,showSubmitButton:S.bool.def(!0),submitButtonOptions:Object,resetFunc:Function,submitFunc:Function,hideRequiredMark:S.bool,labelCol:{type:Object,default:ve.labelCol},layout:S.oneOf(["horizontal","vertical","inline"]).def("horizontal"),tableAction:{type:Object},wrapperCol:{type:Object,default:ve.wrapperCol},colon:S.bool.def(ve.colon),labelAlign:S.string,rowProps:Object,autoSearch:S.bool.def(!1)},Gt=Te({name:"BasicForm",components:{FormItem:Nt,Form:Pe,Row:mt,FormAction:_t},props:Jt,emits:["advanced-change","reset","submit","register"],setup(e,{emit:o,attrs:r}){const c=Ve({}),v=kt(),h=Ve({isAdvanced:!1,hideAdvanceBtn:!0,isLoad:!1,actionSpan:6}),t=U({}),a=U(!1),m=U({}),f=U(null),j=U(null),{prefixCls:g}=wt("basic-form"),B=N(()=>{let C=T(T({},e),n(m));return C.labelWidth&&(C.labelCol=void 0),C.layout==="inline"&&(C.labelCol===Ce.form.labelCol&&(C.labelCol=void 0),C.wrapperCol===Ce.form.wrapperCol&&(C.wrapperCol=void 0)),C}),E=N(()=>[g,{[`${g}--compact`]:n(B).compact}]),u=N(()=>{const{baseRowStyle:C={},rowProps:V}=n(B);return T({style:C},V)}),l=N(()=>T(T(T({},r),e),n(B))),y=N(()=>{const C=n(f)||n(B).schemas;for(const V of C){const{defaultValue:W,component:Ye,componentProps:re}=V;if(W&&Ke.includes(Ye)){let Q="";if(re&&(Q=re==null?void 0:re.valueFormat),!Array.isArray(W))Q?V.defaultValue=z(W).format(Q):V.defaultValue=z(W);else{const me=[];W.forEach(Se=>{Q?me.push(z(Se).format(Q)):me.push(z(Se))}),V.defaultValue=me}}}return n(B).showAdvancedButton?C.filter(V=>V.component!=="Divider"):C}),{handleToggleAdvanced:O}=zt({advanceState:h,emit:o,getProps:B,getSchema:y,formModel:c,defaultValueRef:t}),{handleFormValues:p,initDefault:A}=Kt({getProps:B,defaultValueRef:t,getSchema:y,formModel:c});Yt({getSchema:y,getProps:B,isInitedDefault:a,formElRef:j});const{handleSubmit:F,setFieldsValue:D,clearValidate:s,validate:i,validateFields:b,getFieldsValue:d,updateSchema:k,resetSchema:w,appendSchemaByField:L,removeSchemaByFiled:R,resetFields:P,scrollToField:x}=Ut({emit:o,getProps:B,formModel:c,getSchema:y,defaultValueRef:t,formElRef:j,schemaRef:f,handleFormValues:p});$t({resetAction:P,submitAction:F}),oe(()=>n(B).model,()=>{const{model:C}=n(B);C&&D(C)},{immediate:!0}),oe(()=>n(B).schemas,C=>{w(C!=null?C:[])}),oe(()=>y.value,C=>{Oe(()=>{var V;(V=v==null?void 0:v.redoModalHeight)==null||V.call(v)}),!n(a)&&C!=null&&C.length&&(A(),a.value=!0)});function ae(C){return I(this,null,function*(){m.value=qe(n(m)||{},C)})}const G=We(F,300);function te(C,V){c[C]=V,e.autoSearch===!0&&G()}function X(C){const{autoSubmitOnEnter:V}=n(B);if(V&&C.key==="Enter"&&C.target&&C.target instanceof HTMLElement){const W=C.target;W&&W.tagName&&W.tagName.toUpperCase()=="INPUT"&&F()}}const q={getFieldsValue:d,setFieldsValue:D,resetFields:P,updateSchema:k,resetSchema:w,setProps:ae,getProps:B,removeSchemaByFiled:R,appendSchemaByField:L,clearValidate:s,validateFields:b,validate:i,submit:F,scrollToField:x};return it(()=>{A(),o("register",q)}),T({getBindValue:l,handleToggleAdvanced:O,handleEnterPress:X,formModel:c,defaultValueRef:t,advanceState:h,getRow:u,getProps:B,formElRef:j,getSchema:y,formActionType:q,setFormModel:te,getFormClass:E,getFormActionBindProps:N(()=>T(T({},B.value),h))},q)}});function Xt(e,o,r,c,v,h){const t=H("FormItem"),a=H("FormAction"),m=H("Row"),f=H("Form");return Y(),ee(f,J(e.getBindValue,{class:e.getFormClass,ref:"formElRef",model:e.formModel,onKeypress:lt(e.handleEnterPress,["enter"])}),{default:_(()=>[M(m,ce(he(e.getRow)),{default:_(()=>[K(e.$slots,"formHeader"),(Y(!0),ct(ut,null,be(e.getSchema,j=>(Y(),ee(t,{key:j.field,tableAction:e.tableAction,formActionType:e.formActionType,schema:j,formProps:e.getProps,allDefaultValues:e.defaultValueRef,formModel:e.formModel,setFormModel:e.setFormModel,validateFields:e.validateFields},Le({_:2},[be(Object.keys(e.$slots),g=>({name:g,fn:_(B=>[K(e.$slots,g,ce(he(B||{})))])}))]),1032,["tableAction","formActionType","schema","formProps","allDefaultValues","formModel","setFormModel","validateFields"]))),128)),M(a,J(e.getFormActionBindProps,{onToggleAdvanced:e.handleToggleAdvanced}),Le({_:2},[be(["resetBefore","submitBefore","advanceBefore","advanceAfter"],j=>({name:j,fn:_(g=>[K(e.$slots,j,ce(he(g||{})))])}))]),1040,["onToggleAdvanced"]),K(e.$slots,"formFooter")]),_:3},16)]),_:3},16,["class","model","onKeypress"])}const ln=_e(Gt,[["render",Xt]]);function cn(e){const o=U(null),r=U(!1);ye("OnlineSelectCascade",Bt),ye("LinkTableCard",Tt),ye("LinkTableSelect",Ot);function c(){return I(this,null,function*(){const t=n(o);return t||Be("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),yield Oe(),t})}function v(t){xe()&&dt(()=>{o.value=null,r.value=null}),!(n(r)&&xe()&&t===n(o))&&(o.value=t,r.value=!0,oe(()=>e,()=>{e&&t.setProps(Pt(e))},{immediate:!0,deep:!0}))}return[v,{scrollToField:(t,a)=>I(this,null,function*(){(yield c()).scrollToField(t,a)}),setProps:t=>I(this,null,function*(){(yield c()).setProps(t)}),updateSchema:t=>I(this,null,function*(){(yield c()).updateSchema(t)}),resetSchema:t=>I(this,null,function*(){(yield c()).resetSchema(t)}),clearValidate:t=>I(this,null,function*(){(yield c()).clearValidate(t)}),resetFields:()=>I(this,null,function*(){c().then(t=>I(this,null,function*(){yield t.resetFields()}))}),removeSchemaByFiled:t=>I(this,null,function*(){var a;(a=n(o))==null||a.removeSchemaByFiled(t)}),getFieldsValue:()=>{var a;let t=(a=n(o))==null?void 0:a.getFieldsValue();return t&&Object.keys(t).map(m=>{t[m]instanceof Array&&(typeof(t[m][0]||"")=="object"||(t[m]=t[m].join(",")))}),t},setFieldsValue:t=>I(this,null,function*(){(yield c()).setFieldsValue(t)}),appendSchemaByField:(t,a,m)=>I(this,null,function*(){(yield c()).appendSchemaByField(t,a,m)}),submit:()=>I(this,null,function*(){return(yield c()).submit()}),validate:t=>I(this,null,function*(){const a=yield c();let m=e||a.getProps;return a.validate(t).then(j=>{for(let g in j)j[g]instanceof Array&&He(m,g)==="string"&&(j[g]=j[g].join(","));return Ue(m,j)})}),validateFields:(t,a)=>I(this,null,function*(){return(yield c()).validateFields(t,a)})}]}export{ln as B,cn as u};
