var b=Object.defineProperty;var y=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var h=(e,t,r)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I=(e,t)=>{for(var r in t||(t={}))T.call(t,r)&&h(e,r,t[r]);if(y)for(var r of y(t))_.call(t,r)&&h(e,r,t[r]);return e};var f=(e,t,r)=>new Promise((u,m)=>{var p=o=>{try{l(r.next(o))}catch(d){m(d)}},g=o=>{try{l(r.throw(o))}catch(d){m(d)}},l=o=>o.done?u(o.value):Promise.resolve(o.value).then(p,g);l((r=r.apply(e,t)).next())});import{B as R}from"./index-0d8c6dee.js";import{B as D}from"./BasicForm-ac34d48e.js";import"./componentMap-ba94d61e.js";import{u as x}from"./useForm-a39fb19e.js";import"./JAddInput-ff8a2196.js";import"./JSelectUser-d28baf37.js";import"./JSelectDept-6a5d3f49.js";import"./JPopup-03bf28d5.js";import{B as P}from"./index-23d562e3.js";import"./cron-parser-vendor-c9873295.js";import"./JEllipsis.vue_vue_type_script_setup_true_lang-eaa23dad.js";import{render as n}from"./renderUtils-fec7e871.js";import{b as i}from"./jeecg-online-vendor-f8ebd627.js";import{d as S,k as v,u as a,e as B,a5 as L,a9 as U,a7 as M,f as k,ag as F}from"./vue-5a09445c.js";const Z=[{title:"标题",width:150,dataIndex:"titile"},{title:"消息类型",dataIndex:"msgCategory",width:100,customRender:({text:e})=>n.renderDict(e,"msg_category")},{title:"发布人",width:100,dataIndex:"sender"},{title:"优先级",dataIndex:"priority",width:70,customRender:({text:e})=>{const t=e=="L"?"blue":e=="M"?"yellow":"red";return n.renderTag(n.renderDict(e,"priority"),t)}},{title:"通告对象",dataIndex:"msgType",width:100,customRender:({text:e})=>n.renderDict(e,"msg_type")},{title:"发布状态",dataIndex:"sendStatus",width:70,customRender:({text:e})=>{const t=e=="0"?"red":e=="1"?"green":"gray";return n.renderTag(n.renderDict(e,"send_status"),t)}},{title:"发布时间",width:100,dataIndex:"sendTime"},{title:"撤销时间",width:100,dataIndex:"cancelTime"}],ee=[{field:"titile",label:"标题",component:"JInput",colProps:{span:8}}],q=[{field:"id",label:"id",component:"Input",show:!1},{field:"msgCategory",label:"消息类型",required:!0,component:"JDictSelectTag",defaultValue:"1",componentProps:{type:"radio",dictCode:"msg_category",placeholder:"请选择类型"}},{field:"titile",label:"标题",component:"Input",required:!0,componentProps:{placeholder:"请输入标题"}},{field:"msgAbstract",label:"摘要",component:"InputTextArea",required:!0},{field:"msgType",label:"接收用户",defaultValue:"ALL",component:"JDictSelectTag",required:!0,componentProps:{type:"radio",dictCode:"msg_type",placeholder:"请选择发布范围"}},{field:"userIds",label:"指定用户",component:"JSelectUser",required:!0,componentProps:{rowKey:"id",labelKey:"username"},ifShow:({values:e})=>e.msgType=="USER"},{field:"priority",label:"优先级",defaultValue:"H",component:"JDictSelectTag",componentProps:{dictCode:"priority",type:"radio",placeholder:"请选择优先级"}},{field:"msgContent",label:"内容",component:"Input",render:n.renderTinymce}],te="/sys/annountCement/exportXls",re="/sys/annountCement/importExcel",oe=e=>i.get({url:"/sys/annountCement/list",params:e}),A=(e,t)=>{let r=t?"/sys/annountCement/edit":"/sys/annountCement/add";return i.post({url:r,params:e})},se=(e,t)=>i.delete({url:"/sys/annountCement/delete",data:e},{joinParamsToUrl:!0}).then(()=>{t()}),ne=e=>i.delete({url:"/sys/annountCement/deleteBatch",data:e},{joinParamsToUrl:!0}),ae=e=>i.get({url:"/sys/annountCement/doReleaseData",params:e}),ie=e=>i.get({url:"/sys/annountCement/doReovkeData",params:e}),le=S({__name:"NoticeModal",emits:["register","success"],setup(e,{emit:t}){const r=v(!0),[u,{resetFields:m,setFieldsValue:p,validate:g}]=x({schemas:q,showActionButtonGroup:!1}),[l,{setModalProps:o,closeModal:d}]=P(s=>f(this,null,function*(){yield m(),o({confirmLoading:!1}),r.value=!!(s!=null&&s.isUpdate),a(r)&&(s.record.userIds&&(s.record.userIds=s.record.userIds.substring(0,s.record.userIds.length-1)),yield p(I({},s.record)))})),w=B(()=>a(r)?"编辑":"新增");function C(s){return f(this,null,function*(){try{let c=yield g();o({confirmLoading:!0}),c.msgType==="ALL"?c.userIds="":c.userIds+=",",yield A(c,r.value),d(),t("success")}finally{o({confirmLoading:!1})}})}return(s,c)=>(L(),U(a(R),F(s.$attrs,{onRegister:a(l),title:w.value,onOk:C,width:"900px",destroyOnClose:""}),{default:M(()=>[k(a(D),{onRegister:a(u)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{le as _,te as a,re as b,Z as c,ne as d,se as e,ae as f,oe as g,ie as h,ee as s};
