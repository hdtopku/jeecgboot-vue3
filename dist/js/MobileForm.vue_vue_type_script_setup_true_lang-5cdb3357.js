var b=(_,i,s)=>new Promise((f,m)=>{var g=a=>{try{u(s.next(a))}catch(n){m(n)}},c=a=>{try{u(s.throw(a))}catch(n){m(n)}},u=a=>a.done?f(a.value):Promise.resolve(a.value).then(g,c);u((s=s.apply(_,i)).next())});import{c as I,k as L,bj as R,l as B}from"./jeecg-online-vendor-12004772.js";import{au as V,av as M,ay as z,aw as D,ax as T}from"./index-6916e394.js";import{C as N}from"./index-6d615beb.js";import{_ as O}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-993561ae.js";import{d as U,k,r as $,e as A,aV as j,as as G,f as t,bi as r,u as e,E as S,ag as v,F as J,V as P,J as W}from"./vue-c7e3516e.js";import{cS as x,ce as q,cn as C}from"./antd-vue-vendor-1561c1ba.js";const se=U({__name:"MobileForm",setup(_){const i=x.Item,{t:s}=L(),{handleBackLogin:f,getLoginState:m}=V(),{getFormRules:g}=M(),{notification:c,createErrorModal:u}=B(),a=I(),n=k(),p=k(!1),l=$({mobile:"",sms:""}),{validForm:F}=T(n),h=A(()=>e(m)===z.MOBILE);function w(){return b(this,null,function*(){const d=yield F();if(!!d)try{p.value=!0;const o=yield a.phoneLogin(W({mobile:d.mobile,captcha:d.sms,mode:"none"}));o&&c.success({message:s("sys.login.loginSuccessTitle"),description:`${s("sys.login.loginSuccessDesc")}: ${o.realname}`,duration:3})}catch(o){c.error({message:s("sys.api.errorTip"),description:o.message||s("sys.api.networkExceptionMsg"),duration:3})}finally{p.value=!1}})}function E(){return R({mobile:l.mobile,smsmode:D.FORGET_PASSWORD})}return(d,o)=>h.value?(j(),G(J,{key:0},[t(O,{class:"enter-x"}),t(e(x),{class:"p-4 enter-x",model:l,rules:e(g),ref_key:"formRef",ref:n},{default:r(()=>[t(e(i),{name:"mobile",class:"enter-x"},{default:r(()=>[t(e(q),{size:"large",value:l.mobile,"onUpdate:value":o[0]||(o[0]=y=>l.mobile=y),placeholder:e(s)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),t(e(i),{name:"sms",class:"enter-x"},{default:r(()=>[t(e(N),{size:"large",class:"fix-auto-fill",value:l.sms,"onUpdate:value":o[1]||(o[1]=y=>l.sms=y),placeholder:e(s)("sys.login.smsCode"),sendCodeApi:E},null,8,["value","placeholder"])]),_:1}),t(e(i),{class:"enter-x"},{default:r(()=>[t(e(C),{type:"primary",size:"large",block:"",onClick:w,loading:p.value},{default:r(()=>[S(v(e(s)("sys.login.loginButton")),1)]),_:1},8,["loading"]),t(e(C),{size:"large",block:"",class:"mt-4",onClick:e(f)},{default:r(()=>[S(v(e(s)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])],64)):P("",!0)}});export{se as _};
