import{d as z,l as M,r as H,e as $,n as J,V as i,a7 as x,ac as R,aa as l,f as r,E as y,a8 as Q,W as T,ai as W,aj as X}from"./vue-ebecda47.js";import{D as Y}from"./useOnlineTest-0df0ae86-624ffd01.js";import{useListPage as Z}from"./useListPage-52971497.js";import"./index-993283cc.js";import{B as ee}from"./index-e91e8b28.js";import"./index-a2e0ccba.js";import{ap as C,bB as te}from"./jeecg-online-vendor-cfb58502.js";import oe from"./BasicTable-46b6c894.js";import{Q as ne}from"./componentMap-c36c4b8d.js";import{B as le,u as re}from"./useForm-21b78d9f.js";import{E as ae,F as ie}from"./index-85cfc899.js";import"./lodash-es-vendor-cd7703c8.js";import"./antd-vue-vendor-b75e8c06.js";import"./tinymce-vendor-7c917b36.js";import"./useFormItem-ba20c4de.js";import"./vxe-table-vendor-4aae63bf.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./BasicModal-7e6e7ae9.js";import"./useWindowSizeFn-50bd5ea0.js";import"./index-be9b0972.js";import"./download-c9e5f3f7.js";import"./base64Conver-fa2fe1af.js";import"./index-96e99de8.js";import"./index-118a05d7.js";import"./useCountdown-00a25cd7.js";import"./useFormItemSingle-36e25e6f.js";import"./JAddInput-64f6e84f.js";import"./areaDataUtil-4a5c6609.js";import"./JSelectUser-94adcf4d.js";import"./props-c57324f9.js";import"./JSelectBiz-4fc2f082.js";import"./index-1c3e0ea1.js";import"./index-097af6f9.js";import"./bem-311698ef.js";import"./props-13a58630.js";import"./useContextMenu-eb481e60.js";import"./depart.api-1888bf18.js";import"./JSelectDept-394df716.js";import"./JPopup-f9a8bda3.js";import"./cron-parser-vendor-afad4b1e.js";import"./JEllipsis-410bb5e8.js";import"./JUpload-ffe34816.js";import"./index-ae3841ab.js";import"./index-ab54dd3c.js";import"./injectionKey-69710956.js";var se=Object.defineProperty,S=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,F=(e,t,o)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,pe=(e,t)=>{for(var o in t||(t={}))ce.call(t,o)&&F(e,o,t[o]);if(S)for(var o of S(t))ue.call(t,o)&&F(e,o,t[o]);return e},w=(e,t,o)=>new Promise((v,f)=>{var b=a=>{try{s(o.next(a))}catch(u){f(u)}},c=a=>{try{s(o.throw(a))}catch(u){f(u)}},s=a=>a.done?v(a.value):Promise.resolve(a.value).then(b,c);s((o=o.apply(e,t)).next())});const me=(e,t)=>C.get({url:"/online/cgform/button/list/"+e,params:t});function _(e){return C.delete({url:"/online/cgform/button/deleteBatch",params:{ids:e.join(",")}},{joinParamsToUrl:!0})}const de=(e,t)=>t?C.put({url:"/online/cgform/button/edit",params:e}):C.post({url:"/online/cgform/button/add",params:e}),fe=[{title:"按钮编码",align:"center",dataIndex:"buttonCode"},{title:"按钮名称",align:"center",dataIndex:"buttonName"},{title:"按钮样式",align:"center",dataIndex:"buttonStyle",customRender({text:e,record:t}){if(e==="form"){let o=t.optPosition;return e+"("+(o=="2"?"底部":"侧面")+")"}else return e}},{title:"按钮类型",align:"center",dataIndex:"optType"},{title:"排序",align:"center",dataIndex:"orderNum"},{title:"按钮图标",align:"center",dataIndex:"buttonIcon"},{title:"表达式",align:"center",dataIndex:"exp"},{title:"按钮状态",align:"center",dataIndex:"buttonStatus",customRender({text:e}){return e==1?"激活":"未激活"}}],be=[{label:"按钮编码",field:"buttonCode",component:"Input",required:!0},{label:"按钮名称",field:"buttonName",component:"Input",required:!0},{label:"按钮样式",field:"buttonStyle",component:"Select",componentProps:{options:[{label:"Link",value:"link"},{label:"Button",value:"button"},{label:"Form",value:"form"}]},defaultValue:"link"},{label:"按钮位置",field:"optPosition",component:"Select",componentProps:{options:[{label:"侧面",value:"1"},{label:"底部",value:"2"}]},defaultValue:"2",show:({model:e})=>e.buttonStyle==="form"},{label:"按钮类型",field:"optType",component:"Select",componentProps:{options:[{label:"Js",value:"js"},{label:"Action",value:"action"}]},defaultValue:"js"},{label:"排序",field:"orderNum",component:"InputNumber",componentProps:{style:"width: 100%"}},{label:"按钮图标",field:"buttonIcon",component:"Input",helpMessage:"a-icon type"},{label:"表达式",field:"exp",component:"Input"},{label:"按钮状态",field:"buttonStatus",component:"RadioButtonGroup",componentProps:{options:[{label:"激活",value:"1"},{label:"未激活",value:"0"}]},defaultValue:"1"}],ge=z({name:"CustomButtonList",components:{BasicModal:ee,BasicTable:oe,TableAction:ne,BasicForm:le},emits:["register"],setup(){const e=M(""),{doRequest:t,doDeleteRecord:o,tableContext:v}=Z({tableProps:{api:n=>me(e.value,n),columns:fe,canResize:!1,useSearchForm:!1,beforeFetch(n){return Object.assign(n,{column:"orderNum",order:"asc"})}}}),[f,{reload:b},{rowSelection:c,selectedRowKeys:s}]=v,[a,{closeModal:u}]=ae(n=>w(this,null,function*(){e.value=n.row.id,b()})),{aiTestMode:h,genButtons:B}=Y(),[k,g]=ie(),p=M(!1),m=H({onRegister:k,title:$(()=>p!=null&&p.value?"修改":"新增"),width:800,confirmLoading:!1,onOk:K,onCancel:g.closeModal});let d={};const[j,{resetFields:A,setFieldsValue:D,validate:N}]=re({schemas:be,showActionButtonGroup:!1});function P(n){return w(this,null,function*(){var I;p.value=n.isUpdate,d=pe({},(I=n.record)!=null?I:{}),g.openModal(),yield J(),yield A(),D(d)})}function O(){P({isUpdate:!1})}function V(n){P({isUpdate:!0,record:n})}function L(){u()}function E(){B(e.value)}function G(){return w(this,null,function*(){t(()=>_(s.value))})}function K(){return w(this,null,function*(){try{m.confirmLoading=!0;let n=yield N();n=Object.assign({cgformHeadId:e.value},d,n),yield de(n,p.value),b(),g.closeModal()}finally{m.confirmLoading=!1}})}function U(n){return[{label:"编辑",onClick:()=>V(n)}]}function q(n){return[{label:"删除",popConfirm:{title:"确定删除吗？",placement:"left",confirm:()=>o(()=>_([n.id]))}}]}return{onAdd:O,onBatchDelete:G,aiTestMode:h,onGenButtons:E,registerModal:a,registerTable:f,selectedRowKeys:s,rowSelection:c,onCancel:L,getTableAction:U,getDropDownAction:q,registerForm:j,formModalProps:m}}}),ye={key:0,style:{float:"left"}};function ve(e,t,o,v,f,b){const c=i("a-button"),s=i("a-icon"),a=i("a-menu-item"),u=i("a-menu"),h=i("a-dropdown"),B=i("TableAction"),k=i("BasicTable"),g=i("BasicForm"),p=i("a-spin"),m=i("BasicModal");return x(),R(m,{onRegister:e.registerModal,title:"自定义按钮",width:1200,defaultFullscreen:"",onCancel:e.onCancel},{footer:l(()=>[r(c,{onClick:e.onCancel},{default:l(()=>[y("关闭")]),_:1},8,["onClick"]),e.aiTestMode?(x(),Q("div",ye,[r(c,{onClick:e.onGenButtons},{default:l(()=>[y("生成测试数据")]),_:1},8,["onClick"])])):T("",!0)]),default:l(()=>[r(k,{onRegister:e.registerTable,rowSelection:e.rowSelection},{tableTitle:l(()=>[r(c,{onClick:e.onAdd,type:"primary",preIcon:"ant-design:plus"},{default:l(()=>[y("新增")]),_:1},8,["onClick"]),e.selectedRowKeys.length>0?(x(),R(h,{key:0},{overlay:l(()=>[r(u,null,{default:l(()=>[r(a,{key:"1",onClick:e.onBatchDelete},{default:l(()=>[r(s,{type:"delete"}),y(" 删除 ")]),_:1},8,["onClick"])]),_:1})]),default:l(()=>[r(c,{style:{"margin-left":"8px"}},{default:l(()=>[y(" 批量操作 "),r(s,{type:"down"})]),_:1})]),_:1})):T("",!0)]),action:l(({record:d})=>[r(B,{actions:e.getTableAction(d),dropDownActions:e.getDropDownAction(d)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),r(m,W(X(e.formModalProps)),{default:l(()=>[r(p,{spinning:e.formModalProps.confirmLoading},{default:l(()=>[r(g,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},8,["spinning"])]),_:1},16)]),_:1},8,["onRegister","onCancel"])}const pt=te(ge,[["render",ve]]);export{pt as default};
