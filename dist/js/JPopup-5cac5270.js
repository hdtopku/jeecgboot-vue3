import{as as L,A as N,af as H,aH as pe,u as W,D as X}from"./jeecg-online-vendor-a84f26e2.js";import{B as me}from"./index-5e1edea3.js";import{B as ge,p as a,z as he}from"./index-797f995b.js";import{d as Y,r as U,k as w,e as F,u as n,w as P,s as Ce,V as l,a5 as h,a6 as I,f as o,a7 as t,ac as ye,F as z,a8 as _e,v as we,a9 as Q,A as ve,aa as G,E as V,ab as be,W as Z,ag as x,o as Re}from"./vue-5a09445c.js";const Se=Y({name:"JPopupOnlReportModal",components:{BasicModal:me,SearchFormItem:L(()=>N(()=>import("./SearchFormItem-1ccff645.js"),["js/SearchFormItem-1ccff645.js","js/vue-5a09445c.js","js/JAddInput-7275d351.js","js/jeecg-online-vendor-a84f26e2.js","js/antd-vue-vendor-04f0af1d.js","js/tinymce-vendor-e2919cb0.js","js/vxe-table-vendor-c5aaa9d2.js","js/lodash-es-vendor-70833b4a.js","assets/jeecg-online-vendor-cee2ba5d.css","js/index-797f995b.js","js/codemirror-vendor-f458506d.js","js/echarts-vendor-6c8e2159.js","assets/index-fe1627ce.css","js/areaDataUtil-994dc62e.js","js/useFormItem-51923232.js","js/index-5e1edea3.js","js/BasicModal-02606f87.js","js/useWindowSizeFn-76d4329b.js","assets/BasicModal-1e1b2ed9.css","assets/index-361bf2db.css","js/JSelectUser-c48969f7.js","js/props-6ce5d664.js","js/JSelectBiz-9c436f80.js","assets/JSelectBiz-ba37f0a8.css","assets/JSelectUser-7fda8076.css","js/index-86570f8b.js","js/index-8f3c0498.js","js/bem-05093d2d.js","js/props-17f0c5eb.js","js/useContextMenu-3014907a.js","assets/useContextMenu-6fcaad79.css","assets/index-a95e0833.css","js/depart.api-71c168b0.js","assets/JAddInput-4d25ca38.css","js/componentMap-4f24d9c4.js","js/download-1a51d657.js","js/base64Conver-fa2fe1af.js","js/index-4f7c087f.js","assets/index-399aa0e3.css","js/index-898bd182.js","js/useCountdown-e194c426.js","js/useFormItemSingle-950ee32c.js","assets/index-15cc10f8.css","js/JSelectDept-f9e74791.js","assets/JSelectDept-2ce3f5d2.css","js/cron-parser-vendor-df2efc7b.js","js/JEllipsis.vue_vue_type_script_setup_true_lang-cd7c9198.js","js/JUpload.vue_vue_type_style_index_0_lang-b42545d1.js","assets/JUpload-b67dde08.css","assets/index-0a01c8ed.css","js/index-60a41ace.js","js/index-f2355824.js","assets/index-d42612fa.css","assets/componentMap-11d05ddc.css","js/BasicForm.vue_vue_type_style_index_0_lang-56b5d203.js","assets/BasicForm-9101c3b7.css","assets/SearchFormItem-25096473.css"]),{loading:!1}),BasicTable:L(()=>N(()=>import("./BasicTable-398af8bc.js"),["js/BasicTable-398af8bc.js","js/BasicTable.vue_vue_type_style_index_0_lang-dd06c6a1.js","js/vue-5a09445c.js","js/jeecg-online-vendor-a84f26e2.js","js/antd-vue-vendor-04f0af1d.js","js/tinymce-vendor-e2919cb0.js","js/vxe-table-vendor-c5aaa9d2.js","js/lodash-es-vendor-70833b4a.js","assets/jeecg-online-vendor-cee2ba5d.css","js/index-797f995b.js","js/codemirror-vendor-f458506d.js","js/echarts-vendor-6c8e2159.js","assets/index-fe1627ce.css","js/BasicForm-43f63892.js","js/componentMap-4f24d9c4.js","js/useFormItem-51923232.js","js/index-5e1edea3.js","js/BasicModal-02606f87.js","js/useWindowSizeFn-76d4329b.js","assets/BasicModal-1e1b2ed9.css","assets/index-361bf2db.css","js/download-1a51d657.js","js/base64Conver-fa2fe1af.js","js/index-4f7c087f.js","assets/index-399aa0e3.css","js/index-898bd182.js","js/useCountdown-e194c426.js","js/useFormItemSingle-950ee32c.js","assets/index-15cc10f8.css","js/JAddInput-7275d351.js","js/areaDataUtil-994dc62e.js","js/JSelectUser-c48969f7.js","js/props-6ce5d664.js","js/JSelectBiz-9c436f80.js","assets/JSelectBiz-ba37f0a8.css","assets/JSelectUser-7fda8076.css","js/index-86570f8b.js","js/index-8f3c0498.js","js/bem-05093d2d.js","js/props-17f0c5eb.js","js/useContextMenu-3014907a.js","assets/useContextMenu-6fcaad79.css","assets/index-a95e0833.css","js/depart.api-71c168b0.js","assets/JAddInput-4d25ca38.css","js/JSelectDept-f9e74791.js","assets/JSelectDept-2ce3f5d2.css","js/cron-parser-vendor-df2efc7b.js","js/JEllipsis.vue_vue_type_script_setup_true_lang-cd7c9198.js","js/JUpload.vue_vue_type_style_index_0_lang-b42545d1.js","assets/JUpload-b67dde08.css","assets/index-0a01c8ed.css","js/index-60a41ace.js","js/index-f2355824.js","assets/index-d42612fa.css","assets/componentMap-11d05ddc.css","js/BasicForm.vue_vue_type_style_index_0_lang-56b5d203.js","assets/BasicForm-9101c3b7.css","js/useForm-56054a7d.js","js/injectionKey-69710956.js","assets/BasicTable-0e5f0b32.css"]),{loading:!0})},props:["multi","code","sorter","groupId","param"],emits:["ok","register"],setup(e,{emit:r,refs:E}){const{createMessage:C}=W(),v=U({xs:{span:24},sm:{span:6}}),y=U({xs:{span:24},sm:{span:18}}),[s,{closeModal:i}]=ge(),m=w(),u=w(),g=w(!1),_=H(),b=w({x:!0}),R=F(()=>Object.assign({},n(e),n(_))),[{visibleChange:c,loadColumnsInfo:d,dynamicParamHandler:T,loadData:f,handleChangeInTable:O,combineRowKey:B,clickThenCheck:S,filterUnuseSelect:ee,getOkSelectRows:oe},{visible:ae,rowSelection:ne,checkedKeys:D,selectRows:k,pagination:K,dataSource:te,columns:A,loading:le,title:re,iSorter:M,queryInfo:$,queryParam:j,dictOptions:se}]=pe(R,u),ie=F(()=>n($)&&n($).length>0);P(()=>e.code,()=>{d()}),P(()=>e.param,()=>{ae&&(T(),f())}),Ce(()=>{if(e.sorter){let p=e.sorter.split("=");p.length===2&&["asc","desc"].includes(p[1].toLowerCase())&&(M.value={column:p[0],order:p[1].toLowerCase()},n(A).forEach(q=>{q.dataIndex===n(M).column?q.sortOrder=n(M).order==="asc"?"ascend":"descend":q.sortOrder=!1}))}}),P(()=>K.current,p=>{p&&u.value.setPagination({current:p})});function ue(){g.value=!n(g)}function J(){i(),D.value=[],k.value=[],u.value.clearSelectedRowKeys()}function de(){if(ee(),!e.multi&&n(k)&&n(k).length>1)return C.warning("只能选择一条记录"),!1;if(!n(k)||n(k).length==0)return C.warning("至少选择一条记录"),!1;let p=oe();r("ok",p),J()}function ce(){f(1)}function fe(){j.value={},f(1)}return{attrs:_,register:s,tableScroll:b,dataSource:te,pagination:K,columns:A,rowSelection:ne,checkedKeys:D,loading:le,title:re,handleCancel:J,handleSubmit:de,clickThenCheck:S,loadData:f,combineRowKey:B,handleChangeInTable:O,visibleChange:c,queryInfo:$,queryParam:j,tableRef:u,formRef:m,labelCol:v,wrapperCol:y,dictOptions:se,showSearchFlag:ie,toggleSearchStatus:g,handleToggleSearch:ue,searchQuery:ce,searchReset:fe}}});const ke={key:0,class:"jeecg-basic-table-form-container"},Ie={style:{float:"left",overflow:"hidden"},class:"table-page-search-submitButtons"};function Oe(e,r,E,C,v,y){const s=l("SearchFormItem"),i=l("a-col"),m=l("a-button"),u=l("Icon"),g=l("a-row"),_=l("a-form"),b=l("BasicTable"),R=l("BasicModal");return h(),I("div",null,[o(R,x(e.$attrs,{onRegister:e.register,title:e.title,width:1200,onOk:e.handleSubmit,onCancel:e.handleCancel,cancelText:"关闭",wrapClassName:"j-popup-modal",onVisibleChange:e.visibleChange}),{default:t(()=>[e.showSearchFlag?(h(),I("div",ke,[o(_,{ref:"formRef",model:e.queryParam,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,onKeyup:ye(e.searchQuery,["enter","native"])},{default:t(()=>[o(g,{gutter:24},{default:t(()=>[(h(!0),I(z,null,_e(e.queryInfo,(c,d)=>(h(),I(z,null,[c.hidden==="1"?we((h(),Q(i,{md:8,sm:24,key:"query"+d},{default:t(()=>[o(s,{formElRef:e.formRef,queryParam:e.queryParam,item:c,dictOptions:e.dictOptions},null,8,["formElRef","queryParam","item","dictOptions"])]),_:2},1024)),[[ve,e.toggleSearchStatus]]):(h(),Q(i,{md:8,sm:24,key:"query"+d},{default:t(()=>[o(s,{formElRef:e.formRef,queryParam:e.queryParam,item:c,dictOptions:e.dictOptions},null,8,["formElRef","queryParam","item","dictOptions"])]),_:2},1024))],64))),256)),o(i,{md:8,sm:8},{default:t(()=>[G("span",Ie,[o(i,{lg:6},{default:t(()=>[o(m,{type:"primary",preIcon:"ant-design:reload-outlined",onClick:e.searchReset},{default:t(()=>[V("重置")]),_:1},8,["onClick"]),o(m,{type:"primary",preIcon:"ant-design:search-outlined",onClick:e.searchQuery,style:{"margin-left":"8px"}},{default:t(()=>[V("查询")]),_:1},8,["onClick"]),G("a",{onClick:r[0]||(r[0]=(...c)=>e.handleToggleSearch&&e.handleToggleSearch(...c)),style:{"margin-left":"8px"}},[V(be(e.toggleSearchStatus?"收起":"展开")+" ",1),o(u,{icon:e.toggleSearchStatus?"ant-design:up-outlined":"ant-design:down-outlined"},null,8,["icon"])])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model","label-col","wrapper-col","onKeyup"])])):Z("",!0),o(b,{ref:"tableRef",canResize:!1,bordered:!0,loading:e.loading,rowKey:e.combineRowKey,columns:e.columns,showIndexColumn:!1,dataSource:e.dataSource,pagination:e.pagination,rowSelection:e.rowSelection,onRowClick:e.clickThenCheck,onChange:e.handleChangeInTable},{tableTitle:t(()=>[]),_:1},8,["loading","rowKey","columns","dataSource","pagination","rowSelection","onRowClick","onChange"])]),_:1},16,["onRegister","title","onOk","onCancel","onVisibleChange"])])}const Pe=X(Se,[["render",Oe],["__scopeId","data-v-6fd210c2"]]),Ee=Y({name:"JPopup",components:{JPopupOnlReportModal:Pe},inheritAttrs:!1,props:{code:a.string.def(""),value:a.string.def(""),sorter:a.string.def(""),width:a.number.def(1200),placeholder:a.string.def("请选择"),multi:a.bool.def(!1),param:a.object.def({}),spliter:a.string.def(","),groupId:a.string.def(""),formElRef:a.object,setFieldsValue:a.func,getContainer:a.func,fieldConfig:{type:Array,default:()=>[]}},emits:["update:value","register","popUpChange","focus"],setup(e,{emit:r,refs:E}){const{createMessage:C}=W(),v=H(),y=w(!0),s=w(""),[i,{openModal:m}]=he();let{code:u,fieldConfig:g}=e;const _=F(()=>e.groupId?`${e.groupId}_${u}_${g[0].source}_${g[0].target}`:"");Re(()=>{e.fieldConfig.length==0&&(C.error("popup参数未正确配置!"),y.value=!1)}),P(()=>e.value,d=>{s.value=d&&d.length>0?d.split(e.spliter).join(","):""},{immediate:!0});function b(){r("focus"),!e.disabled&&m(!0)}function R(){s.value=""}function c(d){let{fieldConfig:T}=e,f={};for(let O of T){let B=d.map(S=>S[O.source]).join(",");O.target.split(",").forEach(S=>{f[S]=B})}e.formElRef&&e.formElRef.setFieldsValue(f),e.setFieldsValue&&e.setFieldsValue(f),r("popUpChange",f)}return{showText:s,avalid:y,uniqGroupId:_,attrs:v,regModal:i,handleOpen:b,handleEmpty:R,callBack:c}}});const Te={key:0,class:"components-input-demo-presuffix"};function Be(e,r,E,C,v,y){const s=l("Icon"),i=l("a-input"),m=l("JPopupOnlReportModal");return e.avalid?(h(),I("div",Te,[o(i,x({onClick:e.handleOpen,value:e.showText,"onUpdate:value":r[0]||(r[0]=u=>e.showText=u),placeholder:e.placeholder,readOnly:""},e.attrs),{prefix:t(()=>[o(s,{icon:"ant-design:cluster-outlined"})]),_:1},16,["onClick","value","placeholder"]),o(m,{onRegister:e.regModal,code:e.code,multi:e.multi,sorter:e.sorter,groupId:e.uniqGroupId,param:e.param,onOk:e.callBack,getContainer:e.getContainer},null,8,["onRegister","code","multi","sorter","groupId","param","onOk","getContainer"])])):Z("",!0)}const Fe=X(Ee,[["render",Be],["__scopeId","data-v-4d3ebe5e"]]);export{Fe as d};
