var w=Object.defineProperty;var b=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var g=(e,t,r)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t)=>{for(var r in t||(t={}))x.call(t,r)&&g(e,r,t[r]);if(b)for(var r of b(t))q.call(t,r)&&g(e,r,t[r]);return e};var f=(e,t,r)=>new Promise((p,c)=>{var m=o=>{try{l(r.next(o))}catch(i){c(i)}},d=o=>{try{l(r.throw(o))}catch(i){c(i)}},l=o=>o.done?p(o.value):Promise.resolve(o.value).then(m,d);l((r=r.apply(e,t)).next())});import{B as T}from"./index-9ca8f863.js";import{B as C}from"./BasicForm-e7d3537f.js";import"./componentMap-42aebfee.js";import{u as I}from"./useForm-b8bb8b05.js";import"./JAddInput-6e8b52df.js";import"./JSelectUser-9d666511.js";import"./JSelectDept-113b0470.js";import"./JPopup-746d3c0b.js";import{B as v}from"./index-26fb0584.js";import"./cron-parser-vendor-b0ab0fe2.js";import"./JEllipsis.vue_vue_type_script_setup_true_lang-8153fc9b.js";import{render as y}from"./renderUtils-0fdd7724.js";import{b as s,av as _}from"./jeecg-online-vendor-9cc54e36.js";import"./BasicForm.vue_vue_type_style_index_0_lang-9ae993bd.js";import{M as S}from"./antd-vue-vendor-04f0af1d.js";import{J as B}from"./validator-f8d3e062.js";import{d as j,k as M,u as n,e as P,a5 as N,a9 as U,a7 as k,f as F,ag as E}from"./vue-5a09445c.js";const ne=[{title:"任务类名",dataIndex:"jobClassName",width:200,align:"left"},{title:"Cron表达式",dataIndex:"cronExpression",width:200},{title:"参数",dataIndex:"parameter",width:200},{title:"描述",dataIndex:"description",width:200},{title:"状态",dataIndex:"status",width:100,customRender:({text:e})=>{const t=e=="0"?"green":e=="-1"?"red":"gray";return y.renderTag(y.renderDict(e,"quartz_status"),t)}}],le=[{field:"jobClassName",label:"任务类名",component:"Input",colProps:{span:8}},{field:"status",label:"任务状态",component:"JDictSelectTag",componentProps:{dictCode:"quartz_status",stringToNumber:!0},colProps:{span:8}}],O=[{field:"id",label:"id",component:"Input",show:!1},{field:"jobClassName",label:"任务类名",component:"Input",required:!0},{field:"cronExpression",label:"Cron表达式",component:"JEasyCron",defaultValue:"* * * * * ? *",rules:[{required:!0,message:"请输入Cron表达式"},{validator:B}]},{field:"paramterType",label:"参数类型",component:"Select",defaultValue:"string",componentProps:{options:[{label:"字符串",value:"string"},{label:"JSON对象",value:"json"}]}},{field:"parameter",label:"参数",component:"InputTextArea",ifShow:({values:e})=>e.paramterType=="string"},{field:"parameter",label:"参数",component:"JAddInput",helpMessage:"键值对形式填写",ifShow:({values:e})=>e.paramterType=="json"},{field:"status",label:"状态",component:"JDictSelectTag",componentProps:{dictCode:"quartz_status",type:"radioButton",stringToNumber:!0,dropdownStyle:{maxHeight:"6vh"}}},{field:"description",label:"描述",component:"InputTextArea"}],ie="/sys/quartzJob/exportXls",ue="/sys/quartzJob/importExcel",ce=e=>s.get({url:"/sys/quartzJob/list",params:e}),Q=(e,t)=>{let r=t?"/sys/quartzJob/edit":"/sys/quartzJob/add";return s.post({url:r,params:e})},pe=(e,t)=>s.delete({url:"/sys/quartzJob/delete",data:e},{joinParamsToUrl:!0}).then(()=>{t()}),me=(e,t)=>s.get({url:"/sys/quartzJob/resume",params:e}).then(()=>{t()}),de=(e,t)=>s.get({url:"/sys/quartzJob/pause",params:e}).then(()=>{t()}),fe=(e,t)=>s.get({url:"/sys/quartzJob/execute",params:e}).then(()=>{t()}),be=(e,t)=>{S.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>s.delete({url:"/sys/quartzJob/deleteBatch",data:e},{joinParamsToUrl:!0}).then(()=>{t()})})},ge=j({__name:"QuartzModal",emits:["register","success"],setup(e,{emit:t}){const r=M(!0),[p,{resetFields:c,setFieldsValue:m,validate:d}]=I({schemas:O,showActionButtonGroup:!1,labelWidth:100,labelCol:null,wrapperCol:null}),[l,{setModalProps:o,closeModal:i}]=v(a=>f(this,null,function*(){var u;if(yield c(),o({confirmLoading:!1}),r.value=!!(a!=null&&a.isUpdate),n(r)){try{a.record.paramterType=_((u=a==null?void 0:a.record)==null?void 0:u.parameter)?"json":"string"}catch(R){}yield m(h({},a.record))}})),J=P(()=>n(r)?"编辑任务":"新增任务");function z(a){return f(this,null,function*(){try{let u=yield d();o({confirmLoading:!0}),yield Q(u,r.value),i(),t("success")}finally{o({confirmLoading:!1})}})}return(a,u)=>(N(),U(n(T),E(a.$attrs,{onRegister:n(l),title:J.value,onOk:z,width:"40%"}),{default:k(()=>[F(n(C),{onRegister:n(p)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{ge as _,ie as a,ue as b,ne as c,pe as d,fe as e,be as f,ce as g,de as p,me as r,le as s};
