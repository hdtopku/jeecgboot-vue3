import{aj as r,E as k}from"./index-fde9c72f.js";import{u as Q}from"./useTableSync-9b111e9e.js";import W from"./LinkTableConfigModal-c96e0a66.js";import z from"./LinkTableFieldConfigModal-39084b2f.js";import U from"./FieldExtendJsonModal-74e36454.js";import"./index-8cf3aabb.js";import{bW as G}from"./jeecg-online-vendor-bf2efbcb.js";import"./pick-51214243.js";import"./_flatRest-34ab130c.js";import"./isArray-b183d537.js";import"./toString-8deea73b.js";import"./_arrayPush-ae8b790e.js";import"./BasicForm.vue_vue_type_style_index_0_lang-aeaafe88.js";import"./componentMap-a6d21ad6.js";import"./antd-vue-vendor-1561c1ba.js";import"./JAddInput-2cbbbde9.js";import"./omit-13df237f.js";import"./_baseClone-632ebf1c.js";import{d as X,k as Y,U as g,aV as V,as as Z,f as v,bi as M,ar as ee,E as te,V as ue,aQ as le,F as ie}from"./vue-c7e3516e.js";import"./lodash-es-vendor-42c8d3d4.js";import"./tinymce-vendor-40778af9.js";import"./codemirror-vendor-96aab763.js";import"./echarts-vendor-b30c7238.js";import"./html2canvas-vendor-654dcb8a.js";import"./vxe-table-vendor-8bace23a.js";import"./cgform.data-e49498ca.js";import"./BasicForm-83ba9c88.js";import"./useForm-fa63344e.js";import"./BasicModal-ff8f2086.js";import"./useWindowSizeFn-e5cad7ae.js";import"./useFormItem-4a12ff45.js";import"./JUpload.vue_vue_type_style_index_0_lang-3f4c90f3.js";import"./download-c8889ed9.js";import"./base64Conver-4e359726.js";import"./index-ee020524.js";import"./index-53e807bd.js";import"./useCountdown-473e4dcc.js";import"./index-ed4be6fa.js";import"./areaDataUtil-b2642a1f.js";import"./useSelectBiz-c744cf20.js";import"./props-8e8dbf4f.js";import"./index-d4783a30.js";import"./bem-deccd0b6.js";import"./props-c3781b9d.js";import"./useContextMenu-c0be0b5c.js";import"./useTreeBiz-faf9875a.js";import"./index-63ed9c18.js";import"./depart.api-25dc3d39.js";import"./_baseSlice-834c0c3e.js";var ae=Object.defineProperty,oe=Object.defineProperties,se=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertySymbols,ne=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,O=(t,n,s)=>n in t?ae(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,re=(t,n)=>{for(var s in n||(n={}))ne.call(n,s)&&O(t,s,n[s]);if(J)for(var s of J(n))de.call(n,s)&&O(t,s,n[s]);return t},fe=(t,n)=>oe(t,se(n));const P=[{title:"\u6587\u672C\u6846",value:"text"},{title:"\u5BC6\u7801",value:"password"},{title:"\u4E0B\u62C9\u6846",value:"list"},{title:"\u5355\u9009\u6846",value:"radio"},{title:"\u591A\u9009\u6846",value:"checkbox"},{title:"\u5F00\u5173",value:"switch"},{title:"\u65E5\u671F(\u5E74\u6708\u65E5)",value:"date"},{title:"\u65E5\u671F(\u5E74\u6708\u65E5\u65F6\u5206\u79D2)",value:"datetime"},{title:"\u65F6\u95F4(HH:mm:ss)",value:"time"},{title:"\u6587\u4EF6",value:"file"},{title:"\u56FE\u7247",value:"image"},{title:"\u591A\u884C\u6587\u672C",value:"textarea"},{title:"\u5BCC\u6587\u672C",value:"umeditor"},{title:"MarkDown",value:"markdown"},{title:"\u7528\u6237\u9009\u62E9",value:"sel_user"},{title:"\u90E8\u95E8\u9009\u62E9",value:"sel_depart"},{title:"\u5173\u8054\u8BB0\u5F55",value:"link_table"},{title:"\u4ED6\u8868\u5B57\u6BB5",value:"link_table_field"},{title:"\u7701\u5E02\u533A\u7EC4\u4EF6",value:"pca"},{title:"Popup\u5F39\u6846",value:"popup"},{title:"\u4E0B\u62C9\u591A\u9009\u6846",value:"list_multi"},{title:"\u4E0B\u62C9\u641C\u7D22\u6846",value:"sel_search"},{title:"\u5206\u7C7B\u5B57\u5178\u6811",value:"cat_tree"},{title:"\u81EA\u5B9A\u4E49\u6811\u63A7\u4EF6",value:"sel_tree"},{title:"\u8054\u52A8\u7EC4\u4EF6",value:"link_down"}],pe=[{title:"\u6587\u672C\u6846",value:"text"},{title:"\u5355\u9009\u6846",value:"radio"},{title:"\u5F00\u5173",value:"switch"},{title:"\u65E5\u671F(yyyy-MM-dd)",value:"date"},{title:"\u65E5\u671F\uFF08yyyy-MM-dd HH:mm:ss\uFF09",value:"datetime"},{title:"\u65F6\u95F4\uFF08HH:mm:ss\uFF09",value:"time"},{title:"\u6587\u4EF6",value:"file"},{title:"\u56FE\u7247",value:"image"},{title:"\u4E0B\u62C9\u6846",value:"list"},{title:"\u4E0B\u62C9\u591A\u9009\u6846",value:"list_multi"},{title:"\u4E0B\u62C9\u641C\u7D22\u6846",value:"sel_search"},{title:"popup\u5F39\u51FA\u6846",value:"popup"},{title:"\u90E8\u95E8\u9009\u62E9",value:"sel_depart"},{title:"\u7528\u6237\u9009\u62E9",value:"sel_user"},{title:"\u7701\u5E02\u533A\u7EC4\u4EF6",value:"pca"},{title:"\u591A\u884C\u6587\u672C",value:"textarea"}],me=X({name:"PageAttributeTable",components:{LinkTableConfigModal:W,LinkTableFieldConfigModal:z,FieldExtendJsonModal:U},setup(){const t=Y([{title:"\u5B57\u6BB5\u540D\u79F0",key:"dbFieldName",width:100},{title:"\u5B57\u6BB5\u5907\u6CE8",key:"dbFieldTxt",width:150},{title:"\u8868\u5355\u663E\u793A",key:"isShowForm",width:80,type:r.checkbox,align:"center",customValue:["1","0"],defaultChecked:!0},{title:"\u5217\u8868\u663E\u793A",key:"isShowList",width:80,type:r.checkbox,align:"center",customValue:["1","0"],defaultChecked:!0},{title:"\u662F\u5426\u6392\u5E8F",key:"sortFlag",width:80,type:r.checkbox,align:"center",customValue:["1","0"],defaultChecked:!1},{title:"\u662F\u5426\u53EA\u8BFB",key:"isReadOnly",width:80,type:r.checkbox,align:"center",customValue:["1","0"],defaultChecked:!1},{title:"\u63A7\u4EF6\u7C7B\u578B",key:"fieldShowType",width:170,type:r.select,options:P,defaultValue:"text",placeholder:"\u8BF7\u9009\u62E9${title}",validateRules:[{required:!0,message:"\u8BF7\u9009\u62E9${title}"},{handler:A}]},{title:"\u63A7\u4EF6\u957F\u5EA6",key:"fieldLength",width:120,titleHelp:{message:"\u6B64\u957F\u5EA6\u53EA\u5BF9\u5B50\u8868\u5217\u5B57\u6BB5\u5BBD\u5EA6\u6709\u6548\uFF01"},type:r.inputNumber,defaultValue:200,placeholder:"\u8BF7\u8F93\u5165${title}",validateRules:[{required:!0,message:"${title}\u4E0D\u80FD\u4E3A\u7A7A"}]},{title:"\u662F\u5426\u67E5\u8BE2",key:"isQuery",width:80,type:r.checkbox,align:"center",customValue:["1","0"],defaultChecked:!1},{title:"\u67E5\u8BE2\u7C7B\u578B",key:"queryMode",width:110,type:r.select,options:[{title:"\u666E\u901A\u67E5\u8BE2",value:"single"},{title:"\u8303\u56F4\u67E5\u8BE2",value:"group"}],defaultValue:"single",placeholder:"\u8BF7\u9009\u62E9${title}",validateRules:[{required:!0,message:"\u8BF7\u9009\u62E9${title}"}]},{title:"\u63A7\u4EF6\u9ED8\u8BA4\u503C",key:"fieldDefaultValue",width:120,type:r.input,defaultValue:""},{title:"\u5B9A\u4E49\u8F6C\u6362\u5668",key:"converter",width:150,type:r.input,defaultValue:""},{title:"\u6269\u5C55\u53C2\u6570",key:"fieldExtendJson",width:120,type:r.input,defaultValue:""},{title:"\u66F4\u591A\u914D\u7F6E",minWidth:100,key:"fieldConfig",type:r.slot,slotName:"fieldConfig"}]),n=Q(t),{tableRef:s,tables:c}=n;function A({cellValue:e,row:u},i){let{dbTable:d}=c,l=d.value.tableRef.getTableData({rowIds:[u.id]})[0].dbType;e==="time"&&l!=="string"?i(!1,"\u5F53\u63A7\u4EF6\u7C7B\u578B\u4E3A\u65F6\u95F4\u65F6,\u6570\u636E\u5E93\u5C5E\u6027\u91CC\u7684\u5B57\u6BB5\u7C7B\u578B\u5FC5\u987B\u662FString\uFF01"):e==="date"&&l!=="Date"&&l!=="Datetime"?i(!1,"\u5F53\u63A7\u4EF6\u7C7B\u578B\u4E3A\u65E5\u671F\u65F6\uFF0C\u6570\u636E\u5E93\u5C5E\u6027\u91CC\u7684\u5B57\u6BB5\u7C7B\u578B\u5FC5\u987B\u662FDate\u6216Datetime\uFF01"):e==="datetime"&&l!=="Datetime"?i(!1,"\u5F53\u63A7\u4EF6\u7C7B\u578B\u4E3Adatetime\u65F6\uFF0C\u6570\u636E\u5E93\u5C5E\u6027\u91CC\u7684\u5B57\u6BB5\u7C7B\u578B\u5FC5\u987B\u662FDatetime\uFF01"):i(!0)}function x(e){let u="date";e.dbType==="Datetime"&&(u="datetime"),s.value.setValues([{rowKey:e.id,values:{fieldShowType:u}}])}function C(e){for(let u of t.value)if(u.key=="fieldShowType"){u.options=e?pe:P;break}}function B(e){s.value.setValues([{rowKey:e,values:{isQuery:"1"}}])}const[w,{openModal:T}]=k(),[_,{openModal:y}]=k(),[D,{openModal:N}]=k();function R(e){return e.row.dbFieldName!="id"}function $(e){e.row.fieldShowType.indexOf("link_table")>=0?S(e):L(e)}function S(e){let{row:u}=e,{checkTable:i}=c;if(i){let d=i.value.tableRef.getTableData({rowIds:[u.id]})[0];if(e.row.fieldShowType=="link_table"){let l=K(u,d);T(!0,{record:l,fieldName:u.dbFieldName})}else if(e.row.fieldShowType=="link_table_field"){let l=H(u,d);y(!0,l)}}}function H(e,u){let d=s.value.getTableData().filter(b=>b.fieldShowType=="link_table"),l={};if(d&&d.length>0){let b=c.checkTable.value.tableRef.getTableData();for(let h of d){let E=b.filter(m=>m.dbFieldName==h.dbFieldName);if(E&&E.length>0){let m=E[0];l[m.dbFieldName]={title:h.dbFieldTxt,table:m.dictTable,fields:m.dictText}}}}const{dictTable:p,dictText:f}=u,{id:a,dbFieldTxt:o}=e;return{record:{rowKey:a,dbFieldTxt:o,dictText:f,dictTable:p},tableAndFieldsMap:l}}function K(e,u){const{id:i,dbFieldTxt:d,fieldExtendJson:l}=e,{dictTable:p,dictText:f}=u;let a={rowKey:i,dbFieldTxt:d,dictTable:p};if(f){let o=f.split(",");a.titleField=o[0],o.length>1&&(a.otherFields=f.substring(f.indexOf(",")+1))}else a.titleField="",a.otherFields="";if(l)try{let o=JSON.parse(l);o.multiSelect?a.multiSelect=o.multiSelect:a.multiSelect=!1,o.showType?a.showType=o.showType:a.showType="card",o.imageField?a.imageField=o.imageField:a.imageField=""}catch(o){}return a}function j(e){const{multiSelect:u,showType:i,imageField:d,fieldName:l}=e;let p={showType:i,multiSelect:u,imageField:d},f=[{rowKey:e.rowKey,values:{fieldExtendJson:JSON.stringify(p),dbFieldTxt:e.dbFieldTxt}}];s.value.setValues(f);let{checkTable:a,dbTable:o}=c;if(o){let F=[{rowKey:e.rowKey,values:{dbFieldTxt:e.dbFieldTxt}}];o.value.tableRef.setValues(F)}if(a){let F=e.titleField;e.otherFields&&(F+=","+e.otherFields);const{dictTable:b,dictField:h}=e;let E={dictTable:b,dictField:h,dictText:F,dbFieldName:l},m=[{rowKey:e.rowKey,values:E}];a.value.tableRef.setValues(m)}}function I(e){const{dbFieldTxt:u,dictTable:i,dictText:d,rowKey:l}=e;let p=[{rowKey:l,values:{dbFieldTxt:u}}];s.value.setValues(p);let{checkTable:f,dbTable:a}=c;if(a){let o=[{rowKey:l,values:{dbFieldTxt:u,dbIsPersist:"0"}}];a.value.tableRef.setValues(o)}if(f){let o=[{rowKey:l,values:{dictTable:i,dictText:d}}];f.value.tableRef.setValues(o)}}function L(e){let u=e.row.fieldExtendJson||"",i=e.rowId,d=e.row.fieldShowType||"",l=e.row.sortFlag||"0";N(!0,{jsonStr:u,fieldShowType:d,sortFlag:l,id:i})}function q(e,u){let i;e&&Object.keys(e).length>0?i=[{rowKey:u,values:{fieldExtendJson:JSON.stringify(e)}}]:i=[{rowKey:u,values:{fieldExtendJson:""}}],s.value.setValues(i)}return fe(re({},n),{columns:t,enableQuery:B,syncFieldShowType:x,changePageType:C,showConfigButton:R,showFieldConfig:S,registerExtJsonModal:D,handleExtJson:q,openConfig:$,registerModal:w,handleConfigData:j,registerFieldModal:_,handleFieldConfigData:I})}});function ce(t,n,s,c,A,x){const C=g("a-button"),B=g("JVxeTable"),w=g("link-table-config-modal"),T=g("link-table-field-config-modal"),_=g("FieldExtendJsonModal");return V(),Z(ie,null,[v(B,le({ref:"tableRef","row-class-name":"online-config-page",rowNumber:"",keyboardEdit:"",maxHeight:t.tableHeight.noToolbar,loading:t.loading,columns:t.columns,dataSource:t.dataSource,disabledRows:{dbFieldName:["id","has_child"]}},t.tableProps),{fieldConfig:M(y=>[t.showConfigButton(y)?(V(),ee(C,{key:0,type:"primary",size:"small",ghost:"",onClick:D=>t.openConfig(y)},{default:M(()=>[te("\u9AD8\u7EA7\u914D\u7F6E")]),_:2},1032,["onClick"])):ue("",!0)]),_:1},16,["maxHeight","loading","columns","dataSource"]),v(w,{onRegister:t.registerModal,onSuccess:t.handleConfigData},null,8,["onRegister","onSuccess"]),v(T,{onRegister:t.registerFieldModal,onSuccess:t.handleFieldConfigData},null,8,["onRegister","onSuccess"]),v(_,{onRegister:t.registerExtJsonModal,onSuccess:t.handleExtJson},null,8,["onRegister","onSuccess"])],64)}var rt=G(me,[["render",ce],["__scopeId","data-v-5c39d0ca"]]);export{rt as default};
