var h=Object.defineProperty;var B=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var _=(r,t,e)=>t in r?h(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,f=(r,t)=>{for(var e in t||(t={}))k.call(t,e)&&_(r,e,t[e]);if(B)for(var e of B(t))w.call(t,e)&&_(r,e,t[e]);return r};var g=(r,t,e)=>new Promise((p,c)=>{var m=a=>{try{i(e.next(a))}catch(l){c(l)}},d=a=>{try{i(e.throw(a))}catch(l){c(l)}},i=a=>a.done?p(a.value):Promise.resolve(a.value).then(m,d);i((e=e.apply(r,t)).next())});import{B as F}from"./index-1c1dc92f.js";import{B as M}from"./BasicForm-16b0dbe3.js";import"./componentMap-954cd91c.js";import{u as P}from"./useForm-a6f4b45a.js";import"./JAddInput-0d73042c.js";import"./JSelectUser-ef2d6619.js";import"./JSelectDept-3b235dbd.js";import"./JPopup-10c26cf4.js";import{B as I}from"./index-12df1add.js";import{s as R}from"./page.api-ff6c5533.js";import{an as U,am as x,ao as S,ak as E}from"./jeecg-online-vendor-ef755ff7.js";import{d as V,k as A,u as s,e as D,U as L,a5 as O,a9 as T,a7 as C,f as b,E as q,ag as G}from"./vue-249e5fad.js";const ae=[{label:"名称",field:"name",component:"Input",colProps:{span:6}}],J=[{label:"",field:"id",component:"Input",show:!1},{label:"名称",field:"name",component:"Input",required:!0},{label:"封面图",field:"coverUrl",component:"JImageUpload",componentProps:{fileMax:1}},{label:"分类",field:"type",component:"Select",defaultValue:"1",required:!0,componentProps:{options:[{label:"仪表盘设计",value:"1",key:"1"},{label:"门户设计器",value:"2",key:"2"}]}},{label:"保护码",field:"protectionCode",component:"StrengthMeter"}],re=V({__name:"PageModal",emits:["success","register"],setup(r,{emit:t}){const e=A(!0),[p,{resetFields:c,setFieldsValue:m,validate:d}]=P({schemas:J,showActionButtonGroup:!1}),[i,{setModalProps:a,closeModal:l}]=I(n=>g(this,null,function*(){if(yield c(),a({confirmLoading:!1}),e.value=!!(n!=null&&n.isUpdate),s(e)){let o=f({},n.record);o.protectionCode&&o.protectionCode.length>0&&(o.protectionCode=U(o.protectionCode)),yield m(f({},o))}})),v=D(()=>s(e)?"编辑":"新增");function y(n=0){return g(this,null,function*(){try{const o=yield d();a({confirmLoading:!0}),o.protectionCode&&(o.protectionCode=x(o.protectionCode));const u=yield R(o,e.value);o.id&&S(E.DRAG_CACHE_PREFIX+o.id),l(),t("success",n===1?u:null)}finally{a({confirmLoading:!1})}})}return(n,o)=>{const u=L("a-button");return O(),T(s(F),G(n.$attrs,{onRegister:s(i),okText:"保存",title:v.value,onOk:y,width:700,destroyOnClose:""}),{appendFooter:C(()=>[b(u,{type:"primary",onClick:o[0]||(o[0]=N=>y(1))},{default:C(()=>[q("保存并设计")]),_:1})]),default:C(()=>[b(s(M),{onRegister:s(p)},null,8,["onRegister"])]),_:1},16,["onRegister","title"])}}});export{re as _,ae as s};
