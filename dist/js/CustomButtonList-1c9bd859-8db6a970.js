import{D as E}from"./useOnlineTest-0df0ae86-2162a45a.js";import{useListPage as H}from"./useListPage-37055c1f.js";import $ from"./BasicTable-e53fa5dc.js";import{Q as J}from"./componentMap-d4bccc5b.js";import"./useTable-abb474dc.js";import{B as Q}from"./index-156cafb7.js";import{B as W}from"./BasicForm-202637f7.js";import{u as X}from"./useForm-b308f6ee.js";import"./JAddInput-b2310633.js";import"./JSelectUser-71a05f8d.js";import"./JSelectDept-1f595344.js";import"./JPopup-2fd87e0d.js";import{B as Y,z as Z}from"./index-ebe32d90.js";import"./cron-parser-vendor-f28c5d73.js";import"./JEllipsis.vue_vue_type_script_setup_true_lang-b03a3f81.js";import{V as ee,b as C}from"./jeecg-online-vendor-231813f7.js";import{d as te,k as M,r as oe,e as ne,V as i,a5 as x,a9 as R,a7 as r,f as l,E as y,a6 as re,W as T,ae as le,af as ae,n as ie}from"./vue-5a09445c.js";import"./BasicTable.vue_vue_type_style_index_0_lang-80d59b16.js";import"./injectionKey-69710956.js";import"./antd-vue-vendor-e4fda4cf.js";import"./tinymce-vendor-e2919cb0.js";import"./BasicForm.vue_vue_type_style_index_0_lang-b507e110.js";import"./lodash-es-vendor-3f622b6f.js";import"./useWindowSizeFn-090d6233.js";import"./vxe-table-vendor-c5aaa9d2.js";import"./codemirror-vendor-f458506d.js";import"./echarts-vendor-6c8e2159.js";import"./BasicModal-4736e0c2.js";import"./areaDataUtil-8b7c0164.js";import"./useFormItem-9ad9dd7f.js";import"./props-070e4759.js";import"./JSelectBiz-8d24dfc4.js";import"./index-0644f043.js";import"./index-64029d3c.js";import"./bem-a05115ab.js";import"./props-1156b2b9.js";import"./useContextMenu-695a8028.js";import"./depart.api-125ba91d.js";/* empty css              */import"./download-b10715e6.js";import"./base64Conver-fa2fe1af.js";import"./index-ca8ee4d9.js";import"./index-3e837de3.js";import"./useCountdown-1a556b94.js";import"./useFormItemSingle-2e069e0c.js";import"./JUpload.vue_vue_type_style_index_0_lang-5fe736b1.js";import"./index-a66c1701.js";import"./index-afd7fbfc.js";var se=Object.defineProperty,S=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,F=(e,t,o)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,pe=(e,t)=>{for(var o in t||(t={}))ce.call(t,o)&&F(e,o,t[o]);if(S)for(var o of S(t))ue.call(t,o)&&F(e,o,t[o]);return e},w=(e,t,o)=>new Promise((v,f)=>{var b=a=>{try{s(o.next(a))}catch(u){f(u)}},c=a=>{try{s(o.throw(a))}catch(u){f(u)}},s=a=>a.done?v(a.value):Promise.resolve(a.value).then(b,c);s((o=o.apply(e,t)).next())});const me=(e,t)=>C.get({url:"/online/cgform/button/list/"+e,params:t});function _(e){return C.delete({url:"/online/cgform/button/deleteBatch",params:{ids:e.join(",")}},{joinParamsToUrl:!0})}const de=(e,t)=>t?C.put({url:"/online/cgform/button/edit",params:e}):C.post({url:"/online/cgform/button/add",params:e}),fe=[{title:"按钮编码",align:"center",dataIndex:"buttonCode"},{title:"按钮名称",align:"center",dataIndex:"buttonName"},{title:"按钮样式",align:"center",dataIndex:"buttonStyle",customRender({text:e,record:t}){if(e==="form"){let o=t.optPosition;return e+"("+(o=="2"?"底部":"侧面")+")"}else return e}},{title:"按钮类型",align:"center",dataIndex:"optType"},{title:"排序",align:"center",dataIndex:"orderNum"},{title:"按钮图标",align:"center",dataIndex:"buttonIcon"},{title:"表达式",align:"center",dataIndex:"exp"},{title:"按钮状态",align:"center",dataIndex:"buttonStatus",customRender({text:e}){return e==1?"激活":"未激活"}}],be=[{label:"按钮编码",field:"buttonCode",component:"Input",required:!0},{label:"按钮名称",field:"buttonName",component:"Input",required:!0},{label:"按钮样式",field:"buttonStyle",component:"Select",componentProps:{options:[{label:"Link",value:"link"},{label:"Button",value:"button"},{label:"Form",value:"form"}]},defaultValue:"link"},{label:"按钮位置",field:"optPosition",component:"Select",componentProps:{options:[{label:"侧面",value:"1"},{label:"底部",value:"2"}]},defaultValue:"2",show:({model:e})=>e.buttonStyle==="form"},{label:"按钮类型",field:"optType",component:"Select",componentProps:{options:[{label:"Js",value:"js"},{label:"Action",value:"action"}]},defaultValue:"js"},{label:"排序",field:"orderNum",component:"InputNumber",componentProps:{style:"width: 100%"}},{label:"按钮图标",field:"buttonIcon",component:"Input",helpMessage:"a-icon type"},{label:"表达式",field:"exp",component:"Input"},{label:"按钮状态",field:"buttonStatus",component:"RadioButtonGroup",componentProps:{options:[{label:"激活",value:"1"},{label:"未激活",value:"0"}]},defaultValue:"1"}],ge=te({name:"CustomButtonList",components:{BasicModal:Q,BasicTable:$,TableAction:J,BasicForm:W},emits:["register"],setup(){const e=M(""),{doRequest:t,doDeleteRecord:o,tableContext:v}=H({tableProps:{api:n=>me(e.value,n),columns:fe,canResize:!1,useSearchForm:!1,beforeFetch(n){return Object.assign(n,{column:"orderNum",order:"asc"})}}}),[f,{reload:b},{rowSelection:c,selectedRowKeys:s}]=v,[a,{closeModal:u}]=Y(n=>w(this,null,function*(){e.value=n.row.id,b()})),{aiTestMode:h,genButtons:B}=E(),[k,g]=Z(),p=M(!1),m=oe({onRegister:k,title:ne(()=>p!=null&&p.value?"修改":"新增"),width:800,confirmLoading:!1,onOk:U,onCancel:g.closeModal});let d={};const[A,{resetFields:D,setFieldsValue:j,validate:V}]=X({schemas:be,showActionButtonGroup:!1});function P(n){return w(this,null,function*(){var I;p.value=n.isUpdate,d=pe({},(I=n.record)!=null?I:{}),g.openModal(),yield ie(),yield D(),j(d)})}function N(){P({isUpdate:!1})}function O(n){P({isUpdate:!0,record:n})}function L(){u()}function G(){B(e.value)}function K(){return w(this,null,function*(){t(()=>_(s.value))})}function U(){return w(this,null,function*(){try{m.confirmLoading=!0;let n=yield V();n=Object.assign({cgformHeadId:e.value},d,n),yield de(n,p.value),b(),g.closeModal()}finally{m.confirmLoading=!1}})}function q(n){return[{label:"编辑",onClick:()=>O(n)}]}function z(n){return[{label:"删除",popConfirm:{title:"确定删除吗？",placement:"left",confirm:()=>o(()=>_([n.id]))}}]}return{onAdd:N,onBatchDelete:K,aiTestMode:h,onGenButtons:G,registerModal:a,registerTable:f,selectedRowKeys:s,rowSelection:c,onCancel:L,getTableAction:q,getDropDownAction:z,registerForm:A,formModalProps:m}}}),ye={key:0,style:{float:"left"}};function ve(e,t,o,v,f,b){const c=i("a-button"),s=i("a-icon"),a=i("a-menu-item"),u=i("a-menu"),h=i("a-dropdown"),B=i("TableAction"),k=i("BasicTable"),g=i("BasicForm"),p=i("a-spin"),m=i("BasicModal");return x(),R(m,{onRegister:e.registerModal,title:"自定义按钮",width:1200,defaultFullscreen:"",onCancel:e.onCancel},{footer:r(()=>[l(c,{onClick:e.onCancel},{default:r(()=>[y("关闭")]),_:1},8,["onClick"]),e.aiTestMode?(x(),re("div",ye,[l(c,{onClick:e.onGenButtons},{default:r(()=>[y("生成测试数据")]),_:1},8,["onClick"])])):T("",!0)]),default:r(()=>[l(k,{onRegister:e.registerTable,rowSelection:e.rowSelection},{tableTitle:r(()=>[l(c,{onClick:e.onAdd,type:"primary",preIcon:"ant-design:plus"},{default:r(()=>[y("新增")]),_:1},8,["onClick"]),e.selectedRowKeys.length>0?(x(),R(h,{key:0},{overlay:r(()=>[l(u,null,{default:r(()=>[l(a,{key:"1",onClick:e.onBatchDelete},{default:r(()=>[l(s,{type:"delete"}),y(" 删除 ")]),_:1},8,["onClick"])]),_:1})]),default:r(()=>[l(c,{style:{"margin-left":"8px"}},{default:r(()=>[y(" 批量操作 "),l(s,{type:"down"})]),_:1})]),_:1})):T("",!0)]),action:r(({record:d})=>[l(B,{actions:e.getTableAction(d),dropDownActions:e.getDropDownAction(d)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),l(m,le(ae(e.formModalProps)),{default:r(()=>[l(p,{spinning:e.formModalProps.confirmLoading},{default:r(()=>[l(g,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},8,["spinning"])]),_:1},16)]),_:1},8,["onRegister","onCancel"])}const dt=ee(ge,[["render",ve]]);export{dt as default};
