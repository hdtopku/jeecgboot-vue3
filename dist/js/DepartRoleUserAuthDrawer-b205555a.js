var w=(D,o,e)=>new Promise((c,l)=>{var r=a=>{try{p(e.next(a))}catch(d){l(d)}},t=a=>{try{p(e.throw(a))}catch(d){l(d)}},p=a=>a.done?c(a.value):Promise.resolve(a.value).then(r,t);p((e=e.apply(D,o)).next())});import{d as E,l as i,V as n,a7 as m,ac as k,aa as s,f as _,a8 as h,F as x,ab as F,E as S,ae as $,ad as b,u as g}from"./vue-86253b15.js";import{u as z,B as A}from"./index-6be60ec8.js";import{i as P,j as T,k as G}from"./depart.user.api-0c9706fc.js";import"./jeecg-online-vendor-bc5d810e.js";import"./antd-vue-vendor-371529c2.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-04a44d0a.js";import"./vxe-table-vendor-6a8d95c4.js";import"./index-4de4eaa0.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";const H={style:{width:"100%","margin-top":"15px"}},J=b("span",null,"点击保存",-1),ne=E({__name:"DepartRoleUserAuthDrawer",emits:["register"],setup(D){const o=i(!1),e=i(""),c=i(""),l=i(""),r=i([]),t=i([]),[p,{closeDrawer:a}]=z(u=>{e.value=g(u.userId),c.value=g(u.departId),d()});function d(){return w(this,null,function*(){try{o.value=!0;const u={departId:c.value,userId:e.value},[v,y]=yield Promise.all([P(u),T(u)]);r.value=v,t.value=y.map(I=>I.droleId),l.value=t.value.join(",")}finally{o.value=!1}})}function B(){return w(this,null,function*(){try{o.value=!0,yield G({userId:e.value,newRoleId:t.value.join(","),oldRoleId:l.value}),L()}finally{o.value=!1}})}function C(){R()}function L(){R(),a()}function R(){e.value="",c.value="",l.value="",r.value=[],t.value=[]}return(u,v)=>{const y=n("a-checkbox"),I=n("a-col"),N=n("a-row"),U=n("a-checkbox-group"),V=n("a-button"),j=n("a-empty"),q=n("a-spin");return m(),k(g(A),{title:"部门角色分配",width:365,onClose:C,onRegister:g(p)},{default:s(()=>[_(q,{spinning:o.value},{default:s(()=>[r.value.length>0?(m(),h(x,{key:0},[_(U,{value:t.value,"onUpdate:value":v[0]||(v[0]=f=>t.value=f)},{default:s(()=>[_(N,null,{default:s(()=>[(m(!0),h(x,null,F(r.value,f=>(m(),k(I,{span:24},{default:s(()=>[_(y,{value:f.id},{default:s(()=>[S($(f.roleName),1)]),_:2},1032,["value"])]),_:2},1024))),256))]),_:1})]),_:1},8,["value"]),b("div",H,[_(V,{type:"primary",loading:o.value,size:"small",preIcon:"ant-design:save-filled",onClick:B},{default:s(()=>[J]),_:1},8,["loading"])])],64)):(m(),k(j,{key:1,description:"无配置信息"}))]),_:1},8,["spinning"])]),_:1},8,["onRegister"])}}});export{ne as default};
