var _=(y,i,s)=>new Promise((f,m)=>{var p=a=>{try{u(s.next(a))}catch(n){m(n)}},c=a=>{try{u(s.throw(a))}catch(n){m(n)}},u=a=>a.done?f(a.value):Promise.resolve(a.value).then(p,c);u((s=s.apply(y,i)).next())});import{I as E,J as L,t as R,K as B,q as z,v as M,S as D,u as O,O as T}from"./jeecg-online-vendor-a84f26e2.js";import"./index-797f995b.js";import{C as V}from"./index-898bd182.js";import{_ as N}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-fa096b8a.js";import{bo as S,bw as U,bz as k}from"./antd-vue-vendor-04f0af1d.js";import{d as $,k as v,r as A,e as J,u as e,a5 as W,a6 as q,f as t,a7 as r,E as x,ab as C,F as G,W as K,J as P}from"./vue-5a09445c.js";const se=$({__name:"MobileForm",setup(y){const i=S.Item,{t:s}=z(),{handleBackLogin:f,getLoginState:m}=E(),{getFormRules:p}=L(),{notification:c,createErrorModal:u}=O(),a=R(),n=v(),g=v(!1),l=A({mobile:"",sms:""}),{validForm:F}=T(n),h=J(()=>e(m)===B.MOBILE);function I(){return _(this,null,function*(){const d=yield F();if(d)try{g.value=!0;const o=yield a.phoneLogin(P({mobile:d.mobile,captcha:d.sms,mode:"none"}));o&&c.success({message:s("sys.login.loginSuccessTitle"),description:`${s("sys.login.loginSuccessDesc")}: ${o.realname}`,duration:3})}catch(o){c.error({message:s("sys.api.errorTip"),description:o.message||s("sys.api.networkExceptionMsg"),duration:3})}finally{g.value=!1}})}function w(){return M({mobile:l.mobile,smsmode:D.FORGET_PASSWORD})}return(d,o)=>h.value?(W(),q(G,{key:0},[t(N,{class:"enter-x"}),t(e(S),{class:"p-4 enter-x",model:l,rules:e(p),ref_key:"formRef",ref:n},{default:r(()=>[t(e(i),{name:"mobile",class:"enter-x"},{default:r(()=>[t(e(U),{size:"large",value:l.mobile,"onUpdate:value":o[0]||(o[0]=b=>l.mobile=b),placeholder:e(s)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),t(e(i),{name:"sms",class:"enter-x"},{default:r(()=>[t(e(V),{size:"large",class:"fix-auto-fill",value:l.sms,"onUpdate:value":o[1]||(o[1]=b=>l.sms=b),placeholder:e(s)("sys.login.smsCode"),sendCodeApi:w},null,8,["value","placeholder"])]),_:1}),t(e(i),{class:"enter-x"},{default:r(()=>[t(e(k),{type:"primary",size:"large",block:"",onClick:I,loading:g.value},{default:r(()=>[x(C(e(s)("sys.login.loginButton")),1)]),_:1},8,["loading"]),t(e(k),{size:"large",block:"",class:"mt-4",onClick:e(f)},{default:r(()=>[x(C(e(s)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])],64)):K("",!0)}});export{se as _};
