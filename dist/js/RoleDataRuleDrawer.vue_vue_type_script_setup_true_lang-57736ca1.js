var h=(w,g,c)=>new Promise((u,n)=>{var i=a=>{try{_(c.next(a))}catch(p){n(p)}},e=a=>{try{_(c.throw(a))}catch(p){n(p)}},_=a=>a.done?u(a.value):Promise.resolve(a.value).then(i,e);_((c=c.apply(w,g)).next())});import{u as M,B as P}from"./index-be443812.js";import{u as j}from"./jeecg-online-vendor-658239c9.js";import{q as z,c as A}from"./role.api-86861fbb.js";import{d as K,k as v,V as s,a5 as m,a9 as k,a7 as t,f as l,a6 as b,F as O,a8 as S,E as I,ab as T,aa as D,ag as U,u as o}from"./vue-bcbaddf9.js";const $={style:{width:"100%","margin-top":"15px"}},G={key:1},H=D("h3",null,"无配置信息!",-1),J=[H],ee=K({__name:"RoleDataRuleDrawer",emits:["success","register"],setup(w,{emit:g}){const{createMessage:c}=j(),u=v(""),n=v(""),i=v([]),e=v([]),[_,{setDrawerProps:a,closeDrawer:p}]=M(d=>h(this,null,function*(){yield R(),a({confirmLoading:!1}),u.value=d.functionId,n.value=d.roleId;const r=yield z({functionId:o(u),roleId:o(n)});r.success&&(i.value=r.result.datarule,r.result.drChecked&&(e.value=r.result.drChecked.split(",")))}));function R(){u.value="",n.value="",i.value=[],e.value=[]}function x(){return h(this,null,function*(){(!o(e)||o(e).length==0)&&c.warning("请注意，现未勾选任何数据权限!");let d={permissionId:o(u),roleId:o(n),dataRuleIds:o(e).join(",")};yield A(d),p(),g("success")})}return(d,r)=>{const C=s("a-checkbox"),y=s("a-col"),B=s("Icon"),N=s("a-button"),V=s("a-row"),F=s("a-checkbox-group"),L=s("a-tab-pane"),q=s("a-tabs");return m(),k(o(P),U(d.$attrs,{onRegister:o(_),title:"数据规则配置",width:"450px",destroyOnClose:""}),{default:t(()=>[l(q,{defaultActiveKey:"1"},{default:t(()=>[l(L,{tab:"数据规则",key:"1"},{default:t(()=>[i.value.length>0?(m(),k(F,{key:0,value:e.value,"onUpdate:value":r[0]||(r[0]=f=>e.value=f)},{default:t(()=>[l(V,null,{default:t(()=>[(m(!0),b(O,null,S(i.value,(f,E)=>(m(),k(y,{span:24,key:"dr"+E},{default:t(()=>[l(C,{value:f.id},{default:t(()=>[I(T(f.ruleName),1)]),_:2},1032,["value"])]),_:2},1024))),128)),l(y,{span:24},{default:t(()=>[D("div",$,[l(N,{onClick:x,type:"primary",size:"small"},{default:t(()=>[l(B,{icon:"ant-design:save-outlined"}),I("点击保存")]),_:1})])]),_:1})]),_:1})]),_:1},8,["value"])):(m(),b("div",G,J))]),_:1})]),_:1})]),_:1},16,["onRegister"])}}});export{ee as _};
