var c=(d,R,s)=>new Promise((l,n)=>{var h=r=>{try{f(s.next(r))}catch(m){n(m)}},y=r=>{try{f(s.throw(r))}catch(m){n(m)}},f=r=>r.done?l(r.value):Promise.resolve(r.value).then(h,y);f((s=s.apply(d,R)).next())});import $ from"./BasicTable-0c3b97e4.js";import{Q as A}from"./componentMap-3d0064b3.js";import{u as H}from"./useTable-e785b2d6.js";import{u as Q,a as q,B as G}from"./index-711dccc6.js";import"./index-5effa088.js";import{_ as J}from"./UserDrawer.vue_vue_type_script_setup_true_lang-e9bcb6d4.js";import{_ as X}from"./UseSelectModal.vue_vue_type_script_setup_true_lang-55963f55.js";import{u as Y,j as Z,k as ee,m as te}from"./role.api-9fe8e1c4.js";import{u as oe,s as re}from"./role.data-ae4b97ff.js";import{g as ie}from"./user.api-99a0b5cb.js";import{z as ne}from"./index-0f5326ee.js";import{d as ae,k,V as u,a5 as w,a9 as g,a7 as t,f as o,u as a,E as _,W as I}from"./vue-5a09445c.js";import{D as se}from"./jeecg-online-vendor-a80da268.js";import"./BasicTable.vue_vue_type_style_index_0_lang-370f2588.js";import"./BasicForm-862341ae.js";import"./BasicForm.vue_vue_type_style_index_0_lang-92cda8aa.js";import"./antd-vue-vendor-04f0af1d.js";import"./tinymce-vendor-e2919cb0.js";import"./lodash-es-vendor-70833b4a.js";import"./BasicModal-588c46fe.js";import"./useWindowSizeFn-31e0259d.js";import"./vxe-table-vendor-c5aaa9d2.js";import"./codemirror-vendor-f458506d.js";import"./echarts-vendor-6c8e2159.js";import"./useForm-3526c2e4.js";import"./JAddInput-7a10c45b.js";import"./areaDataUtil-1f845736.js";import"./useFormItem-742dfe7c.js";import"./JSelectUser-0b713614.js";import"./props-4cb7d255.js";import"./JSelectBiz-bd869605.js";import"./index-21f376b3.js";import"./index-14b4b10a.js";import"./bem-8d785cce.js";import"./props-17f0c5eb.js";import"./useContextMenu-16ff3db3.js";import"./depart.api-19a655aa.js";import"./JSelectDept-a5c54ddb.js";import"./JPopup-cd3c8a0f.js";import"./cron-parser-vendor-278b5be3.js";import"./JEllipsis.vue_vue_type_script_setup_true_lang-d40bf8e2.js";import"./injectionKey-69710956.js";/* empty css              */import"./download-d03a8b78.js";import"./base64Conver-fa2fe1af.js";import"./index-eae03fd6.js";import"./index-73ed1f2f.js";import"./useCountdown-85782a4d.js";import"./useFormItemSingle-373c20d8.js";import"./JUpload.vue_vue_type_style_index_0_lang-c2f2a386.js";import"./index-b484e0e9.js";import"./index-42cdfb26.js";import"./user.data-41a21311.js";import"./validator-71c9e8f1.js";import"./renderUtils-37f34eeb.js";import"./useAdaptiveWidth-bd16174c.js";const le=ae({__name:"RoleUserTable",props:{disableUserEdit:{type:Boolean,default:!1}},emits:["register","hideUserList"],setup(d,{emit:R}){const s=d,l=k([]),n=k(""),[h,{setDrawerProps:y,closeDrawer:f}]=Q(e=>c(this,null,function*(){n.value=e.id,x({searchInfo:{roleId:e.id}}),p()})),[r,{openDrawer:m}]=q(),[S,{openModal:U}]=ne(),[v,{reload:p,updateTableDataRecord:D,setProps:x}]=H({title:"用户列表",api:Y,columns:oe,formConfig:{labelWidth:60,schemas:re,autoSubmitOnEnter:!0},striped:!0,useSearchForm:!0,showTableSetting:!0,clickToRowSelect:!1,bordered:!0,showIndexColumn:!1,tableSetting:{fullScreen:!0},canResize:!1,rowKey:"id",actionColumn:{width:180,title:"操作",dataIndex:"action",slots:{customRender:"action"},fixed:void 0}}),T={type:"checkbox",columnWidth:50,selectedRowKeys:l,onChange:B};function B(e,i){l.value=e}function E(){m(!0,{isUpdate:!1,selectedroles:[n.value],isRole:!0})}function K(e){return c(this,null,function*(){try{const i=yield ie({userid:e.id});i&&i.length>0&&(e.selectedroles=i)}catch(i){}m(!0,{record:e,isUpdate:!0,isRole:!0})})}function V(e){return c(this,null,function*(){yield te({userId:e.id,roleId:n.value},p)})}function L(){return c(this,null,function*(){yield Z({userIds:l.value.join(","),roleId:n.value},p)})}function M({isUpdate:e,values:i}){e?D(i.id,i):p()}function N(){U(!0)}function O(e){return c(this,null,function*(){yield ee({roleId:n.value,userIdList:e},p)})}function W(e){return[{label:"编辑",onClick:K.bind(null,e),ifShow:()=>!s.disableUserEdit},{label:"取消关联",popConfirm:{title:"是否确认取消关联",confirm:V.bind(null,e)}}]}return(e,i)=>{const b=u("a-button"),C=u("Icon"),j=u("a-menu-item"),z=u("a-menu"),F=u("a-dropdown");return w(),g(a(G),{onRegister:a(h),title:"角色用户",width:"800",destroyOnClose:""},{default:t(()=>[o(a($),{onRegister:a(v),rowSelection:T},{tableTitle:t(()=>[d.disableUserEdit?I("",!0):(w(),g(b,{key:0,type:"primary",onClick:E},{default:t(()=>[_(" 新增用户")]),_:1})),o(b,{type:"primary",onClick:N},{default:t(()=>[_(" 已有用户")]),_:1}),l.value.length>0?(w(),g(F,{key:1},{overlay:t(()=>[o(z,null,{default:t(()=>[o(j,{key:"1",onClick:L},{default:t(()=>[o(C,{icon:"bx:bx-unlink"}),_(" 取消关联 ")]),_:1})]),_:1})]),default:t(()=>[o(b,null,{default:t(()=>[_("批量操作 "),o(C,{icon:"ant-design:down-outlined"})]),_:1})]),_:1})):I("",!0)]),action:t(({record:P})=>[o(a(A),{actions:W(P)},null,8,["actions"])]),_:1},8,["onRegister"]),o(J,{onRegister:a(r),onSuccess:M},null,8,["onRegister"]),o(X,{onRegister:a(S),onSelect:O},null,8,["onRegister"])]),_:1},8,["onRegister"])}}});const ut=se(le,[["__scopeId","data-v-20dcdc2a"]]);export{ut as default};
