import{Q as M,u as N}from"./jeecg-online-vendor-4c7dd9e8.js";import{u as S}from"./auth.data-8be5c9e3-e3b37a89.js";import{D as V,A as F,L as T}from"./auth.api-d3a6c4b3-548ef687.js";import{d as q,k as l,e as z,w as A,V as y,a5 as v,a6 as I,a9 as E,F as J,aa as O,f as k,a7 as K,E as C}from"./vue-bcbaddf9.js";import"./antd-vue-vendor-a78909e6.js";import"./tinymce-vendor-676f8393.js";import"./vxe-table-vendor-9edfd3ae.js";import"./lodash-es-vendor-9b741fb8.js";var g=(e,u,a)=>new Promise((f,i)=>{var m=t=>{try{r(a.next(t))}catch(s){i(s)}},o=t=>{try{r(a.throw(t))}catch(s){i(s)}},r=t=>t.done?f(t.value):Promise.resolve(t.value).then(m,o);r((a=a.apply(e,u)).next())});const R=q({name:"AuthButtonTree",props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:u}=N(),a=l(""),f=l(2),i=l(!0),m=l([]),o=l([]),r=l([]),t=l(""),s=z(()=>!a.value);A(()=>e.cgformId,h,{immediate:!0});function h(){return g(this,null,function*(){if(!e.cgformId)return;let n=yield V(e.cgformId,f.value);n.forEach(d=>{for(const p of S)if(d.code==p.code){d.title=p.title;break}});let c=[];for(let d of n){let p=w(d);c.push({key:d.id,title:p})}r.value=c})}function b(){h(),x(a.value,t.value)}function x(n,c){return g(this,null,function*(){a.value=n,t.value=c,o.value=[],yield h();let d=yield F({roleId:n,cgformId:e.cgformId,type:f.value,authMode:c});o.value=d.map(p=>p.authId)})}function D(){a.value="",h()}function P(){return g(this,null,function*(){yield T(a.value,e.cgformId,{authId:JSON.stringify(o.value),authMode:t.value}),u.success("保存成功")})}function w(n){let c=n.title+"-";return n.page==3?c+="列表可见":n.page==5&&(c+="表单可见"),c}function B(n){m.value=n,i.value=!1}function _(){a.value="",o.value=[]}return{loadChecked:x,clear:_,expandedKeys:m,autoExpandParent:i,checkedKeys:o,treeData:r,disabled:s,onSave:P,onExpand:B,onRefresh:b,clearChecked:D}}}),$={class:"onl-auth-tree-btns"};function L(e,u,a,f,i,m){const o=y("a-empty"),r=y("a-button"),t=y("a-tree");return v(),I("div",null,[e.disabled?(v(),E(o,{key:0,description:"请先选中左侧角色/部门/用户"})):e.treeData.length===0?(v(),E(o,{key:1,description:"无权限信息"})):(v(),I(J,{key:2},[O("div",$,[k(r,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:K(()=>[C("刷新")]),_:1},8,["onClick"]),k(r,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:K(()=>[C("保存")]),_:1},8,["onClick"])]),k(t,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":u[0]||(u[0]=s=>e.checkedKeys=s),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}const Z=M(R,[["render",L],["__scopeId","data-v-d165a23e"]]);export{Z as default};
