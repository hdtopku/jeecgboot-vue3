import{d as he,l as o,o as we,V as u,a7 as i,a8 as D,f as n,aa as t,ad as Ce,E as f,j as xe,v as V,B as H,W as O,ac as y,u as z,R as k,as as Oe,F as J,ab as ne,ae as Q,g as Se}from"./vue-ebecda47.js";import{e as _,cL as Ne,cM as Be,c as se}from"./antd-vue-vendor-b75e8c06.js";import{bb as Pe,bc as De}from"./jeecg-online-vendor-cfb58502.js";import{r as $e,a5 as Ue}from"./index-85cfc899.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-cd7703c8.js";import"./vxe-table-vendor-4aae63bf.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";const Ae=c=>{if(c==null)return"";const F=/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/g,h=c.match(F);return h!=null?h[0]:c},Me=()=>navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)!=null,Te=()=>!Me(),Ee={class:"flex flex-wrap justify-evenly"},Le={key:0,class:"flex flex-wrap justify-evenly"},je={key:1,class:"flex flex-wrap justify-evenly"},We=he({__name:"Search",props:{placeholder:{type:String,default:"粘贴搜索"},showTop:{type:Boolean,default:!1},showCopy:{type:Boolean,default:!1},showPeople:{type:Boolean,default:!1},tabPane:{type:Object,default:()=>({tabs:[],activeKey:"0"})},switchName:{type:String,default:""}},emits:["queryList","changeAdvanced","confirmCopy"],setup(c,{expose:F,emit:h}){var ee;const p=c,{hasPermission:oe}=$e(),d=o(_()),w=o(_()),s=o(),v=o(1),W=o(!0),$=o(!1),U=o(!1),K=o([]),m=o(0),C=o(!1),S=o(!1),ue=e=>e&&e>_().endOf("day"),ie=e=>e&&e>_().endOf("day")||e.isBefore(d.value),g=o(),N=(e,a=0)=>{m.value=e,m.value===365?d.value=_().startOf("year"):m.value===100?d.value=_().startOf("month"):d.value=_().subtract(e,"day"),w.value=_().subtract(a,"day"),g.value=!1,b()},G=()=>{g.value=!0,b()},re=()=>{navigator.clipboard.readText().then(e=>{s.value=e,b()}).catch(e=>{e instanceof DOMException?se.error("请手动粘贴，或允许读取剪贴板，失败原因："+e):se.error("请手动粘贴，失败原因："+e)})},X=()=>{var e;return W.value?S.value&&((e=p.switchName)==null?void 0:e.length)>0?"warning":"primary":"error"},ce=()=>{K.value.length===0&&(U.value=!0,Ue({}).then(e=>{K.value=e.records,U.value=!1}))},I=Pe(De),B=o();let{username:A,realname:ve}=I==null?void 0:I.userInfo;const de=A;B.value=ve;const fe=e=>{A=e,W.value=de===B.value,e==null&&(B.value="所有人"),b()},M=o((ee=p==null?void 0:p.tabPane)==null?void 0:ee.activeKey),pe=e=>{M.value=e,b()},b=()=>{var a,r,x,P,T,E,L,j,Y;d.value.isAfter(w.value)&&(w.value=d.value),s.value=Ae((a=s==null?void 0:s.value)==null?void 0:a.trim());let e=(r=s.value)==null?void 0:r.indexOf("/j/");e<0&&(e=(x=s.value)==null?void 0:x.indexOf("/c/")),e<0&&(e=(P=s.value)==null?void 0:P.indexOf("/d/")),e>=0&&(s.value=(T=s.value)==null?void 0:T.substring(e+3)),e<0&&(e=(E=s.value)==null?void 0:E.indexOf("/jb/"),e>=0&&(s.value=(L=s.value)==null?void 0:L.substring(e+4)),e=(j=s.value)==null?void 0:j.indexOf("/jc/"),e>=0&&(s.value=(Y=s.value)==null?void 0:Y.substring(e+4))),localStorage.setItem("searchSwitch:"+p.switchName,JSON.stringify(S.value)),h("queryList",{pageNo:1,pageSize:30,startTime:d.value.startOf("day").format("YYYY-MM-DD HH:mm:ss"),endTime:w.value.endOf("day").format("YYYY-MM-DD HH:mm:ss"),keyword:s.value,username:A,checked:S.value,status:M.value})},me=()=>{C.value=!C.value,h("changeAdvanced")},Z=()=>{$.value=!0,h("confirmCopy",{count:v.value,username:A,checked:S.value})},{proxy:R}=Se();return F({queryFinish:(e="")=>{v.value===1?R.tool.copy(e,e+"已复制"):R.tool.copy(e,v.value+"条已复制"),$.value=!1}}),we(()=>{var e;S.value=JSON.parse((e=localStorage.getItem("searchSwitch:"+p.switchName))!=null?e:"false"),b()}),(e,a)=>{var ae,te;const r=u("a-button"),x=u("a-space"),P=u("a-date-picker"),T=u("a-select-option"),E=u("a-spin"),L=u("a-select"),j=u("a-input"),Y=u("a-card"),q=u("a-col"),ye=u("a-slider"),_e=u("a-popconfirm"),ge=u("a-row"),be=u("a-tab-pane"),ke=u("a-tabs");return i(),D(J,null,[n(Y,{size:"small"},{default:t(()=>[Ce("div",Ee,[c.showTop?(i(),D("div",Le,[n(x,{size:5,class:"mb-2"},{default:t(()=>[n(r,{type:!g.value&&m.value===365?"link":"",onClick:a[0]||(a[0]=l=>N(365,0))},{default:t(()=>[f("今年 ")]),_:1},8,["type"]),n(r,{type:!g.value&&m.value===30?"link":"",onClick:a[1]||(a[1]=l=>N(30,0))},{default:t(()=>[f(" 30天 ")]),_:1},8,["type"]),n(r,{type:!g.value&&m.value===100?"link":"",onClick:a[2]||(a[2]=l=>N(100))},{default:t(()=>[f(" 本月 ")]),_:1},8,["type"]),n(r,{type:!g.value&&m.value===1?"link":"",onClick:a[3]||(a[3]=l=>N(1,1))},{default:t(()=>[f(" 昨天 ")]),_:1},8,["type"]),n(r,{type:!g.value&&m.value===0?"link":"",onClick:a[4]||(a[4]=l=>N(0,0))},{default:t(()=>[f(" 今天 ")]),_:1},8,["type"])]),_:1}),n(xe,{"enter-active-class":"animate__animated animate__flipInX","leave-active-class":"animate__animated animate__flipOutX animate__faster"},{default:t(()=>[V(n(x,{class:"mb-2"},{default:t(()=>[n(P,{onChange:G,allowClear:"",placeholder:"开始日期","disabled-date":ue,value:d.value,"onUpdate:value":a[5]||(a[5]=l=>d.value=l)},null,8,["value"]),n(P,{onChange:G,allowClear:"",placeholder:"结束日期","disabled-date":ie,value:w.value,"onUpdate:value":a[6]||(a[6]=l=>w.value=l)},null,8,["value"])]),_:1},512),[[H,C.value]])]),_:1})])):O("",!0),n(j,{size:"large",value:s.value,"onUpdate:value":a[8]||(a[8]=l=>s.value=l),onChange:b,placeholder:c.placeholder,allowClear:""},{prefix:t(()=>[n(r,{type:"link",onClick:me},{default:t(()=>[C.value?(i(),y(z(Ne),{key:0})):(i(),y(z(Be),{key:1}))]),_:1}),k(e.$slots,"prefix"),C.value?(i(),y(x,{key:0},{default:t(()=>[z(oe)("am:selectUser")&&c.showPeople?(i(),y(L,{key:0,size:"",loading:U.value,allowClear:"",ref:"select",value:B.value,"onUpdate:value":a[7]||(a[7]=l=>B.value=l),style:{width:"90px"},onFocus:ce,onChange:fe},Oe({default:t(()=>[(i(!0),D(J,null,ne(K.value,l=>(i(),y(T,{key:l.id,value:l.username},{default:t(()=>[f(Q(l.realname),1)]),_:2},1032,["value"]))),128))]),_:2},[U.value?{name:"notFoundContent",fn:t(()=>[n(E,{size:"small"})]),key:"0"}:void 0]),1032,["loading","value"])):O("",!0),z(Te)()?(i(),y(r,{key:1,ghost:"",type:"success",onClick:re},{default:t(()=>[f("粘贴")]),_:1})):O("",!0)]),_:1})):O("",!0)]),suffix:t(()=>[C.value?k(e.$slots,"suffixAdvanced",{key:0}):k(e.$slots,"suffixNotAdvanced",{key:1}),k(e.$slots,"suffix")]),_:3},8,["value","placeholder"])])]),_:3}),c.showCopy?(i(),y(ge,{key:0,class:"w-full mt-2"},{default:t(()=>[n(q,{span:4},{default:t(()=>[k(e.$slots,"left")]),_:3}),n(q,{span:14},{default:t(()=>[n(ye,{style:{display:"inline-block"},value:v.value,"onUpdate:value":a[9]||(a[9]=l=>v.value=l),min:1,max:500},null,8,["value"])]),_:1}),n(q,{class:"text-center",span:6},{default:t(()=>[V(n(r,{onClick:Z,loading:$.value,type:X()},{default:t(()=>[f("复制"+Q(v.value)+"条 ",1)]),_:1},8,["loading","type"]),[[H,v.value===1]]),n(_e,{title:`确定复制${v.value}条吗?`,"ok-text":"确定","cancel-text":"取消",onConfirm:Z},{default:t(()=>[V(n(r,{loading:$.value,placeholder:"开始日期",type:X()},{default:t(()=>[f("复制"+Q(v.value)+"条 ",1)]),_:1},8,["loading","type"]),[[H,v.value>1]])]),_:1},8,["title"])]),_:1})]),_:3})):O("",!0),((te=(ae=p.tabPane)==null?void 0:ae.tabs)==null?void 0:te.length)>0?(i(),D("div",je,[n(ke,{animated:!1,activeKey:M.value,"onUpdate:activeKey":a[10]||(a[10]=l=>M.value=l),onTabClick:pe},{leftExtra:t(()=>[k(e.$slots,"leftTabExtra")]),rightExtra:t(()=>[k(e.$slots,"rightTabExtra")]),default:t(()=>{var l;return[(i(!0),D(J,null,ne((l=p.tabPane)==null?void 0:l.tabs,le=>(i(),y(be,{key:le.tabKey,tab:le.tabName},null,8,["tab"]))),128))]}),_:3},8,["activeKey"])])):O("",!0)],64)}}});export{We as default};
