import{Q as V,u as T}from"./jeecg-online-vendor-885afdd4.js";import{f as Q,A as R,B as q}from"./auth.api-d3a6c4b3-6890b7e5.js";import{as as H,at as J,au as W,av as X,aw as Y}from"./antd-vue-vendor-a78909e6.js";import{d as $,k as p,e as j,w as G,V as f,a5 as x,a6 as D,a9 as S,F as L,aa as Z,f as r,a7 as v,E as k,u as ee}from"./vue-bcbaddf9.js";import"./tinymce-vendor-676f8393.js";import"./vxe-table-vendor-9edfd3ae.js";import"./lodash-es-vendor-9b741fb8.js";var K=(e,h,c)=>new Promise((C,m)=>{var s=o=>{try{l(c.next(o))}catch(d){m(d)}},n=o=>{try{l(c.throw(o))}catch(d){m(d)}},l=o=>o.done?C(o.value):Promise.resolve(o.value).then(s,n);l((c=c.apply(e,h)).next())});const ae=$({name:"AuthFieldTree",components:{DownCircleOutlined:H,HomeOutlined:J,UpCircleOutlined:W,UndoOutlined:X,CheckOutlined:Y},props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:h}=T(),c=p(""),C=p(1),m=p(!0),s=p([]),n=p([]),l=p([]),o=p([]),d=p(""),I=j(()=>!c.value);G(()=>e.cgformId,y,{immediate:!0});function y(){return K(this,null,function*(){if(!e.cgformId)return;let a=yield Q(e.cgformId,C.value),t=[],i=[];a.forEach(u=>{i.includes(u.code)||(i.push(u.code),t.push({key:u.code,title:u.title}))});for(let u of t){let w=[];for(let E of a)if(u.key===E.code){let F=O(E);w.push({key:E.id,title:F})}u.children=w}o.value=t,s.value=[...i],l.value=i})}function O(a){let t="";return a.page==3?t+="列表":a.page==5&&(t+="表单"),a.control==3?t+="可编辑":a.control==5&&(t+="可见"),t}function g(a,t){return K(this,null,function*(){c.value=a,d.value=t,n.value=[],yield y();let i=yield R({roleId:a,cgformId:e.cgformId,type:C.value,authMode:t});n.value=i.map(u=>u.authId)})}function _(){c.value="",y()}function A(){y(),g(c.value,d.value)}function b(){return K(this,null,function*(){let a=n.value.filter(t=>l.value.indexOf(t)<0);yield q(c.value,e.cgformId,{authId:JSON.stringify(a),authMode:d.value}),h.success("保存成功")})}function z(){s.value=[...l.value]}function B(){s.value=[]}function P(a){s.value=a,m.value=!1}function U(){c.value="",n.value=[]}function M(){n.value=[]}function N(){const a=function(t){for(let i of t)n.value.push(i.key),i.children&&i.children.length>0&&a.call(null,i.children)};n.value=[],a.call(null,ee(o))}return{loadChecked:g,clear:U,expandedKeys:s,autoExpandParent:m,checkedKeys:n,treeData:o,disabled:I,onSave:b,onExpand:P,clearChecked:_,onCloseAll:B,onExpandAll:z,onRefresh:A,onClearSelected:M,onSelectAll:N}}}),te={class:"onl-auth-tree-btns"};function le(e,h,c,C,m,s){const n=f("a-empty"),l=f("a-button"),o=f("DownCircleOutlined"),d=f("UpCircleOutlined"),I=f("CheckOutlined"),y=f("UndoOutlined"),O=f("a-tree");return x(),D("div",null,[e.disabled?(x(),S(n,{key:0,description:"请先选中左侧角色/部门/用户"})):e.treeData.length===0?(x(),S(n,{key:1,description:"无权限信息"})):(x(),D(L,{key:2},[Z("div",te,[r(l,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:v(()=>[k("刷新")]),_:1},8,["onClick"]),r(l,{onClick:e.onExpandAll,size:"small",type:"primary",ghost:""},{default:v(()=>[r(o),k("展开")]),_:1},8,["onClick"]),r(l,{onClick:e.onCloseAll,size:"small",type:"primary",ghost:""},{default:v(()=>[r(d),k("折叠")]),_:1},8,["onClick"]),r(l,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:v(()=>[k("保存")]),_:1},8,["onClick"]),r(l,{onClick:e.onSelectAll,size:"small",type:"primary",ghost:""},{default:v(()=>[r(I),k("全选")]),_:1},8,["onClick"]),r(l,{onClick:e.onClearSelected,size:"small",type:"primary",ghost:""},{default:v(()=>[r(y),k("重置")]),_:1},8,["onClick"])]),r(O,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":h[0]||(h[0]=g=>e.checkedKeys=g),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}const se=V(ae,[["render",le],["__scopeId","data-v-e6dabb1d"]]);export{se as default};
