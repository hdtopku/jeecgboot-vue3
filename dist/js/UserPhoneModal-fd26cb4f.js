var I=Object.defineProperty,P=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var M=(s,e,o)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,v=(s,e)=>{for(var o in e||(e={}))q.call(e,o)&&M(s,o,e[o]);if(b)for(var o of b(e))N.call(e,o)&&M(s,o,e[o]);return s},R=(s,e)=>P(s,U(e));var h=(s,e,o)=>new Promise((i,t)=>{var l=a=>{try{c(o.next(a))}catch(m){t(m)}},f=a=>{try{c(o.throw(a))}catch(m){t(m)}},c=a=>a.done?i(a.value):Promise.resolve(a.value).then(l,f);c((o=o.apply(s,e)).next())});import{d as w,r as O,l as C,V as d,a7 as T,ac as $,aa as u,f as n,u as k,E as j,af as A}from"./vue-50733b77.js";import{B as D}from"./BasicModal-064024e0.js";import{C as G}from"./index-f3acc26c.js";import{u as L,q as H,b9 as J,bp as K}from"./jeecg-online-vendor-d3e1865b.js";import"./index-f7d688aa.js";import{rules as Q}from"./validator-0e75b328.js";import{c2 as W}from"./antd-vue-vendor-c5335947.js";import{E as X}from"./index-b34ff7bc.js";import{u as Y}from"./UserSetting.api-6e884b8c.js";import"./useWindowSizeFn-34cbae37.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-058e2396.js";import"./vxe-table-vendor-838914b0.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./useCountdown-9338ec9a.js";import"./useFormItemSingle-37938520.js";import"./user.api-c252cb60.js";const Z=w({name:"user-replace-phone-modal"}),Ce=w(R(v({},Z),{emits:["register","success"],setup(s,{emit:e}){const o=L(),{createMessage:i}=H(),t=O({phone:"",smscode:""}),l=C(),f=C({}),c={phone:[v({},Q.duplicateCheckRule("sys_user","phone",t,{label:"手机号"})[0]),{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式有误"}],smscode:[{required:!0,message:"请输入验证码"}]},a=W.useForm,m=C(""),[y,{setModalProps:B,closeModal:E}]=X(r=>h(this,null,function*(){l.value.resetFields(),l.value.clearValidate(),B({confirmLoading:!1}),m.value="修改手机号",r.record.smscode="",Object.assign(t,r.record),f.value=r.record}));function F(){return J({mobile:t.phone,smsmode:K.REGISTER})}function S(){return h(this,null,function*(){yield l.value.validateFields(),Y(t).then(r=>{r.success?(i.success("修改手机号成功"),e("success"),E()):i.warning(r.message)})})}return(r,p)=>{const x=d("a-input"),_=d("a-form-item"),V=d("a-button"),z=d("a-form");return T(),$(D,A(r.$attrs,{onRegister:k(y),width:"500px",title:m.value,showCancelBtn:!1,showOkBtn:!1}),{default:u(()=>[n(z,{class:"antd-modal-form",ref_key:"formRef",ref:l,model:t,rules:c},{default:u(()=>[n(_,{name:"phone"},{default:u(()=>[n(x,{size:"large",value:t.phone,"onUpdate:value":p[0]||(p[0]=g=>t.phone=g),placeholder:"请输入手机号"},null,8,["value"])]),_:1}),n(_,{name:"smscode"},{default:u(()=>[n(k(G),{size:"large",value:t.smscode,"onUpdate:value":p[1]||(p[1]=g=>t.smscode=g),placeholder:"输入6位验证码",sendCodeApi:F},null,8,["value"])]),_:1}),n(_,null,{default:u(()=>[n(V,{size:"large",type:"primary",block:"",onClick:S},{default:u(()=>[j(" 确认 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},16,["onRegister","title"])}}}));export{Ce as default};
