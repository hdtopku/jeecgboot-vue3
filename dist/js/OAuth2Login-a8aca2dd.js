import{aC as n,aD as a}from"./index-fde9c72f.js";import{d as m,k as c,bF as h,aV as k,as as v}from"./vue-c7e3516e.js";import{r as A,P as y,c as _,k as B,l as F}from"./jeecg-online-vendor-bf2efbcb.js";import"./lodash-es-vendor-42c8d3d4.js";import"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./codemirror-vendor-96aab763.js";import"./echarts-vendor-b30c7238.js";import"./html2canvas-vendor-654dcb8a.js";import"./vxe-table-vendor-8bace23a.js";const W=m({__name:"OAuth2Login",setup(L){const p=c(n()),e=c({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:l}=h(),o=l.value;n()||A.replace({path:y.BASE_LOGIN,query:o.query}),p.value&&g();function g(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),f()}function f(){if(e.value.thirdApp)if(o.query.oauth2LoginToken){let s=o.query.oauth2LoginToken;d({token:s,thirdType:o.query.thirdType})}else e.value.wxWork?a("wechat_enterprise"):e.value.dingtalk&&a("dingtalk")}function d(s){const u=_(),{notification:r}=F(),{t:i}=B();u.ThirdLogin(s).then(t=>{t&&t.userInfo?r.success({message:i("sys.login.loginSuccessTitle"),description:`${i("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):r.error({message:"\u767B\u5F55\u5931\u8D25",description:((t.response||{}).data||{}).message||t.message||"\u8BF7\u6C42\u51FA\u73B0\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5",duration:4})})}return(s,u)=>(k(),v("div"))}});export{W as default};
