var Y=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var k=(o,n,t)=>n in o?Y(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t,x=(o,n)=>{for(var t in n||(n={}))te.call(n,t)&&k(o,t,n[t]);if(h)for(var t of h(n))ne.call(n,t)&&k(o,t,n[t]);return o},E=(o,n)=>Z(o,ee(n));var D=(o,n,t)=>new Promise((m,f)=>{var _=i=>{try{l(t.next(i))}catch(c){f(c)}},b=i=>{try{l(t.throw(i))}catch(c){f(c)}},l=i=>i.done?m(i.value):Promise.resolve(i.value).then(_,b);l((t=t.apply(o,n)).next())});import oe from"./BasicTable-29c6504d.js";import{T as ae}from"./componentMap-a6d21ad6.js";import"./BasicTable.vue_vue_type_style_index_0_lang-b7d11241.js";import"./useTable-7e303edd.js";import"./index-8cf3aabb.js";import{a as F}from"./index-fb25354c.js";import{useListPage as re}from"./useListPage-5049b37a.js";import{_ as se}from"./UserDrawer.vue_vue_type_script_setup_true_lang-42e0df80.js";import{U as ue}from"./JAddInput-2cbbbde9.js";import{_ as le}from"./DepartRoleUserAuthDrawer.vue_vue_type_script_setup_true_lang-3eacf8e7.js";import{m as ie,n as ce,u as pe}from"./depart.user.api-fc1a836a.js";import{c as de,e as me}from"./depart.user.data-d5425979.js";import{E as fe}from"./index-fde9c72f.js";import{d as _e,c as De,e as be,w as we,U as d,aV as A,as as ge,f as a,bi as s,E as B,u,ar as Ce,V as ye,F as Ue,at as R}from"./vue-c7e3516e.js";const he=R("span",null,"\u53D6\u6D88\u5173\u8054",-1),ke=R("span",null,"\u6279\u91CF\u64CD\u4F5C ",-1),Ke=_e({__name:"DepartUserInfoTab",props:{data:{require:!0,type:Object}},setup(o){const n=o;De("prefixCls");const t=be(()=>{var e;return(e=n.data)==null?void 0:e.id}),m={xs:24,sm:24,md:24,lg:12,xl:12,xxl:8},{tableContext:f,createMessage:_}=re({tableProps:{api:ie,columns:de,canResize:!1,formConfig:{schemas:me,baseColProps:m,labelAlign:"left",labelCol:{xs:24,sm:24,md:24,lg:9,xl:7,xxl:5},wrapperCol:{},actionColOptions:E(x({},m),{style:{textAlign:"left"}})},beforeFetch(e){e.depId=t.value}}}),[b,{reload:l,setProps:i,setLoading:c,updateTableDataRecord:S},{rowSelection:v,selectedRowKeys:w}]=f;we(()=>n.data,()=>l());const[I,{openDrawer:g,setDrawerProps:xe}]=F(),[T,P]=F(),[M,V]=fe();function j(){w.value=[]}function N(e){P.openDrawer(!0,{userId:e.id,departId:t})}function O(){var e,r;t.value?g(!0,{isUpdate:!1,departDisabled:!0,nextDepartOptions:{value:(e=n.data)==null?void 0:e.key,label:(r=n.data)==null?void 0:r.title},record:{activitiSync:1,userIdentity:1,selecteddeparts:t.value}}):_.warning("\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u90E8\u95E8")}function K(e){g(!0,{record:e,isUpdate:!0,departDisabled:!0,showFooter:!1})}function L(e){g(!0,{isUpdate:!0,record:e,departDisabled:!0})}function $(){V.openModal()}function C(e,r){return D(this,null,function*(){if(!t.value)_.warning("\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u90E8\u95E8");else{c(!0);let p=u(e).join(",");try{return yield pe({depId:t.value,userIds:p},r),l()}finally{c(!1)}}return Promise.reject()})}function q(){return D(this,null,function*(){try{yield C(w,!0),j()}catch(e){}})}function z(e,r){return D(this,null,function*(){if(r.length>0)try{c(!0),yield ce(t.value,r),l()}finally{c(!1)}})}function G({isUpdate:e,values:r}){e?S(r.id,r):l()}function H(e){return[{label:"\u7F16\u8F91",onClick:L.bind(null,e)}]}function J(e){return[{label:"\u90E8\u95E8\u89D2\u8272",onClick:N.bind(null,e)},{label:"\u7528\u6237\u8BE6\u60C5",onClick:K.bind(null,e)},{label:"\u53D6\u6D88\u5173\u8054",color:"error",popConfirm:{title:"\u786E\u8BA4\u53D6\u6D88\u5173\u8054\u5417\uFF1F",confirm:C.bind(null,[e.id],!1)}}]}return(e,r)=>{const p=d("a-button"),y=d("icon"),Q=d("a-menu-item"),W=d("a-menu"),X=d("a-dropdown");return A(),ge(Ue,null,[a(u(oe),{onRegister:u(b),rowSelection:u(v)},{tableTitle:s(()=>[a(p,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:$},{default:s(()=>[B("\u6DFB\u52A0\u5DF2\u6709\u7528\u6237")]),_:1}),a(p,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:O},{default:s(()=>[B("\u65B0\u5EFA\u7528\u6237")]),_:1}),u(w).length>0?(A(),Ce(X,{key:0},{overlay:s(()=>[a(W,null,{default:s(()=>[a(Q,{key:"1",onClick:q},{default:s(()=>[a(y,{icon:"bx:bx-unlink"}),he]),_:1})]),_:1})]),default:s(()=>[a(p,null,{default:s(()=>[ke,a(y,{icon:"akar-icons:chevron-down"})]),_:1})]),_:1})):ye("",!0)]),action:s(({record:U})=>[a(u(ae),{actions:H(U),dropDownActions:J(U)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),a(se,{onRegister:u(I),onSuccess:G},null,8,["onRegister"]),a(le,{onRegister:u(T)},null,8,["onRegister"]),a(ue,{rowKey:"id",onRegister:u(M),onGetSelectResult:z},null,8,["onRegister"])],64)}}});export{Ke as _};
