var v=Object.defineProperty;var h=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var y=(s,t,e)=>t in s?v(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,P=(s,t)=>{for(var e in t||(t={}))w.call(t,e)&&y(s,e,t[e]);if(h)for(var e of h(t))M.call(t,e)&&y(s,e,t[e]);return s};var f=(s,t,e)=>new Promise((c,l)=>{var p=n=>{try{a(e.next(n))}catch(r){l(r)}},d=n=>{try{a(e.throw(n))}catch(r){l(r)}},a=n=>n.done?c(n.value):Promise.resolve(n.value).then(p,d);a((e=e.apply(s,t)).next())});import{B}from"./index-378f1f74.js";import{B as I}from"./BasicForm-b17dbcb2.js";import"./componentMap-ac4d3a60.js";import{u as T}from"./useForm-ec2789c8.js";import"./JAddInput-079a6c33.js";import"./JSelectUser-b7290477.js";import"./JSelectDept-52bb52e5.js";import"./JPopup-4aed0a12.js";import{B as C}from"./index-b6e19f4a.js";import"./antd-vue-vendor-cce59da1.js";import{s as D,u as F}from"./jeecg-online-vendor-88d7be55.js";import{a as R}from"./UserSetting.api-94ba4641.js";import{d as x,k as g,a5 as A,a9 as L,a7 as Y,f as O,u as i,ag as U}from"./vue-705b7309.js";const ee=[{key:"1",name:"个人信息",component:"BaseSetting",icon:"ant-design:user-outlined"},{key:"2",name:"我的租户",component:"TenantSetting",icon:"ant-design:team-outlined"},{key:"3",name:"账号安全",component:"AccountSetting",icon:"ant-design:lock-outlined"},{key:"4",name:"第三方APP",component:"WeChatDingSetting",icon:"ant-design:contacts-outlined"}],G=[{field:"realname",component:"Input",label:"姓名",colProps:{span:24},required:!0},{field:"birthday",component:"DatePicker",label:"生日",colProps:{span:24},componentProps:{showTime:!1,valueFormat:"YYYY-MM-DD",getPopupContainer:()=>document.body}},{field:"sex",component:"RadioGroup",label:"性别",colProps:{span:24},componentProps:{options:[{label:"男",value:1},{label:"女",value:2}]}},{field:"relTenantIds",component:"JDictSelectTag",label:"租户",colProps:{span:24},componentProps:{mode:"multiple",dictCode:"sys_tenant,name,id",disabled:!0}},{field:"post",component:"JDictSelectTag",label:"职位",colProps:{span:24},componentProps:{mode:"multiple",dictCode:"sys_position,name,code",disabled:!0}},{label:"",field:"id",component:"Input",show:!1}],oe=x({__name:"UserAccountModal",emits:["register","success"],setup(s,{emit:t}){const e=D(),{createMessage:c}=F(),[l,{resetFields:p,setFieldsValue:d,validate:a,updateSchema:n}]=T({schemas:G,showActionButtonGroup:!1}),r=g({});g(!1);const b=g(""),[S,{setModalProps:u,closeModal:_}]=C(o=>f(this,null,function*(){yield p(),u({confirmLoading:!1}),b.value="编辑个人资料",o.record.post&&(o.record.post=o.record.post.split(",")),o.record.relTenantIds&&(o.record.relTenantIds=o.record.relTenantIds.split(",")),r.value=o.record,o.record.birthday==="未填写"&&(o.record.birthday=void 0),yield d(P({},o.record))}));function k(){return f(this,null,function*(){try{let o=yield a();u({confirmLoading:!0}),yield R(o).then(m=>{m.success?c.success(m.message):c.warn(m.message)}),Object.assign(r.value,o),e.setUserInfo(i(r)),t("success"),_()}finally{u({confirmLoading:!1})}})}return(o,m)=>(A(),L(i(B),U(o.$attrs,{onRegister:i(S),width:"500px",title:b.value,onOk:k,destroyOnClose:""}),{default:Y(()=>[O(i(I),{onRegister:i(l)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{oe as _,ee as s};
