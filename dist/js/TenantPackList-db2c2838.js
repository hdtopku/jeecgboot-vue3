var J=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var P=(a,o,e)=>o in a?J(a,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[o]=e,A=(a,o)=>{for(var e in o||(o={}))Z.call(o,e)&&P(a,e,o[e]);if(M)for(var e of M(o))tt.call(o,e)&&P(a,e,o[e]);return a},v=(a,o)=>X(a,Y(o));var s=(a,o,e)=>new Promise((l,d)=>{var k=i=>{try{f(e.next(i))}catch(p){d(p)}},r=i=>{try{f(e.throw(i))}catch(p){d(p)}},f=i=>i.done?l(i.value):Promise.resolve(i.value).then(k,r);f((e=e.apply(a,o)).next())});import{d as O,l as T,r as et,V as ot,a7 as C,a8 as nt,f as m,aa as u,u as n,ac as R,E as I,W as S,af as at,F as it}from"./vue-50733b77.js";import{B as rt}from"./index-f7d688aa.js";import{p as st,d as lt}from"./tenant.data-b5c32939.js";import{p as pt,k as B}from"./tenant.api-23ecf51b.js";import{useListPage as ct}from"./useListPage-4f9607d2.js";import"./index-f191817e.js";import mt from"./TenantPackMenuModal-b7eeb804.js";import{M as ut}from"./antd-vue-vendor-c5335947.js";import{q as dt}from"./jeecg-online-vendor-d3e1865b.js";import ft from"./TenantPackUserModal-693493f5.js";import{F,E as gt}from"./index-b34ff7bc.js";import kt from"./BasicTable-ca5b2c76.js";import{Q as ht}from"./componentMap-5c02cfaf.js";import"./BasicModal-064024e0.js";import"./useWindowSizeFn-34cbae37.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-058e2396.js";import"./vxe-table-vendor-838914b0.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./renderUtils-74a3a0ef.js";import"./index-fa22fec6.js";import"./index-95220aa0.js";import"./validator-0e75b328.js";import"./user.api-c252cb60.js";import"./index-7e7a94e9.js";import"./useForm-14ceb529.js";import"./JAddInput-9c2385b5.js";import"./areaDataUtil-5dfcdadb.js";import"./useFormItem-915d7f1b.js";import"./JSelectUser-99e618da.js";import"./props-2079d80b.js";import"./JSelectBiz-f98b6288.js";import"./index-7963a080.js";import"./bem-e62027cc.js";import"./props-12d3a914.js";import"./useContextMenu-e6153f12.js";import"./depart.api-1967d2cb.js";import"./JSelectDept-0fd43050.js";import"./JPopup-8bd4163b.js";import"./JEllipsis-66e02300.js";import"./download-49b89a1a.js";import"./base64Conver-fa2fe1af.js";import"./index-54db12ae.js";import"./index-f3acc26c.js";import"./useCountdown-9338ec9a.js";import"./useFormItemSingle-37938520.js";import"./cron-parser-vendor-19ac00ef.js";import"./JUpload-c8630cc9.js";import"./index-665aeeac.js";import"./index-1ac4dcff.js";import"./injectionKey-69710956.js";import"./TenantUserSelectModal-171de6af.js";const wt=O({name:"tenant-pack-modal"}),ye=O(v(A({},wt),{emits:["register","success"],setup(a,{emit:o}){const[e,{openModal:l}]=F(),[d,{openModal:k}]=F(),r=T(0),{prefixCls:f,tableContext:i}=ct({designScope:"tenant-template",tableProps:{api:pt,columns:st,immediate:!1,formConfig:{schemas:lt,labelCol:{xxl:8},actionColOptions:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8}},beforeFetch:t=>Object.assign(t,{tenantId:n(r),packType:"custom"})}}),[p,{reload:U},{rowSelection:D,selectedRowKeys:h,selectedRows:E}]=i,w=T(!1),[V,{setModalProps:Ct,closeModal:N}]=gt(t=>s(this,null,function*(){r.value=t.tenantId,w.value=t.showPackAddAndEdit,c()})),j="租户产品包列表";function K(t){return s(this,null,function*(){N()})}function L(t){return[{label:"用户",onClick:z.bind(null,t)},{label:"编辑",onClick:$.bind(null,t),ifShow:()=>w.value}]}function c(){(h.value=[])&&U()}function $(t){return s(this,null,function*(){l(!0,{isUpdate:!0,record:t,tenantId:n(r),packType:"custom",showFooter:!0})})}const y=et(["superAdmin","accountAdmin","appAdmin"]),{createMessage:b}=dt();function q(t){return s(this,null,function*(){if(y.indexOf(t.packCode)!=-1){b.warning("默认系统产品包不允许删除");return}yield B({ids:t.id},c)})}function Q(){return s(this,null,function*(){let t=E.value;if(t&&t.length>0){for(let g=0;g<t.length;g++)if(y.indexOf(t[g].packCode)!=-1){b.warning("默认系统产品包不允许删除");return}}ut.confirm({title:"删除租户产品包",content:"是否删除租户产品包",okText:"确认",cancelText:"取消",onOk:()=>s(this,null,function*(){yield B({ids:h.value.join(",")},c)})})})}function W(){l(!0,{isUpdate:!1,tenantId:n(r),packType:"custom",showFooter:!0})}function z(t){k(!0,{record:t})}function G(t){return[{label:"详情",onClick:H.bind(null,t)},{label:"删除",popConfirm:{title:"是否确认删除租户产品包",confirm:q.bind(null,t)}}]}function H(t){l(!0,{isUpdate:!0,record:t,tenantId:n(r),packType:"custom",showFooter:!1})}return(t,g)=>{const x=ot("a-button");return C(),nt(it,null,[m(n(rt),at(t.$attrs,{onRegister:n(V),title:j,onOk:K,width:"800px",showCancelBtn:!1,showOkBtn:!1}),{default:u(()=>[m(n(kt),{onRegister:n(p),rowSelection:n(D)},{tableTitle:u(()=>[w.value?(C(),R(x,{key:0,preIcon:"ant-design:plus-outlined",type:"primary",onClick:W,style:{"margin-right":"5px"}},{default:u(()=>[I("新增 ")]),_:1})):S("",!0),n(h).length>0?(C(),R(x,{key:1,preIcon:"ant-design:delete-outlined",type:"primary",onClick:Q,style:{"margin-right":"5px"}},{default:u(()=>[I("批量删除 ")]),_:1})):S("",!0)]),action:u(({record:_})=>[m(n(ht),{actions:L(_),dropDownActions:G(_)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"])]),_:1},16,["onRegister"]),m(mt,{onRegister:n(e),onSuccess:c},null,8,["onRegister"]),m(ft,{onRegister:n(d),onSuccess:c},null,8,["onRegister"])],64)}}}));export{ye as default};
