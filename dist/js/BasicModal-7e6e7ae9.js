var fe=Object.defineProperty,me=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var te=(e,t,a)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,B=(e,t)=>{for(var a in t||(t={}))ge.call(t,a)&&te(e,a,t[a]);if(ee)for(var a of ee(t))he.call(t,a)&&te(e,a,t[a]);return e},E=(e,t)=>me(e,pe(t));var V=(e,t,a)=>new Promise((f,n)=>{var i=u=>{try{c(a.next(u))}catch(m){n(m)}},o=u=>{try{c(a.throw(u))}catch(m){n(m)}},c=u=>u.done?f(u.value):Promise.resolve(u.value).then(i,o);c((a=a.apply(e,t)).next())});import{u as r,s as X,d as N,H as ye,f as C,i as Ce,l as k,e as $,w as I,o as be,b as Se,n as P,V as g,x as ve,a7 as b,ac as M,aa as p,v as ke,a8 as L,aq as Fe,R as O,ak as He,F as ne,W as Y,af as z,E as J,ae as K,z as Be,g as $e,as as oe,ab as le,ai as ae,aj as se}from"./vue-ebecda47.js";import{M as Me,bk as Oe,cu as Te,cv as _e,co as we,cB as Pe,cC as Ne,o as G}from"./antd-vue-vendor-b75e8c06.js";import{B as ie,ar as De,_ as q,v as Re,a6 as We}from"./jeecg-online-vendor-cfb58502.js";import{v as je,a9 as Ee,c as Le,u as ze,x as qe,aa as Ae,m as ce,B as Ve}from"./index-85cfc899.js";import{useWindowSizeFn as Ie}from"./useWindowSizeFn-50bd5ea0.js";import"./lodash-es-vendor-cd7703c8.js";const{t:re}=ie(),Xe={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:re("common.cancelText")},okText:{type:String,default:re("common.okText")},closeFunc:Function},Q=Object.assign({},Xe,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number},enableComment:{type:Boolean,default:!1}});function Ye(e){const t=(n,i)=>getComputedStyle(n)[i],a=n=>{if(!n)return;n.setAttribute("data-drag",r(e.draggable));const i=n.querySelector(".ant-modal-header"),o=n.querySelector(".ant-modal");!i||!o||!r(e.draggable)||(i.style.cursor="move",i.onmousedown=c=>{if(!c)return;const u=c.clientX,m=c.clientY,l=document.body.clientWidth,d=document.documentElement.clientHeight,h=o.offsetWidth,y=o.offsetHeight,v=o.offsetLeft,S=l-o.offsetLeft-h,F=o.offsetTop;let H=d-o.offsetTop-y;H<0&&(H=d-o.offsetTop);const w=t(o,"left"),D=t(o,"top");let R=+w,W=+D;w.includes("%")?(R=+document.body.clientWidth*(+w.replace(/%/g,"")/100),W=+document.body.clientHeight*(+D.replace(/%/g,"")/100)):(R=+w.replace(/px/g,""),W=+D.replace(/px/g,"")),document.onmousemove=function(A){let T=A.clientX-u,_=A.clientY-m;-T>v?T=-v:T>S&&(T=S),-_>F?_=-F:_>H&&(_=H),o.style.cssText+=`;left:${T+R}px;top:${_+W}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},f=()=>{const n=document.querySelectorAll(".ant-modal-wrap");for(const i of Array.from(n)){if(!i)continue;const o=t(i,"display"),c=i.getAttribute("data-drag");o!=="none"&&(c===null||r(e.destroyOnClose))&&a(i)}};X(()=>{!r(e.visible)||!r(e.draggable)||je(()=>{f()},30)})}function Ue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ce(e)}const Ge=N({name:"Modal",inheritAttrs:!1,props:Q,emits:["cancel"],setup(e,{slots:t,emit:a}){const{visible:f,draggable:n,destroyOnClose:i}=ye(e),o=De();Ye({visible:f,destroyOnClose:i,draggable:n});const c=u=>{a("cancel",u)};return()=>{let u;const m=E(B(B({},r(o)),e),{onCancel:c});return C(Me,m,Ue(u=Ee(t))?u:{default:()=>[u]})}}}),ue=Symbol();function Je(e){return Le(e,ue)}function vt(){return ze(ue)}const Ke={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},Qe=N({name:"ModalWrapper",components:{ScrollContainer:qe},inheritAttrs:!1,props:Ke,emits:["height-change","ext-height"],setup(e,{emit:t}){const a=k(null),f=k(null),n=k(0),i=k(0);let o=0,c=()=>{};Ie(l.bind(null,!1)),Ae(f,()=>{l()},{attributes:!0,subtree:!0}),Je({redoModalHeight:l});const u=$(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${r(n)}px`}));X(()=>{e.useWrapper&&l()}),I(()=>e.fullScreen,d=>{l(),d?i.value=n.value:n.value=i.value}),be(()=>{const{modalHeaderHeight:d,modalFooterHeight:h}=e;t("ext-height",d+h)}),Se(()=>{c&&c()});function m(){return V(this,null,function*(){P(()=>{var h;const d=r(a);d&&((h=d==null?void 0:d.scrollTo)==null||h.call(d,0))})})}function l(){return V(this,null,function*(){if(!e.visible)return;const d=r(a);if(!d)return;const h=d.$el.parentElement;if(h){h.style.padding="0",yield P();try{const y=h.parentElement&&h.parentElement.parentElement;if(!y)return;const v=getComputedStyle(y).top,S=Number.parseInt(v);let F=window.innerHeight-S*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;S<40&&(F-=26),yield P();const H=r(f);if(!H)return;yield P(),o=H.scrollHeight,e.fullScreen?n.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:n.value=e.height?e.height:o>F?F:o,t("height-change",r(n))}catch(y){}}})}return{wrapperRef:a,spinRef:f,spinStyle:u,scrollTop:m,setModalHeight:l}}}),Ze=["loading-tip"];function xe(e,t,a,f,n,i){const o=g("ScrollContainer"),c=ve("loading");return b(),M(o,{ref:"wrapperRef"},{default:p(()=>[ke((b(),L("div",{ref:"spinRef",style:Fe(e.spinStyle),"loading-tip":e.loadingTip},[O(e.$slots,"default")],12,Ze)),[[c,e.loading]])]),_:3},512)}const et=q(Qe,[["render",xe]]),tt=N({name:"ModalClose",components:{Tooltip:Oe,FullscreenExitOutlined:Te,FullscreenOutlined:_e,CloseOutlined:we,LeftSquareOutlined:Pe,RightSquareOutlined:Ne},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean},enableComment:{type:Boolean,default:!1},commentSpan:{type:Number,default:0}},emits:["cancel","fullscreen","comment"],setup(e,{emit:t}){const{prefixCls:a}=ce("basic-modal-close"),{t:f}=ie(),n=$(()=>[a,`${a}--custom`,{[`${a}--can-full`]:e.canFullscreen||e.enableComment}]);function i(l){t("cancel",l)}function o(l){l==null||l.stopPropagation(),l==null||l.preventDefault(),(e.commentSpan==0||e.enableComment==!1)&&t("fullscreen")}function c(l){l==null||l.stopPropagation(),l==null||l.preventDefault(),e.fullScreen==!1&&t("fullscreen"),t("comment",!0)}function u(l){l==null||l.stopPropagation(),l==null||l.preventDefault(),t("comment",!1)}const m=$(()=>e.enableComment===!0?!1:e.canFullscreen);return{t:f,getClass:n,prefixCls:a,handleCancel:i,handleFullScreen:o,handleOpenComment:c,handleCloseComment:u,fullScreenStatus:m}}});function nt(e,t,a,f,n,i){const o=g("FullscreenExitOutlined"),c=g("Tooltip"),u=g("FullscreenOutlined"),m=g("RightSquareOutlined"),l=g("LeftSquareOutlined"),d=g("CloseOutlined");return b(),L("div",{class:He(e.getClass)},[e.fullScreenStatus?(b(),L(ne,{key:0},[e.fullScreen?(b(),M(c,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:p(()=>[C(o,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(b(),M(c,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:p(()=>[C(u,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):Y("",!0),e.enableComment?(b(),L(ne,{key:1},[e.commentSpan>0?(b(),M(c,{key:0,title:"收起",placement:"bottom"},{default:p(()=>[C(m,{onClick:e.handleCloseComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1})):(b(),M(c,{key:1,title:"展开",placement:"bottom"},{default:p(()=>[C(l,{onClick:e.handleOpenComment,style:{"font-size":"16px"}},null,8,["onClick"])]),_:1}))],64)):Y("",!0),C(c,{title:e.t("component.modal.close"),placement:"bottom"},{default:p(()=>[C(d,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}const ot=q(tt,[["render",nt]]),lt=N({name:"BasicModalFooter",props:Q,emits:["ok","cancel"],setup(e,{emit:t}){function a(n){t("ok",n)}function f(n){t("cancel",n)}return{handleOk:a,handleCancel:f}}});function at(e,t,a,f,n,i){const o=g("a-button");return b(),L("div",null,[O(e.$slots,"insertFooter"),e.showCancelBtn?(b(),M(o,z({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:p(()=>[J(K(e.cancelText),1)]),_:1},16,["onClick"])):Y("",!0),O(e.$slots,"centerFooter"),e.showOkBtn?(b(),M(o,z({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:p(()=>[J(K(e.okText),1)]),_:1},16,["type","onClick","loading"])):Y("",!0),O(e.$slots,"appendFooter")])}const st=q(lt,[["render",at]]),rt=N({name:"BasicModalHeader",components:{BasicTitle:Ve},emits:["dblclick"],props:{helpMessage:{type:[String,Array]},title:{type:String}}});function it(e,t,a,f,n,i){const o=g("BasicTitle");return b(),M(o,{helpMessage:e.helpMessage},{default:p(()=>[J(K(e.title),1)]),_:1},8,["helpMessage"])}const ct=q(rt,[["render",it]]);function ut(e){const t=k(!1),a=$(()=>{const n=r(e.wrapClassName)||"";return r(t)?`fullscreen-modal ${n} `:r(n)});function f(n){n&&n.stopPropagation(),t.value=!r(t)}return{getWrapClassName:a,handleFullScreen:f,fullScreenRef:t}}const dt=N({name:"BasicModal",components:{Modal:Ge,ModalWrapper:et,ModalClose:ot,ModalFooter:st,ModalHeader:ct},inheritAttrs:!1,props:Q,emits:["visible-change","height-change","cancel","ok","register","update:visible","fullScreen"],setup(e,{emit:t,attrs:a,slots:f}){const n=k(!1),i=k(null),o=k(null),{prefixCls:c}=ce("basic-modal"),u=k(0),m={setModalProps:R,emitVisible:void 0,redoModalHeight:()=>{P(()=>{r(o)&&r(o).setModalHeight()})}},l=$e();l&&t("register",m,l.uid);const d=$(()=>B(B({},e),r(i))),h=$(()=>!r(d).title&&!f.title),{handleFullScreen:y,getWrapClassName:v,fullScreenRef:S}=ut({modalWrapperRef:o,extHeightRef:u,wrapClassName:Be(d.value,"wrapClassName")}),F=$(()=>{const s=E(B({},r(d)),{visible:r(n),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return E(B({},s),{wrapClassName:r(v)})}),H=$(()=>{const s=E(B(B({},a),r(d)),{visible:r(n),wrapClassName:r(v)});return r(S)?G(s,["height","title"]):G(s,"title")}),w=$(()=>{if(!r(S))return r(F).height});X(()=>{S.value=!!e.defaultFullscreen}),X(()=>{n.value=!!e.visible}),I(()=>r(n),s=>{var j;t("visible-change",s),t("update:visible",s),l&&((j=m.emitVisible)==null||j.call(m,s,l.uid)),P(()=>{e.scrollTop&&s&&r(o)&&r(o).scrollTop()})},{immediate:!1});function D(s){return V(this,null,function*(){var j,x;if(s==null||s.stopPropagation(),!((x=(j=s.target)==null?void 0:j.classList)!=null&&x.contains(c+"-close--custom"))){if(e.closeFunc&&Re(e.closeFunc)){const de=yield e.closeFunc();n.value=!de;return}n.value=!1,t("cancel",s)}})}function R(s){i.value=We(r(i)||{},s),Reflect.has(s,"visible")&&(n.value=!!s.visible),Reflect.has(s,"defaultFullscreen")&&(S.value=!!s.defaultFullscreen)}function W(s){t("ok",s)}function A(s){t("height-change",s)}function T(s){u.value=s}function _(s){e.canFullscreen&&(s.stopPropagation(),y(s))}const U=k(0);I(()=>e.enableComment,s=>{Z(s)},{immediate:!0});function Z(s){s===!0?U.value=6:U.value=0}return I(S,s=>{t("fullScreen",s)}),{handleCancel:D,getBindValue:H,getProps:F,handleFullScreen:y,fullScreenRef:S,getMergeProps:d,handleOk:W,visibleRef:n,omit:G,modalWrapperRef:o,handleExtHeight:T,handleHeightChange:A,handleTitleDbClick:_,getWrapperHeight:w,commentSpan:U,handleComment:Z,isNoTitle:h}}});function ft(e,t,a,f,n,i){const o=g("ModalClose"),c=g("ModalHeader"),u=g("ModalFooter"),m=g("ModalWrapper"),l=g("a-col"),d=g("a-row"),h=g("Modal");return b(),M(h,z(e.getBindValue,{onCancel:e.handleCancel}),oe({default:p(()=>[C(d,{class:"jeecg-modal-wrapper"},{default:p(()=>[C(l,{span:24-e.commentSpan,class:"jeecg-modal-content"},{default:p(()=>[C(m,z({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:p(()=>[O(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:3},8,["span"]),C(l,{span:e.commentSpan,class:"jeecg-comment-outer"},{default:p(()=>[O(e.$slots,"comment")]),_:3},8,["span"])]),_:3})]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:p(()=>[C(o,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,commentSpan:e.commentSpan,enableComment:e.getProps.enableComment,onComment:e.handleComment,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","commentSpan","enableComment","onComment","onCancel","onFullscreen"])]),key:"0"},e.isNoTitle?void 0:{name:"title",fn:p(()=>[C(c,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]),key:"1"},e.$slots.footer?void 0:{name:"footer",fn:p(()=>[C(u,z(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),oe({_:2},[le(Object.keys(e.$slots),y=>({name:y,fn:p(v=>[O(e.$slots,y,ae(se(v||{})))])}))]),1040,["onOk","onCancel"])]),key:"2"},le(Object.keys(e.omit(e.$slots,"default")),y=>({name:y,fn:p(v=>[O(e.$slots,y,ae(se(v||{})))])}))]),1040,["onCancel"])}const mt=q(dt,[["render",ft]]),kt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));export{mt as B,kt as a,vt as u};
