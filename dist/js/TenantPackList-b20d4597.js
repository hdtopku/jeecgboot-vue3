var J=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var P=(a,o,e)=>o in a?J(a,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[o]=e,A=(a,o)=>{for(var e in o||(o={}))Z.call(o,e)&&P(a,e,o[e]);if(M)for(var e of M(o))tt.call(o,e)&&P(a,e,o[e]);return a},v=(a,o)=>X(a,Y(o));var s=(a,o,e)=>new Promise((l,d)=>{var k=i=>{try{f(e.next(i))}catch(p){d(p)}},r=i=>{try{f(e.throw(i))}catch(p){d(p)}},f=i=>i.done?l(i.value):Promise.resolve(i.value).then(k,r);f((e=e.apply(a,o)).next())});import{d as O,l as T,r as et,V as ot,a7 as C,a8 as nt,f as m,aa as u,u as n,ac as R,E as I,W as S,af as at,F as it}from"./vue-ebecda47.js";import{B as rt}from"./index-e91e8b28.js";import{p as st,d as lt}from"./tenant.data-d59cff77.js";import{p as pt,k as B}from"./tenant.api-82c12bef.js";import{useListPage as ct}from"./useListPage-52971497.js";import"./index-993283cc.js";import mt from"./TenantPackMenuModal-5a463c15.js";import{M as ut}from"./antd-vue-vendor-b75e8c06.js";import{C as dt}from"./jeecg-online-vendor-cfb58502.js";import ft from"./TenantPackUserModal-14870acb.js";import{F,E as gt}from"./index-85cfc899.js";import kt from"./BasicTable-46b6c894.js";import{Q as ht}from"./componentMap-c36c4b8d.js";import"./BasicModal-7e6e7ae9.js";import"./useWindowSizeFn-50bd5ea0.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-cd7703c8.js";import"./vxe-table-vendor-4aae63bf.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./renderUtils-e0ecd00e.js";import"./index-be9b0972.js";import"./index-1c3e0ea1.js";import"./validator-fb5fa821.js";import"./user.api-729c8827.js";import"./index-a2e0ccba.js";import"./useForm-21b78d9f.js";import"./JAddInput-64f6e84f.js";import"./areaDataUtil-4a5c6609.js";import"./useFormItem-ba20c4de.js";import"./JSelectUser-94adcf4d.js";import"./props-c57324f9.js";import"./JSelectBiz-4fc2f082.js";import"./index-097af6f9.js";import"./bem-311698ef.js";import"./props-13a58630.js";import"./useContextMenu-eb481e60.js";import"./depart.api-1888bf18.js";import"./JSelectDept-394df716.js";import"./JPopup-f9a8bda3.js";import"./JEllipsis-410bb5e8.js";import"./download-c9e5f3f7.js";import"./base64Conver-fa2fe1af.js";import"./index-96e99de8.js";import"./index-118a05d7.js";import"./useCountdown-00a25cd7.js";import"./useFormItemSingle-36e25e6f.js";import"./cron-parser-vendor-afad4b1e.js";import"./JUpload-ffe34816.js";import"./index-ae3841ab.js";import"./index-ab54dd3c.js";import"./injectionKey-69710956.js";import"./TenantUserSelectModal-7e191b46.js";const wt=O({name:"tenant-pack-modal"}),ye=O(v(A({},wt),{emits:["register","success"],setup(a,{emit:o}){const[e,{openModal:l}]=F(),[d,{openModal:k}]=F(),r=T(0),{prefixCls:f,tableContext:i}=ct({designScope:"tenant-template",tableProps:{api:pt,columns:st,immediate:!1,formConfig:{schemas:lt,labelCol:{xxl:8},actionColOptions:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8}},beforeFetch:t=>Object.assign(t,{tenantId:n(r),packType:"custom"})}}),[p,{reload:U},{rowSelection:D,selectedRowKeys:h,selectedRows:E}]=i,w=T(!1),[V,{setModalProps:Ct,closeModal:N}]=gt(t=>s(this,null,function*(){r.value=t.tenantId,w.value=t.showPackAddAndEdit,c()})),j="租户产品包列表";function K(t){return s(this,null,function*(){N()})}function L(t){return[{label:"用户",onClick:z.bind(null,t)},{label:"编辑",onClick:$.bind(null,t),ifShow:()=>w.value}]}function c(){(h.value=[])&&U()}function $(t){return s(this,null,function*(){l(!0,{isUpdate:!0,record:t,tenantId:n(r),packType:"custom",showFooter:!0})})}const y=et(["superAdmin","accountAdmin","appAdmin"]),{createMessage:b}=dt();function Q(t){return s(this,null,function*(){if(y.indexOf(t.packCode)!=-1){b.warning("默认系统产品包不允许删除");return}yield B({ids:t.id},c)})}function W(){return s(this,null,function*(){let t=E.value;if(t&&t.length>0){for(let g=0;g<t.length;g++)if(y.indexOf(t[g].packCode)!=-1){b.warning("默认系统产品包不允许删除");return}}ut.confirm({title:"删除租户产品包",content:"是否删除租户产品包",okText:"确认",cancelText:"取消",onOk:()=>s(this,null,function*(){yield B({ids:h.value.join(",")},c)})})})}function q(){l(!0,{isUpdate:!1,tenantId:n(r),packType:"custom",showFooter:!0})}function z(t){k(!0,{record:t})}function G(t){return[{label:"详情",onClick:H.bind(null,t)},{label:"删除",popConfirm:{title:"是否确认删除租户产品包",confirm:Q.bind(null,t)}}]}function H(t){l(!0,{isUpdate:!0,record:t,tenantId:n(r),packType:"custom",showFooter:!1})}return(t,g)=>{const x=ot("a-button");return C(),nt(it,null,[m(n(rt),at(t.$attrs,{onRegister:n(V),title:j,onOk:K,width:"800px",showCancelBtn:!1,showOkBtn:!1}),{default:u(()=>[m(n(kt),{onRegister:n(p),rowSelection:n(D)},{tableTitle:u(()=>[w.value?(C(),R(x,{key:0,preIcon:"ant-design:plus-outlined",type:"primary",onClick:q,style:{"margin-right":"5px"}},{default:u(()=>[I("新增 ")]),_:1})):S("",!0),n(h).length>0?(C(),R(x,{key:1,preIcon:"ant-design:delete-outlined",type:"primary",onClick:W,style:{"margin-right":"5px"}},{default:u(()=>[I("批量删除 ")]),_:1})):S("",!0)]),action:u(({record:_})=>[m(n(ht),{actions:L(_),dropDownActions:G(_)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"])]),_:1},16,["onRegister"]),m(mt,{onRegister:n(e),onSuccess:c},null,8,["onRegister"]),m(ft,{onRegister:n(d),onSuccess:c},null,8,["onRegister"])],64)}}}));export{ye as default};
