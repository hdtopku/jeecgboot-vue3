var k=(f,C,d)=>new Promise((p,i)=>{var _=n=>{try{s(d.next(n))}catch(c){i(c)}},v=n=>{try{s(d.throw(n))}catch(c){i(c)}},s=n=>n.done?p(n.value):Promise.resolve(n.value).then(_,v);s((d=d.apply(f,C)).next())});import{a as U,u as W,B as X}from"./index-1b5a8dbb.js";import{_ as z}from"./index-3ce15f67.js";import{P as G}from"./index-6916e394.js";import{_ as H}from"./RoleDataRuleDrawer.vue_vue_type_script_setup_true_lang-57932dbe.js";import{m as J,n as A,o as Y}from"./role.api-eaf37e05.js";import{d as Z,k as u,U as D,aV as F,ar as K,bi as t,E as l,f as o,u as a,ag as ee,V as te,aQ as oe,aX as ae,aW as le,at as B}from"./vue-c7e3516e.js";import{_ as se}from"./jeecg-online-vendor-12004772.js";import"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./bem-2be191b9.js";import"./lodash-es-vendor-42c8d3d4.js";import"./props-c3781b9d.js";import"./useContextMenu-1b1215cd.js";import"./codemirror-vendor-96aab763.js";import"./echarts-vendor-b30c7238.js";import"./html2canvas-vendor-654dcb8a.js";import"./vxe-table-vendor-8bace23a.js";const S=f=>(ae("data-v-ce6058ab"),f=f(),le(),f),ne=S(()=>B("div",{class:"line"},null,-1)),re=S(()=>B("div",{class:"line"},null,-1)),ue=Z({__name:"RolePermissionDrawer",emits:["register"],setup(f,{emit:C}){const d=u([]),p=u([]),i=u([]),_=u([]),v=u([]),s=u(""),n=u(null),c=u(!1),g=u([]),w=u(!0),[P,{openDrawer:T}]=U(),[b,{setDrawerProps:E,closeDrawer:R}]=W(e=>k(this,null,function*(){yield $(),E({confirmLoading:!1,loading:!0}),s.value=e.roleId;const r=yield J();d.value=r.treeList,p.value=r.ids,g.value=r.ids;const m=yield A({roleId:a(s)});i.value=m,_.value=m,E({loading:!1})}));function V(e){i.value=e.checked?e.checked:e}function N(e){e&&e.length>0&&(v.value=e),T(!0,{functionId:a(v)[0],roleId:a(s)})}function $(){d.value=[],p.value=[],i.value=[],_.value=[],v.value=[],s.value=""}function L(){const e=a(n);if(!e)throw new Error("tree is null!");return e}function I(e){return k(this,null,function*(){let r={roleId:a(s),permissionIds:a(L().getCheckedKeys()).join(","),lastpermissionIds:a(_).join(",")};if(c.value===!1&&(yield j(r)),e)R();else{const m=yield A({roleId:a(s)});_.value=m}})}function j(e){return k(this,null,function*(){c.value=!0,yield Y(e),setTimeout(()=>{c.value=!1},500)})}function q({key:e}){e==="checkAll"?i.value=p.value:e==="cancelCheck"?i.value=[]:e==="openAll"?g.value=p.value:e==="closeAll"?g.value=[]:e==="relation"?w.value=!1:w.value=!0}return(e,r)=>{const m=D("Icon"),y=D("a-menu-item"),M=D("a-menu"),O=D("a-dropdown"),x=D("a-button");return F(),K(a(X),oe(e.$attrs,{onRegister:a(b),width:"650px",destroyOnClose:"",showFooter:""}),{title:t(()=>[l(" \u89D2\u8272\u6743\u9650\u914D\u7F6E "),o(O,null,{overlay:t(()=>[o(M,{onClick:q},{default:t(()=>[o(y,{key:"checkAll"},{default:t(()=>[l("\u9009\u62E9\u5168\u90E8")]),_:1}),o(y,{key:"cancelCheck"},{default:t(()=>[l("\u53D6\u6D88\u9009\u62E9")]),_:1}),ne,o(y,{key:"openAll"},{default:t(()=>[l("\u5C55\u5F00\u5168\u90E8")]),_:1}),o(y,{key:"closeAll"},{default:t(()=>[l("\u6298\u53E0\u5168\u90E8")]),_:1}),re,o(y,{key:"relation"},{default:t(()=>[l("\u5C42\u7EA7\u5173\u8054")]),_:1}),o(y,{key:"standAlone"},{default:t(()=>[l("\u5C42\u7EA7\u72EC\u7ACB")]),_:1})]),_:1})]),default:t(()=>[o(m,{icon:"ant-design:more-outlined",class:"more-icon"})]),_:1})]),footer:t(()=>[o(a(G),{title:"\u786E\u5B9A\u653E\u5F03\u7F16\u8F91\uFF1F",onConfirm:a(R),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[l("\u53D6\u6D88")]),_:1},8,["onConfirm"]),o(x,{onClick:r[0]||(r[0]=h=>I(!1)),type:"primary",loading:c.value,ghost:"",style:{"margin-right":"0.8rem"}},{default:t(()=>[l("\u4EC5\u4FDD\u5B58")]),_:1},8,["loading"]),o(x,{onClick:r[1]||(r[1]=h=>I(!0)),type:"primary",loading:c.value},{default:t(()=>[l("\u4FDD\u5B58\u5E76\u5173\u95ED")]),_:1},8,["loading"])]),default:t(()=>[o(a(z),{ref_key:"treeRef",ref:n,checkable:"",treeData:d.value,checkedKeys:i.value,expandedKeys:g.value,selectedKeys:v.value,checkStrictly:w.value,clickRowToExpand:!1,title:"\u6240\u62E5\u6709\u7684\u7684\u6743\u9650",onCheck:V,onSelect:N},{title:t(({slotTitle:h,ruleFlag:Q})=>[l(ee(h)+" ",1),Q?(F(),K(m,{key:0,icon:"ant-design:align-left-outlined",style:{"margin-left":"5px",color:"red"}})):te("",!0)]),_:1},8,["treeData","checkedKeys","expandedKeys","selectedKeys","checkStrictly"]),o(H,{onRegister:a(P)},null,8,["onRegister"])]),_:1},16,["onRegister"])}}});const xe=se(ue,[["__scopeId","data-v-ce6058ab"]]);export{xe as default};
