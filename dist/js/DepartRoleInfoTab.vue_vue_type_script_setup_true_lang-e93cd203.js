var G=Object.defineProperty,H=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var y=(n,o,e)=>o in n?G(n,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[o]=e,v=(n,o)=>{for(var e in o||(o={}))X.call(o,e)&&y(n,e,o[e]);if(x)for(var e of x(o))Y.call(o,e)&&y(n,e,o[e]);return n},k=(n,o)=>H(n,J(o));var w=(n,o,e)=>new Promise((u,m)=>{var _=l=>{try{r(e.next(l))}catch(c){m(c)}},g=l=>{try{r(e.throw(l))}catch(c){m(c)}},r=l=>l.done?u(l.value):Promise.resolve(l.value).then(_,g);r((e=e.apply(n,o)).next())});import Z from"./BasicTable-fd5e1142.js";import{Q as ee}from"./componentMap-a7b11ac1.js";import"./useTable-364925fb.js";import"./index-d3bb5676.js";import{a as te}from"./index-b7f47a95.js";import{useListPage as oe}from"./useListPage-5b8be68e.js";import{_ as ne}from"./DepartRoleModal.vue_vue_type_script_setup_true_lang-a8b23e66.js";import{_ as ae}from"./DepartRoleAuthDrawer.vue_vue_type_script_setup_true_lang-71ba39ad.js";import{f as re,g as le}from"./depart.user.api-cfc5903c.js";import{d as se,a as ie}from"./depart.user.data-7fd0ad05.js";import{z as ce}from"./index-679980cc.js";import{d as de,c as pe,e as ue,w as me,o as fe,U as d,a5 as M,a6 as S,f as a,a7 as s,E as _e,u as i,F as A,V as ge,aa as F}from"./vue-249e5fad.js";const be=F("span",null,"删除",-1),we=F("span",null,"批量操作 ",-1),Pe=de({__name:"DepartRoleInfoTab",props:{data:{require:!0,type:Object}},emits:["register"],setup(n){const o=n;pe("prefixCls");const e=ue(()=>{var t;return(t=o.data)==null?void 0:t.id}),u={xs:24,sm:24,md:24,lg:12,xl:12,xxl:8},{tableContext:m,createMessage:_}=oe({tableProps:{api:re,columns:se,canResize:!1,formConfig:{labelWidth:100,schemas:ie,baseColProps:u,labelAlign:"left",labelCol:{xs:24,sm:24,md:24,lg:9,xl:7,xxl:6},wrapperCol:{},actionColOptions:k(v({},u),{style:{textAlign:"left"}})},beforeFetch(t){t.deptId=e.value}}}),[g,{reload:r,setProps:l,setLoading:c,updateTableDataRecord:I},{rowSelection:P,selectedRowKeys:b}]=m,[T,R]=ce(),[B,V]=te();me(()=>o.data,()=>r()),fe(()=>{r()});function j(){b.value=[]}function N(){R.openModal(!0,{isUpdate:!1,record:{}})}function L(t){R.openModal(!0,{isUpdate:!0,record:t})}function U(t){V.openDrawer(!0,{record:t})}function C(t,p){return w(this,null,function*(){if(!e.value)_.warning("请先选择一个部门");else{c(!0);let f=i(t).join(",");try{return yield le({ids:f},p),r()}finally{c(!1)}}return Promise.reject()})}function z(){return w(this,null,function*(){try{yield C(b,!0),j()}catch(t){}})}function E({isUpdate:t,values:p}){t?I(p.id,p):r()}function K(t){return[{label:"编辑",onClick:L.bind(null,t)}]}function O(t){return[{label:"授权",onClick:U.bind(null,t)},{label:"删除",color:"error",popConfirm:{title:"确认要删除吗？",confirm:C.bind(null,[t.id],!1)}}]}return(t,p)=>{const f=d("a-button"),$=d("a-divider"),h=d("icon"),q=d("a-menu-item"),Q=d("a-menu"),W=d("a-dropdown");return M(),S(A,null,[a(i(Z),{onRegister:i(g),rowSelection:i(P)},{tableTitle:s(()=>[a(f,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:N},{default:s(()=>[_e("添加部门角色")]),_:1}),i(b).length>0?(M(),S(A,{key:0},[a($,{type:"vertical"}),a(W,null,{overlay:s(()=>[a(Q,null,{default:s(()=>[a(q,{key:"1",onClick:z},{default:s(()=>[a(h,{icon:"ant-design:delete-outlined"}),be]),_:1})]),_:1})]),default:s(()=>[a(f,null,{default:s(()=>[we,a(h,{icon:"akar-icons:chevron-down"})]),_:1})]),_:1})],64)):ge("",!0)]),action:s(({record:D})=>[a(i(ee),{actions:K(D),dropDownActions:O(D)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),a(ne,{departId:e.value,onRegister:i(T),onSuccess:E},null,8,["departId","onRegister"]),a(ae,{onRegister:i(B)},null,8,["onRegister"])],64)}}});export{Pe as _};
