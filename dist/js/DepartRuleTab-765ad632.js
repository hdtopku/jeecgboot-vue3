var m=(D,x,d)=>new Promise((i,u)=>{var l=n=>{try{c(d.next(n))}catch(o){u(o)}},y=n=>{try{c(d.throw(n))}catch(o){u(o)}},c=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,y);c((d=d.apply(D,x)).next())});import{a as U}from"./index-fb25354c.js";import{_ as G}from"./index-d4783a30.js";import{_ as H}from"./DepartDataRuleDrawer.vue_vue_type_script_setup_true_lang-1990e64b.js";import{c as J,e as M,f as Q}from"./depart.api-25dc3d39.js";import{l as W}from"./index-fde9c72f.js";import{d as X,e as Y,k as r,w as Z,n as C,U as p,aV as g,as as ee,f as t,bi as a,ar as h,u as E,at as K,ag as te,V as ae,ad as ne,E as f,F as oe}from"./vue-c7e3516e.js";import{_ as se}from"./jeecg-online-vendor-bf2efbcb.js";import"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./bem-deccd0b6.js";import"./lodash-es-vendor-42c8d3d4.js";import"./props-c3781b9d.js";import"./useContextMenu-c0be0b5c.js";import"./codemirror-vendor-96aab763.js";import"./echarts-vendor-b30c7238.js";import"./html2canvas-vendor-654dcb8a.js";import"./vxe-table-vendor-8bace23a.js";const le={class:"j-box-bottom-button offset-20",style:{"margin-top":"30px"}},ue=X({__name:"DepartRuleTab",props:{data:{type:Object,default:()=>({})}},setup(D){const x=D,{prefixCls:d}=W("j-depart-form-content"),i=Y(()=>{var e;return(e=x.data)==null?void 0:e.id}),u=r(),l=r(!1),y=r([]),c=r([]),n=r([]),o=r([]),I=r([]),j=r(!0),[A,S]=U();F(),Z(i,()=>R(),{immediate:!0});function F(){return m(this,null,function*(){try{l.value=!0;let{treeList:e}=yield J();y.value=e,yield C(),b(!0)}finally{l.value=!1}})}function R(){return m(this,null,function*(){if(i.value)try{l.value=!0;let e=yield M({departId:i.value});o.value=e,I.value=[...e]}finally{l.value=!1}})}function V(){return m(this,null,function*(){try{l.value=!0,yield Q({departId:i.value,permissionIds:o.value.join(","),lastpermissionIds:I.value.join(",")}),yield F(),yield R()}finally{l.value=!1}})}function B(e){Array.isArray(e)?o.value=e:o.value=e.checked}function L(e){c.value=e}function N(e,{selectedNodes:s}){var _;if((_=s[0])!=null&&_.ruleFlag){let w=e[0];S.openDrawer(!0,{departId:i,functionId:w})}n.value=[]}function b(e){return m(this,null,function*(){u.value.expandAll(e),yield C(),c.value=u.value.getExpandedKeys()})}function T(e){return m(this,null,function*(){u.value.checkAll(e),yield C(),o.value=u.value.getCheckedKeys()})}return(e,s)=>{const _=p("Icon"),w=p("a-empty"),k=p("a-menu-item"),P=p("a-menu"),$=p("a-button"),q=p("a-dropdown"),z=p("a-spin");return g(),ee(oe,null,[t(z,{spinning:l.value},{default:a(()=>[y.value.length>0?(g(),h(E(G),{key:0,ref_key:"basicTree",ref:u,class:"depart-rule-tree",checkable:"",treeData:y.value,checkedKeys:o.value,selectedKeys:n.value,expandedKeys:c.value,checkStrictly:j.value,style:{height:"500px",overflow:"auto"},onCheck:B,onExpand:L,onSelect:N},{title:a(({slotTitle:v,ruleFlag:O})=>[K("span",null,te(v),1),O?(g(),h(_,{key:0,icon:"ant-design:align-left-outlined",style:{"margin-left":"5px",color:"red"}})):ae("",!0)]),_:1},8,["treeData","checkedKeys","selectedKeys","expandedKeys","checkStrictly"])):(g(),h(w,{key:1,description:"\u65E0\u53EF\u914D\u7F6E\u90E8\u95E8\u6743\u9650"})),K("div",le,[K("div",{class:ne(["j-box-bottom-button-float",[`${E(d)}`]])},[t(q,{trigger:["click"],placement:"top"},{overlay:a(()=>[t(P,null,{default:a(()=>[t(k,{key:"3",onClick:s[0]||(s[0]=v=>T(!0))},{default:a(()=>[f("\u5168\u90E8\u52FE\u9009")]),_:1}),t(k,{key:"4",onClick:s[1]||(s[1]=v=>T(!1))},{default:a(()=>[f("\u53D6\u6D88\u5168\u9009")]),_:1}),t(k,{key:"5",onClick:s[2]||(s[2]=v=>b(!0))},{default:a(()=>[f("\u5C55\u5F00\u6240\u6709")]),_:1}),t(k,{key:"6",onClick:s[3]||(s[3]=v=>b(!1))},{default:a(()=>[f("\u6536\u8D77\u6240\u6709")]),_:1})]),_:1})]),default:a(()=>[t($,{style:{float:"left"}},{default:a(()=>[f(" \u6811\u64CD\u4F5C "),t(_,{icon:"ant-design:up-outlined"})]),_:1})]),_:1}),t($,{type:"primary",preIcon:"ant-design:save-filled",onClick:V},{default:a(()=>[f("\u4FDD\u5B58")]),_:1})],2)])]),_:1},8,["spinning"]),t(H,{onRegister:E(A)},null,8,["onRegister"])],64)}}});const Ee=se(ue,[["__scopeId","data-v-92cad6be"]]);export{Ee as default};
