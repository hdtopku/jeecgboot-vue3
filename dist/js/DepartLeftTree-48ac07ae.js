var d=(r,_,c)=>new Promise((x,l)=>{var a=s=>{try{o(c.next(s))}catch(u){l(u)}},n=s=>{try{o(c.throw(s))}catch(u){l(u)}},o=s=>s.done?x(s.value):Promise.resolve(s.value).then(a,n);o((c=c.apply(r,_)).next())});import{d as j,c as E,l as i,V as y,a7 as v,ac as h,aa as w,f as C,a8 as P,W as V,F as N,n as K}from"./vue-50733b77.js";import{ap as D}from"./jeecg-online-vendor-d3e1865b.js";import{s as W}from"./depart.user.api-453a0c9a.js";const L=r=>D.get({url:"/sys/sysDepart/queryDepartTreeSync",params:r}),G=r=>D.get({url:"/sys/user/queryByOrgCodeForAddressList",params:r}),J=r=>D.get({url:"/sys/position/list",params:r}),z=j({__name:"DepartLeftTree",emits:["select","rootTreeData"],setup(r,{expose:_,emit:c}){const x=E("prefixCls"),l=i(!1),a=i([]),n=i([]),o=i([]),s=i(!1),u=i(null),S=i("");function m(){return d(this,null,function*(){try{l.value=!0,a.value=[];const e=yield L();Array.isArray(e)&&(a.value=e),n.value.length===0&&T()}finally{l.value=!1}})}m();function b(e){return d(this,null,function*(){try{const t=yield L({pid:e.dataRef.id});if(t.length==0)e.dataRef.isLeaf=!0;else if(e.dataRef.children=t,n.value.length>0){let p=[];for(let f of n.value)t.findIndex(g=>g.id===f)!==-1&&p.push(f);p.length>0&&(n.value=[...n.value])}a.value=[...a.value]}catch(t){}return Promise.resolve()})}function T(){let e=a.value[0];e&&(e.isLeaf||(n.value=[e.key]),q())}function q(){return d(this,null,function*(){yield K(),s.value=!0,yield K(),s.value=!1})}function k(e,t){o.value=[e],t&&(u.value=t,c("select",t))}function B(e){return d(this,null,function*(){if(e)try{l.value=!0,a.value=[];let t=yield W({keyWord:e});Array.isArray(t)&&(a.value=t),T()}finally{l.value=!1}else m();S.value=e})}function R(e,t){e.length>0&&o.value[0]!==e[0]?k(e[0],t.selectedNodes[0]):k(o.value[0])}return _({loadRootTreeData:m}),(e,t)=>{const p=y("a-input-search"),f=y("a-tree"),g=y("a-empty"),A=y("a-spin"),F=y("a-card");return v(),h(F,{bordered:!1,style:{height:"100%"}},{default:w(()=>[C(A,{spinning:l.value},{default:w(()=>[C(p,{placeholder:"按部门名称搜索…",style:{"margin-bottom":"10px"},onSearch:B,allowClear:""}),a.value.length>0?(v(),P(N,{key:0},[s.value?V("",!0):(v(),h(f,{key:0,showLine:"",clickRowToExpand:!1,treeData:a.value,selectedKeys:o.value,"load-data":b,expandedKeys:n.value,"onUpdate:expandedKeys":t[0]||(t[0]=O=>n.value=O),onSelect:R},null,8,["treeData","selectedKeys","expandedKeys"]))],64)):(v(),h(g,{key:1,description:"暂无数据"}))]),_:1},8,["spinning"])]),_:1})}}}),Q=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));export{Q as D,z as _,G as l,J as p};
