import{d as M,l,e as N,w as S,V as y,a7 as v,a8 as I,ac as E,F as V,ad as q,f as k,aa as K,E as C}from"./vue-86253b15.js";import{q as F,bB as T}from"./jeecg-online-vendor-bc5d810e.js";import{u as z}from"./auth.data-8be5c9e3-960125c8.js";import{D as A,A as J,L as O}from"./auth.api-d3a6c4b3-91d6782c.js";import"./antd-vue-vendor-371529c2.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-04a44d0a.js";import"./vxe-table-vendor-6a8d95c4.js";var g=(e,u,a)=>new Promise((f,i)=>{var m=t=>{try{r(a.next(t))}catch(s){i(s)}},o=t=>{try{r(a.throw(t))}catch(s){i(s)}},r=t=>t.done?f(t.value):Promise.resolve(t.value).then(m,o);r((a=a.apply(e,u)).next())});const R=M({name:"AuthButtonTree",props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:u}=F(),a=l(""),f=l(2),i=l(!0),m=l([]),o=l([]),r=l([]),t=l(""),s=N(()=>!a.value);S(()=>e.cgformId,h,{immediate:!0});function h(){return g(this,null,function*(){if(!e.cgformId)return;let n=yield A(e.cgformId,f.value);n.forEach(d=>{for(const p of z)if(d.code==p.code){d.title=p.title;break}});let c=[];for(let d of n){let p=P(d);c.push({key:d.id,title:p})}r.value=c})}function b(){h(),x(a.value,t.value)}function x(n,c){return g(this,null,function*(){a.value=n,t.value=c,o.value=[],yield h();let d=yield J({roleId:n,cgformId:e.cgformId,type:f.value,authMode:c});o.value=d.map(p=>p.authId)})}function D(){a.value="",h()}function B(){return g(this,null,function*(){yield O(a.value,e.cgformId,{authId:JSON.stringify(o.value),authMode:t.value}),u.success("保存成功")})}function P(n){let c=n.title+"-";return n.page==3?c+="列表可见":n.page==5&&(c+="表单可见"),c}function w(n){m.value=n,i.value=!1}function _(){a.value="",o.value=[]}return{loadChecked:x,clear:_,expandedKeys:m,autoExpandParent:i,checkedKeys:o,treeData:r,disabled:s,onSave:B,onExpand:w,onRefresh:b,clearChecked:D}}}),$={class:"onl-auth-tree-btns"};function L(e,u,a,f,i,m){const o=y("a-empty"),r=y("a-button"),t=y("a-tree");return v(),I("div",null,[e.disabled?(v(),E(o,{key:0,description:"请先选中左侧角色/部门/用户"})):e.treeData.length===0?(v(),E(o,{key:1,description:"无权限信息"})):(v(),I(V,{key:2},[q("div",$,[k(r,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:K(()=>[C("刷新")]),_:1},8,["onClick"]),k(r,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:K(()=>[C("保存")]),_:1},8,["onClick"])]),k(t,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":u[0]||(u[0]=s=>e.checkedKeys=s),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}const Z=T(R,[["render",L],["__scopeId","data-v-d165a23e"]]);export{Z as default};
