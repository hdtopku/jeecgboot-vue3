var h=(z,v,i)=>new Promise((r,p)=>{var u=n=>{try{c(i.next(n))}catch(d){p(d)}},t=n=>{try{c(i.throw(n))}catch(d){p(d)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(u,t);c((i=i.apply(z,v)).next())});import{u as A,C as V}from"./upload-1228aa25.js";import{g as Y,t as F,u as R}from"./jeecg-online-vendor-a80da268.js";import{h as j}from"./header-55b09394.js";import{m as H,z as O,g as $}from"./index-0f5326ee.js";import{c as P,d as q}from"./antd-vue-vendor-04f0af1d.js";import{a as G,g as J}from"./UserSetting.api-12a988ce.js";import{_ as K}from"./UserAccountModal.vue_vue_type_script_setup_true_lang-f2ef4d1c.js";import"./index-5effa088.js";import{d as L,k as y,e as Q,o as W,V as x,a5 as b,a6 as D,aa as e,f as m,u as f,ab as l,a7 as X,E as Z,am as ee,F as te}from"./vue-5a09445c.js";const se={class:"user-setting-top"},ae={class:"account-avatar"},oe={class:"account-right"},ne={key:0},ie={class:"font-size-17 account-name"},le={key:1},ce={class:"use-day"},re={class:"account-data"},ue={class:"account-detail"},de=e("div",{class:"font-size-15 font-bold font-color-gray",style:{"margin-bottom":"16px"}},"详细资料",-1),_e={class:"margin-bottom-10 font-size-13"},me=e("span",{class:"gray-75 item-label"},"生日",-1),pe={class:"gray-3"},fe={class:"margin-bottom-10 font-size-13"},ve=e("span",{class:"gray-75 item-label"},"性别",-1),ge={class:"gray-3"},he={class:"margin-bottom-10 nowarp font-size-13"},ye=e("span",{class:"gray-75 item-label"},"职位",-1),xe={class:"gray-3"},be=e("span",{class:"item-label"},null,-1),De={class:"account-info"},ze=e("div",{class:"font-size-15 font-bold font-color-gray",style:{"margin-bottom":"16px"}},"联系信息",-1),Ce={class:"margin-bottom-10 font-size-13"},Ie=e("span",{class:"gray-75 item-label"},"邮箱",-1),Te={class:"gray-3"},Me={class:"margin-bottom-10 font-size-13"},ke=e("span",{class:"gray-75 item-label"},"手机",-1),Be={class:"gray-3"},je=L({__name:"BaseSetting",setup(z){const v=Y("sex")||[{text:"男",value:"1"},{text:"女",value:"2"}],{createMessage:i}=R(),r=F(),{prefixCls:p}=H("j-base-setting-container"),u=y(!1),t=y({}),c=y(),[n,{openModal:d}]=O(),T=Q(()=>$(t.value.avatar)||j);function M(s,a){const o=r.getUserInfo;o.avatar=a,r.setUserInfo(o),a&&C({avatar:a,id:o.id})}function C(s){G(s).then(a=>{a.success||i.warn(a.message)})}function k(){u.value=!0,setTimeout(()=>{c.value.focus()},100)}function B(){t.value.realname?(C({realname:t.value.realname,id:t.value.id}),r.setUserInfo(t.value)):i.warn("请输入姓名"),u.value=!1}function U(s){return s?q(s).format("YYYY-MM-DD"):"未填写"}function w(s){let a=v.find(_=>parseInt(_.value)===s),o="未填写";return a&&(o=a.text),o}function E(){let s=P(t.value);d(!0,{record:s})}function I(){J().then(s=>h(this,null,function*(){s.success&&(s.result?(s.result.sexText=w(s.result.sex),s.result.birthday=U(s.result.birthday),s.result.createTimeText=S(s.result.createTime),t.value=s.result):t.value={})}))}function S(s){let a,o,_=Date.parse(s),g=new Date().getTime();return o=Math.abs(g-_),a=Math.floor(o/(1e3*3600*24)),a+" 天"}return W(()=>h(this,null,function*(){I()})),(s,a)=>{const o=x("Icon"),_=x("a-tooltip"),g=x("a-input");return b(),D(te,null,[e("div",{class:ee(["account-padding",[`${f(p)}`]])},[e("div",se,[e("div",ae,[m(f(V),{uploadApi:f(A),showBtn:!1,value:T.value,btnProps:{preIcon:"ant-design:cloud-upload-outlined"},onChange:M,width:"80"},null,8,["uploadApi","value"]),e("div",oe,[u.value?(b(),D("div",le,[m(g,{ref_key:"accountNameEdit",ref:c,maxlength:100,value:t.value.realname,"onUpdate:value":a[0]||(a[0]=N=>t.value.realname=N),onBlur:B},null,8,["value"])])):(b(),D("div",ne,[e("span",ie,l(t.value.realname),1),m(_,{content:"编辑姓名"},{default:X(()=>[m(o,{class:"pointer font-size-17 gray-bd account-icon",icon:"ant-design:edit-outlined",onClick:k})]),_:1})])),e("div",ce,[Z(" 使用："),e("span",null,l(t.value.createTimeText),1)])])])]),e("div",re,[e("div",ue,[de,e("div",_e,[me,e("span",pe,l(t.value.birthday),1)]),e("div",fe,[ve,e("span",ge,l(t.value.sexText),1)]),e("div",he,[ye,e("span",xe,l(t.value.postText?t.value.postText:"未填写"),1)]),e("div",{class:"font-size-13"},[be,e("span",{class:"item-label pointer",style:{color:"#1e88e5"},onClick:E},"编辑")])]),e("div",De,[ze,e("div",Ce,[Ie,e("span",Te,l(t.value.email?t.value.email:"未填写"),1)]),e("div",Me,[ke,e("span",Be,l(t.value.phone?t.value.phone:"未填写"),1)])])])],2),m(K,{onRegister:f(n),onSuccess:I},null,8,["onRegister"])],64)}}});export{je as _};
