var m=(x,b,d)=>new Promise((c,r)=>{var l=n=>{try{u(d.next(n))}catch(o){r(o)}},y=n=>{try{u(d.throw(n))}catch(o){r(o)}},u=n=>n.done?c(n.value):Promise.resolve(n.value).then(l,y);u((d=d.apply(x,b)).next())});import{a as W}from"./index-5044610b.js";import{_ as G}from"./index-8f3c0498.js";import{_ as H}from"./DepartDataRuleDrawer.vue_vue_type_script_setup_true_lang-bd0f3ee3.js";import{c as J,e as M,f as Q}from"./depart.api-71c168b0.js";import{m as U}from"./index-797f995b.js";import{d as X,e as Y,k as i,w as Z,n as C,V as p,a5 as g,a6 as ee,f as t,a7 as a,a9 as h,u as K,aa as I,ab as te,W as ae,am as ne,E as f,F as oe}from"./vue-5a09445c.js";import{D as se}from"./jeecg-online-vendor-a84f26e2.js";import"./antd-vue-vendor-04f0af1d.js";import"./tinymce-vendor-e2919cb0.js";import"./bem-05093d2d.js";import"./vxe-table-vendor-c5aaa9d2.js";import"./lodash-es-vendor-70833b4a.js";import"./props-17f0c5eb.js";import"./useContextMenu-3014907a.js";import"./codemirror-vendor-f458506d.js";import"./echarts-vendor-6c8e2159.js";const le={class:"j-box-bottom-button offset-20",style:{"margin-top":"30px"}},re=X({__name:"DepartRuleTab",props:{data:{type:Object,default:()=>({})}},setup(x){const b=x,{prefixCls:d}=U("j-depart-form-content"),c=Y(()=>{var e;return(e=b.data)==null?void 0:e.id}),r=i(),l=i(!1),y=i([]),u=i([]),n=i([]),o=i([]),R=i([]),S=i(!0),[E,V]=W();T(),Z(c,()=>$(),{immediate:!0});function T(){return m(this,null,function*(){try{l.value=!0;let{treeList:e}=yield J();y.value=e,yield C(),w(!0)}finally{l.value=!1}})}function $(){return m(this,null,function*(){if(c.value)try{l.value=!0;let e=yield M({departId:c.value});o.value=e,R.value=[...e]}finally{l.value=!1}})}function B(){return m(this,null,function*(){try{l.value=!0,yield Q({departId:c.value,permissionIds:o.value.join(","),lastpermissionIds:R.value.join(",")}),yield T(),yield $()}finally{l.value=!1}})}function L(e){Array.isArray(e)?o.value=e:o.value=e.checked}function N(e){u.value=e}function F(e,{selectedNodes:s}){var _;if((_=s[0])!=null&&_.ruleFlag){let D=e[0];V.openDrawer(!0,{departId:c,functionId:D})}n.value=[]}function w(e){return m(this,null,function*(){r.value.expandAll(e),yield C(),u.value=r.value.getExpandedKeys()})}function j(e){return m(this,null,function*(){r.value.checkAll(e),yield C(),o.value=r.value.getCheckedKeys()})}return(e,s)=>{const _=p("Icon"),D=p("a-empty"),k=p("a-menu-item"),P=p("a-menu"),A=p("a-button"),q=p("a-dropdown"),z=p("a-spin");return g(),ee(oe,null,[t(z,{spinning:l.value},{default:a(()=>[y.value.length>0?(g(),h(K(G),{key:0,ref_key:"basicTree",ref:r,class:"depart-rule-tree",checkable:"",treeData:y.value,checkedKeys:o.value,selectedKeys:n.value,expandedKeys:u.value,checkStrictly:S.value,style:{height:"500px",overflow:"auto"},onCheck:L,onExpand:N,onSelect:F},{title:a(({slotTitle:v,ruleFlag:O})=>[I("span",null,te(v),1),O?(g(),h(_,{key:0,icon:"ant-design:align-left-outlined",style:{"margin-left":"5px",color:"red"}})):ae("",!0)]),_:1},8,["treeData","checkedKeys","selectedKeys","expandedKeys","checkStrictly"])):(g(),h(D,{key:1,description:"无可配置部门权限"})),I("div",le,[I("div",{class:ne(["j-box-bottom-button-float",[`${K(d)}`]])},[t(q,{trigger:["click"],placement:"top"},{overlay:a(()=>[t(P,null,{default:a(()=>[t(k,{key:"3",onClick:s[0]||(s[0]=v=>j(!0))},{default:a(()=>[f("全部勾选")]),_:1}),t(k,{key:"4",onClick:s[1]||(s[1]=v=>j(!1))},{default:a(()=>[f("取消全选")]),_:1}),t(k,{key:"5",onClick:s[2]||(s[2]=v=>w(!0))},{default:a(()=>[f("展开所有")]),_:1}),t(k,{key:"6",onClick:s[3]||(s[3]=v=>w(!1))},{default:a(()=>[f("收起所有")]),_:1})]),_:1})]),default:a(()=>[t(A,{style:{float:"left"}},{default:a(()=>[f(" 树操作 "),t(_,{icon:"ant-design:up-outlined"})]),_:1})]),_:1}),t(A,{type:"primary",preIcon:"ant-design:save-filled",onClick:B},{default:a(()=>[f("保存")]),_:1})],2)])]),_:1},8,["spinning"]),t(H,{onRegister:K(E)},null,8,["onRegister"])],64)}}});const he=se(re,[["__scopeId","data-v-92cad6be"]]);export{he as default};
