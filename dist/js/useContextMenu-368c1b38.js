var $=Object.defineProperty,O=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var _=(e,t,o)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,g=(e,t)=>{for(var o in t||(t={}))N.call(t,o)&&_(e,o,t[o]);if(C)for(var o of C(t))S.call(t,o)&&_(e,o,t[o]);return e},w=(e,t)=>O(e,D(t));import{i as P,f as i,d as A,l as M,e as F,o as H,n as R,b as E,u as y,F as U,q as V,g as W}from"./vue-86253b15.js";import{t as q}from"./index-4de4eaa0.js";import{bu as v,bU as B}from"./antd-vue-vendor-371529c2.js";import{b6 as T}from"./jeecg-online-vendor-bc5d810e.js";import"./lodash-es-vendor-04a44d0a.js";import"./tinymce-vendor-7c917b36.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./vxe-table-vendor-6a8d95c4.js";function X(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!P(e)}const b="context-menu",Y={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},k=e=>{const{item:t}=e;return i("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&i(q,{class:"mr-2",icon:t.icon},null),i("span",null,[t.label])])},z=A({name:"ContextMenu",props:Y,setup(e){const t=M(null),o=M(!1),c=F(()=>{const{axis:s,items:n,styles:r,width:l}=e,{x:a,y:f}=s||{x:0,y:0},p=(n||[]).length*40,h=l,x=document.body,L=x.clientWidth<a+h?a-h:a,j=x.clientHeight<f+p?f-p:f;return w(g({},r),{width:`${l}px`,left:`${L+1}px`,top:`${j+1}px`})});H(()=>{R(()=>o.value=!0)}),E(()=>{const s=y(t);s&&document.body.removeChild(s)});function m(s,n){const{handler:r,disabled:l}=s;l||(o.value=!1,n==null||n.stopPropagation(),n==null||n.preventDefault(),r==null||r())}function u(s){return s.map(n=>{const{disabled:r,label:l,children:a,divider:f=!1}=n,p={item:n,handler:m,showIcon:e.showIcon};return!a||a.length===0?i(U,null,[i(v.Item,{disabled:r,class:`${b}__item`,key:l},{default:()=>[i(k,p,null)]}),f?i(B,{key:`d-${l}`},null):null]):y(o)?i(v.SubMenu,{key:l,disabled:r,popupClassName:`${b}__popup`},{title:()=>i(k,p,null),default:()=>u(a)}):null})}return()=>{let s;if(!y(o))return null;const{items:n}=e;return i(v,{inlineIndent:12,mode:"vertical",class:b,ref:t,style:y(c)},X(s=u(n))?s:{default:()=>[s]})}}});const d={domList:[],resolve:()=>{}},G=function(e){const{event:t}=e||{};if(t&&(t==null||t.preventDefault()),!!T)return new Promise(o=>{const c=document.body,m=document.createElement("div"),u={};e.styles&&(u.styles=e.styles),e.items&&(u.items=e.items),e.event&&(u.customEvent=t,u.axis={x:t.clientX,y:t.clientY});const s=i(z,u);V(s,m);const n=function(){d.resolve("")};d.domList.push(m);const r=function(){d.domList.forEach(l=>{try{l&&c.removeChild(l)}catch(a){}}),c.removeEventListener("click",n),c.removeEventListener("scroll",n)};d.resolve=function(l){r(),o(l)},r(),c.appendChild(m),c.addEventListener("click",n),c.addEventListener("scroll",n)})},I=function(){d&&(d.resolve(""),d.domList=[])};function re(e=!0){return W()&&e&&E(()=>{I()}),[G,I]}export{re as useContextMenu};
