import{V as F,u as T}from"./jeecg-online-vendor-f8ebd627.js";import{f as R,A as Q,B as q}from"./auth.api-d3a6c4b3-173a1b25.js";import{bQ as H,bR as J,bS as W,bT as X,bU as Y}from"./antd-vue-vendor-04f0af1d.js";import{d as $,k as p,e as j,w as G,V as f,a5 as x,a6 as S,a9 as D,F as L,aa as Z,f as r,a7 as v,E as k,u as ee}from"./vue-5a09445c.js";import"./tinymce-vendor-e2919cb0.js";import"./vxe-table-vendor-c5aaa9d2.js";import"./lodash-es-vendor-70833b4a.js";var b=(e,h,c)=>new Promise((C,m)=>{var s=o=>{try{l(c.next(o))}catch(d){m(d)}},n=o=>{try{l(c.throw(o))}catch(d){m(d)}},l=o=>o.done?C(o.value):Promise.resolve(o.value).then(s,n);l((c=c.apply(e,h)).next())});const te=$({name:"AuthFieldTree",components:{DownCircleOutlined:H,HomeOutlined:J,UpCircleOutlined:W,UndoOutlined:X,CheckOutlined:Y},props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:h}=T(),c=p(""),C=p(1),m=p(!0),s=p([]),n=p([]),l=p([]),o=p([]),d=p(""),I=j(()=>!c.value);G(()=>e.cgformId,y,{immediate:!0});function y(){return b(this,null,function*(){if(!e.cgformId)return;let t=yield R(e.cgformId,C.value),a=[],i=[];t.forEach(u=>{i.includes(u.code)||(i.push(u.code),a.push({key:u.code,title:u.title}))});for(let u of a){let K=[];for(let E of t)if(u.key===E.code){let V=O(E);K.push({key:E.id,title:V})}u.children=K}o.value=a,s.value=[...i],l.value=i})}function O(t){let a="";return t.page==3?a+="列表":t.page==5&&(a+="表单"),t.control==3?a+="可编辑":t.control==5&&(a+="可见"),a}function g(t,a){return b(this,null,function*(){c.value=t,d.value=a,n.value=[],yield y();let i=yield Q({roleId:t,cgformId:e.cgformId,type:C.value,authMode:a});n.value=i.map(u=>u.authId)})}function _(){c.value="",y()}function w(){y(),g(c.value,d.value)}function A(){return b(this,null,function*(){let t=n.value.filter(a=>l.value.indexOf(a)<0);yield q(c.value,e.cgformId,{authId:JSON.stringify(t),authMode:d.value}),h.success("保存成功")})}function z(){s.value=[...l.value]}function U(){s.value=[]}function B(t){s.value=t,m.value=!1}function P(){c.value="",n.value=[]}function M(){n.value=[]}function N(){const t=function(a){for(let i of a)n.value.push(i.key),i.children&&i.children.length>0&&t.call(null,i.children)};n.value=[],t.call(null,ee(o))}return{loadChecked:g,clear:P,expandedKeys:s,autoExpandParent:m,checkedKeys:n,treeData:o,disabled:I,onSave:A,onExpand:B,clearChecked:_,onCloseAll:U,onExpandAll:z,onRefresh:w,onClearSelected:M,onSelectAll:N}}}),ae={class:"onl-auth-tree-btns"};function le(e,h,c,C,m,s){const n=f("a-empty"),l=f("a-button"),o=f("DownCircleOutlined"),d=f("UpCircleOutlined"),I=f("CheckOutlined"),y=f("UndoOutlined"),O=f("a-tree");return x(),S("div",null,[e.disabled?(x(),D(n,{key:0,description:"请先选中左侧角色/部门/用户"})):e.treeData.length===0?(x(),D(n,{key:1,description:"无权限信息"})):(x(),S(L,{key:2},[Z("div",ae,[r(l,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:v(()=>[k("刷新")]),_:1},8,["onClick"]),r(l,{onClick:e.onExpandAll,size:"small",type:"primary",ghost:""},{default:v(()=>[r(o),k("展开")]),_:1},8,["onClick"]),r(l,{onClick:e.onCloseAll,size:"small",type:"primary",ghost:""},{default:v(()=>[r(d),k("折叠")]),_:1},8,["onClick"]),r(l,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:v(()=>[k("保存")]),_:1},8,["onClick"]),r(l,{onClick:e.onSelectAll,size:"small",type:"primary",ghost:""},{default:v(()=>[r(I),k("全选")]),_:1},8,["onClick"]),r(l,{onClick:e.onClearSelected,size:"small",type:"primary",ghost:""},{default:v(()=>[r(y),k("重置")]),_:1},8,["onClick"])]),r(O,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":h[0]||(h[0]=g=>e.checkedKeys=g),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}const se=F(te,[["render",le],["__scopeId","data-v-e6dabb1d"]]);export{se as default};
