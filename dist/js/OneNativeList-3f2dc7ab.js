var pe=Object.defineProperty;var K=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var U=(d,l,t)=>l in d?pe(d,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[l]=t,J=(d,l)=>{for(var t in l||(l={}))fe.call(l,t)&&U(d,t,l[t]);if(K)for(var t of K(l))ve.call(l,t)&&U(d,t,l[t]);return d};var L=(d,l,t)=>new Promise((P,y)=>{var k=f=>{try{c(t.next(f))}catch(h){y(h)}},r=f=>{try{c(t.throw(f))}catch(h){y(h)}},c=f=>f.done?P(f.value):Promise.resolve(f.value).then(k,r);c((t=t.apply(d,l)).next())});import{d as ge,l as i,r as _e,o as he,V as g,a7 as p,ac as O,aa as n,ad as m,f as o,E as _,u as b,W,ae as xe,a8 as x,F as N}from"./vue-86253b15.js";import{ao as ye,aO as D,aT as ke,q as we,ap as R,az as M}from"./jeecg-online-vendor-bc5d810e.js";import be from"./OneNativeModal-ed687718.js";import{bv as Ce,M as Se}from"./antd-vue-vendor-371529c2.js";import{t as F,n as G,g as Ie,ao as Te}from"./index-4de4eaa0.js";import{downloadFile as je}from"./renderUtils-3d92a36f.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-04a44d0a.js";import"./vxe-table-vendor-6a8d95c4.js";import"./OneNativeForm-6a4c7b35.js";import"./JAddInput-eb55e093.js";import"./areaDataUtil-c66543dc.js";import"./useFormItem-48d9339b.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./index-5f3b36bb.js";import"./BasicModal-8033a6fa.js";import"./useWindowSizeFn-0b39b13a.js";import"./JSelectUser-43c751df.js";import"./props-edbd03b5.js";import"./JSelectBiz-4759b897.js";import"./index-6c9d1f87.js";import"./index-6021b022.js";import"./bem-6904c165.js";import"./props-3eac2fce.js";import"./useContextMenu-368c1b38.js";import"./depart.api-b7cb4c93.js";import"./JUpload-5d01fa2e.js";import"./index-7eb57de2.js";import"./JPopup-1441d476.js";import"./JSelectDept-1fac1b66.js";const De={class:"table-operator"},Ee={class:"ant-alert ant-alert-info",style:{"margin-bottom":"16px"}},ze=m("i",{class:"anticon anticon-info-circle ant-alert-icon"},null,-1),Oe={style:{"font-weight":"600"}},Ne={key:0,style:{"font-size":"12px","font-style":"italic"}},Re=["src","preview"],Me={key:0,style:{"font-size":"12px","font-style":"italic"}},Fe=["onClick"],Pe={class:"ant-dropdown-link"},Ve=["onClick"],Xe=m("a",null,"删除",-1),bt=ge({__name:"OneNativeList",setup(d){const{handleExportXls:l,handleImportXls:t}=ke(),P=i(!1),y=i({}),k=i(!1),r=i([]),c=i(),f={"X-Access-Token":ye()},h=i([{title:"文本",align:"center",dataIndex:"name"},{title:"字典下拉",align:"center",dataIndex:"xiala",customRender:({text:e})=>e?D(r.value.xiala,e):""},{title:"字典单选",align:"center",dataIndex:"danxuan",customRender:({text:e})=>e?D(r.value.danxuan,e):""},{title:"字典多选",align:"center",dataIndex:"duoxuan",customRender:({text:e})=>e?D(r.value.duoxuan,e):""},{title:"开关",align:"center",dataIndex:"kaiguan",customRender:({text:e})=>e?D(r.value.kaiguan,e):""},{title:"日期",align:"center",dataIndex:"riqi",customRender:function({text:e}){return e?e.length>10?e.substr(0,10):e:""}},{title:"年月日时分秒",align:"center",dataIndex:"nyrsfm"},{title:"时间",align:"center",dataIndex:"shijian"},{title:"文件",align:"center",dataIndex:"wenjian"},{title:"图片",align:"center",dataIndex:"tupian"},{title:"操作",dataIndex:"action",align:"center",fixed:"right",width:147}]),w=_e({list:"/test/jeecgDemo/oneNative/list",delete:"/test/jeecgDemo/oneNative/delete",exportXls:"/test/jeecgDemo/oneNative/exportXls",importExcel:"test/jeecgDemo/oneNative/importExcel"}),V=i([]),X=i(!1),v=i({current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:(e,a)=>a[0]+"-"+a[1]+" 共"+e+"条",showQuickJumper:!0,showSizeChanger:!0,total:0}),u=i([]),C=i([]),B=i({column:"createTime",order:"desc"}),A=i({}),{createMessage:Y}=we();function Z(e,a){u.value=e,C.value=a}function ee({pagination:e,filters:a,sorter:s}){v.value=e,B.value=s,A.value=J({},a)}function te(){c.value.disableSubmit=!1,c.value.add()}function ae(){u.value=[],C.value=[]}function ne(){Se.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>{R.delete({url:w.delete,data:{ids:u.value}},{joinParamsToUrl:!0}).then(()=>{I()})}})}function Be(e){let a=Q();u.value&&u.value.length>0&&(a.selections=u.join(",")),l(e,w.exportXls,G(a))}function Ae(e){t(e,w.importExcel,"").then(()=>{I()})}function Q(){let e=Object.assign(y.value,B.value,A.value);return e.field=oe(),e.pageNo=v.value.current,e.pageSize=v.value.pageSize,G(e)}function oe(){let e="id,";return h.value.forEach(function(a){e+=","+a.dataIndex}),e}function S(e){e===1&&(v.value.current=1),k.value=!0;let a=Q();R.get({url:w.list,params:a},{isTransformResponse:!1}).then(s=>{s.success?(V.value=s.result.records,s.result&&s.result.total?v.value.total=s.result.total:v.value.total=0):Y.warning(s.message)}).finally(()=>{k.value=!1})}function Qe(){S(1),u.value=[],C.value=[]}function $e(){X.value=!X.value}function qe(){y.value={},S(1)}function le(e){return e&&e.indexOf(",")>0&&(e=e.substring(0,e.indexOf(","))),Ie(e)}function ie(e){c.value.disableSubmit=!1,c.value.edit(e)}function se(e){c.value.disableSubmit=!0,c.value.edit(e)}function re(e){R.delete({url:w.delete,data:{ids:e}},{joinParamsToUrl:!0}).then(a=>{I()})}function ce(){return L(this,null,function*(){r.value.flzds=yield Te({code:"B01"}),r.value.xiala=yield M("sex"),r.value.danxuan=yield M("sex"),r.value.duoxuan=yield M("urgent_level")})}function I(){u.value=[],C.value=[],S(1)}return he(()=>{r.value.kaiguan=[{text:"是",value:"1"},{text:"否",value:"2"}],S(),ce()}),(e,a)=>{const s=g("a-button"),E=g("a-menu-item"),$=g("a-menu"),q=g("a-dropdown"),ue=g("a-divider"),de=g("a-table"),me=g("a-card");return p(),O(me,{bordered:!1},{default:n(()=>[m("div",De,[o(s,{onClick:te,type:"primary",preIcon:"ant-design:plus"},{default:n(()=>[_("新增")]),_:1}),u.value.length>0?(p(),O(q,{key:0},{overlay:n(()=>[o($,null,{default:n(()=>[o(E,{key:"1",onClick:ne},{default:n(()=>[o(b(F),{icon:"ant-design:delete-outlined"}),_(" 删除 ")]),_:1})]),_:1})]),default:n(()=>[o(s,null,{default:n(()=>[_("批量操作 "),o(b(F),{icon:"mdi:chevron-down"})]),_:1})]),_:1})):W("",!0)]),m("div",null,[m("div",Ee,[ze,_(" 已选择 "),m("a",Oe,xe(u.value.length),1),_("项 "),m("a",{style:{"margin-left":"24px"},onClick:ae},"清空")]),o(de,{ref:"table",size:"middle",scroll:{x:!0},bordered:"",rowKey:"id",class:"j-table-force-nowrap",columns:h.value,dataSource:V.value,pagination:v.value,loading:k.value,rowSelection:{selectedRowKeys:u.value,onChange:Z},onChange:ee},{bodyCell:n(({column:z,text:T,record:j})=>[z.dataIndex==="tupian"?(p(),x(N,{key:0},[T?(p(),x("img",{key:1,src:le(T),preview:j.id,alt:"",class:"anty-img-wrap"},null,8,Re)):(p(),x("span",Ne,"无图片"))],64)):z.dataIndex==="wenjian"?(p(),x(N,{key:1},[T?(p(),O(s,{key:1,ghost:!0,type:"primary",preIcon:"ant-design:download",size:"small",onClick:H=>b(je)(T)},{default:n(()=>[_(" 下载 ")]),_:2},1032,["onClick"])):(p(),x("span",Me,"无文件"))],64)):z.dataIndex==="action"?(p(),x(N,{key:2},[m("a",{onClick:H=>ie(j)},"编辑",8,Fe),o(ue,{type:"vertical"}),o(q,null,{overlay:n(()=>[o($,{class:"antd-more"},{default:n(()=>[o(E,null,{default:n(()=>[m("a",{onClick:H=>se(j)},"详情",8,Ve)]),_:2},1024),o(E,null,{default:n(()=>[o(b(Ce),{title:"确定删除吗?",onConfirm:()=>re(j.id)},{default:n(()=>[Xe]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:n(()=>[m("a",Pe,[_("更多 "),o(b(F),{icon:"mdi-light:chevron-down"})])]),_:2},1024)],64)):W("",!0)]),_:1},8,["columns","dataSource","pagination","loading","rowSelection"])]),o(be,{ref_key:"oneProtogenesisModal",ref:c,onOk:I},null,512)]),_:1})}}});export{bt as default};
