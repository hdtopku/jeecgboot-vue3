var z=Object.defineProperty,U=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var S=(e,t,o)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,_=(e,t)=>{for(var o in t||(t={}))K.call(t,o)&&S(e,o,t[o]);if(F)for(var o of F(t))Q.call(t,o)&&S(e,o,t[o]);return e},L=(e,t)=>U(e,G(t));var k=(e,t,o)=>new Promise((d,s)=>{var u=n=>{try{p(o.next(n))}catch(m){s(m)}},l=n=>{try{p(o.throw(n))}catch(m){s(m)}},p=n=>n.done?d(n.value):Promise.resolve(n.value).then(u,l);p((o=o.apply(e,t)).next())});import{d as H,k as y,e as T,u as J,o as W,q,U as f,a5 as E,a9 as D,a7 as g,f as v,ae as X,af as Y,aa as x,m as N,am as j,t as Z,A as ee,ag as te}from"./vue-249e5fad.js";import{aq as oe,m as ae,J as h}from"./index-679980cc.js";import{L as le}from"./useTableSync-dc333087-ab940f96.js";import{C as ne,n as ie,U as re,u as se}from"./jeecg-online-vendor-216a3b98.js";import{B as ue}from"./BasicForm-e402ba31.js";import"./componentMap-a7b11ac1.js";import{u as pe}from"./useForm-b140653f.js";import"./JAddInput-448c30de.js";import"./JSelectUser-6445886b.js";import"./JSelectDept-a510196a.js";import"./JPopup-17610371.js";import"./index-d3bb5676.js";import{M as ce,e as de,ac as me,aR as fe}from"./antd-vue-vendor-31afcf32.js";import"./BasicForm.vue_vue_type_style_index_0_lang-4a18cb84.js";import"./lodash-es-vendor-c1987ca1.js";import"./tinymce-vendor-676f8393.js";import"./echarts-vendor-6c8e2159.js";import"./vxe-table-vendor-0b109a77.js";import"./cgform.data-cbdd88c3-7b14cb3e.js";import"./BasicModal-9db7feac.js";import"./useWindowSizeFn-be58341e.js";import"./useFormItem-ffb99f3a.js";import"./JUpload.vue_vue_type_style_index_0_lang-bb1d589f.js";import"./download-e75f2be2.js";import"./base64Conver-fa2fe1af.js";import"./index-373123f1.js";import"./index-a84832ad.js";import"./useCountdown-4c58e3fd.js";import"./index-cab72147.js";import"./areaDataUtil-ce3f5a88.js";import"./props-cfc852e3.js";import"./JSelectBiz-75d5549c.js";import"./index-729d20ee.js";import"./codemirror-vendor-611c4582.js";import"./index-45c71305.js";import"./bem-d0082e60.js";import"./props-7b44416e.js";import"./useContextMenu-46301301.js";import"./depart.api-a2e1c84a.js";const ve=H({name:"JPrompt",components:{Modal:ce,Spin:de,Input:me,BasicForm:ue,ConfigProvider:fe},emits:["register"],setup(e,{emit:t}){const o=y(),{getAntdLocale:d}=oe(),s=y(!1),u=y(!1),l=y({}),p=T(()=>{var c;return(c=l.value.placeholder)!=null?c:"请输入内容"}),[n,{clearValidate:m,setFieldsValue:i,validate:a,updateSchema:r}]=pe({compact:!0,wrapperCol:{span:24},schemas:[{label:"",field:"input",component:"Input",slot:"customInput"}],showActionButtonGroup:!1}),C=T(()=>{var O,I;let c=l.value,b={width:(O=c.width)!=null?O:500,title:(I=c.title)!=null?I:"prompt",visible:J(s),confirmLoading:J(u)};return L(_(_(_({},b),e),c),{onOk:M,onCancel(){typeof l.value.onCancel=="function"&&l.value.onCancel(),V()}})});W(()=>{t("register",{openModal:w,setLoading:R,getVisible:s})});function w(c){return k(this,null,function*(){var b,P;document.body.focus(),l.value=c,s.value=!0,yield q(),yield r({field:"input",required:l.value.required,rules:l.value.rules,dynamicRules:l.value.dynamicRules}),yield i({input:(b=l.value.defaultValue)!=null?b:""}),yield m(),(P=o.value)==null||P.focus()})}function V(){s.value=!1}function $(){a()}function M(){return k(this,null,function*(){try{const{onOk:c}=l.value;let b=yield a();R(!0),typeof c=="function"?(yield c(b.input))!==!1&&V():V()}finally{R(!1)}})}function R(c){u.value=c}return{inputRef:o,getProps:C,loading:u,options:l,placeholder:p,getAntdLocale:d,onChange:$,onSubmit:M,registerForm:n}}}),ge={style:{padding:"20px"}},be=["innerHTML"];function he(e,t,o,d,s,u){const l=f("Input"),p=f("BasicForm"),n=f("Spin"),m=f("Modal"),i=f("ConfigProvider");return E(),D(i,{locale:e.getAntdLocale},{default:g(()=>[v(m,X(Y(e.getProps)),{default:g(()=>[v(n,{spinning:e.loading},{default:g(()=>[x("div",ge,[x("div",{innerHTML:e.options.content,style:{"margin-bottom":"8px"}},null,8,be),v(p,{onRegister:e.registerForm},{customInput:g(({model:a,field:r})=>[v(l,{ref:"inputRef",value:a[r],"onUpdate:value":C=>a[r]=C,placeholder:e.placeholder,onPressEnter:e.onSubmit,onInput:e.onChange},null,8,["value","onUpdate:value","placeholder","onPressEnter","onInput"])]),_:1},8,["onRegister"])])]),_:1},8,["spinning"])]),_:1},16)]),_:1},8,["locale"])}const ye=ne(ve,[["render",he]]);function Ce(){function e(t){let o=null;const d=document.createElement("div"),s=v(ye,{onRegister(i){return k(this,null,function*(){o=i,yield q(),i.openModal(t)})},afterClose(){N(null,d),document.body.removeChild(d)}});N(s,d),document.body.appendChild(d);function u(){return o==null&&ie("useJPrompt instance is undefined!"),o}function l(i){var a;(a=u())==null||a.updateModal(i)}function p(){var i;(i=u())==null||i.closeModal()}function n(i){var a;(a=u())==null||a.setLoading(i)}return{closeModal:p,updateModal:l,setLoading:n}}return{createJPrompt:e}}var we=Object.defineProperty,Pe=Object.defineProperties,_e=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertySymbols,ke=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable,A=(e,t,o)=>t in e?we(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ve=(e,t)=>{for(var o in t||(t={}))ke.call(t,o)&&A(e,o,t[o]);if(B)for(var o of B(t))xe.call(t,o)&&A(e,o,t[o]);return e},Re=(e,t)=>Pe(e,_e(t));const Te=H({name:"CheckDictTable",components:{VNodes:(e,{attrs:t})=>t.vnodes},setup(){const{prefixCls:e}=ae("cgform-check-dict-table"),{createMessage:t}=se(),o=y([{title:"字段名称",key:"dbFieldName",width:100},{title:"字段备注",key:"dbFieldTxt",width:100},{title:"字段Href",key:"fieldHref",width:130,type:h.input,defaultValue:""},{title:"验证规则",key:"fieldValidType",width:170,type:h.slot,slotName:"fieldValidType",allowInput:!0,defaultValue:"",placeholder:"空"},{title:"校验必填",key:"fieldMustInput",width:80,type:h.checkbox,align:"center",customValue:["1","0"],defaultChecked:!1},{title:"字典Table",key:"dictTable",width:280,type:h.textarea,defaultValue:""},{title:"字典Code",key:"dictField",width:280,type:h.input,defaultValue:""},{title:"字典Text",key:"dictText",width:280,type:h.input,defaultValue:""}]),d=le(o),s=y([{label:"空",value:""},{label:"唯一校验",value:"only"},{label:"6到16位数字",value:"n6-16"},{label:"6到18位字母",value:"s6-18"},{label:"6到16位任意字符",value:"*6-16"},{label:"网址",value:"url"},{label:"电子邮件",value:"e"},{label:"手机号码",value:"m"},{label:"邮政编码",value:"p"},{label:"字母",value:"s"},{label:"数字",value:"n"},{label:"整数",value:"z"},{label:"非空",value:"*"},{label:"金额",value:"money"}]),u=T(()=>s.value.map(a=>a.value)),{createJPrompt:l}=Ce();function p(a){return a!=null&&!u.value.includes(a)}function n(a){l({title:"自定义正则表达式",placeholder:"请输入正则表达式",rules:[{required:!0,message:"正则表达式不能为空！"},{validator:i}],onOk:r=>{a.triggerChange(r),t.success("添加成功")}})}function m(a){l({title:"修改自定义正则表达式",defaultValue:a.value,placeholder:"请输入正则表达式",rules:[{required:!0,message:"正则表达式不能为空！"},{validator:i}],onOk:r=>{a.triggerChange(r),r!==a.value&&t.success("修改成功")}})}function i(a,r){return p(r)?Promise.resolve():Promise.reject("当前校验已存在")}return Re(Ve({},d),{prefixCls:e,columns:o,isCustomRegexp:p,validTypeOptions:s,validTypeValues:u,onAddCustomRegexp:n,onChangeCustomRegexp:m})}}),Me={class:"custom-option-list rc-virtual-list-holder-inner",style:{"border-top":"1px solid #dfdfdf"}},Oe=["onClick"];function Ie(e,t,o,d,s,u){const l=f("VNodes"),p=f("a-select"),n=f("a-col"),m=f("a-button"),i=f("a-row"),a=f("JVxeTable");return E(),D(a,te({ref:"tableRef",rowNumber:"",keyboardEdit:"",class:[e.prefixCls],maxHeight:e.tableHeight.noToolbar,loading:e.loading,columns:e.columns,dataSource:e.dataSource,disabledRows:{dbFieldName:["id","has_child"]}},e.tableProps),{fieldValidType:g(r=>[v(i,{type:"flex",class:j(["row-valid-type",{full:!e.isCustomRegexp(r.value)}])},{default:g(()=>[v(n,{class:j(["left"])},{default:g(()=>[v(p,{value:r.value,options:e.validTypeOptions,placeholder:"空",style:{width:"100%"},onChange:r.triggerChange},{dropdownRender:g(({menuNode:C})=>[v(l,{vnodes:C},null,8,["vnodes"]),Z(x("div",Me,[x("div",{class:"ant-select-item ant-select-item-option",title:"使用自定义正则表达式作为校验规则",onClick:w=>e.onAddCustomRegexp(r),onMousedown:t[0]||(t[0]=w=>w.preventDefault())}," 正则表达式 ",40,Oe)],512),[[ee,!e.isCustomRegexp(r.value)]])]),_:2},1032,["value","options","onChange"])]),_:2},1024),v(n,{class:"right",title:"修改自定义正则表达式"},{default:g(()=>[v(m,{preIcon:"ant-design:edit",onClick:()=>e.onChangeCustomRegexp(r)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["class"])]),_:1},16,["class","maxHeight","loading","columns","dataSource"])}const ht=re(Te,[["render",Ie],["__scopeId","data-v-7693eace"]]);export{ht as default};
