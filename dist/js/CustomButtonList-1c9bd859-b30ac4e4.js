import{D as E}from"./useOnlineTest-0df0ae86-26931e5c.js";import{useListPage as H}from"./useListPage-66893768.js";import $ from"./BasicTable-438c62dc.js";import{Q as J}from"./componentMap-8ca03aee.js";import"./useTable-28fc0fe6.js";import{B as Q}from"./index-abefda79.js";import{B as W}from"./BasicForm-21b7ac92.js";import{u as X}from"./useForm-69b31c99.js";import"./JAddInput-b8d2ab38.js";import"./JSelectUser-d2cfe039.js";import"./JSelectDept-f59102d9.js";import"./JPopup-78bf3f5d.js";import{B as Y,z as Z}from"./index-0d179770.js";import"./cron-parser-vendor-7c1c3251.js";import{Q as ee,b as C}from"./jeecg-online-vendor-658239c9.js";import{d as te,k as M,r as oe,e as ne,V as i,a5 as x,a9 as R,a7 as l,f as r,E as y,a6 as le,W as T,ae as re,af as ae,q as ie}from"./vue-bcbaddf9.js";import"./BasicTable.vue_vue_type_style_index_0_lang-9ce97bb7.js";import"./injectionKey-69710956.js";import"./antd-vue-vendor-a78909e6.js";import"./tinymce-vendor-676f8393.js";import"./BasicForm.vue_vue_type_style_index_0_lang-3e2c32c1.js";import"./lodash-es-vendor-9b741fb8.js";import"./useWindowSizeFn-fbe431de.js";import"./vxe-table-vendor-9edfd3ae.js";import"./echarts-vendor-6c8e2159.js";import"./BasicModal-d4150903.js";import"./areaDataUtil-661e31ab.js";import"./useFormItem-9082d1c8.js";import"./props-8e60cede.js";import"./JSelectBiz-8b34874f.js";import"./index-8e0aeea9.js";import"./codemirror-vendor-7570b8a9.js";import"./index-6219dca4.js";import"./bem-6b2974b6.js";import"./props-c7c3390f.js";import"./useContextMenu-fdbf9c9a.js";import"./depart.api-380afd6d.js";import"./JUpload.vue_vue_type_style_index_0_lang-e11e0a89.js";import"./download-f4ef666f.js";import"./base64Conver-fa2fe1af.js";import"./index-e3a70fab.js";import"./index-42cd22d1.js";import"./useCountdown-d0291e3c.js";import"./index-ebd3f065.js";var se=Object.defineProperty,S=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,F=(e,t,o)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,pe=(e,t)=>{for(var o in t||(t={}))ce.call(t,o)&&F(e,o,t[o]);if(S)for(var o of S(t))ue.call(t,o)&&F(e,o,t[o]);return e},w=(e,t,o)=>new Promise((v,f)=>{var b=a=>{try{s(o.next(a))}catch(u){f(u)}},c=a=>{try{s(o.throw(a))}catch(u){f(u)}},s=a=>a.done?v(a.value):Promise.resolve(a.value).then(b,c);s((o=o.apply(e,t)).next())});const me=(e,t)=>C.get({url:"/online/cgform/button/list/"+e,params:t});function _(e){return C.delete({url:"/online/cgform/button/deleteBatch",params:{ids:e.join(",")}},{joinParamsToUrl:!0})}const de=(e,t)=>t?C.put({url:"/online/cgform/button/edit",params:e}):C.post({url:"/online/cgform/button/add",params:e}),fe=[{title:"按钮编码",align:"center",dataIndex:"buttonCode"},{title:"按钮名称",align:"center",dataIndex:"buttonName"},{title:"按钮样式",align:"center",dataIndex:"buttonStyle",customRender({text:e,record:t}){if(e==="form"){let o=t.optPosition;return e+"("+(o=="2"?"底部":"侧面")+")"}else return e}},{title:"按钮类型",align:"center",dataIndex:"optType"},{title:"排序",align:"center",dataIndex:"orderNum"},{title:"按钮图标",align:"center",dataIndex:"buttonIcon"},{title:"表达式",align:"center",dataIndex:"exp"},{title:"按钮状态",align:"center",dataIndex:"buttonStatus",customRender({text:e}){return e==1?"激活":"未激活"}}],be=[{label:"按钮编码",field:"buttonCode",component:"Input",required:!0},{label:"按钮名称",field:"buttonName",component:"Input",required:!0},{label:"按钮样式",field:"buttonStyle",component:"Select",componentProps:{options:[{label:"Link",value:"link"},{label:"Button",value:"button"},{label:"Form",value:"form"}]},defaultValue:"link"},{label:"按钮位置",field:"optPosition",component:"Select",componentProps:{options:[{label:"侧面",value:"1"},{label:"底部",value:"2"}]},defaultValue:"2",show:({model:e})=>e.buttonStyle==="form"},{label:"按钮类型",field:"optType",component:"Select",componentProps:{options:[{label:"Js",value:"js"},{label:"Action",value:"action"}]},defaultValue:"js"},{label:"排序",field:"orderNum",component:"InputNumber",componentProps:{style:"width: 100%"}},{label:"按钮图标",field:"buttonIcon",component:"Input",helpMessage:"a-icon type"},{label:"表达式",field:"exp",component:"Input"},{label:"按钮状态",field:"buttonStatus",component:"RadioButtonGroup",componentProps:{options:[{label:"激活",value:"1"},{label:"未激活",value:"0"}]},defaultValue:"1"}],ge=te({name:"CustomButtonList",components:{BasicModal:Q,BasicTable:$,TableAction:J,BasicForm:W},emits:["register"],setup(){const e=M(""),{doRequest:t,doDeleteRecord:o,tableContext:v}=H({tableProps:{api:n=>me(e.value,n),columns:fe,canResize:!1,useSearchForm:!1,beforeFetch(n){return Object.assign(n,{column:"orderNum",order:"asc"})}}}),[f,{reload:b},{rowSelection:c,selectedRowKeys:s}]=v,[a,{closeModal:u}]=Y(n=>w(this,null,function*(){e.value=n.row.id,b()})),{aiTestMode:h,genButtons:B}=E(),[k,g]=Z(),p=M(!1),m=oe({onRegister:k,title:ne(()=>p!=null&&p.value?"修改":"新增"),width:800,confirmLoading:!1,onOk:K,onCancel:g.closeModal});let d={};const[A,{resetFields:D,setFieldsValue:j,validate:N}]=X({schemas:be,showActionButtonGroup:!1});function P(n){return w(this,null,function*(){var I;p.value=n.isUpdate,d=pe({},(I=n.record)!=null?I:{}),g.openModal(),yield ie(),yield D(),j(d)})}function O(){P({isUpdate:!1})}function V(n){P({isUpdate:!0,record:n})}function L(){u()}function q(){B(e.value)}function G(){return w(this,null,function*(){t(()=>_(s.value))})}function K(){return w(this,null,function*(){try{m.confirmLoading=!0;let n=yield N();n=Object.assign({cgformHeadId:e.value},d,n),yield de(n,p.value),b(),g.closeModal()}finally{m.confirmLoading=!1}})}function U(n){return[{label:"编辑",onClick:()=>V(n)}]}function z(n){return[{label:"删除",popConfirm:{title:"确定删除吗？",placement:"left",confirm:()=>o(()=>_([n.id]))}}]}return{onAdd:O,onBatchDelete:G,aiTestMode:h,onGenButtons:q,registerModal:a,registerTable:f,selectedRowKeys:s,rowSelection:c,onCancel:L,getTableAction:U,getDropDownAction:z,registerForm:A,formModalProps:m}}}),ye={key:0,style:{float:"left"}};function ve(e,t,o,v,f,b){const c=i("a-button"),s=i("a-icon"),a=i("a-menu-item"),u=i("a-menu"),h=i("a-dropdown"),B=i("TableAction"),k=i("BasicTable"),g=i("BasicForm"),p=i("a-spin"),m=i("BasicModal");return x(),R(m,{onRegister:e.registerModal,title:"自定义按钮",width:1200,defaultFullscreen:"",onCancel:e.onCancel},{footer:l(()=>[r(c,{onClick:e.onCancel},{default:l(()=>[y("关闭")]),_:1},8,["onClick"]),e.aiTestMode?(x(),le("div",ye,[r(c,{onClick:e.onGenButtons},{default:l(()=>[y("生成测试数据")]),_:1},8,["onClick"])])):T("",!0)]),default:l(()=>[r(k,{onRegister:e.registerTable,rowSelection:e.rowSelection},{tableTitle:l(()=>[r(c,{onClick:e.onAdd,type:"primary",preIcon:"ant-design:plus"},{default:l(()=>[y("新增")]),_:1},8,["onClick"]),e.selectedRowKeys.length>0?(x(),R(h,{key:0},{overlay:l(()=>[r(u,null,{default:l(()=>[r(a,{key:"1",onClick:e.onBatchDelete},{default:l(()=>[r(s,{type:"delete"}),y(" 删除 ")]),_:1},8,["onClick"])]),_:1})]),default:l(()=>[r(c,{style:{"margin-left":"8px"}},{default:l(()=>[y(" 批量操作 "),r(s,{type:"down"})]),_:1})]),_:1})):T("",!0)]),action:l(({record:d})=>[r(B,{actions:e.getTableAction(d),dropDownActions:e.getDropDownAction(d)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),r(m,re(ae(e.formModalProps)),{default:l(()=>[r(p,{spinning:e.formModalProps.confirmLoading},{default:l(()=>[r(g,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},8,["spinning"])]),_:1},16)]),_:1},8,["onRegister","onCancel"])}const ct=ee(ge,[["render",ve]]);export{ct as default};
