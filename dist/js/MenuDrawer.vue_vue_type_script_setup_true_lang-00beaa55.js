var W=Object.defineProperty;var _=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var y=(o,s,t)=>s in o?W(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t,B=(o,s)=>{for(var t in s||(s={}))k.call(s,t)&&y(o,t,s[t]);if(_)for(var t of _(s))R.call(s,t)&&y(o,t,s[t]);return o};var g=(o,s,t)=>new Promise((d,i)=>{var m=r=>{try{c(t.next(r))}catch(l){i(l)}},f=r=>{try{c(t.throw(r))}catch(l){i(l)}},c=r=>r.done?d(r.value):Promise.resolve(r.value).then(m,f);c((t=t.apply(o,s)).next())});import{B as S}from"./BasicForm-1c4cfe6b.js";import"./componentMap-bab84cb7.js";import{u as T}from"./useForm-799a6766.js";import"./JAddInput-903fbbea.js";import"./JSelectUser-14c3fad5.js";import"./JSelectDept-56a87299.js";import"./JPopup-d3d151eb.js";import"./index-b03d7914.js";import"./cron-parser-vendor-d9194a40.js";import"./index-cd2db611.js";import{f as I,l as L,C as M,g as V}from"./menu.data-9778a9c8.js";import{u as x,B as N}from"./index-e95eba3a.js";import{useDrawerAdaptiveWidth as O}from"./useAdaptiveWidth-8d86514b.js";import{d as $,M as j,k as C,e as q,u as a,a5 as G,a9 as z,a7 as E,f as H,ag as J}from"./vue-bcbaddf9.js";const le=$({__name:"MenuDrawer",emits:["success","register"],setup(o,{emit:s}){const{adaptiveWidth:t}=O(),d=j(),i=C(!0),m=C(0),f=e=>e===2,[c,{setProps:r,resetFields:l,setFieldsValue:w,updateSchema:v,validate:D,clearValidate:K}]=T({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:I,showActionButtonGroup:!1}),[b,{setDrawerProps:h,closeDrawer:P}]=x(e=>g(this,null,function*(){var n;yield l(),h({confirmLoading:!1}),i.value=!!(e!=null&&e.isUpdate),m.value=(n=e==null?void 0:e.record)==null?void 0:n.menuType;const p=yield L();if(v([{field:"parentId",componentProps:{treeData:p}},{field:"name",label:f(a(m))?"按钮/权限":"菜单名称"},{field:"url",required:!f(a(m)),componentProps:{onChange:u=>F(u.target.value)}}]),typeof e.record=="object"){let u=B({},e.record);w(u),F(u.url)}r({disabled:!d.showFooter})})),A=q(()=>a(i)?"编辑菜单":"新增菜单");function U(){return g(this,null,function*(){try{const e=yield D();M.IFrame===e.component&&(e.component=e.frameSrc),h({confirmLoading:!0}),yield V(e,a(i)),P(),s("success")}finally{h({confirmLoading:!1})}})}function F(e){let p="",n=e;e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),p=`${e}`):p="请输入组件名称",v([{field:"componentName",componentProps:{placeholder:p}}]),n!=null&&n!=""&&(n.startsWith("http://")||n.startsWith("https://"))&&w({component:n})}return(e,p)=>(G(),z(a(N),J(e.$attrs,{onRegister:a(b),showFooter:"",width:a(t),title:A.value,onOk:U}),{default:E(()=>[H(a(S),{onRegister:a(c),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{le as _};
