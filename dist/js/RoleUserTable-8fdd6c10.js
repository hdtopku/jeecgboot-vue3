var m=(d,R,s)=>new Promise((l,n)=>{var h=r=>{try{f(s.next(r))}catch(c){n(c)}},y=r=>{try{f(s.throw(r))}catch(c){n(c)}},f=r=>r.done?l(r.value):Promise.resolve(r.value).then(h,y);f((s=s.apply(d,R)).next())});import{d as z,l as I,V as p,a7 as w,ac as g,aa as t,f as o,E as _,W as k,u as a}from"./vue-ebecda47.js";import{u as A}from"./index-993283cc.js";import{u as H,a as Q,B as q}from"./index-5c1c038a.js";import"./index-e91e8b28.js";import G from"./UserDrawer-c3e6d90c.js";import J from"./UseSelectModal-b562dc23.js";import{u as X,c as Y,e as Z,f as ee}from"./role.api-b91d30ca.js";import{u as te,b as oe}from"./role.data-706d1ed9.js";import{g as re}from"./user.api-729c8827.js";import{F as ie}from"./index-85cfc899.js";import{Q as ne}from"./componentMap-c36c4b8d.js";import ae from"./BasicTable-46b6c894.js";import{_ as se}from"./jeecg-online-vendor-cfb58502.js";import"./antd-vue-vendor-b75e8c06.js";import"./tinymce-vendor-7c917b36.js";import"./index-be9b0972.js";import"./lodash-es-vendor-cd7703c8.js";import"./BasicModal-7e6e7ae9.js";import"./useWindowSizeFn-50bd5ea0.js";import"./vxe-table-vendor-4aae63bf.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./index-a2e0ccba.js";import"./useForm-21b78d9f.js";import"./JAddInput-64f6e84f.js";import"./areaDataUtil-4a5c6609.js";import"./useFormItem-ba20c4de.js";import"./JSelectUser-94adcf4d.js";import"./props-c57324f9.js";import"./JSelectBiz-4fc2f082.js";import"./index-1c3e0ea1.js";import"./index-097af6f9.js";import"./bem-311698ef.js";import"./props-13a58630.js";import"./useContextMenu-eb481e60.js";import"./depart.api-1888bf18.js";import"./JSelectDept-394df716.js";import"./JPopup-f9a8bda3.js";import"./JEllipsis-410bb5e8.js";import"./user.data-f8f5590c.js";import"./validator-fb5fa821.js";import"./renderUtils-e0ecd00e.js";import"./useAdaptiveWidth-f2ae9128.js";import"./download-c9e5f3f7.js";import"./base64Conver-fa2fe1af.js";import"./index-96e99de8.js";import"./index-118a05d7.js";import"./useCountdown-00a25cd7.js";import"./useFormItemSingle-36e25e6f.js";import"./cron-parser-vendor-afad4b1e.js";import"./JUpload-ffe34816.js";import"./index-ae3841ab.js";import"./index-ab54dd3c.js";import"./injectionKey-69710956.js";const le=z({__name:"RoleUserTable",props:{disableUserEdit:{type:Boolean,default:!1}},emits:["register","hideUserList"],setup(d,{emit:R}){const s=d,l=I([]),n=I(""),[h,{setDrawerProps:y,closeDrawer:f}]=H(e=>m(this,null,function*(){n.value=e.id,D({searchInfo:{roleId:e.id}}),u()})),[r,{openDrawer:c}]=Q(),[S,{openModal:U}]=ie(),[v,{reload:u,updateTableDataRecord:x,setProps:D}]=A({title:"用户列表",api:X,columns:te,formConfig:{labelWidth:60,schemas:oe,autoSubmitOnEnter:!0},striped:!0,useSearchForm:!0,showTableSetting:!0,clickToRowSelect:!1,bordered:!0,showIndexColumn:!1,tableSetting:{fullScreen:!0},canResize:!1,rowKey:"id",actionColumn:{width:180,title:"操作",dataIndex:"action",slots:{customRender:"action"},fixed:void 0}}),T={type:"checkbox",columnWidth:50,selectedRowKeys:l,onChange:B};function B(e,i){l.value=e}function E(){c(!0,{isUpdate:!1,selectedroles:[n.value],isRole:!0})}function K(e){return m(this,null,function*(){try{const i=yield re({userid:e.id});i&&i.length>0&&(e.selectedroles=i)}catch(i){}c(!0,{record:e,isUpdate:!0,isRole:!0})})}function V(e){return m(this,null,function*(){yield Y({userId:e.id,roleId:n.value},u)})}function F(){return m(this,null,function*(){yield Z({userIds:l.value.join(","),roleId:n.value},u)})}function L({isUpdate:e,values:i}){e?x(i.id,i):u()}function M(){U(!0)}function N(e){return m(this,null,function*(){yield ee({roleId:n.value,userIdList:e},u)})}function O(e){return[{label:"编辑",onClick:K.bind(null,e),ifShow:()=>!s.disableUserEdit},{label:"取消关联",popConfirm:{title:"是否确认取消关联",confirm:V.bind(null,e)}}]}return(e,i)=>{const b=p("a-button"),C=p("Icon"),W=p("a-menu-item"),P=p("a-menu"),$=p("a-dropdown");return w(),g(a(q),{onRegister:a(h),title:"角色用户",width:"800",destroyOnClose:""},{default:t(()=>[o(a(ae),{onRegister:a(v),rowSelection:T},{tableTitle:t(()=>[d.disableUserEdit?k("",!0):(w(),g(b,{key:0,type:"primary",onClick:E},{default:t(()=>[_(" 新增用户")]),_:1})),o(b,{type:"primary",onClick:M},{default:t(()=>[_(" 已有用户")]),_:1}),l.value.length>0?(w(),g($,{key:1},{overlay:t(()=>[o(P,null,{default:t(()=>[o(W,{key:"1",onClick:F},{default:t(()=>[o(C,{icon:"bx:bx-unlink"}),_(" 取消关联 ")]),_:1})]),_:1})]),default:t(()=>[o(b,null,{default:t(()=>[_("批量操作 "),o(C,{icon:"ant-design:down-outlined"})]),_:1})]),_:1})):k("",!0)]),action:t(({record:j})=>[o(a(ne),{actions:O(j)},null,8,["actions"])]),_:1},8,["onRegister"]),o(G,{onRegister:a(r),onSuccess:L},null,8,["onRegister"]),o(J,{onRegister:a(S),onSelect:N},null,8,["onRegister"])]),_:1},8,["onRegister"])}}});const mt=se(le,[["__scopeId","data-v-20dcdc2a"]]);export{mt as default};
