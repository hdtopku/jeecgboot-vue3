var J=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var P=(a,n,t)=>n in a?J(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,A=(a,n)=>{for(var t in n||(n={}))Z.call(n,t)&&P(a,t,n[t]);if(M)for(var t of M(n))ee.call(n,t)&&P(a,t,n[t]);return a},v=(a,n)=>X(a,Y(n));var r=(a,n,t)=>new Promise((l,m)=>{var k=s=>{try{f(t.next(s))}catch(c){m(c)}},i=s=>{try{f(t.throw(s))}catch(c){m(c)}},f=s=>s.done?l(s.value):Promise.resolve(s.value).then(k,i);f((t=t.apply(a,n)).next())});import{B as te}from"./index-156cafb7.js";import{p as ne,a as oe}from"./tenant.data-9b6cb136.js";import{p as ae,d as T}from"./tenant.api-9f2ccaf7.js";import{useListPage as se}from"./useListPage-37055c1f.js";import ie from"./BasicTable-e53fa5dc.js";import{Q as re}from"./componentMap-d4bccc5b.js";import"./useTable-abb474dc.js";import{_ as le}from"./TenantPackMenuModal.vue_vue_type_script_setup_true_name_tenant-pack-menu-modal_lang-f7c5fbb2.js";import{u as ce}from"./jeecg-online-vendor-231813f7.js";import ue from"./TenantPackUserModal-26cf0099.js";import{z as R,B as de}from"./index-ebe32d90.js";import{M as pe}from"./antd-vue-vendor-e4fda4cf.js";import{d as F,k as B,r as me,V as fe,a5 as C,a6 as ge,f as d,a7 as p,u as o,a9 as I,E as S,W as O,ag as ke,F as he}from"./vue-5a09445c.js";const we=F({name:"tenant-pack-modal"}),Fe=F(v(A({},we),{emits:["register","success"],setup(a,{emit:n}){const[t,{openModal:l}]=R(),[m,{openModal:k}]=R(),i=B(0),{prefixCls:f,tableContext:s}=se({designScope:"tenant-template",tableProps:{api:ae,columns:ne,immediate:!1,formConfig:{schemas:oe,labelCol:{xxl:8},actionColOptions:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8}},beforeFetch:e=>Object.assign(e,{tenantId:o(i),packType:"custom"})}}),[c,{reload:U},{rowSelection:D,selectedRowKeys:h,selectedRows:E}]=s,w=B(!1),[V,{setModalProps:Ce,closeModal:N}]=de(e=>r(this,null,function*(){i.value=e.tenantId,w.value=e.showPackAddAndEdit,u()})),j="租户产品包列表";function K(e){return r(this,null,function*(){N()})}function L(e){return[{label:"用户",onClick:q.bind(null,e)},{label:"编辑",onClick:$.bind(null,e),ifShow:()=>w.value}]}function u(){(h.value=[])&&U()}function $(e){return r(this,null,function*(){l(!0,{isUpdate:!0,record:e,tenantId:o(i),packType:"custom",showFooter:!0})})}const _=me(["superAdmin","accountAdmin","appAdmin"]),{createMessage:y}=ce();function z(e){return r(this,null,function*(){if(_.indexOf(e.packCode)!=-1){y.warning("默认系统产品包不允许删除");return}yield T({ids:e.id},u)})}function Q(){return r(this,null,function*(){let e=E.value;if(e&&e.length>0){for(let g=0;g<e.length;g++)if(_.indexOf(e[g].packCode)!=-1){y.warning("默认系统产品包不允许删除");return}}pe.confirm({title:"删除租户产品包",content:"是否删除租户产品包",okText:"确认",cancelText:"取消",onOk:()=>r(this,null,function*(){yield T({ids:h.value.join(",")},u)})})})}function W(){l(!0,{isUpdate:!1,tenantId:o(i),packType:"custom",showFooter:!0})}function q(e){k(!0,{record:e})}function G(e){return[{label:"详情",onClick:H.bind(null,e)},{label:"删除",popConfirm:{title:"是否确认删除租户产品包",confirm:z.bind(null,e)}}]}function H(e){l(!0,{isUpdate:!0,record:e,tenantId:o(i),packType:"custom",showFooter:!1})}return(e,g)=>{const b=fe("a-button");return C(),ge(he,null,[d(o(te),ke(e.$attrs,{onRegister:o(V),title:j,onOk:K,width:"800px",showCancelBtn:!1,showOkBtn:!1}),{default:p(()=>[d(o(ie),{onRegister:o(c),rowSelection:o(D)},{tableTitle:p(()=>[w.value?(C(),I(b,{key:0,preIcon:"ant-design:plus-outlined",type:"primary",onClick:W,style:{"margin-right":"5px"}},{default:p(()=>[S("新增 ")]),_:1})):O("",!0),o(h).length>0?(C(),I(b,{key:1,preIcon:"ant-design:delete-outlined",type:"primary",onClick:Q,style:{"margin-right":"5px"}},{default:p(()=>[S("批量删除 ")]),_:1})):O("",!0)]),action:p(({record:x})=>[d(o(re),{actions:L(x),dropDownActions:G(x)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"])]),_:1},16,["onRegister"]),d(le,{onRegister:o(t),onSuccess:u},null,8,["onRegister"]),d(ue,{onRegister:o(m),onSuccess:u},null,8,["onRegister"])],64)}}}));export{Fe as _};
