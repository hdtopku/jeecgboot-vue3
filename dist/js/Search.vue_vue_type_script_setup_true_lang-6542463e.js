import{d as ke,k as s,o as he,U as o,aV as i,as as E,f as u,bi as t,at as we,E as f,h as De,v as q,A as H,V as F,ar as y,u as j,R as C,ax as Fe,F as J,a_ as ue,ag as Q,g as xe}from"./vue-c7e3516e.js";import{ab as _,t as Be,a0 as Oe,a8 as ne}from"./antd-vue-vendor-1561c1ba.js";import{bl as Ae,bm as Ee}from"./jeecg-online-vendor-bf2efbcb.js";import{n as Se,L as Ne}from"./index-fde9c72f.js";const Pe=c=>{if(c==null)return"";const z=/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/g,k=c.match(z);return k!=null?k[0]:c},Ue=()=>navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)!=null,$e=()=>!Ue(),Te={class:"flex flex-wrap justify-evenly"},Le={key:0,class:"flex flex-wrap justify-evenly"},Me={key:1,class:"flex flex-wrap justify-evenly"},Ve=ke({__name:"Search",props:{placeholder:{type:String,default:"\u7C98\u8D34\u641C\u7D22"},showTop:{type:Boolean,default:!1},showCopy:{type:Boolean,default:!1},showPeople:{type:Boolean,default:!1},tabPane:{type:Object,default:()=>({tabs:[],activeKey:"0"})},switchName:{type:String,default:""}},emits:["queryList","changeAdvanced","confirmCopy"],setup(c,{expose:z,emit:k}){var ee;const p=c,{hasPermission:se}=Se(),d=s(_()),h=s(_()),n=s(),v=s(1),G=s(!0),S=s(!1),N=s(!1),K=s([]),m=s(0),w=s(!1),x=s(!1),oe=e=>e&&e>_().endOf("day"),ie=e=>e&&e>_().endOf("day")||e.isBefore(d.value),g=s(),B=(e,a=0)=>{m.value=e,m.value===365?d.value=_().startOf("year"):m.value===100?d.value=_().startOf("month"):d.value=_().subtract(e,"day"),h.value=_().subtract(a,"day"),g.value=!1,b()},W=()=>{g.value=!0,b()},re=()=>{navigator.clipboard.readText().then(e=>{n.value=e,b()}).catch(e=>{e instanceof DOMException?ne.error("\u8BF7\u624B\u52A8\u7C98\u8D34\uFF0C\u6216\u5141\u8BB8\u8BFB\u53D6\u526A\u8D34\u677F\uFF0C\u5931\u8D25\u539F\u56E0\uFF1A"+e):ne.error("\u8BF7\u624B\u52A8\u7C98\u8D34\uFF0C\u5931\u8D25\u539F\u56E0\uFF1A"+e)})},X=()=>{var e;return G.value?x.value&&((e=p.switchName)==null?void 0:e.length)>0?"warning":"primary":"error"},ce=()=>{K.value.length===0&&(N.value=!0,Ne({}).then(e=>{K.value=e.records,N.value=!1}))},I=Ae(Ee),O=s();let{username:P,realname:ve}=I==null?void 0:I.userInfo;const de=P;O.value=ve;const fe=e=>{P=e,G.value=de===O.value,e==null&&(O.value="\u6240\u6709\u4EBA"),b()},U=s((ee=p==null?void 0:p.tabPane)==null?void 0:ee.activeKey),pe=e=>{U.value=e,b()},b=()=>{var a,r,D,A,$,T,L,M,Y;d.value.isAfter(h.value)&&(h.value=d.value),n.value=Pe((a=n==null?void 0:n.value)==null?void 0:a.trim());let e=(r=n.value)==null?void 0:r.indexOf("/j/");e<0&&(e=(D=n.value)==null?void 0:D.indexOf("/c/")),e<0&&(e=(A=n.value)==null?void 0:A.indexOf("/d/")),e>=0&&(n.value=($=n.value)==null?void 0:$.substring(e+3)),e<0&&(e=(T=n.value)==null?void 0:T.indexOf("/jb/"),e>=0&&(n.value=(L=n.value)==null?void 0:L.substring(e+4)),e=(M=n.value)==null?void 0:M.indexOf("/jc/"),e>=0&&(n.value=(Y=n.value)==null?void 0:Y.substring(e+4))),localStorage.setItem("searchSwitch:"+p.switchName,JSON.stringify(x.value)),k("queryList",{pageNo:1,pageSize:30,startTime:d.value.startOf("day").format("YYYY-MM-DD HH:mm:ss"),endTime:h.value.endOf("day").format("YYYY-MM-DD HH:mm:ss"),keyword:n.value,username:P,checked:x.value,status:U.value})},me=()=>{w.value=!w.value,k("changeAdvanced")},Z=()=>{S.value=!0,k("confirmCopy",{count:v.value,username:P,checked:x.value})},{proxy:R}=xe();return z({queryFinish:(e="")=>{v.value===1?R.tool.copy(e,e+"\u5DF2\u590D\u5236"):R.tool.copy(e,v.value+"\u6761\u5DF2\u590D\u5236"),S.value=!1}}),he(()=>{var e;x.value=JSON.parse((e=localStorage.getItem("searchSwitch:"+p.switchName))!=null?e:"false"),b()}),(e,a)=>{var ae,te;const r=o("a-button"),D=o("a-space"),A=o("a-date-picker"),$=o("a-select-option"),T=o("a-spin"),L=o("a-select"),M=o("a-input"),Y=o("a-card"),V=o("a-col"),ye=o("a-slider"),_e=o("a-popconfirm"),ge=o("a-row"),be=o("a-tab-pane"),Ce=o("a-tabs");return i(),E(J,null,[u(Y,{size:"small"},{default:t(()=>[we("div",Te,[c.showTop?(i(),E("div",Le,[u(D,{size:5,class:"mb-2"},{default:t(()=>[u(r,{type:!g.value&&m.value===365?"link":"",onClick:a[0]||(a[0]=l=>B(365,0))},{default:t(()=>[f("\u4ECA\u5E74 ")]),_:1},8,["type"]),u(r,{type:!g.value&&m.value===30?"link":"",onClick:a[1]||(a[1]=l=>B(30,0))},{default:t(()=>[f(" 30\u5929 ")]),_:1},8,["type"]),u(r,{type:!g.value&&m.value===100?"link":"",onClick:a[2]||(a[2]=l=>B(100))},{default:t(()=>[f(" \u672C\u6708 ")]),_:1},8,["type"]),u(r,{type:!g.value&&m.value===1?"link":"",onClick:a[3]||(a[3]=l=>B(1,1))},{default:t(()=>[f(" \u6628\u5929 ")]),_:1},8,["type"]),u(r,{type:!g.value&&m.value===0?"link":"",onClick:a[4]||(a[4]=l=>B(0,0))},{default:t(()=>[f(" \u4ECA\u5929 ")]),_:1},8,["type"])]),_:1}),u(De,{"enter-active-class":"animate__animated animate__flipInX","leave-active-class":"animate__animated animate__flipOutX animate__faster"},{default:t(()=>[q(u(D,{class:"mb-2"},{default:t(()=>[u(A,{onChange:W,allowClear:"",placeholder:"\u5F00\u59CB\u65E5\u671F","disabled-date":oe,value:d.value,"onUpdate:value":a[5]||(a[5]=l=>d.value=l)},null,8,["value"]),u(A,{onChange:W,allowClear:"",placeholder:"\u7ED3\u675F\u65E5\u671F","disabled-date":ie,value:h.value,"onUpdate:value":a[6]||(a[6]=l=>h.value=l)},null,8,["value"])]),_:1},512),[[H,w.value]])]),_:1})])):F("",!0),u(M,{size:"large",value:n.value,"onUpdate:value":a[8]||(a[8]=l=>n.value=l),onChange:b,placeholder:c.placeholder,allowClear:""},{prefix:t(()=>[u(r,{type:"link",onClick:me},{default:t(()=>[w.value?(i(),y(j(Be),{key:0})):(i(),y(j(Oe),{key:1}))]),_:1}),C(e.$slots,"prefix"),w.value?(i(),y(D,{key:0},{default:t(()=>[j(se)("am:selectUser")&&c.showPeople?(i(),y(L,{key:0,size:"",loading:N.value,allowClear:"",ref:"select",value:O.value,"onUpdate:value":a[7]||(a[7]=l=>O.value=l),style:{width:"90px"},onFocus:ce,onChange:fe},Fe({default:t(()=>[(i(!0),E(J,null,ue(K.value,l=>(i(),y($,{key:l.id,value:l.username},{default:t(()=>[f(Q(l.realname),1)]),_:2},1032,["value"]))),128))]),_:2},[N.value?{name:"notFoundContent",fn:t(()=>[u(T,{size:"small"})]),key:"0"}:void 0]),1032,["loading","value"])):F("",!0),j($e)()?(i(),y(r,{key:1,ghost:"",type:"success",onClick:re},{default:t(()=>[f("\u7C98\u8D34")]),_:1})):F("",!0)]),_:1})):F("",!0)]),suffix:t(()=>[w.value?C(e.$slots,"suffixAdvanced",{key:0}):C(e.$slots,"suffixNotAdvanced",{key:1}),C(e.$slots,"suffix")]),_:3},8,["value","placeholder"])])]),_:3}),c.showCopy?(i(),y(ge,{key:0,class:"w-full mt-2"},{default:t(()=>[u(V,{span:4},{default:t(()=>[C(e.$slots,"left")]),_:3}),u(V,{span:14},{default:t(()=>[u(ye,{style:{display:"inline-block"},value:v.value,"onUpdate:value":a[9]||(a[9]=l=>v.value=l),min:1,max:500},null,8,["value"])]),_:1}),u(V,{class:"text-center",span:6},{default:t(()=>[q(u(r,{onClick:Z,loading:S.value,type:X()},{default:t(()=>[f("\u590D\u5236"+Q(v.value)+"\u6761 ",1)]),_:1},8,["loading","type"]),[[H,v.value===1]]),u(_e,{title:`\u786E\u5B9A\u590D\u5236${v.value}\u6761\u5417?`,"ok-text":"\u786E\u5B9A","cancel-text":"\u53D6\u6D88",onConfirm:Z},{default:t(()=>[q(u(r,{loading:S.value,placeholder:"\u5F00\u59CB\u65E5\u671F",type:X()},{default:t(()=>[f("\u590D\u5236"+Q(v.value)+"\u6761 ",1)]),_:1},8,["loading","type"]),[[H,v.value>1]])]),_:1},8,["title"])]),_:1})]),_:3})):F("",!0),((te=(ae=p.tabPane)==null?void 0:ae.tabs)==null?void 0:te.length)>0?(i(),E("div",Me,[u(Ce,{animated:!1,activeKey:U.value,"onUpdate:activeKey":a[10]||(a[10]=l=>U.value=l),onTabClick:pe},{leftExtra:t(()=>[C(e.$slots,"leftTabExtra")]),rightExtra:t(()=>[C(e.$slots,"rightTabExtra")]),default:t(()=>{var l;return[(i(!0),E(J,null,ue((l=p.tabPane)==null?void 0:l.tabs,le=>(i(),y(be,{key:le.tabKey,tab:le.tabName},null,8,["tab"]))),128))]}),_:3},8,["activeKey"])])):F("",!0)],64)}}});export{Ve as _};
