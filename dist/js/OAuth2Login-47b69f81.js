import{a3 as n,a4 as u}from"./index-b6e19f4a.js";import{d as m,k as c,a4 as h,a5 as k,a6 as v}from"./vue-705b7309.js";import{ah as A,au as y,s as _,q as L,u as q}from"./jeecg-online-vendor-88d7be55.js";import"./antd-vue-vendor-cce59da1.js";import"./tinymce-vendor-6e169cb2.js";import"./lodash-es-vendor-5fc8fca4.js";import"./codemirror-vendor-3f45d0f3.js";import"./echarts-vendor-6c8e2159.js";import"./vxe-table-vendor-60c6a8c7.js";const $=m({__name:"OAuth2Login",setup(w){const p=c(n()),e=c({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:l}=h(),s=l.value;n()||A.replace({path:y.BASE_LOGIN,query:s.query}),p.value&&g();function g(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),f()}function f(){if(e.value.thirdApp)if(s.query.oauth2LoginToken){let o=s.query.oauth2LoginToken;d({token:o,thirdType:s.query.thirdType})}else e.value.wxWork?u("wechat_enterprise"):e.value.dingtalk&&u("dingtalk")}function d(o){const i=_(),{notification:r}=q(),{t:a}=L();i.ThirdLogin(o).then(t=>{t&&t.userInfo?r.success({message:a("sys.login.loginSuccessTitle"),description:`${a("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):r.error({message:"登录失败",description:((t.response||{}).data||{}).message||t.message||"请求出现错误，请稍后再试",duration:4})})}return(o,i)=>(k(),v("div"))}});export{$ as default};
