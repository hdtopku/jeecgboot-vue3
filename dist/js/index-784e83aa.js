var v=Object.defineProperty,$=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var w=(i,e,o)=>e in i?v(i,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[e]=o,E=(i,e)=>{for(var o in e||(e={}))B.call(e,o)&&w(i,o,e[o]);if(_)for(var o of _(e))M.call(e,o)&&w(i,o,e[o]);return i},T=(i,e)=>$(i,O(e));var C=(i,e,o)=>new Promise((p,m)=>{var c=r=>{try{l(o.next(r))}catch(u){m(u)}},f=r=>{try{l(o.throw(r))}catch(u){m(u)}},l=r=>r.done?p(r.value):Promise.resolve(r.value).then(c,f);l((o=o.apply(i,e)).next())});import N from"./BasicTable-29c6504d.js";import{T as P}from"./componentMap-a6d21ad6.js";import"./BasicTable.vue_vue_type_style_index_0_lang-b7d11241.js";import{u as R}from"./useTable-7e303edd.js";import{ad as I,d as D,ac as V,l as W}from"./jeecg-online-vendor-bf2efbcb.js";import{d as U,e as y,U as x,aV as j,as as H,f as s,bi as a,E as A,u as g}from"./vue-c7e3516e.js";import"./index-fde9c72f.js";import"./lodash-es-vendor-42c8d3d4.js";import"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./codemirror-vendor-96aab763.js";import"./echarts-vendor-b30c7238.js";import"./html2canvas-vendor-654dcb8a.js";import"./vxe-table-vendor-8bace23a.js";import"./BasicForm-83ba9c88.js";import"./BasicForm.vue_vue_type_style_index_0_lang-aeaafe88.js";import"./index-8cf3aabb.js";import"./BasicModal-ff8f2086.js";import"./useWindowSizeFn-e5cad7ae.js";import"./useFormItem-4a12ff45.js";import"./JUpload.vue_vue_type_style_index_0_lang-3f4c90f3.js";import"./download-c8889ed9.js";import"./base64Conver-4e359726.js";import"./index-ee020524.js";import"./index-53e807bd.js";import"./useCountdown-473e4dcc.js";import"./JAddInput-2cbbbde9.js";import"./areaDataUtil-b2642a1f.js";import"./useSelectBiz-c744cf20.js";import"./props-8e8dbf4f.js";import"./index-d4783a30.js";import"./bem-deccd0b6.js";import"./props-c3781b9d.js";import"./useContextMenu-c0be0b5c.js";import"./useTreeBiz-faf9875a.js";import"./index-63ed9c18.js";import"./depart.api-25dc3d39.js";import"./index-ed4be6fa.js";import"./useForm-fa63344e.js";import"./injectionKey-5da932b3.js";const L=[{title:"\u6587\u4EF6\u540D\u79F0",dataIndex:"fileName",width:120},{title:"\u6587\u4EF6\u5730\u5740",dataIndex:"url",width:100}],G=[{label:"\u6587\u4EF6\u540D\u79F0",field:"fileName",component:"Input",colProps:{span:6}},{label:"\u6587\u4EF6\u5730\u5740",field:"url",component:"Input",colProps:{span:6}}],K="/sys/oss/file/upload",X="/sys/upload/uploadMinio",q=i=>I.get({url:"/sys/oss/file/list",params:i}),z=(i,e)=>I.delete({url:"/sys/oss/file/delete",params:i},{joinParamsToUrl:!0}).then(()=>{e()}),J=U({name:"system-ossfile"}),Re=U(T(E({},J),{setup(i){const{createMessage:e}=W(),o=D(),p={"X-Access-Token":V()},[m,{reload:c}]=R({api:q,rowKey:"id",columns:L,formConfig:{labelWidth:120,schemas:G,autoSubmitOnEnter:!0},striped:!0,useSearchForm:!0,showTableSetting:!0,clickToRowSelect:!1,bordered:!0,showIndexColumn:!1,tableSetting:{fullScreen:!0},beforeFetch:t=>Object.assign({column:"createTime",order:"desc"},t),actionColumn:{width:80,title:"\u64CD\u4F5C",dataIndex:"action",slots:{customRender:"action"},fixed:void 0}}),f=y(()=>`${o.uploadUrl}${K}`),l=y(()=>`${o.uploadUrl}${X}`);function r(t){if(t&&t.url){let n=encodeURIComponent(t.url);(n.endsWith(".pdf")||n.endsWith(".doc")||n.endsWith(".docx"))&&(n=n+"&officePreviewType=pdf");let d=`${o.viewUrl}?url=`+n;window.open(d,"_blank")}}function u(t){return C(this,null,function*(){yield z({id:t.id},c)})}function h(t){var n=t.type;if(n==="image"){if(n.indexOf("image")<0)return e.warning("\u8BF7\u4E0A\u4F20\u56FE\u7247"),!1}else if(n==="file"&&n.indexOf("image")>=0)return e.warning("\u8BF7\u4E0A\u4F20\u6587\u4EF6"),!1;return!0}function b(t){t.file.status==="done"?t.file.response.success?(c(),e.success(`${t.file.name} \u4E0A\u4F20\u6210\u529F!`)):e.error(`${t.file.response.message}`):t.file.status==="error"&&e.error(`${t.file.response.message}`)}function S(t){return[{label:"\u9884\u89C8",onClick:r.bind(null,t)},{label:"\u5220\u9664",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664",confirm:u.bind(null,t)}}]}return(t,n)=>{const d=x("a-button"),F=x("a-upload");return j(),H("div",null,[s(g(N),{onRegister:g(m)},{tableTitle:a(()=>[s(F,{name:"file",showUploadList:!1,action:f.value,headers:p,beforeUpload:h,onChange:b},{default:a(()=>[s(d,{type:"primary",preIcon:"ant-design:upload-outlined"},{default:a(()=>[A("OSS\u6587\u4EF6\u4E0A\u4F20")]),_:1})]),_:1},8,["action"]),s(F,{name:"file",showUploadList:!1,action:l.value,headers:p,beforeUpload:h,onChange:b},{default:a(()=>[s(d,{type:"primary",preIcon:"ant-design:upload-outlined"},{default:a(()=>[A("MINIO\u6587\u4EF6\u4E0A\u4F20")]),_:1})]),_:1},8,["action"])]),action:a(({record:k})=>[s(g(P),{actions:S(k)},null,8,["actions"])]),_:1},8,["onRegister"])])}}}));export{Re as default};
