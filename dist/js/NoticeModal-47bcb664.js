var w=Object.defineProperty;var f=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var h=(e,t,n)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C=(e,t)=>{for(var n in t||(t={}))_.call(t,n)&&h(e,n,t[n]);if(f)for(var n of f(t))D.call(t,n)&&h(e,n,t[n]);return e};var g=(e,t,n)=>new Promise((m,u)=>{var p=o=>{try{d(n.next(o))}catch(i){u(i)}},y=o=>{try{d(n.throw(o))}catch(i){u(i)}},d=o=>o.done?m(o.value):Promise.resolve(o.value).then(p,y);d((n=n.apply(e,t)).next())});import{d as T,l as x,e as R,u as a,a7 as v,ac as S,aa as P,f as B,af as L}from"./vue-86253b15.js";import{B as M}from"./index-5f3b36bb.js";import"./index-2b71c6a1.js";import{render as r}from"./renderUtils-3d92a36f.js";import{ap as l}from"./jeecg-online-vendor-bc5d810e.js";import{u as U,B as k}from"./useForm-61401b42.js";import{E}from"./index-4de4eaa0.js";const G=[{title:"标题",width:150,dataIndex:"titile"},{title:"消息类型",dataIndex:"msgCategory",width:100,customRender:({text:e})=>r.renderDict(e,"msg_category")},{title:"发布人",width:100,dataIndex:"sender"},{title:"优先级",dataIndex:"priority",width:70,customRender:({text:e})=>{const t=e=="L"?"blue":e=="M"?"yellow":"red";return r.renderTag(r.renderDict(e,"priority"),t)}},{title:"通告对象",dataIndex:"msgType",width:100,customRender:({text:e})=>r.renderDict(e,"msg_type")},{title:"发布状态",dataIndex:"sendStatus",width:70,customRender:({text:e})=>{const t=e=="0"?"red":e=="1"?"green":"gray";return r.renderTag(r.renderDict(e,"send_status"),t)}},{title:"发布时间",width:100,dataIndex:"sendTime"},{title:"撤销时间",width:100,dataIndex:"cancelTime"}],$=[{field:"titile",label:"标题",component:"JInput",colProps:{span:8}}],F=[{field:"id",label:"id",component:"Input",show:!1},{field:"msgCategory",label:"消息类型",required:!0,component:"JDictSelectTag",defaultValue:"1",componentProps:{type:"radio",dictCode:"msg_category",placeholder:"请选择类型"}},{field:"titile",label:"标题",component:"Input",required:!0,componentProps:{placeholder:"请输入标题"}},{field:"msgAbstract",label:"摘要",component:"InputTextArea",required:!0},{field:"msgType",label:"接收用户",defaultValue:"ALL",component:"JDictSelectTag",required:!0,componentProps:{type:"radio",dictCode:"msg_type",placeholder:"请选择发布范围"}},{field:"userIds",label:"指定用户",component:"JSelectUser",required:!0,componentProps:{rowKey:"id",labelKey:"username"},ifShow:({values:e})=>e.msgType=="USER"},{field:"priority",label:"优先级",defaultValue:"H",component:"JDictSelectTag",componentProps:{dictCode:"priority",type:"radio",placeholder:"请选择优先级"}},{field:"msgContent",label:"内容",component:"Input",render:r.renderTinymce}];const Q="/sys/annountCement/exportXls",W="/sys/annountCement/importExcel",Y=e=>l.get({url:"/sys/annountCement/list",params:e}),N=(e,t)=>{let n=t?"/sys/annountCement/edit":"/sys/annountCement/add";return l.post({url:n,params:e})},Z=(e,t)=>l.delete({url:"/sys/annountCement/delete",data:e},{joinParamsToUrl:!0}).then(()=>{t()}),A=e=>l.delete({url:"/sys/annountCement/deleteBatch",data:e},{joinParamsToUrl:!0}),ee=e=>l.get({url:"/sys/annountCement/doReleaseData",params:e}),te=e=>l.get({url:"/sys/annountCement/doReovkeData",params:e}),q=T({__name:"NoticeModal",emits:["register","success"],setup(e,{emit:t}){const n=x(!0),[m,{resetFields:u,setFieldsValue:p,validate:y}]=U({schemas:F,showActionButtonGroup:!1}),[d,{setModalProps:o,closeModal:i}]=E(s=>g(this,null,function*(){yield u(),o({confirmLoading:!1}),n.value=!!(s!=null&&s.isUpdate),a(n)&&(s.record.userIds&&(s.record.userIds=s.record.userIds.substring(0,s.record.userIds.length-1)),yield p(C({},s.record)))})),I=R(()=>a(n)?"编辑":"新增");function b(s){return g(this,null,function*(){try{let c=yield y();o({confirmLoading:!0}),c.msgType==="ALL"?c.userIds="":c.userIds+=",",yield N(c,n.value),i(),t("success")}finally{o({confirmLoading:!1})}})}return(s,c)=>(v(),S(a(M),L(s.$attrs,{onRegister:a(d),title:I.value,onOk:b,width:"900px",destroyOnClose:""}),{default:P(()=>[B(a(k),{onRegister:a(m)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}}),ne=Object.freeze(Object.defineProperty({__proto__:null,default:q},Symbol.toStringTag,{value:"Module"}));export{ne as N,q as _,Q as a,W as b,G as c,Z as d,A as e,ee as f,Y as g,te as h,$ as s};
