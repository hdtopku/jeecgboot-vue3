var h=(w,g,c)=>new Promise((u,n)=>{var i=a=>{try{_(c.next(a))}catch(p){n(p)}},e=a=>{try{_(c.throw(a))}catch(p){n(p)}},_=a=>a.done?u(a.value):Promise.resolve(a.value).then(i,e);_((c=c.apply(w,g)).next())});import{d as M,l as v,V as s,a7 as m,ac as k,aa as t,f as l,a8 as b,ab as P,E as I,ae as j,F as z,ad as D,af as A,u as o}from"./vue-86253b15.js";import{u as K,B as O}from"./index-6be60ec8.js";import{q as S}from"./jeecg-online-vendor-bc5d810e.js";import{q as T,h as U}from"./role.api-104e8967.js";import"./antd-vue-vendor-371529c2.js";import"./tinymce-vendor-7c917b36.js";import"./index-4de4eaa0.js";import"./lodash-es-vendor-04a44d0a.js";import"./codemirror-vendor-9b2dceac.js";import"./echarts-vendor-ba343549.js";import"./vxe-table-vendor-6a8d95c4.js";const $={style:{width:"100%","margin-top":"15px"}},G={key:1},H=D("h3",null,"无配置信息!",-1),J=[H],le=M({__name:"RoleDataRuleDrawer",emits:["success","register"],setup(w,{emit:g}){const{createMessage:c}=S(),u=v(""),n=v(""),i=v([]),e=v([]),[_,{setDrawerProps:a,closeDrawer:p}]=K(d=>h(this,null,function*(){yield R(),a({confirmLoading:!1}),u.value=d.functionId,n.value=d.roleId;const r=yield T({functionId:o(u),roleId:o(n)});r.success&&(i.value=r.result.datarule,r.result.drChecked&&(e.value=r.result.drChecked.split(",")))}));function R(){u.value="",n.value="",i.value=[],e.value=[]}function x(){return h(this,null,function*(){(!o(e)||o(e).length==0)&&c.warning("请注意，现未勾选任何数据权限!");let d={permissionId:o(u),roleId:o(n),dataRuleIds:o(e).join(",")};yield U(d),p(),g("success")})}return(d,r)=>{const C=s("a-checkbox"),y=s("a-col"),B=s("Icon"),N=s("a-button"),V=s("a-row"),q=s("a-checkbox-group"),F=s("a-tab-pane"),L=s("a-tabs");return m(),k(o(O),A(d.$attrs,{onRegister:o(_),title:"数据规则配置",width:"450px",destroyOnClose:""}),{default:t(()=>[l(L,{defaultActiveKey:"1"},{default:t(()=>[l(F,{tab:"数据规则",key:"1"},{default:t(()=>[i.value.length>0?(m(),k(q,{key:0,value:e.value,"onUpdate:value":r[0]||(r[0]=f=>e.value=f)},{default:t(()=>[l(V,null,{default:t(()=>[(m(!0),b(z,null,P(i.value,(f,E)=>(m(),k(y,{span:24,key:"dr"+E},{default:t(()=>[l(C,{value:f.id},{default:t(()=>[I(j(f.ruleName),1)]),_:2},1032,["value"])]),_:2},1024))),128)),l(y,{span:24},{default:t(()=>[D("div",$,[l(N,{onClick:x,type:"primary",size:"small"},{default:t(()=>[l(B,{icon:"ant-design:save-outlined"}),I("点击保存")]),_:1})])]),_:1})]),_:1})]),_:1},8,["value"])):(m(),b("div",G,J))]),_:1})]),_:1})]),_:1},16,["onRegister"])}}});export{le as default};
