var W=Object.defineProperty;var C=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var v=(o,s,t)=>s in o?W(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t,B=(o,s)=>{for(var t in s||(s={}))k.call(s,t)&&v(o,t,s[t]);if(C)for(var t of C(s))E.call(s,t)&&v(o,t,s[t]);return o};var w=(o,s,t)=>new Promise((d,i)=>{var c=r=>{try{p(t.next(r))}catch(m){i(m)}},l=r=>{try{p(t.throw(r))}catch(m){i(m)}},p=r=>r.done?d(r.value):Promise.resolve(r.value).then(c,l);p((t=t.apply(o,s)).next())});import{B as R}from"./BasicForm-83ba9c88.js";import"./componentMap-a6d21ad6.js";import{u as S}from"./useForm-fa63344e.js";import"./JAddInput-2cbbbde9.js";import"./index-fde9c72f.js";import{f as T,l as V,C as I,g as L}from"./menu.data-1f600b79.js";import{u as M,B as x}from"./index-fb25354c.js";import{useDrawerAdaptiveWidth as N}from"./useAdaptiveWidth-f3bdcb95.js";import{d as O,M as $,k as _,e as j,u as a,aV as q,ar as G,bi as Q,f as z,aQ as H}from"./vue-c7e3516e.js";const ne=O({__name:"MenuDrawer",emits:["success","register"],setup(o,{emit:s}){const{adaptiveWidth:t}=N(),d=$(),i=_(!0),c=_(0),l=e=>e===2,[p,{setProps:r,resetFields:m,setFieldsValue:g,updateSchema:F,validate:y,clearValidate:J}]=S({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:T,showActionButtonGroup:!1}),[b,{setDrawerProps:h,closeDrawer:A}]=M(e=>w(this,null,function*(){var n;yield m(),h({confirmLoading:!1}),i.value=!!(e!=null&&e.isUpdate),c.value=(n=e==null?void 0:e.record)==null?void 0:n.menuType;const u=yield V();if(F([{field:"parentId",componentProps:{treeData:u}},{field:"name",label:l(a(c))?"\u6309\u94AE/\u6743\u9650":"\u83DC\u5355\u540D\u79F0"},{field:"url",required:!l(a(c)),componentProps:{onChange:f=>D(f.target.value)}}]),typeof e.record=="object"){let f=B({},e.record);g(f),D(f.url)}r({disabled:!d.showFooter})})),P=j(()=>a(i)?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355");function U(){return w(this,null,function*(){try{const e=yield y();I.IFrame===e.component&&(e.component=e.frameSrc),h({confirmLoading:!0}),yield L(e,a(i)),A(),s("success")}finally{h({confirmLoading:!1})}})}function D(e){let u="",n=e;e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),u=`${e}`):u="\u8BF7\u8F93\u5165\u7EC4\u4EF6\u540D\u79F0",F([{field:"componentName",componentProps:{placeholder:u}}]),n!=null&&n!=""&&(n.startsWith("http://")||n.startsWith("https://"))&&g({component:n})}return(e,u)=>(q(),G(a(x),H(e.$attrs,{onRegister:a(b),showFooter:"",width:a(t),title:P.value,onOk:U}),{default:Q(()=>[z(a(R),{onRegister:a(p),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{ne as _};
