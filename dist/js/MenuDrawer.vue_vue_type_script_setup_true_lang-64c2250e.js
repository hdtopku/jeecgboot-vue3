var k=Object.defineProperty;var _=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var y=(o,s,t)=>s in o?k(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t,B=(o,s)=>{for(var t in s||(s={}))R.call(s,t)&&y(o,t,s[t]);if(_)for(var t of _(s))S.call(s,t)&&y(o,t,s[t]);return o};var g=(o,s,t)=>new Promise((d,i)=>{var p=r=>{try{c(t.next(r))}catch(l){i(l)}},f=r=>{try{c(t.throw(r))}catch(l){i(l)}},c=r=>r.done?d(r.value):Promise.resolve(r.value).then(p,f);c((t=t.apply(o,s)).next())});import{B as T}from"./BasicForm-e7d3537f.js";import"./componentMap-42aebfee.js";import{u as I}from"./useForm-b8bb8b05.js";import"./JAddInput-6e8b52df.js";import"./JSelectUser-9d666511.js";import"./JSelectDept-113b0470.js";import"./JPopup-746d3c0b.js";import"./index-26fb0584.js";import"./cron-parser-vendor-b0ab0fe2.js";import"./index-9ca8f863.js";import"./JEllipsis.vue_vue_type_script_setup_true_lang-8153fc9b.js";import{f as L,l as M,C as V,g as x}from"./menu.data-69a80efc.js";import{u as N,B as O}from"./index-2ed3aa04.js";import{useDrawerAdaptiveWidth as $}from"./useAdaptiveWidth-227426ee.js";import{d as j,M as q,k as C,e as G,u as a,a5 as z,a9 as E,a7 as H,f as J,ag as K}from"./vue-5a09445c.js";const fe=j({__name:"MenuDrawer",emits:["success","register"],setup(o,{emit:s}){const{adaptiveWidth:t}=$(),d=q(),i=C(!0),p=C(0),f=e=>e===2,[c,{setProps:r,resetFields:l,setFieldsValue:w,updateSchema:v,validate:D,clearValidate:b}]=I({labelCol:{md:{span:4},sm:{span:6}},wrapperCol:{md:{span:20},sm:{span:18}},schemas:L,showActionButtonGroup:!1}),[P,{setDrawerProps:h,closeDrawer:A}]=N(e=>g(this,null,function*(){var n;yield l(),h({confirmLoading:!1}),i.value=!!(e!=null&&e.isUpdate),p.value=(n=e==null?void 0:e.record)==null?void 0:n.menuType;const m=yield M();if(v([{field:"parentId",componentProps:{treeData:m}},{field:"name",label:f(a(p))?"按钮/权限":"菜单名称"},{field:"url",required:!f(a(p)),componentProps:{onChange:u=>F(u.target.value)}}]),typeof e.record=="object"){let u=B({},e.record);w(u),F(u.url)}p.value==2&&b(),r({disabled:!d.showFooter})})),U=G(()=>a(i)?"编辑菜单":"新增菜单");function W(){return g(this,null,function*(){try{const e=yield D();V.IFrame===e.component&&(e.component=e.frameSrc),h({confirmLoading:!0}),yield x(e,a(i)),A(),s("success")}finally{h({confirmLoading:!1})}})}function F(e){let m="",n=e;e!=null&&e!=""?(e.startsWith("/")&&(e=e.substring(1)),e=e.replaceAll("/","-"),e=e.replaceAll(":","@"),m=`${e}`):m="请输入组件名称",v([{field:"componentName",componentProps:{placeholder:m}}]),n!=null&&n!=""&&(n.startsWith("http://")||n.startsWith("https://"))&&w({component:n})}return(e,m)=>(z(),E(a(O),K(e.$attrs,{onRegister:a(P),showFooter:"",width:a(t),title:U.value,onOk:W}),{default:H(()=>[J(a(T),{onRegister:a(c),class:"menuForm"},null,8,["onRegister"])]),_:1},16,["onRegister","width","title"]))}});export{fe as _};
