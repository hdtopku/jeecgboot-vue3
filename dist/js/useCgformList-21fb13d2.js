import{bF as me,k as g,q as F,u as Fe,G as he,w as ye}from"./vue-c7e3516e.js";import"./index-8cf3aabb.js";import{a as be}from"./index-fb25354c.js";import{useListPage as De}from"./useListPage-5049b37a.js";import{l as Ee,d as ge,a as Be,b as Ce,c as we,e as ve,f as _e,g as Te}from"./CgformModal-b709fc79.js";import{C as T}from"./clipboard-68651e90.js";import{f as Se,l as Me}from"./jeecg-online-vendor-bf2efbcb.js";import{E as f,q as Le}from"./index-fde9c72f.js";import{dc as Ae,cz as S,ce as ke}from"./antd-vue-vendor-1561c1ba.js";var Pe=Object.defineProperty,xe=Object.defineProperties,Oe=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,Ue=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable,L=(u,t,o)=>t in u?Pe(u,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[t]=o,B=(u,t)=>{for(var o in t||(t={}))Ue.call(t,o)&&L(u,o,t[o]);if(M)for(var o of M(t))Ne.call(t,o)&&L(u,o,t[o]);return u},C=(u,t)=>xe(u,Oe(t)),h=(u,t,o)=>new Promise((d,m)=>{var a=i=>{try{s(o.next(i))}catch(r){m(r)}},p=i=>{try{s(o.throw(i))}catch(r){m(r)}},s=i=>i.done?d(i.value):Promise.resolve(i.value).then(a,p);s((o=o.apply(u,t)).next())}),k=(u=>(u[u.normal=0]="normal",u[u.copy=1]="copy",u))(k||{});const w="copy-this-text",A="data-clipboard-text";function Re(){return{createCopyModal:Ie}}const{createMessage:D,createConfirm:$e}=Me();function Ie(u){var t,o,d,m,a;const p=Fe(u.copyText),s=`INSERT INTO sys_permission(id, parent_id, name, url, component, component_name, redirect, menu_type, perms, perms_type, sort_no, always_show, icon, is_route, is_leaf, keep_alive, hidden, hide_tab, description, status, del_flag, rule_flag, create_by, create_time, update_by, update_time, internal_or_external) 
                       VALUES ('${Le()}', NULL, '${u.copyTitle}', '${p}', '1', NULL, NULL, 0, NULL, '1', 0.00, 0, NULL, 0, 1, 0, 0, 0, NULL, '1', 0, 0, 'admin', null, NULL, NULL, 0)`;let i=$e(C(B({},u),{iconType:(t=u.iconType)!=null?t:"info",width:(o=u.width)!=null?o:500,title:(d=u.title)!=null?d:"\u590D\u5236",closable:!0,maskClosable:(m=u.maskClosable)!=null?m:!0,cancelText:"\u590D\u5236SQL",okText:(a=u.okText)!=null?a:"\u590D\u5236URL",cancelButtonProps:{class:"copy-this-sql","data-clipboard-text":s},okButtonProps:C(B({},u.okButtonProps),{class:w,[A]:p}),onOk(){return new Promise(r=>{const l=new T("."+w);l.on("success",()=>{l.destroy(),D.success("\u590D\u5236URL\u6210\u529F"),r()}),l.on("error",()=>{D.error("\u8BE5\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u81EA\u52A8\u590D\u5236"),l.destroy(),r()})})},onCancel(){return new Promise(r=>{const l=new T(".copy-this-sql");l.on("success",()=>{l.destroy(),D.success("\u590D\u5236\u63D2\u5165\u83DC\u5355SQL\u6210\u529F"),r()}),l.on("error",()=>{D.error("\u8BE5\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u81EA\u52A8\u590D\u5236"),l.destroy(),r()})})}}));return he(u.copyText)&&ye(u.copyText,r=>{i.update({okButtonProps:C(B({},u.okButtonProps),{class:w,[A]:r})})}),i}function Xe(u){const t=u.pageType===k.normal,o=me(),d=De({designScope:u.designScope,tableProps:{api:Ee,columns:u.columns,formConfig:{schemas:u.formSchemas},beforeFetch:e=>{let n=t?0:1,c=t?void 0:o.currentRoute.value.params.code;return Se(e.tableType_MultiString)&&(e.tableType_MultiString=e.tableType_MultiString.join(",")),Object.assign(e,{copyType:n,physicId:c})}}}),{tableContext:m,createMessage:a,createConfirm:p}=d,[,{reload:s,setLoading:i},{selectedRowKeys:r,selectedRows:l}]=m,[P,v]=f(),[x,O]=f(),[U,N]=f(),[R,$]=f(),[I,q]=f(),[j,Y]=f(),[G,J]=f(),[V,Q]=be(),[z,K]=f();function X(){v.openModal(!0,{isUpdate:!1})}function H(e){v.openModal(!0,{isUpdate:!0,record:e})}function W(e){return h(this,null,function*(){yield Be(e),s()})}function Z(e){return h(this,null,function*(){yield Ce(e),s()})}function ee(){let e=r.value;if(e.length<=0){a.warning("\u8BF7\u5148\u9009\u62E9\u4E00\u6761\u8BB0\u5F55\uFF01");return}p({title:"\u5220\u9664",content:"<p>\u79FB\u9664\u53EA\u4F1A\u5220\u9664\u8868\u5355\u914D\u7F6E\uFF1B<br>\u5220\u9664\u5219\u4F1A\u5220\u9664\u5BF9\u5E94\u7684\u6570\u636E\u5E93\u8868\u4EE5\u53CA\u5B50\u8868\u4E14\u4E0D\u80FD\u6062\u590D\u3002<br>\u8BF7\u786E\u8BA4\u60A8\u7684\u64CD\u4F5C\u2026</p>",iconType:"warning",closable:!0,okText:"\u79FB\u9664",cancelText:"\u5220\u9664",cancelButtonProps:{danger:!0},onOk:()=>h(this,null,function*(){return _(we,e,!0)}),onCancel(n){return n!=null&&n.triggerCancel?Promise.resolve():_(ve,e,!0)}})}function _(e,n,c=!1){return h(this,null,function*(){try{i(!0);const E=yield e(n);return s(),c&&(r.value=[]),E}finally{i(!1)}return Promise.reject()})}function ue(){y(([e])=>$.openModal(!0,{row:e}))}function te(){y(([e])=>q.openModal(!0,{row:e}))}function ne(){y(([e])=>Y.openModal(!0,{row:e}))}function oe(){y(([e])=>J.openModal(!0,{row:e}))}function ae(){O.openModal(!0,{})}function y(e,n=1,c=1){l.value.length<n?a.warning(`\u8BF7\u5148\u81F3\u5C11\u9009\u4E2D ${n} \u6761\u8BB0\u5F55`):l.value.length>c?a.warning(`\u6700\u591A\u53EA\u80FD\u9009\u4E2D ${n} \u6761\u8BB0\u5F55`):e(l.value)}function le(){if(l.value.length===0)a.warning("\u8BF7\u5148\u9009\u4E2D\u4E00\u6761\u8BB0\u5F55");else if(l.value.length>1)a.warning("\u4EE3\u7801\u751F\u6210\u53EA\u80FD\u9009\u4E2D\u4E00\u6761\u8BB0\u5F55");else{let e=l.value[0];e?e.isDbSynch!="Y"?a.warning("\u8BF7\u5148\u540C\u6B65\u6570\u636E\u5E93\uFF01"):e.tableType==3?a.warning("\u8BF7\u9009\u4E2D\u8BE5\u8868\u5BF9\u5E94\u7684\u4E3B\u8868"):N.openModal(!0,{code:e.id}):a.warning("\u8BF7\u9009\u4E2D\u5F53\u524D\u9875\u7684\u6570\u636E\uFF01")}}function ie(e){e.isTree=="Y"?o.push({path:"/online/cgformTreeList/"+e.id}):o.push({path:"/online/cgformList/"+e.id})}function re(e){const n=g("normal"),c=g(!1),E=p({iconType:"info",title:"\u540C\u6B65\u6570\u636E\u5E93",content:()=>F("div",{style:"margin: 20px 0;"},F(Ae,{value:n.value,disabled:c.value,"onUpdate:value":b=>n.value=b},()=>[F(S,{value:"normal"},()=>"\u666E\u901A\u540C\u6B65\uFF08\u4FDD\u7559\u8868\u6570\u636E\uFF09"),F(S,{value:"force"},()=>"\u5F3A\u5236\u540C\u6B65\uFF08\u5220\u9664\u8868\uFF0C\u91CD\u65B0\u751F\u6210\uFF09")])),maskClosable:!0,okText:"\u5F00\u59CB\u540C\u6B65",onOk(){return h(this,null,function*(){c.value=!0,E.update({maskClosable:!1,keyboard:!1,okText:"\u540C\u6B65\u4E2D\u2026",okButtonProps:{loading:c.value},cancelButtonProps:{disabled:c.value}});try{yield _e(e.id,n.value)}catch(b){a.warn(b.message||b)}finally{s()}})}})}const{createCopyModal:se}=Re();function ce(e){let n;e.themeTemplate==="erp"?n=`/online/cgformErpList/${e.id}`:e.themeTemplate==="innerTable"?n=`/online/cgformInnerTableList/${e.id}`:e.themeTemplate==="tab"?n=`/online/cgformTabList/${e.id}`:e.isTree=="Y"?n=`/online/cgformTreeList/${e.id}`:n=`/online/cgformList/${e.id}`,se({title:`\u83DC\u5355\u94FE\u63A5\u3010${e.tableTxt}\u3011`,content:n,copyText:n,copyTitle:`${e.tableTxt}`})}function pe(e){const n=g(e.tableName+"_copy");p({title:"\u590D\u5236\u8868",content:()=>F("div",{style:"margin: 20px 0;"},["\u8BF7\u8F93\u5165\u65B0\u8868\u540D\uFF1A",F(ke,{value:n.value,"onUpdate:value":c=>n.value=c})]),iconType:"info",closable:!0,okText:"\u590D\u5236",onOk(){n.value?n.value===e.tableName?a.warning("\u65B0\u8868\u540D\u548C\u65E7\u8868\u540D\u4E0D\u80FD\u4E00\u81F4"):Te(e.id,n.value).then(s):a.warning("\u8BF7\u8F93\u5165\u65B0\u8868\u540D")}})}function fe(e){return[{label:"\u7F16\u8F91",onClick:()=>H(e)}]}function de(e){return[{label:"\u540C\u6B65\u6570\u636E\u5E93",onClick:()=>re(e),ifShow:()=>t&&e.isDbSynch!="Y"},{label:"\u529F\u80FD\u6D4B\u8BD5",class:["low-app-hide"],onClick:()=>ie(e),ifShow:()=>t?e.isDbSynch=="Y"&&e.tableType!==3:!0},{label:"\u914D\u7F6E\u5730\u5740",class:["low-app-hide"],onClick:()=>ce(e),ifShow:()=>t?e.isDbSynch=="Y"&&e.tableType!==3:!0},{label:"\u6743\u9650\u63A7\u5236",onClick:()=>Q.openDrawer(!0,{cgformId:e.id})},{label:"\u89D2\u8272\u6388\u6743",onClick:()=>K.openModal(!0,{cgformId:e.id})},{label:"\u89C6\u56FE\u7BA1\u7406",class:["low-app-hide"],onClick:()=>o.push(`/online/copyform/${e.id}`),ifShow:()=>t&&e.hascopy==1},{label:"\u751F\u6210\u89C6\u56FE",class:["low-app-hide"],popConfirm:{title:"\u786E\u5B9A\u751F\u6210\u89C6\u56FE\u5417\uFF1F",placement:"left",confirm:()=>{i(!0),ge(e.id).then(()=>{a.success("\u5DF2\u6210\u529F\u751F\u6210\u89C6\u56FE")}).finally(()=>{i(!1),s()})}},ifShow:()=>t},{label:"\u590D\u5236\u8868",onClick:()=>pe(e),ifShow:()=>t},{label:"\u79FB\u9664",popConfirm:{title:"\u786E\u5B9A\u79FB\u9664\u5417\uFF1F",placement:"left",confirm:()=>Z(e.id)}},{label:"\u5220\u9664",popConfirm:{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",placement:"left",confirm:()=>W(e.id)},ifShow:()=>t}]}return{router:o,pageContext:d,onAdd:X,onDeleteBatch:ee,onImportDbTable:ae,onGenerateCode:le,onShowCustomButton:ue,onShowEnhanceJs:te,onShowEnhanceSql:ne,onShowEnhanceJava:oe,getTableAction:fe,getDropDownAction:de,registerCustomButtonModal:R,registerEnhanceJsModal:I,registerEnhanceSqlModal:j,registerEnhanceJavaModal:G,registerAuthManagerDrawer:V,registerAuthSetterModal:z,registerCgformModal:P,registerDbToOnlineModal:x,registerCodeGeneratorModal:U}}export{k as C,Xe as u};
