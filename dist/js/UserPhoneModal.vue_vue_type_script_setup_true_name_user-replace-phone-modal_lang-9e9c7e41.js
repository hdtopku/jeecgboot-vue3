var V=Object.defineProperty,z=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var k=(o,s,e)=>s in o?V(o,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[s]=e,v=(o,s)=>{for(var e in s||(s={}))P.call(s,e)&&k(o,e,s[e]);if(b)for(var e of b(s))U.call(s,e)&&k(o,e,s[e]);return o},M=(o,s)=>z(o,I(s));var h=(o,s,e)=>new Promise((a,n)=>{var p=t=>{try{m(e.next(t))}catch(c){n(c)}},f=t=>{try{m(e.throw(t))}catch(c){n(c)}},m=t=>t.done?a(t.value):Promise.resolve(t.value).then(p,f);m((e=e.apply(o,s)).next())});import{B as N}from"./BasicModal-d2e0602d.js";import{C as O}from"./index-89a04c4e.js";import{t as T,v as $,S as j,u as q}from"./jeecg-online-vendor-9cc54e36.js";import"./index-9ca8f863.js";import{rules as A}from"./validator-79eadaee.js";import{B as D}from"./index-26fb0584.js";import{u as G}from"./UserSetting.api-bda68a5b.js";import{bo as L}from"./antd-vue-vendor-04f0af1d.js";import{d as w,r as H,k as C,V as d,a5 as J,a9 as K,a7 as u,f as l,u as R,E as Q,ag as W}from"./vue-5a09445c.js";const X=w({name:"user-replace-phone-modal"}),me=w(M(v({},X),{emits:["register","success"],setup(o,{emit:s}){T();const{createMessage:e}=q(),a=H({phone:"",smscode:""}),n=C(),p=C({}),f={phone:[v({},A.duplicateCheckRule("sys_user","phone",a,{label:"手机号"})[0]),{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式有误"}],smscode:[{required:!0,message:"请输入验证码"}]};L.useForm;const m=C(""),[t,{setModalProps:c,closeModal:B}]=D(r=>h(this,null,function*(){n.value.resetFields(),n.value.clearValidate(),c({confirmLoading:!1}),m.value="修改手机号",r.record.smscode="",Object.assign(a,r.record),p.value=r.record}));function y(){return $({mobile:a.phone,smsmode:j.REGISTER})}function S(){return h(this,null,function*(){yield n.value.validateFields(),G(a).then(r=>{r.success?(e.success("修改手机号成功"),s("success"),B()):e.warning(r.message)})})}return(r,i)=>{const x=d("a-input"),_=d("a-form-item"),E=d("a-button"),F=d("a-form");return J(),K(N,W(r.$attrs,{onRegister:R(t),width:"500px",title:m.value,showCancelBtn:!1,showOkBtn:!1}),{default:u(()=>[l(F,{class:"antd-modal-form",ref_key:"formRef",ref:n,model:a,rules:f},{default:u(()=>[l(_,{name:"phone"},{default:u(()=>[l(x,{size:"large",value:a.phone,"onUpdate:value":i[0]||(i[0]=g=>a.phone=g),placeholder:"请输入手机号"},null,8,["value"])]),_:1}),l(_,{name:"smscode"},{default:u(()=>[l(R(O),{size:"large",value:a.smscode,"onUpdate:value":i[1]||(i[1]=g=>a.smscode=g),placeholder:"输入6位验证码",sendCodeApi:y},null,8,["value"])]),_:1}),l(_,null,{default:u(()=>[l(E,{size:"large",type:"primary",block:"",onClick:S},{default:u(()=>[Q(" 确认 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},16,["onRegister","title"])}}}));export{me as _};
