var x=(e,a,n)=>new Promise((f,i)=>{var r=t=>{try{u(n.next(t))}catch(y){i(y)}},o=t=>{try{u(n.throw(t))}catch(y){i(y)}},u=t=>t.done?f(t.value):Promise.resolve(t.value).then(r,o);u((n=n.apply(e,a)).next())});import{ad as P,bV as R,l as G,_ as X}from"./jeecg-online-vendor-bf2efbcb.js";import{d as q,e as S,U as E,aV as l,ar as m,bi as p,f as $,E as T,ag as k,V as b,k as Y,q as A,as as z,aQ as H,b7 as K,F as N}from"./vue-c7e3516e.js";import{a9 as L,F as Z}from"./antd-vue-vendor-1561c1ba.js";const U={getEnabledType:"/sys/thirdApp/getEnabledType",wechatEnterprise:{user:"/sys/thirdApp/sync/wechatEnterprise/user",depart:"/sys/thirdApp/sync/wechatEnterprise/depart"},dingtalk:{user:"/sys/thirdApp/sync/dingtalk/user",depart:"/sys/thirdApp/sync/dingtalk/depart"}};let D=null;const ee=()=>x(void 0,null,function*(){if(D!=null)return R(D);{let{success:e,result:a}=yield P.get({url:U.getEnabledType},{isTransformResponse:!1});if(e)return D=R(a),a}return{}}),O=q({__name:"JThirdAppDropdown",props:{type:String,name:String,syncToApp:Boolean,syncToLocal:Boolean},emits:["to-app","to-local"],setup(e,{emit:a}){const n=e,f=S(()=>n.type==="wechatEnterprise"?!1:n.syncToLocal);function i(r){a(r.key,{type:n.type})}return(r,o)=>{const u=E("a-button"),t=E("a-menu-item"),y=E("a-menu"),h=E("a-dropdown");return e.syncToApp&&e.syncToLocal?(l(),m(h,{key:0},{overlay:p(()=>[$(y,{onClick:i},{default:p(()=>[e.syncToApp?(l(),m(t,{key:"to-app"},{default:p(()=>[T("\u540C\u6B65\u5230"+k(e.name),1)]),_:1})):b("",!0),f.value?(l(),m(t,{key:"to-local"},{default:p(()=>[T("\u540C\u6B65\u5230\u672C\u5730")]),_:1})):b("",!0)]),_:1})]),default:p(()=>[$(u,{type:"primary",preIcon:"ant-design:sync-outlined"},{default:p(()=>[T("\u540C\u6B65"+k(e.name),1)]),_:1})]),_:1})):e.syncToApp?(l(),m(u,{key:1,type:"primary",preIcon:"ant-design:sync-outlined",onClick:o[0]||(o[0]=B=>i({key:"to-app"}))},{default:p(()=>[T("\u540C\u6B65"+k(e.name),1)]),_:1})):(l(),m(u,{key:2,type:"primary",preIcon:"ant-design:sync-outlined",onClick:o[1]||(o[1]=B=>i({key:"to-local"}))},{default:p(()=>[T("\u540C\u6B65"+k(e.name)+"\u5230\u672C\u5730",1)]),_:1}))}}}),ne=q({__name:"JThirdAppButton",props:{bizType:{type:String,required:!0},syncToApp:Boolean,syncToLocal:Boolean,selectedRowKeys:Array},emits:["sync-ok","sync-error","sync-finally"],setup(e,{emit:a}){const n=e,{createMessage:f,createWarningModal:i}=G(),r=Y({}),o=S(()=>({syncToApp:n.syncToApp,syncToLocal:n.syncToLocal})),u=S(()=>({"to-app":t,"to-local":y}));function t(s){B(s.type,"/toApp")}function y(s){B(s.type,"/toLocal")}function h(){return x(this,null,function*(){r.value=yield ee()})}function B(s,d){let C=U[s];if(!(C&&C[n.bizType]))return;let Q=C[n.bizType]+d,F=n.selectedRowKeys,V="\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u5168\u90E8\u6570\u636E\u5417\uFF1F\u53EF\u80FD\u82B1\u8D39\u8F83\u957F\u65F6\u95F4\uFF01";return Array.isArray(F)&&F.length>0?V=`\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u8FD9 ${F.length} \u9879\u5417\uFF1F`:F=[],new Promise((j,te)=>{const J=L.confirm({icon:$(Z),title:"\u540C\u6B65",content:V,onOk:()=>{J.update({keyboard:!1,okText:"\u540C\u6B65\u4E2D\u2026",cancelButtonProps:{disabled:!0}});let W={ids:F.join(",")};return P.get({url:Q,params:W},{isTransformResponse:!1}).then(c=>{let g={};c.result&&(g={width:600,title:c.message,content:()=>{let w,M=["\u6210\u529F\u4FE1\u606F\u5982\u4E0B\uFF1A",I(A,c.result.successInfo.map((_,v)=>`${v+1}. ${_}`).join(`
`))];return c.success?w=[...M,A("br"),"\u65E0\u5931\u8D25\u4FE1\u606F\uFF01"]:w=["\u5931\u8D25\u4FE1\u606F\u5982\u4E0B\uFF1A",I(A,c.result.failInfo.map((_,v)=>`${v+1}. ${_}`).join(`
`)),A("br"),...M],w}}),c.success?(g!=null?L.success(g):f.warning(c.message),a("sync-ok")):(g!=null?L.warning(g):f.warning(c.message),a("sync-error"))}).catch(()=>J.destroy()).finally(()=>{j(),a("sync-finally",{type:s,direction:d,isToApp:d==="/toApp",isToLocal:d==="/toLocal"})})},onCancel(){j()}})})}function I(s,d){return s("div",{id:"box",style:{minHeight:"100px",border:"1px solid #d9d9d9",fontSize:"14px",maxHeight:"250px",whiteSpace:"pre",overflow:"auto",padding:"10px"}},d)}return h(),(s,d)=>e.syncToApp||e.syncToLocal?(l(),z(N,{key:0},[r.value.wechatEnterprise?(l(),m(O,H({key:0,type:"wechatEnterprise",name:"\u4F01\u5FAE"},o.value,K(u.value)),null,16)):b("",!0),r.value.dingtalk?(l(),m(O,H({key:1,type:"dingtalk",name:"\u9489\u9489"},o.value,K(u.value)),null,16)):b("",!0)],64)):(l(),z(N,{key:1},[T("\u672A\u8BBE\u7F6E\u4EFB\u4F55\u540C\u6B65\u65B9\u5411")],64))}});const le=X(ne,[["__scopeId","data-v-d8023e59"]]);export{le as J};
