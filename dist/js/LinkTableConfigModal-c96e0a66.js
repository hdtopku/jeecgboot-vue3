import{B as N}from"./index-8cf3aabb.js";import{B as M}from"./BasicForm-83ba9c88.js";import"./componentMap-a6d21ad6.js";import{u as I}from"./useForm-fa63344e.js";import"./JAddInput-2cbbbde9.js";import{A as L}from"./index-fde9c72f.js";import{bW as R,ad as A}from"./jeecg-online-vendor-bf2efbcb.js";import{o as J}from"./omit-13df237f.js";import"./toString-8deea73b.js";import"./isArray-b183d537.js";import"./_baseClone-632ebf1c.js";import"./_arrayPush-ae8b790e.js";import"./_flatRest-34ab130c.js";import{k as c,e as q,U as b,aV as D,ar as j,bi as _,f as y,aQ as G}from"./vue-c7e3516e.js";import"./BasicModal-ff8f2086.js";import"./antd-vue-vendor-1561c1ba.js";import"./tinymce-vendor-40778af9.js";import"./useWindowSizeFn-e5cad7ae.js";import"./lodash-es-vendor-42c8d3d4.js";import"./codemirror-vendor-96aab763.js";import"./echarts-vendor-b30c7238.js";import"./html2canvas-vendor-654dcb8a.js";import"./vxe-table-vendor-8bace23a.js";import"./BasicForm.vue_vue_type_style_index_0_lang-aeaafe88.js";import"./useFormItem-4a12ff45.js";import"./JUpload.vue_vue_type_style_index_0_lang-3f4c90f3.js";import"./download-c8889ed9.js";import"./base64Conver-4e359726.js";import"./index-ee020524.js";import"./index-53e807bd.js";import"./useCountdown-473e4dcc.js";import"./index-ed4be6fa.js";import"./areaDataUtil-b2642a1f.js";import"./useSelectBiz-c744cf20.js";import"./props-8e8dbf4f.js";import"./index-d4783a30.js";import"./bem-deccd0b6.js";import"./props-c3781b9d.js";import"./useContextMenu-c0be0b5c.js";import"./useTreeBiz-faf9875a.js";import"./index-63ed9c18.js";import"./depart.api-25dc3d39.js";import"./_baseSlice-834c0c3e.js";var H=Object.defineProperty,C=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,E=(i,l,t)=>l in i?H(i,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[l]=t,z=(i,l)=>{for(var t in l||(l={}))K.call(l,t)&&E(i,t,l[t]);if(C)for(var t of C(l))$.call(l,t)&&E(i,t,l[t]);return i},m=(i,l,t)=>new Promise((n,r)=>{var g=o=>{try{u(t.next(o))}catch(s){r(s)}},f=o=>{try{u(t.throw(o))}catch(s){r(s)}},u=o=>o.done?n(o.value):Promise.resolve(o.value).then(g,f);u((t=t.apply(i,l)).next())});const Q={name:"LinkTableConfigModal",emits:["success","register"],components:{BasicModal:N,BasicForm:M},setup(i,{emit:l}){const t=c(!1),n=c("");let r={};const[g,{closeModal:f}]=L(e=>m(this,null,function*(){r=z({},e.record),yield v({dictTable:e.record.dictTable}),setTimeout(()=>m(this,null,function*(){let d=J(e.record,"dictTable");yield v(d),yield T()}),200),n.value=e.fieldName})),u=c(""),o=c(""),s=c([]),h=c([]);function P(e){return m(this,null,function*(){if(e){const d="/online/cgform/field/listByHeadCode",p=yield A.get({url:d,params:{headCode:e}});if(p&&p.length>0){let F=p.filter(a=>a.dbFieldName!="id"&&a.dbIsPersist==1);F.length>0?s.value=F.map(a=>({text:a.dbFieldTxt,value:a.dbFieldName})):s.value=[];let B=p.filter(a=>a.dbFieldName!="id"&&a.fieldShowType=="image"&&a.dbIsPersist==1);B.length>0?h.value=B.map(a=>({text:a.dbFieldTxt,value:a.dbFieldName})):h.value=[{text:"\u65E0\u56FE\u7247\u5B57\u6BB5\u53EF\u4EE5\u9009\u62E9",value:"",key:"",disabled:!0}]}else s.value=[],h.value=[{text:"\u65E0\u56FE\u7247\u5B57\u6BB5\u53EF\u4EE5\u9009\u62E9",value:"",key:"",disabled:!0}]}})}function w(e){return m(this,null,function*(){u.value="",o.value="",yield P(e)})}const O=q(()=>{let e=s.value,d=u.value,p=o.value;return e.filter(F=>F.value!=d&&F.value!=p)}),S=[{label:"rowKey",field:"rowKey",component:"Input",show:!1},{label:"dictField",field:"dictField",component:"Input",defaultValue:"id",show:!1},{label:"\u5B57\u6BB5\u63CF\u8FF0",field:"dbFieldTxt",component:"Input",required:!0},{label:"\u5173\u8054\u8868",field:"dictTable",component:"JSearchSelect",required:!0,componentProps:({formActionType:e})=>({dict:"onl_cgform_head where copy_type = 0,table_txt,table_name",pageSize:10,async:!0,immediateChange:!0,popContainer:".link-table-config-modal",params:{order:"desc",column:"create_time"},onChange:d=>m(this,null,function*(){(r.titleField||r.otherFields)&&(yield e.setFieldsValue({titleField:"",otherFields:"",imageField:""}),yield e.clearValidate()),yield w(d)})})},{label:"\u6807\u9898\u5B57\u6BB5",field:"titleField",component:"JSearchSelect",required:!0,componentProps:{async:!1,popContainer:".link-table-config-modal",dictOptions:s,immediateChange:!0,onChange:e=>{u.value=e,r.titleField=e}}},{label:"\u5C01\u9762\u56FE\u7247",field:"imageField",component:"JSearchSelect",componentProps:{async:!1,popContainer:".link-table-config-modal",dictOptions:h,immediateChange:!0,onChange:e=>{o.value=e,r.imageFieldName=e}}},{label:"\u5176\u4ED6\u5B57\u6BB5",field:"otherFields",component:"JSelectMultiple",componentProps:{popContainer:".link-table-config-modal",options:O,onChange:e=>{r.otherFields=e}}},{label:"\u663E\u793A\u65B9\u5F0F",field:"showType",component:"Select",defaultValue:"card",componentProps:{options:[{label:"\u5361\u7247",value:"card"},{label:"\u4E0B\u62C9\u6846",value:"select"}]}},{label:"\u662F\u5426\u591A\u9009",field:"multiSelect",component:"RadioGroup",defaultValue:!1,componentProps:{options:[{label:"\u5426",value:!1},{label:"\u662F",value:!0}]}}],[V,{validate:k,setFieldsValue:v,clearValidate:T,resetFields:W}]=I({schemas:S,showActionButtonGroup:!1,labelAlign:"right"});function x(){return m(this,null,function*(){let e=yield k();e.fieldName=n.value,l("success",e),f()})}return{registerModal:g,spinningLoading:t,registerForm:V,handleSubmit:x}}};function U(i,l,t,n,r,g){const f=b("BasicForm"),u=b("a-spin"),o=b("BasicModal");return D(),j(o,G({wrapClassName:"link-table-config-modal"},i.$attrs,{title:"\u5173\u8054\u8BB0\u5F55\u914D\u7F6E",onRegister:n.registerModal,keyboard:"",canFullscreen:!1,cancelText:"\u5173\u95ED",onOk:n.handleSubmit}),{default:_(()=>[y(u,{spinning:n.spinningLoading},{default:_(()=>[y(f,{onRegister:n.registerForm},null,8,["onRegister"])]),_:1},8,["spinning"])]),_:1},16,["onRegister","onOk"])}var qe=R(Q,[["render",U]]);export{qe as default};
