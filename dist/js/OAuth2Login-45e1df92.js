import{aj as r,a8 as h,ak as k,U as m,al as u,t as v,q as A,u as y}from"./jeecg-online-vendor-231813f7.js";import{d as _,k as l,a4 as L,a5 as T,a6 as w}from"./vue-5a09445c.js";import"./antd-vue-vendor-e4fda4cf.js";import"./tinymce-vendor-e2919cb0.js";import"./vxe-table-vendor-c5aaa9d2.js";import"./lodash-es-vendor-3f622b6f.js";const W=_({__name:"OAuth2Login",setup(x){const c=l(r()),e=l({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:p}=L(),s=p.value;r()||h.replace({path:k.BASE_LOGIN,query:s.query}),c.value&&g();function g(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),d()}function d(){if(e.value.thirdApp)if(s.query.oauth2LoginToken){let n=s.query.oauth2LoginToken;f({token:n,thirdType:s.query.thirdType,tenantId:m})}else e.value.wxWork?u("wechat_enterprise"):e.value.dingtalk&&u("dingtalk")}function f(n){const a=v(),{notification:i}=y(),{t:o}=A();a.ThirdLogin(n).then(t=>{t&&t.userInfo?i.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):i.error({message:o("sys.login.errorTip"),description:((t.response||{}).data||{}).message||t.message||o("sys.login.networkExceptionMsg"),duration:4})})}return(n,a)=>(T(),w("div"))}});export{W as default};
