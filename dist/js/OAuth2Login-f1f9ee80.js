import{d as h,l as r,a4 as m,a7 as k,a8 as v}from"./vue-ebecda47.js";import{af as u,I as A,b as y,bw as l,u as _,an as w,C as L,B as T}from"./jeecg-online-vendor-cfb58502.js";import"./antd-vue-vendor-b75e8c06.js";import"./tinymce-vendor-7c917b36.js";import"./lodash-es-vendor-cd7703c8.js";import"./vxe-table-vendor-4aae63bf.js";const W=h({__name:"OAuth2Login",setup(x){const c=r(u()),e=r({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:p}=m(),s=p.value;u()||A.replace({path:y.BASE_LOGIN,query:s.query}),c.value&&g();function g(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),d()}function d(){if(e.value.thirdApp)if(s.query.oauth2LoginToken){let n=s.query.oauth2LoginToken;f({token:n,thirdType:s.query.thirdType,tenantId:w})}else e.value.wxWork?l("wechat_enterprise"):e.value.dingtalk&&l("dingtalk")}function f(n){const i=_(),{notification:a}=L(),{t:o}=T();i.ThirdLogin(n).then(t=>{t&&t.userInfo?a.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):a.error({message:o("sys.login.errorTip"),description:((t.response||{}).data||{}).message||t.message||o("sys.login.networkExceptionMsg"),duration:4})})}return(n,i)=>(k(),v("div"))}});export{W as default};
