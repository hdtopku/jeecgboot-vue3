var b=Object.defineProperty;var y=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var h=(e,t,r)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I=(e,t)=>{for(var r in t||(t={}))C.call(t,r)&&h(e,r,t[r]);if(y)for(var r of y(t))D.call(t,r)&&h(e,r,t[r]);return e};var f=(e,t,r)=>new Promise((u,m)=>{var p=o=>{try{l(r.next(o))}catch(d){m(d)}},g=o=>{try{l(r.throw(o))}catch(d){m(d)}},l=o=>o.done?u(o.value):Promise.resolve(o.value).then(p,g);l((r=r.apply(e,t)).next())});import{B as R}from"./index-9793b37c.js";import{B as _}from"./BasicForm-f4f93547.js";import"./componentMap-e7638604.js";import{u as P}from"./useForm-23b2a8f6.js";import"./JAddInput-c3d24774.js";import"./JSelectUser-7d43c9a7.js";import"./JSelectDept-1dcd8f6b.js";import"./JPopup-576bb5ed.js";import{B as x}from"./index-a9a5a3b3.js";import"./cron-parser-vendor-15fe1aca.js";import{rules as v}from"./validator-bf07e139.js";import{render as n}from"./renderUtils-55ff983f.js";import{b as i}from"./jeecg-online-vendor-c39424cc.js";import{d as S,k as B,u as a,e as L,a5 as M,a9 as U,a7 as k,f as F,ag as q}from"./vue-bcbaddf9.js";const ee=[{title:"标题",width:150,dataIndex:"titile"},{title:"消息类型",dataIndex:"msgCategory",width:100,customRender:({text:e})=>n.renderDict(e,"msg_category")},{title:"发布人",width:100,dataIndex:"sender"},{title:"优先级",dataIndex:"priority",width:70,customRender:({text:e})=>{const t=e=="L"?"blue":e=="M"?"yellow":"red";return n.renderTag(n.renderDict(e,"priority"),t)}},{title:"通告对象",dataIndex:"msgType",width:100,customRender:({text:e})=>n.renderDict(e,"msg_type")},{title:"发布状态",dataIndex:"sendStatus",width:70,customRender:({text:e})=>{const t=e=="0"?"red":e=="1"?"green":"gray";return n.renderTag(n.renderDict(e,"send_status"),t)}},{title:"发布时间",width:100,dataIndex:"sendTime"},{title:"撤销时间",width:100,dataIndex:"cancelTime"}],te=[{field:"titile",label:"标题",component:"JInput",colProps:{span:8}}],A=[{field:"id",label:"id",component:"Input",show:!1},{field:"msgCategory",label:"消息类型",required:!0,component:"JDictSelectTag",defaultValue:"1",componentProps:{type:"radio",dictCode:"msg_category",placeholder:"请选择类型"}},{field:"titile",label:"标题",component:"Input",required:!0,componentProps:{placeholder:"请输入标题"}},{field:"msgAbstract",label:"摘要",component:"InputTextArea",required:!0},{field:"endTime",label:"截至日期",component:"DatePicker",componentProps:{showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择截至日期"},dynamicRules:({model:e})=>v.endTime(e.startTime,!0)},{field:"msgType",label:"接收用户",defaultValue:"ALL",component:"JDictSelectTag",required:!0,componentProps:{type:"radio",dictCode:"msg_type",placeholder:"请选择发布范围"}},{field:"userIds",label:"指定用户",component:"JSelectUser",required:!0,componentProps:{rowKey:"id",labelKey:"username"},ifShow:({values:e})=>e.msgType=="USER"},{field:"priority",label:"优先级",defaultValue:"H",component:"JDictSelectTag",componentProps:{dictCode:"priority",type:"radio",placeholder:"请选择优先级"}},{field:"msgContent",label:"内容",component:"Input",render:n.renderTinymce}],re="/sys/annountCement/exportXls",oe="/sys/annountCement/importExcel",se=e=>i.get({url:"/sys/annountCement/list",params:e}),J=(e,t)=>{let r=t?"/sys/annountCement/edit":"/sys/annountCement/add";return i.post({url:r,params:e})},ne=(e,t)=>i.delete({url:"/sys/annountCement/delete",data:e},{joinParamsToUrl:!0}).then(()=>{t()}),ae=e=>i.delete({url:"/sys/annountCement/deleteBatch",data:e},{joinParamsToUrl:!0}),ie=e=>i.get({url:"/sys/annountCement/doReleaseData",params:e}),le=e=>i.get({url:"/sys/annountCement/doReovkeData",params:e}),de=S({__name:"NoticeModal",emits:["register","success"],setup(e,{emit:t}){const r=B(!0),[u,{resetFields:m,setFieldsValue:p,validate:g}]=P({schemas:A,showActionButtonGroup:!1}),[l,{setModalProps:o,closeModal:d}]=x(s=>f(this,null,function*(){yield m(),o({confirmLoading:!1}),r.value=!!(s!=null&&s.isUpdate),a(r)&&(s.record.userIds&&(s.record.userIds=s.record.userIds.substring(0,s.record.userIds.length-1)),yield p(I({},s.record)))})),w=L(()=>a(r)?"编辑":"新增");function T(s){return f(this,null,function*(){try{let c=yield g();o({confirmLoading:!0}),c.msgType==="ALL"?c.userIds="":c.userIds+=",",yield J(c,r.value),d(),t("success")}finally{o({confirmLoading:!1})}})}return(s,c)=>(M(),U(a(R),q(s.$attrs,{onRegister:a(l),title:w.value,onOk:T,width:"900px",destroyOnClose:""}),{default:k(()=>[F(a(_),{onRegister:a(u)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{de as _,re as a,oe as b,ee as c,ae as d,ne as e,ie as f,se as g,le as h,te as s};
